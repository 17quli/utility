CREATE VIEW ${var:view_db}.wrq_tblwebnoticeattachments AS
SELECT z.flngWebNoticeAttachmentKey, z.flngWebNoticeKey, z.fstrName, z.flngCheckSum, z.flngSize, z.flngSizeCompressed, z.fstrDescription, z.fi64BinaryDataKey, z.fblnForcedPDF, z.fstrWho, z.fdtmWhen, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.wrq_tblwebnoticeattachments z LEFT OUTER JOIN (SELECT cl.fstrCustomerLevel, wb.flngwebnoticekey FROM ${var:source_db}.wrq_tblwebnotice wb INNER JOIN ${var:source_db}.app_tblcustomerlevel cl ON cl.flngcustomerkey = wb.flngcustomerkey WHERE wb.record_active_flag = 'Y' AND wb.record_deleted_flag = 'N' AND cl.record_active_flag = 'Y' AND cl.record_deleted_flag = 'N') zcl ON z.flngwebnoticekey = zcl.flngwebnoticekey WHERE nvl(zcl.fstrcustomerlevel, 'STD') = 'STD';
