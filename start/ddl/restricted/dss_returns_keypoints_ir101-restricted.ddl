CREATE VIEW ${var:view_db}.dss_returns_keypoints_ir101 AS
SELECT z.IRD_NUMBER, z.LOCATION_NUMBER, z.RETURN_PERIOD_DATE, z.RETURN_TYPE, z.RETURN_VERSION_NO, z.RETURN_STATUS, z.FORM_VERSION_NO, z.NUMBER_OF_ERROR_ITEMS, z.`TIMESTAMP`, z.ADJUSTMENTS_1206, z.CALCULATION_OF_EXPENSES_1209, z.CALCULATION_OF_INCOME_1204, z.CREDIT_ADJUSTMENTS_1210, z.GST_ON_FRINGE_BENEFITS_1205, z.GST_ON_PURCHS_AND_EXS_1211, z.GST_ON_SALES_AND_INCOME_1207, z.GST_TO_PAY_REFUND_1212, z.PRE_ENCRIPTION_CHECK_100018, z.PRE_ENCRIPTION_IRD_NO_100019, z.PRE_ENCRIPTION_LOC_NO_100020, z.TOTAL_PURCHASES_EXPENSES_1208, z.TOTAL_SALES_AND_INCOME_1201, z.TOTAL_TAXABLE_SUPPLIES_1203, z.ZERO_RATED_SUPPLIES_1202, z.ACCT_REV_FLAG_100668, z.ASSET_SAL_OVR_1000_100660, z.COMP_AND_VOLNT_PROV_TAX_100663, z.GST_AND_PROV_TAX_PAYBLE_100667, z.GST_LIABILITY_100666, z.GST_RFND_TRANS_PROV_TAX_100664, z.PROV_TAX_LES_GST_RE_XFR_100665, z.PRV_TAX_INST_DUE_100662, z.SALE_INC_FRM_PRIOR_MNTH_100656, z.SAL_AND_INC_ALL_BR_100659, z.SAL_AND_INC_FRM_ALL_BR_100658, z.SAL_AND_INC_LES_AST_SAL_100661, z.SUM_SAL_INC_THIS_LAST_100657, z.TOT_SAL_INC_THIS_PRD_100655, z.ADJUSTMNTS_AMT_12_5_PCT_100638, z.ADJUSTMNTS_AMT_15_PCT_100692, z.CALC_OF_EXP_12_5_PCT_100765, z.CALC_OF_EXP_15_PCT_100766, z.CALC_OF_INCOME_12_5_PCT_100767, z.CALC_OF_INCOME_15_PCT_100768, z.CREDIT_ADJ_12_5_PCT_100769, z.CREDIT_ADJ_15_PCT_100770, z.GST_PURCH_EXPS_12_5_PCT_100771, z.GST_PURCH_EXPS_15_PCT_100772, z.GST_SALES_INC_12_5_PCT_100773, z.GST_SALES_INC_15_PCT_100774, z.TOT_PURCH_EXP_12_5_PCT_100775, z.TOT_PURCH_EXP_15_PCT_100776, z.TOT_SALES_INC_12_5_PCT_100777, z.TOT_SALES_INC_15_PCT_100778, z.TOT_TAXBLE_SUP_12_5_PCT_100779, z.TOT_TAXBLE_SUP_15_PCT_100780, z.ZRO_RTD_SUP_12_5_PCT_100781, z.ZRO_RTD_SUP_15_PCT_100782, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.dss_returns_keypoints_ir101 z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON sc.ird_number = z.ird_number WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
