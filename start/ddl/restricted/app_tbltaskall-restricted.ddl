CREATE VIEW ${var:view_db}.app_tbltaskall AS
SELECT z.flngKey, z.fstrTaskSource, z.flngVer, z.flngVerLast, z.flngSubTask, z.fstrCategory, z.fstrType, z.fstrStage, z.flngCustomerKey, z.fintProfileNumber, z.flngAccountKey, z.fstrAccountType, z.fdtmFilingPeriod, z.flngResponsibilityKey, z.flngQueueKey, z.flngRuleKey, z.fblnQueueRuleError, z.fblnQueueUpdate, z.fintNotificationType, z.fblnInteractive, z.flngWeight, z.fdtmTaskDate, z.fstrTaskLanguage, z.fstrTaskArea, z.flngEvaluation, z.fdtmEvaluation, z.fstrIdType, z.fstrFormattedId, z.fstrListFormatName, z.fcurAmount, z.fstrExternalId, z.fdtmWorkDate, z.fdtmWorkDateTime, z.fdtmCreated, z.fdtmSubTaskCreated, z.fstrAssignedTo, z.fdtmAssigned, z.fdtmHandoff, z.fdtmAvailable, z.fdtmDue, z.fdtmExpire, z.fdtmUserCompleted, z.fdtmSubTaskCompleted, z.fdtmEverCompleted, z.fblnReminder, z.flngReminderDelay, z.fdtmReminder, z.fdtmAttention, z.fstrAttention, z.flngWaitTimeSubTask, z.flngWaitTimeTotal, z.flngAssignedTimeSubTask, z.flngAssignedTimeTotal, z.flngWaitDaysSubTask, z.flngWaitDaysTotal, z.flngAssignedDaysSubTask, z.flngAssignedDaysTotal, z.fstrWho, z.fdtmWhen, z.fdtmCompleted, z.fdtmAborted, z.source_table, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.app_tbltaskall z LEFT OUTER JOIN ${var:source_db}.app_tblcustomerlevel cl ON z.flngcustomerkey = cl.flngcustomerkey WHERE nvl(cl.fstrCustomerLevel, 'STD') = 'STD' AND nvl(cl.record_active_flag, 'Y') = 'Y';
