CREATE VIEW ${var:view_db}.dss_spk2ir_calls AS
SELECT z.CALL_NUMBER_CODE, z.CALL_DATE, z.CALL_START_TIME, z.CALL_END_TIME, z.IVR_SITE_INDICATOR, z.SERVICE_CODE, z.ABANDON_FLAG, z.IRD_NUMBER, z.AUTHORISED_IRD_NUMBER, z.HANDOFF_PROCESS_INDICATOR, z.TARGET_SKILL, z.OPEN_NAVIGATOR_ATTEMPTS, z.AUTHORISED_ID_ENTRY_ATTEMPTS, z.UNAUTHORISED_ID_ENTRY_ATTEMPTS, z.AUTHORISED_ID_NUMBER_TYPE, z.ON_DISAMBIGUATION, z.INTENT, z.SOFT_PHONE_TRANSFER, z.PIN_VERIFIED_INDICATOR, z.ADDRESS_VERIFIED_INDICATOR, z.DOB_VERIFIED_INDICATOR, z.NAME_VERIFIED_INDICATOR, z.PHONE_VERIFIED_INDICATOR, z.CLI_VERIFIED_INDICATOR, z.SOFT_PHONE_WRAP_UP_REASON_CODE, z.EDW_LOAD_DATE, z.RUN_ID, z.EAI_SEQUENCE_NUMBER, z.ID_ENTRY_ATTEMPTED, z.INTENT_CORRECT, z.ABANDON_INDICATOR, z.HANDOFF_CENTRE_INDICATOR, z.VOICE_MESSAGE_INDICATOR, z.MESSAGE_LEFT_COUNT, z.ABANDON_TIME, z.HANDOFF_TIME, z.CALL_DURATION, z.CALL_LEG, z.BIOMETRIC_IRD_NUMBER, z.BIOMETRIC_DATE_OF_BIRTH, z.BIOMETRIC_TOKEN3, z.BIOMETRIC_TOKEN4, z.TYPE_OF_VERIFICATION, z.IRD_NUMBER_LOOKED_UP, z.insert_object_run_key FROM ${var:source_db}.dss_spk2ir_calls z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON CAST(z.IRD_NUMBER AS INT) = CAST(sc.IRD_NUMBER AS INT) WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
