CREATE VIEW ${var:view_db}.dss_edw_voice_agent AS
SELECT z.TENANT_KEY, z.INTERACTION_ID, z.CONN_ID, z.INTERACTION_RESOURCE_ID, z.DATE_TIME_KEY, z.RESOURCE_KEY, z.LAST_VQUEUE_RESOURCE_KEY, z.MEDIA_TYPE_KEY, z.GROUP_COMBINATION_KEY, z.INTERACTION_TYPE_KEY, z.INTERACTION_DESCRIPTOR_KEY, z.USER_DATA_KEY1, z.USER_DATA_KEY2, z.CALENDAR_DATE, z.START_TS_LOCAL, z.END_TS_LOCAL, z.RESOURCE_NAME, z.FIRST_NAME, z.LAST_NAME, z.EMPLOYEE_ID, z.LAST_VQ_NAME, z.SOURCE_ADDRESS, z.RESOURCE_ROLE_CODE, z.ROLE_REASON, z.RESULT, z.RESULT_REASON, z.CAPPED, z.IRD_NUMBER, z.CLI, z.ACCEPTED_UNIQUE, z.ACCEPTED, z.NOTACCEPTED, z.OFFERED, z.RESPONDED_UNIQUE, z.RESPONSES, z.ABANDONED_INVITE, z.REJECTED, z.INVITE, z.INVITE_TIME, z.ENGAGE_TIME, z.ENGAGE, z.SHORT, z.HOLD_TIME, z.`HOLD`, z.WRAP_TIME, z.WRAP, z.CONSULT_RECEIVED_ENGAGE_TIME, z.CONSULT_RECEIVED_ACCEPTED, z.CONSULT_RESPONSES, z.CONSULT_RECEIVED_HOLD_TIME, z.CONSULT_RECEIVED_HOLD, z.CONSULT_RECEIVED_WRAP_TIME, z.CONSULT_RECEIVED_WRAP, z.CONSULT_RCV_WARM_ENGAGE_TIME, z.CONSULT_RCV_ACC_WARM, z.CONSULT_RCV_WARM_HOLD_TIME, z.CONSULT_RCV_WARM_HOLD, z.CONSULT_RCV_WARM_WRAP_TIME, z.CONSULT_RCV_WARM_WRAP, z.CONSULT_INITIATED, z.CONSULT_INITIATED_TIME, z.CONFERENCE_INITIATED, z.CONFERENCE_RECEIVED_ACCEPTED, z.TRANSFER_INIT_AGENT, z.XFER_RECEIVED_ACCEPTED, z.AGENT_DISCONNECT_FIRST, z.TIME_PERIOD_START, z.TOTAL_TIME, z.TALK_TIME, z.CALL_LEG, z.NAME, z.EDW_LOAD_DATE, z.insert_object_run_key FROM ${var:source_db}.dss_edw_voice_agent z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON CAST(z.IRD_NUMBER AS INT) = CAST(sc.IRD_NUMBER AS INT) WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
