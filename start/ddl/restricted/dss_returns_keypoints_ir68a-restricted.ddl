CREATE VIEW ${var:view_db}.dss_returns_keypoints_ir68a AS
SELECT z.IRD_NUMBER, z.LOCATION_NUMBER, z.RETURN_PERIOD_DATE, z.RETURN_TYPE, z.RETURN_VERSION_NO, z.RETURN_STATUS, z.FORM_VERSION_NO, z.NUMBER_OF_ERROR_ITEMS, z.`TIMESTAMP`, z.ACC_CLASS_NUMBER_1_412, z.AC_PREMIUM_EXCL_GST_401, z.CALC_EMPLOYER_PREMIUM_403, z.CLASS_NUMBER10_100356, z.CLASS_NUMBER11_100359, z.CLASS_NUMBER12_100362, z.CLASS_NUMBER13_100365, z.CLASS_NUMBER14_100368, z.CLASS_NUMBER15_100371, z.CLASS_NUMBER16_100374, z.CLASS_NUMBER17_100377, z.CLASS_NUMBER18_100380, z.CLASS_NUMBER19_100383, z.CLASS_NUMBER20_100386, z.CLASS_NUMBER21_100389, z.CLASS_NUMBER22_100392, z.CLASS_NUMBER23_100395, z.CLASS_NUMBER24_100398, z.CLASS_NUMBER3_100335, z.CLASS_NUMBER4_100338, z.CLASS_NUMBER5_100341, z.CLASS_NUMBER6_100344, z.CLASS_NUMBER7_100347, z.CLASS_NUMBER8_100350, z.CLASS_NUMBER9_100353, z.CLASS_NUMBER_2_100332, z.DATE_CERTIFICATES_KEYED_814, z.EXCESS_OVER_79466_410, z.FIRST_WEEK_PAYMENT_408, z.GST_ON_RESID_CLAIMS_LEVY_402, z.LIABLE_EARNINGS10_100357, z.LIABLE_EARNINGS11_100360, z.LIABLE_EARNINGS12_100363, z.LIABLE_EARNINGS13_100366, z.LIABLE_EARNINGS14_100369, z.LIABLE_EARNINGS15_100372, z.LIABLE_EARNINGS16_100375, z.LIABLE_EARNINGS17_100378, z.LIABLE_EARNINGS18_100381, z.LIABLE_EARNINGS19_100384, z.LIABLE_EARNINGS1_413, z.LIABLE_EARNINGS20_100387, z.LIABLE_EARNINGS21_100390, z.LIABLE_EARNINGS22_100393, z.LIABLE_EARNINGS23_100396, z.LIABLE_EARNINGS24_100399, z.LIABLE_EARNINGS2_100333, z.LIABLE_EARNINGS3_100336, z.LIABLE_EARNINGS4_100339, z.LIABLE_EARNINGS5_100342, z.LIABLE_EARNINGS6_100345, z.LIABLE_EARNINGS7_100348, z.LIABLE_EARNINGS8_100351, z.LIABLE_EARNINGS9_100354, z.OTHER_PAYMENTS_411, z.OVERPAY_PAYE_124, z.PAYMENT_AFTER_FIRST_WEEK_409, z.PREMIUM_EXCLUDING_GST_100402, z.PREMIUM_PAYABLE10_100358, z.PREMIUM_PAYABLE11_100361, z.PREMIUM_PAYABLE12_100364, z.PREMIUM_PAYABLE13_100367, z.PREMIUM_PAYABLE14_100370, z.PREMIUM_PAYABLE15_100373, z.PREMIUM_PAYABLE16_100376, z.PREMIUM_PAYABLE17_100379, z.PREMIUM_PAYABLE18_100382, z.PREMIUM_PAYABLE19_100385, z.PREMIUM_PAYABLE1_427, z.PREMIUM_PAYABLE20_100388, z.PREMIUM_PAYABLE21_100391, z.PREMIUM_PAYABLE22_100394, z.PREMIUM_PAYABLE23_100397, z.PREMIUM_PAYABLE24_100400, z.PREMIUM_PAYABLE2_100334, z.PREMIUM_PAYABLE3_100337, z.PREMIUM_PAYABLE4_100340, z.PREMIUM_PAYABLE5_100343, z.PREMIUM_PAYABLE6_100346, z.PREMIUM_PAYABLE7_100349, z.PREMIUM_PAYABLE8_100352, z.PREMIUM_PAYABLE9_100355, z.PREVIOUS_ISSUE_DATE_406, z.PREVIOUS_NOTICE_TYPE_405, z.PREVIOUS_PREM_AMOUNT_404, z.PRE_ENCRIPTION_CHECK_100018, z.PRE_ENCRIPTION_IRD_NO_100019, z.PRE_ENCRIPTION_LOC_NO_100020, z.STD_DISCLAIMER_APPLIES_100045, z.TOTAL_GROSS_EARNINGS_823, z.TOT_EARNINGS_LBLE_FOR_PREM_110, z.TOT_EMPLOY_PREM_PAYABLE_100401, z.CALC_GST_ON_PREMIUM_100575, z.EMPLOYER_PREMIUM_RATE_1_100544, z.EMPLOYER_PREMIUM_RATE_2_100545, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.dss_returns_keypoints_ir68a z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON CAST(z.IRD_NUMBER AS INT) = CAST(sc.IRD_NUMBER AS INT) WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
