CREATE VIEW ${var:view_db}.dss_returns_keypoints_ir15s AS
SELECT z.IRD_NUMBER, z.LOCATION_NUMBER, z.RETURN_PERIOD_DATE, z.RETURN_TYPE, z.RETURN_VERSION_NO, z.RETURN_STATUS, z.FORM_VERSION_NO, z.NUMBER_OF_ERROR_ITEMS, z.`TIMESTAMP`, z.CERTS_FILED_BY_TAPE_DISK_303, z.DATE_CERTIFICATES_KEYED_814, z.HALEX_INTEREST__1102, z.HALEX_NO_OF_CERTS_ATT_815, z.HALEX_RWT_1104, z.NETT_RWT_1006, z.NUMBER_OF_CERTS_ATTD_1118, z.OVER_UNDER_PAYMENT_1120, z.PRE_ENCRIPTION_CHECK_100018, z.PRE_ENCRIPTION_IRD_NO_100019, z.PRE_ENCRIPTION_LOC_NO_100020, z.TOTAL_INTEREST_PAID_100235, z.TOTAL_RWT_PAYABLE_1103, z.TOT_FORGN_WITHOLDING_TAX_1105, z.TOT_INT_24_CENTS_DOLLAR_1100, z.TOT_INT_33_CENTS_DOLLAR_1101, z.TOT_INT_NO_RWT_DED_100236, z.TOT_RWT_FOR_CERTS_ATT_1117, z.TOT_RWT_NO_CERTS_ATT_1119, z.NOT_USED_100024, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.dss_returns_keypoints_ir15s z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON sc.ird_number = z.ird_number WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
