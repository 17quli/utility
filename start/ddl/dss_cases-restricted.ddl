CREATE VIEW ${var:view_db}.dss_cases AS
SELECT z.IRD_NUMBER, z.LOCATION_NUMBER, z.CASE_TYPE_CODE, z.CASE_NUMBER, z.DATE_APPLIED, z.DATE_CEASED, z.CASE_KEY, z.DATE_BEGIN, z.DATE_END, z.CASE_CATEGORY_CODE, z.CASE_TYPE_GROUP_CODE, z.TOTAL_DEBT_AMOUNT, z.TOTAL_DISCREPANCY_AMT, z.TOTAL_HOURS_EFFORT, z.MANUAL_CASE_INDICATOR, z.OPEN_CASE_REASON_CODE, z.CLOSE_CASE_REASON_CODE, z.CASE_STATUS_CODE, z.AUDIT_RISK_RATING_CODE, z.AUDIT_CASE_AUTH_CODE, z.AUDIT_PROJECT_ID, z.OFFICE_UNIT_CODE, z.`TIMESTAMP`, z.AUDIT_TEAM_LEADER_ID, z.AUDIT_CASE_LEADER_ID, z.DISPUTE_DATE, z.INACTIVATED_DATE, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.dss_cases z LEFT OUTER JOIN ${var:source_db}.dss_special_clients_all sc ON CAST(z.IRD_NUMBER AS INT) = CAST(sc.IRD_NUMBER AS INT) WHERE nvl(sc.special_classification, 'STD') = 'STD' AND nvl(sc.record_active_flag, 'Y') = 'Y' AND nvl(sc.record_deleted_flag, 'N') = 'N';
