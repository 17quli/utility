CREATE VIEW ${var:view_db}.app_tbluserinfo AS
SELECT z.fstrUser, z.fstrType, z.fdtmStart, z.fdtmEnd, z.fstrFirstName, z.fstrFamilyName, z.fstrMiddleName, z.fstrTitle, z.fstrStreet, z.fstrStreet2, z.fstrUnit, z.fstrUnitType, z.fstrCity, z.fstrCounty, z.fstrState, z.fstrZip, z.fstrCountry, z.fstrAttention, z.fstrLocationCode, z.fstrUrbanization, z.fstrRowId, z.fstrMunicipality, z.fstrDistrict, z.fstrSubDistrict, z.fstrSubProvince, z.fstrAddressDescription, z.fblnVerified, z.fdtmVerified, z.fstrPhoneType1, z.fintCountryCode1, z.fstrCountry1, z.fstrAreaCode1, z.fstrPhoneNumber1, z.fstrExtension1, z.fstrPhoneType2, z.fintCountryCode2, z.fstrCountry2, z.fstrAreaCode2, z.fstrPhoneNumber2, z.fstrExtension2, z.fstrPhoneType3, z.fintCountryCode3, z.fstrCountry3, z.fstrAreaCode3, z.fstrPhoneNumber3, z.fstrExtension3, z.fstrPhoneType4, z.fintCountryCode4, z.fstrCountry4, z.fstrAreaCode4, z.fstrPhoneNumber4, z.fstrExtension4, z.fstrEmail, z.fstrLOB, z.fstrSBU, z.fstrRegion, z.fstrDistrictOffice, z.fstrResLocation, z.fstrDeskLocation, z.fstrAliasName, z.fstrNetworkId, z.fstrManager, z.flngCustomerKey, z.fblnProduction, z.fstrWho, z.fdtmWhen, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.app_tbluserinfo z LEFT OUTER JOIN ${var:source_db}.app_tblcustomerlevel cl ON z.flngCustomerKey = cl.flngCustomerKey WHERE nvl(cl.fstrcustomerlevel, 'STD') != 'SPCAD2' AND nvl(cl.record_active_flag, 'Y') = 'Y' AND nvl(cl.record_deleted_flag, 'N') = 'N';
