CREATE VIEW ${var:view_db}.app_tblcustomerinfo AS
SELECT z.flngcustomerkey, z.flngJointCustomerKey, z.fblnPrime, z.fstrCustomerType, z.flngDocKey, z.flngFolderKey, z.fblnDefault, z.fintProfileNumber, z.fdtmCommence, z.fdtmCease, z.fdtmCreated, z.fi64NameKey, z.fintNameKey, z.fstrDisplay, z.fblnFormatted, z.fstrNameType, z.fstrFamilyName, z.fstrMiddleName, z.fstrFirstName, z.fstrNameControl, z.fstrTitle, z.fstrSuffix, z.fstrFreeFormatName, z.fstrListFormatName, z.fstrAdditionalName, z.fstrAdditionalName2, z.fi64AddressKey, z.fintAddressKey, z.fstrAddressType, z.fstrStreet, z.fstrStreet2, z.fstrUnitType, z.fstrUnit, z.fstrCity, z.fstrCounty, z.fstrState, z.fstrZip, z.fstrCountry, z.fstrAttention, z.fstrLocationCode, z.fstrUrbanization, z.fstrMunicipality, z.fstrDistrict, z.fstrSubDistrict, z.fstrSubProvince, z.fstrAddressDescription, z.fstrListFormatAddress, z.flngIDKey, z.fstrIDType, z.fstrID, z.fstrFormattedID, z.fstrDistrictOffice, z.fstrCollectDistrictOffice, z.fstrReviewType, z.fstrCustomerLevel, z.fi64ProtectedDataSource, z.fdtmWhen, z.record_effective_timestamp, z.record_expiry_timestamp, z.record_active_flag, z.record_deleted_flag, z.insert_object_run_key, z.update_object_run_key FROM ${var:source_db}.app_tblcustomerinfo z LEFT OUTER JOIN ${var:source_db}.app_tblcustomerlevel cl ON z.flngcustomerkey = cl.flngcustomerkey WHERE nvl(cl.fstrCustomerLevel, 'STD') != 'SPCAD2' AND nvl(cl.record_active_flag, 'Y') = 'Y' AND nvl(cl.record_deleted_flag, 'N') = 'N';
