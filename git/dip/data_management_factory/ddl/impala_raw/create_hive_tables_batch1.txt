  

-- ref_lancustomerlevel P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomerlevel;                                         
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomerlevel (                                                
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRCUSTOMERLEVEL VARCHAR(12),                                                                                                      
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;


-- ref_lancustomersubtype P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomersubtype;                                       
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomersubtype (                                              
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerSubType VARCHAR(12),                                                                                                    
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),                                                                                                      
fstrDecodeWeb VARCHAR(510),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                       
 ) STORED AS PARQUET;  

-- wrq_tblwebnotice P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.wrq_tblwebnotice;                                             
CREATE TABLE ${target_db=Enter the target database name here}.wrq_tblwebnotice (                                                    
flngWebNoticeKey INT,                                                                                                               
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrWebNoticeArea VARCHAR(24),                                                                                                      
fstrWebNoticeCategory VARCHAR(24),                                                                                                  
fstrWebNoticeType VARCHAR(24),                                                                                                      
fstrWebNoticeSubType VARCHAR(24),                                                                                                   
fstrWebNoticeReason VARCHAR(24),                                                                                                    
fstrApplication VARCHAR(40),                                                                                                        
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngWebLogonKey INT,                                                                                                                
flngParentNoticeKey INT,                                                                                                            
flngWebReqKey INT,                                                                                                                  
fstrSubject VARCHAR(510),                                                                                                           
fstrMessage VARCHAR(32767),                                                                                                         
fstrAdditionalInfo VARCHAR(510),                                                                                                    
fblnUrgent SMALLINT,                                                                                                                
fblnUser SMALLINT,                                                                                                                  
fblnPrivate SMALLINT,                                                                                                               
fstrLanguage VARCHAR(6),                                                                                                            
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;  

-- ref_lanofficelocation P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanofficelocation;                                        
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanofficelocation (                                               
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRDISTRICTOFFICE VARCHAR(12),                                                                                                     
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),     
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                 
 ) STORED AS PARQUET;  

-- ref_lannz_customersegments P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customersegments;                                   
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customersegments (                                          
fstrSegment VARCHAR(6),                                                                                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),   
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                   
 ) STORED AS PARQUET;  

-- ref_lannz_customerclass P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customerclass;                                      
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customerclass (                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrDecode1 VARCHAR(24),                                                                                                            
fstrDecode2 VARCHAR(60),                                                                                                            
fstrDescription VARCHAR(510),     
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;  


-- ref_lanIndicator P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanindicator (                                                    
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRINDICATOR VARCHAR(12),                                                                                                          
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),    
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                
 ) STORED AS PARQUET; 

-- ref_lannz_customerclass P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customerclass;                                      
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customerclass (                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrDecode1 VARCHAR(24),                                                                                                            
fstrDecode2 VARCHAR(60),                                                                                                            
fstrDescription VARCHAR(510),   
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                              
 ) STORED AS PARQUET;        

-- ref_lanIndicator P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanindicator (                                                    
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRINDICATOR VARCHAR(12),                                                                                                          
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000), 
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                     
 ) STORED AS PARQUET;            


-- ref_lancustomertype P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomertype;                                          
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomertype (                                                 
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerType VARCHAR(12),                                                                                                       
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDecodeWeb VARCHAR(510),                                                                                                         
FSTRDESCRIPTION VARCHAR(2000),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;   

-- dss_special_clients P1
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_special_clients_all;  
CREATE TABLE ${target_db=Enter the target database name here}.dss_special_clients_all
 (   
ird_number INT,   
special_classification VARCHAR(20), 
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT ) 
STORED AS PARQUET ;


--dss_old_system_numbers P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_old_system_numbers;                                       
CREATE TABLE ${target_db=Enter the target database name here}.dss_old_system_numbers (                                              
OLD_SYSTEM_NUMBER INT,                                                                                                              
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;   

-- dss_offices P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_offices;                                                  
CREATE TABLE ${target_db=Enter the target database name here}.dss_offices (                                                         
OFFICE_CODE VARCHAR(4),                                                                                                             
DESCRIPTION VARCHAR(60),                                                                                                            
SERVICE_CENTRE_CODE VARCHAR(6),                                                                                                     
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
`TIMESTAMP` TIMESTAMP,  
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                              
 ) STORED AS PARQUET;           


-- dss_external_references P2H3
DROP TABLE ${target_db=Enter the target database name here}.dss_external_references;
CREATE TABLE ${target_db=Enter the target database name here}.dss_external_references (                                             
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
EXTERNAL_ORG_CODE VARCHAR(6),                                                                                                       
EXTERNAL_ID VARCHAR(40),                                                                                                            
DATE_START TIMESTAMP,                                                                                                               
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_END TIMESTAMP,                                                                                                                 
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
COUNTRY_CODE VARCHAR(6),  
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                          
 ) STORED AS PARQUET;                                                                                                               
                                 
-- app_tblaccount P2H2
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblaccount;                                               
CREATE TABLE ${target_db=Enter the target database name here}.app_tblaccount (                                                      
flngAccountKey INT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
flngCustomerKey INT,                                                                                                                
fintParentProfileNumber SMALLINT,                                                                                                   
fintProfileNumber SMALLINT,                                                                                                         
fstrAccountType VARCHAR(12),                                                                                                        
fstrFiling VARCHAR(12),                                                                                                             
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fstrStatus VARCHAR(60),                                                                                                             
fstrClosureReason VARCHAR(60),                                                                                                      
fblnMailForm SMALLINT,                                                                                                              
flngDocKey INT,                                                                                                                     
flngFolderKey INT,                                                                                                                  
fdtmCreated TIMESTAMP,                                                                                                              
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
fdtmwhen_info TIMESTAMP,
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;         

--app_tblaccountinfo P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblaccountinfo;                                           
CREATE TABLE ${target_db=Enter the target database name here}.app_tblaccountinfo
 (  
 flngaccountkey INT,  
 fintparentprofilenumber SMALLINT, 
 fintprofilenumber SMALLINT, 
 flngcustomerkey INT, 
 flngjointcustomerkey INT,  
 flngjointaccountkey INT,   
 fblnprime SMALLINT,   
 fstraccounttype VARCHAR(12), 
 flngdockey INT,   
 flngfolderkey INT,   
 fstrfilingfrq VARCHAR(60),   
 fdtmcommence TIMESTAMP,   
 fdtmcease TIMESTAMP,   
 fdtmcreated TIMESTAMP,   
 fi64namekey BIGINT,   
 fintnamekey SMALLINT,   
 fstrdisplay VARCHAR(24), 
 fblnformatted SMALLINT,  
 fstrnametype VARCHAR(40),   
 fstrfamilyname VARCHAR(510),  
 fstrmiddlename VARCHAR(100),  
 fstrfirstname VARCHAR(100),  
 fstrnamecontrol VARCHAR(20),   
 fstrtitle VARCHAR(20),  
 fstrsuffix VARCHAR(20),  
 fstrfreeformatname VARCHAR(510),  
 fstrlistformatname VARCHAR(510),   
 fstradditionalname VARCHAR(510),  
 fstradditionalname2 VARCHAR(510),   
 fi64addresskey BIGINT,  
 fintaddresskey SMALLINT,  
 fstraddresstype VARCHAR(40), 
 fstrstreet VARCHAR(510),   
 fstrstreet2 VARCHAR(510),  
 fstrunittype VARCHAR(100),  
 fstrunit VARCHAR(60),   
 fstrcity VARCHAR(200),   
 fstrcounty VARCHAR(12),  
 fstrstate VARCHAR(12),  
 fstrzip VARCHAR(60),  
 fstrdistrictoffice VARCHAR(12),  
 fstrcountry VARCHAR(12),   
 fstrattention VARCHAR(510),  
 fstrlocationcode VARCHAR(60),
 fstrurbanization VARCHAR(100),  
 fstrmunicipality VARCHAR(60),  
 fstrdistrict VARCHAR(60),   
 fstrsubdistrict VARCHAR(60),  
 fstrsubprovince VARCHAR(100),  
 fstraddressdescription VARCHAR(510), 
 fstrlistformataddress VARCHAR(510),  
 flngidkey INT,   fstridtype VARCHAR(12),  
 fstrid VARCHAR(60),   
 fstrformattedid VARCHAR(60),  
 fstrcollectdistrictoffice VARCHAR(12),   
 fstrcollectcity VARCHAR(200),  
 fstrcustomertype VARCHAR(12),  
 fstrreviewtype VARCHAR(12), 
 fstrcustomerlevel VARCHAR(12),   
 fi64protecteddatasource BIGINT,  
 fdtmwhen TIMESTAMP, 
 record_effective_timestamp TIMESTAMP,  
 record_expiry_timestamp TIMESTAMP,  
 record_active_flag VARCHAR(1),  
 record_deleted_flag VARCHAR(1),  
 insert_object_run_key INT,  
 update_object_run_key INT ) STORED AS PARQUET ;



--  app_tblcrmextendedlog P2H2 
-- additional fields included to tblcrmlog
DROP TABLE ${target_db=Enter the target database name here}.app_tblcrmextendedlog;
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcrmextendedlog 
(   flngcrmkey INT,   
    flngver INT,   
    flngverlast INT,   
    fstrcrmsource VARCHAR(40),   
    fstrcrmtype VARCHAR(40),  
    flngparentcrmkey INT,   
    flngcustomerkey INT,   
    fintprofilenumber SMALLINT,  
    flngaccountkey INT,   
    fstraccounttype VARCHAR(12),  
    fdtmfilingperiod TIMESTAMP,  
    flngbillitemkey INT,  
    fintbillitem SMALLINT,   
    flngfolderkey INT,  
    fi64sourcekey BIGINT,   
    fstrsourceid VARCHAR(100),   
    fstrsourcetype VARCHAR(60),   
    fstrsourcedata VARCHAR(510),  
    fstrdata VARCHAR(32767), 
    fblnextended SMALLINT, 
    fblnprivate SMALLINT,   
    fblnhaschildren SMALLINT,  
    fblnhighimportance SMALLINT,   
    fblnsystem SMALLINT,
    fstreditedby VARCHAR(20),
    fdtmedited TIMESTAMP,  
    fstrcomment VARCHAR(2000),
    fblncommentexists SMALLINT,  
    fstrwho VARCHAR(20),   
    fdtmwhen TIMESTAMP, 
    change_capture TIMESTAMP,  
    record_effective_timestamp TIMESTAMP,   
    record_expiry_timestamp TIMESTAMP,   
    record_active_flag VARCHAR(1),  
    record_deleted_flag VARCHAR(1),   
    insert_object_run_key INT,   
    update_object_run_key INT ) STORED AS PARQUET;



--app_tblcustomer P2H2 
-- fdtmwhen_info  included
DROP TABLE ${target_db=Enter the target database name here}.app_tblcustomer;
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomer (   
flngcustomerkey INT,  
flngver INT,  
flngverlast INT,   
fstrcustomertype VARCHAR(12),  
fdtmcommence TIMESTAMP,  
fdtmcease TIMESTAMP,  
flngcustomerlevel INT,   
flngdockey INT,   
flngfolderkey INT, 
flngrefreshver INT,   
flngcustomerversion INT,   
flngwebversion INT,   
fdtmwebpublished TIMESTAMP,   
fdtmcreated TIMESTAMP,   
fstrwho VARCHAR(20),  
fdtmwhen TIMESTAMP,   
fdtmwhen_info TIMESTAMP,   
record_effective_timestamp TIMESTAMP,   
record_expiry_timestamp TIMESTAMP,   
record_active_flag VARCHAR(1),   
record_deleted_flag VARCHAR(1),   
insert_object_run_key INT,   
update_object_run_key INT ) 
STORED AS PARQUET ;



 
--app_tblcustomerhistory P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerhistory;                                       
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerhistory (                                              
flngCustomerKey INT,                                                                                                                
flngVerLast INT,                                                                                                                    
fstrCustomerTypeFrom VARCHAR(12),                                                                                                   
fstrCustomerTypeTo VARCHAR(12),                                                                                                     
flngDocKeyFrom INT,                                                                                                                 
flngDocKeyTo INT,                                                                                                                   
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;                                                                                                               
                          
--app_tblcustomerinfo P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerinfo;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerinfo (                                                 
flngCustomerKey INT,                                                                                                                
flngJointCustomerKey INT,                                                                                                           
fblnPrime SMALLINT,                                                                                                                 
fstrCustomerType VARCHAR(12),                                                                                                       
flngDocKey INT,                                                                                                                     
flngFolderKey INT,                                                                                                                  
fblnDefault SMALLINT,                                                                                                               
fintProfileNumber SMALLINT,                                                                                                         
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fdtmCreated TIMESTAMP,                                                                                                              
fi64NameKey BIGINT,                                                                                                                 
fintNameKey SMALLINT,                                                                                                               
fstrDisplay VARCHAR(24),                                                                                                            
fblnFormatted SMALLINT,                                                                                                             
fstrNameType VARCHAR(40),                                                                                                           
fstrFamilyName VARCHAR(510),                                                                                                        
fstrMiddleName VARCHAR(100),                                                                                                        
fstrFirstName VARCHAR(100),                                                                                                         
fstrNameControl VARCHAR(20),                                                                                                        
fstrTitle VARCHAR(20),                                                                                                              
fstrSuffix VARCHAR(20),                                                                                                             
fstrFreeFormatName VARCHAR(510),                                                                                                    
fstrListFormatName VARCHAR(510),                                                                                                    
fstrAdditionalName VARCHAR(510),                                                                                                    
fstrAdditionalName2 VARCHAR(510),                                                                                                   
fi64AddressKey BIGINT,                                                                                                              
fintAddressKey SMALLINT,                                                                                                            
fstrAddressType VARCHAR(40),                                                                                                        
fstrStreet VARCHAR(510),                                                                                                            
fstrStreet2 VARCHAR(510),                                                                                                           
fstrUnitType VARCHAR(100),                                                                                                          
fstrUnit VARCHAR(60),                                                                                                               
fstrCity VARCHAR(200),                                                                                                              
fstrCounty VARCHAR(12),                                                                                                             
fstrState VARCHAR(12),                                                                                                              
fstrZip VARCHAR(60),                                                                                                                
fstrCountry VARCHAR(12),                                                                                                            
fstrAttention VARCHAR(510),                                                                                                         
fstrLocationCode VARCHAR(60),                                                                                                       
fstrUrbanization VARCHAR(100),                                                                                                      
fstrMunicipality VARCHAR(60),                                                                                                       
fstrDistrict VARCHAR(60),                                                                                                           
fstrSubDistrict VARCHAR(60),                                                                                                        
fstrSubProvince VARCHAR(100),                                                                                                       
fstrAddressDescription VARCHAR(510),                                                                                                
fstrListFormatAddress VARCHAR(510),                                                                                                 
flngIDKey INT,                                                                                                                      
fstrIDType VARCHAR(12),                                                                                                             
fstrID VARCHAR(60),                                                                                                                 
fstrFormattedID VARCHAR(60),                                                                                                        
fstrDistrictOffice VARCHAR(12),                                                                                                     
fstrCollectDistrictOffice VARCHAR(12),                                                                                              
fstrReviewType VARCHAR(12),                                                                                                         
fstrCustomerLevel VARCHAR(12),                                                                                                      
fi64ProtectedDataSource BIGINT,                                                                                                     
fdtmWhen TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;  


--app_tblcustomerlevel P2H2
-- flngcustomerkey  included
DROP TABLE  ${target_db=Enter the target database name here}.app_tblcustomerlevel;
CREATE TABLE  ${target_db=Enter the target database name here}.app_tblcustomerlevel
(   
flngdockey INT,  
flngcustomerkey INT,   
fstrcustomerlevel VARCHAR(12),  
fstrwho VARCHAR(20),  
fdtmwhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,   
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT ) 
STORED AS PARQUET ;
 

--app_tblcustomermail P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomermail;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomermail (                                                 
flngMailItemKey INT,                                                                                                                
fstrFormat VARCHAR(12),                                                                                                             
flngMailCategoryKey INT,                                                                                                            
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fintAddressKey SMALLINT,                                                                                                            
fintAddressProfile SMALLINT,                                                                                                        
fintNameKey SMALLINT,                                                                                                               
fintNameProfile SMALLINT,                                                                                                           
flngBillItemKey INT,                                                                                                                
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngMailItemTypeKey INT,                                                                                                            
flngTemplateKey INT,                                                                                                                
fstrLetterId VARCHAR(60),                                                                                                           
fstrMailType VARCHAR(24),                                                                                                           
fdtmRequest TIMESTAMP,                                                                                                              
fdtmReady TIMESTAMP,                                                                                                                
fdtmPrinted TIMESTAMP,                                                                                                              
fdtmRePrinted TIMESTAMP,                                                                                                            
fdtmResend TIMESTAMP,                                                                                                               
fdtmEmailed TIMESTAMP,                                                                                                              
fblnValid SMALLINT,                                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,      
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                             
 ) STORED AS PARQUET;   



--app_tblcustomerstd P2H2
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerstd;                                           
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerstd (                                                  
FLNGDOCKEY INT,                                                                                                                     
FDTMDOB TIMESTAMP,                                                                                                                  
FDTMDOD TIMESTAMP,                                                                                                                  
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;                                                                                                               
                         

--app_tbldocposttransaction P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tbldocposttransaction;                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tbldocposttransaction (                                           
flngDocKey INT,                                                                                                                     
fstrField VARCHAR(200),                                                                                                             
flngTableRow INT,                                                                                                                   
flngDocVerLast INT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fintPosting SMALLINT,                                                                                                               
fi64SourceKey BIGINT,                                                                                                               
fstrSource VARCHAR(40),                                                                                                             
fstrIdType VARCHAR(12),                                                                                                             
fstrId VARCHAR(60),                                                                                                                 
fstrNameControl VARCHAR(8),                                                                                                         
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fstrAccountType VARCHAR(12),                                                                                                        
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngBillItemKey INT,                                                                                                                
fstrBillType VARCHAR(12),                                                                                                           
fdtmBillDue TIMESTAMP,                                                                                                              
fstrGroup VARCHAR(24),                                                                                                              
flngTransKey INT,                                                                                                                   
fstrTransType VARCHAR(12),                                                                                                          
fdtmEffect TIMESTAMP,                                                                                                               
fdtmReport TIMESTAMP,                                                                                                               
fcurAmount DECIMAL(19,4),                                                                                                           
fintWorkStatus SMALLINT,                                                                                                            
fblnProcessed SMALLINT,                                                                                                             
fdtmReviewed TIMESTAMP,                                                                                                             
fdtmPosted TIMESTAMP,                                                                                                               
fdtmReversed TIMESTAMP,                                                                                                             
fblnUpdatePeriod SMALLINT,                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;  


         
--app_tblid P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblid;                                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblid (                                                           
FLNGIDKEY INT,                                                                                                                      
FLNGVER INT,                                                                                                                        
FLNGCUSTOMERKEY INT,                                                                                                                
FSTRIDTYPE VARCHAR(12),                                                                                                             
FSTRID VARCHAR(60),                                                                                                                 
FLNGACCOUNTKEY INT,                                                                                                                 
FLNGVERLAST INT,                                                                                                                    
FBLNVALIDATED SMALLINT,                                                                                                             
FBLNACTIVE SMALLINT,                                                                                                                
FINTPROFILENUMBER SMALLINT,                                                                                                         
FBLNDEFAULT SMALLINT,                                                                                                               
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
flngImageKey INT,                                                                                                                   
flngDocKey INT,                                                                                                                     
flngCrmKey INT,                                                                                                                     
fi64ProtectedDataSource BIGINT,                                                                                                     
fintProtectLevel SMALLINT,                                                                                                          
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;  



--app_tblindicator P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.app_tblindicator (                                                    
FLNGINDICATORKEY INT,                                                                                                               
FLNGVER INT,                                                                                                                        
FLNGVERLAST INT,                                                                                                                    
FINTLEVEL SMALLINT,                                                                                                                 
FLNGCUSTOMERKEY INT,                                                                                                                
FINTPROFILENUMBER SMALLINT,                                                                                                         
FLNGACCOUNTKEY INT,                                                                                                                 
FSTRINDICATOR VARCHAR(12),                                                                                                          
FDTMCOMMENCE TIMESTAMP,                                                                                                             
FDTMFILINGPERIOD TIMESTAMP,                                                                                                         
FDTMFILINGPERIODTO TIMESTAMP,                                                                                                       
FCURAMOUNT DECIMAL(19,4),                                                                                                           
FDTMCEASE TIMESTAMP,                                                                                                                
FSTRREASON VARCHAR(12),                                                                                                             
FDTMCOMMENCE1 TIMESTAMP,                                                                                                            
FDTMCEASE1 TIMESTAMP,                                                                                                               
flngCrmKey INT,                                                                                                                     
FSTRCOMMENT VARCHAR(510),                                                                                                           
FSTRUSER VARCHAR(20),                                                                                                               
flngDocKey INT,                                                                                                                     
fblnActive SMALLINT,                                                                                                                
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;                                                                                                               
                        

--app_tblmailitem P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblmailitem;                                              
CREATE TABLE ${target_db=Enter the target database name here}.app_tblmailitem (                                                     
flngMailItemKey INT,                                                                                                                
flngVerLast INT,                                                                                                                    
flngMailTypeKey INT,                                                                                                                
flngTemplateKey INT,                                                                                                                
flngCRMKey INT,                                                                                                                     
fstrRecipientKey VARCHAR(60),                                                                                                       
flngNameAddressHash INT,                                                                                                            
fstrSortKey VARCHAR(60),                                                                                                            
fdtmSortDate TIMESTAMP,                                                                                                             
fintMailTypeSort SMALLINT,                                                                                                          
fstrLanguage VARCHAR(6),                                                                                                            
fstrAddressBlock VARCHAR(4000),                                                                                                     
fstrEmailTo VARCHAR(510),                                                                                                           
fstrName VARCHAR(510),                                                                                                              
fstrDLN VARCHAR(60),                                                                                                                
fstrCity VARCHAR(510),                                                                                                              
fstrCountry VARCHAR(200),                                                                                                           
fstrZip VARCHAR(60),                                                                                                                
fblnValidAddress SMALLINT,                                                                                                          
fdtmCreated TIMESTAMP,                                                                                                              
fstrCreatedWho VARCHAR(20),                                                                                                         
fdtmBatched TIMESTAMP,                                                                                                              
fdtmPrinted TIMESTAMP,                                                                                                              
fstrPrintedWho VARCHAR(20),                                                                                                         
fstrPrinter VARCHAR(510),                                                                                                           
fdtmRePrinted TIMESTAMP,                                                                                                            
fstrReprintedWho VARCHAR(20),                                                                                                       
fstrRePrintPrinter VARCHAR(510),                                                                                                    
fdtmReady TIMESTAMP,                                                                                                                
fstrReadyWho VARCHAR(20),                                                                                                           
fdtmEmailedOn TIMESTAMP,                                                                                                            
flngPrintGroupKey INT,                                                                                                              
fblnValid SMALLINT,                                                                                                                 
fstrValidatedWho VARCHAR(20),                                                                                                       
fdtmValidatedWhen TIMESTAMP,                                                                                                        
fblnElectronicOnly SMALLINT,                                                                                                        
fstrRenderType VARCHAR(24),                                                                                                         
fstrDatabase VARCHAR(40),                                                                                                           
flngImageKey INT,                                                                                                                   
fblnLock SMALLINT,                                                                                                                  
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;      

--app_tblnaics P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnaics;                                                 
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnaics (                                                        
flngNAICSKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrNAICSVersion VARCHAR(24),                                                                                                       
fstrNAICS VARCHAR(60),                                                                                                              
fstrLevel1 VARCHAR(60),                                                                                                             
fstrLevel2 VARCHAR(60),                                                                                                             
fstrLevel3 VARCHAR(60),                                                                                                             
fstrLevel4 VARCHAR(60),                                                                                                             
fstrLevel5 VARCHAR(60),                                                                                                             
fstrLevel6 VARCHAR(60),                                                                                                             
flngCustomerKey INT,                                                                                                                
fintProfileNumber SMALLINT,                                                                                                         
flngAccountKey INT,                                                                                                                 
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fcurBusinessMakeup DECIMAL(19,4),                                                                                                   
fblnDefault SMALLINT,                                                                                                               
fblnActive SMALLINT,                                                                                                                
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;      

--app_tblnamerecord P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnamerecord;                                            
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnamerecord (                                                   
fi64NameKey BIGINT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fdtmEffectiveFrom TIMESTAMP,                                                                                                        
fdtmEffectiveTo TIMESTAMP,                                                                                                          
fdtmSystemFrom TIMESTAMP,                                                                                                           
fdtmSystemTo TIMESTAMP,                                                                                                             
fstrSource VARCHAR(40),                                                                                                             
flngCustomerKey INT,                                                                                                                
fintProfileNumber SMALLINT,                                                                                                         
fi64SourceKey BIGINT,                                                                                                               
fstrNameType VARCHAR(40),                                                                                                           
fstrDisplay VARCHAR(24),                                                                                                            
fblnFormatted SMALLINT,                                                                                                             
fstrLastName VARCHAR(100),                                                                                                          
fintLastModifier SMALLINT,                                                                                                          
fstrFirstName VARCHAR(100),                                                                                                         
fintFirstModifier SMALLINT,                                                                                                         
fstrMiddleName VARCHAR(100),                                                                                                        
fintMiddleModifier SMALLINT,                                                                                                        
fstrTitle VARCHAR(20),                                                                                                              
fintTitleModifier SMALLINT,                                                                                                         
fstrSuffix VARCHAR(20),                                                                                                             
fintSuffixModifier SMALLINT,                                                                                                        
fstrFreeFormatName VARCHAR(510),                                                                                                    
fintFreeFormatModifier SMALLINT,                                                                                                    
fstrAdditionalName VARCHAR(510),                                                                                                    
fintAdditionalModifier SMALLINT,                                                                                                    
fstrAdditionalName2 VARCHAR(510),                                                                                                   
fintAdditionalModifier2 SMALLINT,                                                                                                   
fstrListFormatName VARCHAR(510),                                                                                                    
fi64ProtectedDataSource BIGINT,                                                                                                     
flngCrmKey INT,                                                                                                                     
fblnBlank SMALLINT,                                                                                                                 
fblnCurrent SMALLINT,                                                                                                               
fblnActive SMALLINT,                                                                                                                
fintProtectLevel SMALLINT,                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                   
 ) STORED AS PARQUET;         

--app_tblnz_accidgedu P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_accidgedu;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_accidgedu (                                                 
flngDocKey INT,                                                                                                                     
fstrEducationProvider VARCHAR(100),                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;  

--app_tblnz_accidgovr P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_accidgovr;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_accidgovr (                                                 
flngDocKey INT,                                                                                                                     
fstrIssuingCountry VARCHAR(6),                                                                                                      
fblnTranslationReceived SMALLINT,                                                                                                   
flngEntryNumber INT,                                                                                                                
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;



--app_tblnz_calllog P2H1
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_calllog;                                            
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_calllog (                                                   
flngVisitKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrIrdNumber VARCHAR(20),                                                                                                          
fstrAuthIRDNumber VARCHAR(20),                                                                                                      
flngChildVisitKey INT,                                                                                                              
fstrUpdateReason VARCHAR(40),                                                                                                       
fstrIvrPath VARCHAR(4000),                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;     

--app_tblnz_cstcominfo P2H2
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_cstcominfo;    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_cstcominfo (                                                                                         
flngDocKey INT,                                                                                                                     
fstrURL VARCHAR(100),                                                                                                               
fblnNilCompany SMALLINT,                                                                                                            
fblnDonee SMALLINT,                                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;      

--app_tblnz_customerstd P2H2

                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_customerstd;                                        
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_customerstd (                                               
flngDocKey INT,                                                                                                                     
fstrCustomerSubTypeClass VARCHAR(12),                                                                                               
fstrCustomerSubType VARCHAR(12),                                                                                                    
fstrCustomerSegment VARCHAR(100),                                                                                                   
fstrSpecialFileType VARCHAR(12),                                                                                                    
fblnSpecialTaxResidency SMALLINT,                                                                                                   
fstrNonResidentType VARCHAR(100),                                                                                                   
fstrCurrentTaxResidency VARCHAR(100),                                                                                               
fstrClosureReason VARCHAR(12),                                                                                                      
fintSMSCountryCode SMALLINT,                                                                                                        
fstrSMSAreaCode VARCHAR(10),                                                                                                        
fstrSMSPhoneNumber VARCHAR(30),                                                                                                     
fdtmIncomeBalanceDate TIMESTAMP,                                                                                                    
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;     

--app_tblnz_custsegmenthist P2H1

                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_custsegmenthist;                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_custsegmenthist (                                           
flngDocKey INT,                                                                                                                     
flngVerLast INT,                                                                                                                    
fstrCustomerSegment VARCHAR(100),                                                                                                   
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;    

--app_tblnz_custtaxresidency P2H4
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_custtaxresidency;                                   
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_custtaxresidency (                                          
flngDocKey INT,                                                                                                                     
fintSeq SMALLINT,                                                                                                                   
fstrTaxResidency VARCHAR(100),                                                                                                      
fdtmResStart TIMESTAMP,                                                                                                             
fdtmResEnd TIMESTAMP,                                                                                                               
fblnIsFinancial SMALLINT,                                                                                                           
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
                                                                                                                                    
 ) STORED AS PARQUET;         

--app_tblnz_visitmanagedcall P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_visitmanagedcall;                                   
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_visitmanagedcall (                                          
flngDocKey INT,                                                                                                                     
fstrCallerIrdNumber VARCHAR(20),                                                                                                    
fstrAuthorisedIrdNumber VARCHAR(20),                                                                                                
fstrTaxAgentName VARCHAR(100),                                                                                                      
fstrVoiceEnrolStatus VARCHAR(2),                                                                                                    
fstrVoiceOptOutStatus VARCHAR(2),                                                                                                   
fstrTransferReason VARCHAR(510),                                                                                                    
fstrCallerIntentCorrect VARCHAR(6),                                                                                                 
fstrCallerIntent VARCHAR(100),                                                                                                      
fstrCorrectedIntent VARCHAR(100),                                                                                                   
fstrCallQueue VARCHAR(100),                                                                                                         
fstrStageOneFeedback VARCHAR(24),                                                                                                   
fblnVirtualHold SMALLINT,                                                                                                           
fblnContactDetailsChecked SMALLINT,                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET; 

--app_tblvisit P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblvisit;                                                 
CREATE TABLE ${target_db=Enter the target database name here}.app_tblvisit (                                                        
flngVisitKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrVisitSource VARCHAR(24),                                                                                                        
fstrVisitCategory VARCHAR(24),                                                                                                      
fstrVisitSubCategory VARCHAR(24),                                                                                                   
flngFolderKey INT,                                                                                                                  
flngCustomerKey INT,                                                                                                                
fblnUnregisteredVisitor SMALLINT,                                                                                                   
fi64NameKey BIGINT,                                                                                                                 
fi64AddressKey BIGINT,                                                                                                              
fstrVisitId VARCHAR(60),                                                                                                            
fstrTicketId VARCHAR(60),                                                                                                           
fstrExternalId VARCHAR(60),                                                                                                         
fstrIdType VARCHAR(12),                                                                                                             
fstrId VARCHAR(60),                                                                                                                 
fstrCountry VARCHAR(12),                                                                                                            
fintCountryCode SMALLINT,                                                                                                           
fstrAreaCode VARCHAR(10),                                                                                                           
fstrPhoneNumber VARCHAR(30),                                                                                                        
fblnVisitorVerified SMALLINT,                                                                                                       
fstrVerifyDocType VARCHAR(24),                                                                                                      
fintVerifyDocVer SMALLINT,                                                                                                          
fi64VerifyDocEditInProgressKey BIGINT,                                                                                              
flngVerifyDocKey INT,                                                                                                               
fstrDocType VARCHAR(24),                                                                                                            
fintDocVer SMALLINT,                                                                                                                
fi64DocEditInProgressKey BIGINT,                                                                                                    
flngDocKey INT,                                                                                                                     
flngXmlKey INT,                                                                                                                     
fstrOwner VARCHAR(20),                                                                                                              
fstrDistrictOffice VARCHAR(12),                                                                                                     
fblnHold SMALLINT,                                                                                                                  
fdtmVisitStart TIMESTAMP,                                                                                                           
fdtmVisitEnd TIMESTAMP,                                                                                                             
flngDuration INT,                                                                                                                   
flngWaitTime INT,                                                                                                                   
fblnActive SMALLINT,                                                                                                                
fdtmReversed TIMESTAMP,                                                                                                             
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                           

--dss_agents P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_agents;                                                   
CREATE TABLE ${target_db=Enter the target database name here}.dss_agents (                                                          
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
AGT_DATE_START TIMESTAMP,                                                                                                           
AGT_DATE_END TIMESTAMP,                                                                                                             
AGENT_TYPE VARCHAR(2),                                                                                                              
OLD_SYSTEM_NUMBER INT,                                                                                                              
AGENCY_IRD_NUMBER INT,                                                                                                              
AGENCY_LOCATION_NUMBER INT,                                                                                                         
AGENT_TIME_EXTENSION VARCHAR(2),                                                                                                    
WITHDRAW_DATE TIMESTAMP,                                                                                                            
OFFICE_NUMBER INT,                                                                                                                  
SEGMNT VARCHAR(2),                                                                                                                  
MICRO_SEGMNT VARCHAR(4),                                                                                                            
ACCOUNT_MANAGER_ID VARCHAR(16),                                                                                                     
EFILE_ACCESS VARCHAR(2),                                                                                                            
EFILE_TARGET VARCHAR(2),                                                                                                            
`TIMESTAMP` TIMESTAMP,                                                                                                              
DATE_CEASED TIMESTAMP,                                                                                                              
PROFESSIONAL_ORG_CODE VARCHAR(2),                                                                                                   
PUBLIC_PRACTICE_CERT_IND VARCHAR(2),                                                                                                
EMPLOYER_RETURNS_IND VARCHAR(2),                                                                                                    
OTHER_RETURN_IND VARCHAR(2),                                                                                                        
EMAIL_ADDRESS VARCHAR(120),                                                                                                         
EFILE_IRD_NUMBER INT,                                                                                                               
EFILE_LOCATION_NUMBER INT,                                                                                                          
EFILE_REPORT_OPTION VARCHAR(2),                                                                                                     
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                               

--dss_client_codes P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_client_codes;                                             
CREATE TABLE ${target_db=Enter the target database name here}.dss_client_codes (                                                    
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
TAX_TYPE VARCHAR(6),                                                                                                                
CLIENT_CODE_TYPE VARCHAR(6),                                                                                                        
CLIENT_CODE_VALUE VARCHAR(6),                                                                                                       
DATE_START TIMESTAMP,                                                                                                               
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_END TIMESTAMP,                                                                                                                 
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
USER_ID VARCHAR(16),                                                                                                                
DATE_PROCESSED TIMESTAMP,                                                                                                           
CLIENT_CODE_KEY INT,                                                                                                                
BEGIN_CHANGE_REASON_CODE VARCHAR(8),                                                                                                
END_CHANGE_REASON_CODE VARCHAR(8),                                                                                                  
INBOUND_DOC_LODGE_NBR_PREFIX INT,                                                                                                   
INBOUND_DOC_LODGE_NBR INT,                                                                                                          
OUTBOUND_DOC_LODGE_NBR_PREFIX INT,                                                                                                  
OUTBOUND_DOC_LODGE_NBR INT,                                                                                                         
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;          

--dss_client_names P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_client_names;      
CREATE TABLE ${target_db=Enter the target database name here}.dss_client_names (                                                    
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
CLIENT_NAME_TYPE VARCHAR(4),                                                                                                        
SEQUENCE_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
FIRST_NAMES VARCHAR(74),                                                                                                            
SURNAME VARCHAR(62),                                                                                                                
TITLE VARCHAR(12),                                                                                                                  
ORGANISATION_NAME VARCHAR(148),                                                                                                     
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;      

--dss_clients P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_clients;   
CREATE TABLE ${target_db=Enter the target database name here}.dss_clients (                                                         
IRD_NUMBER INT,                                                                                                                     
ENTITY_TYPE VARCHAR(2),                                                                                                             
DATE_APPLIED TIMESTAMP,                                                                                                             
ENTITY_CLASS VARCHAR(4),                                                                                                            
CUST_TYPE VARCHAR(6),                                                                                                               
MASTER_LOCATION INT,                                                                                                                
DATE_CREATED TIMESTAMP,                                                                                                             
DATE_OF_BIRTH TIMESTAMP,                                                                                                            
ORG_COMMENCEMENT_DATE TIMESTAMP,                                                                                                    
CLIENT_STATUS VARCHAR(2),                                                                                                           
RESIDENT_IND VARCHAR(2),                                                                                                            
SIC_SOURCE VARCHAR(2),                                                                                                              
LOAN_IND VARCHAR(2),                                                                                                                
SECURE_IND VARCHAR(2),                                                                                                              
CLIENT_PASSWORD VARCHAR(20),                                                                                                        
RWT_RATE INT,                                                                                                                       
IDENTIFICATION_TYPE_CODE VARCHAR(2),                                                                                                
ID_SERIAL_NUMBER VARCHAR(40),                                                                                                       
PHONE_NUMBER VARCHAR(48),                                                                                                           
WORK_PHONE_NUMBER VARCHAR(48),                                                                                                      
CELL_PHONE_NUMBER VARCHAR(48),                                                                                                      
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
GENDER VARCHAR(2),                                                                                                                  
NOMINATED_GST_IRD_NUMBER INT,                                                                                                       
NOMINATED_GST_LOCATION_NUMBER INT,                                                                                                  
LATEST_INC_PERIOD_ASSESSED TIMESTAMP,                                                                                               
BALANCE_DATE INT,                                                                                                                   
PROVISIONAL_IND_CODE INT,                                                                                                           
RATIO_PERCENTAGE DECIMAL(8,2),                                                                                                      
RATIO_STATUS_CODE VARCHAR(6),                                                                                                       
RATIO_BASE_PERIOD_DATE TIMESTAMP,                                                                                                   
CURRENT_CAL_RATIO_START_DATE TIMESTAMP,                                                                                             
RATIO_PENDING_INDICATOR VARCHAR(2),                                                                                                 
INTERVIEW_REQUIRED_IND VARCHAR(2),                                                                                                  
NZ_CITIZEN_IND VARCHAR(2),                                                                                                          
VERIFIER_ORGANISATION_ID VARCHAR(6),                                                                                                
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;    

--dss_customers P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_customers;                                                
CREATE TABLE ${target_db=Enter the target database name here}.dss_customers (                                                       
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
ENTITY_TYPE VARCHAR(2),                                                                                                             
ENTITY_CLASS VARCHAR(4),                                                                                                            
CLIENT_STATUS VARCHAR(2),                                                                                                           
SEGMENT_ID VARCHAR(40),                                                                                                             
MICRO_SEGMENT VARCHAR(40),                                                                                                          
DISTRICT_OFFICE VARCHAR(40),                                                                                                        
SERVICE_CENTRE VARCHAR(40),                                                                                                         
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
DATE_OF_BIRTH TIMESTAMP,                                                                                                            
ORG_COMMENCEMENT_DATE TIMESTAMP,                                                                                                    
LOAN_INDICATOR VARCHAR(2),                                                                                                          
RESIDENT_INDICATOR VARCHAR(2),                                                                                                      
SIC_CODE VARCHAR(16),                                                                                                               
DATE_ADVISORY_VISIT TIMESTAMP,                                                                                                      
ADDRESS_STATUS VARCHAR(2),                                                                                                          
CUST_TYPE VARCHAR(6),                                                                                                               
DATE_CREATED TIMESTAMP,                                                                                                             
SIC_SOURCE VARCHAR(2),                                                                                                              
IDENTIFICATION_TYPE_CODE VARCHAR(2),                                                                                                
ID_SERIAL_NUMBER VARCHAR(40),                                                                                                       
PHONE_NUMBER VARCHAR(48),                                                                                                           
WORK_PHONE_NUMBER VARCHAR(48),                                                                                                      
CELL_PHONE_NUMBER VARCHAR(48),                                                                                                      
NATURE_OF_BUSINESS VARCHAR(100),                                                                                                    
MESH_BLOCK INT,                                                                                                                     
GENDER VARCHAR(2),                                                                                                                  
INTERVIEW_REQUIRED_IND VARCHAR(2),                                                                                                  
NZ_CITIZEN_IND VARCHAR(2),                                                                                                          
VERIFIER_ORGANISATION_ID VARCHAR(6),    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                             
 ) STORED AS PARQUET;   

--dss_entity_classes P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_entity_classes;                                           
CREATE TABLE ${target_db=Enter the target database name here}.dss_entity_classes (                                                  
ENTITY_CLASS_CODE VARCHAR(4),                                                                                                       
DATE_APPLIED TIMESTAMP,                                                                                                             
DESCRIPTION VARCHAR(120),                                                                                                           
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;      



--dss_entity_types P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_entity_types;                                             
CREATE TABLE ${target_db=Enter the target database name here}.dss_entity_types (                                                    
ENTITY_TYPE_CODE VARCHAR(2),                                                                                                        
DATE_APPLIED TIMESTAMP,                                                                                                             
DESCRIPTION VARCHAR(120),                                                                                                           
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                         




                                                                       
                       

-- ref_lancustomerlevel P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomerlevel;                                         
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomerlevel (                                                
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRCUSTOMERLEVEL VARCHAR(12),                                                                                                      
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;


-- ref_lancustomersubtype P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomersubtype;                                       
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomersubtype (                                              
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerSubType VARCHAR(12),                                                                                                    
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),                                                                                                      
fstrDecodeWeb VARCHAR(510),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                       
 ) STORED AS PARQUET;  

-- wrq_tblwebnotice P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.wrq_tblwebnotice;                                             
CREATE TABLE ${target_db=Enter the target database name here}.wrq_tblwebnotice (                                                    
flngWebNoticeKey INT,                                                                                                               
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrWebNoticeArea VARCHAR(24),                                                                                                      
fstrWebNoticeCategory VARCHAR(24),                                                                                                  
fstrWebNoticeType VARCHAR(24),                                                                                                      
fstrWebNoticeSubType VARCHAR(24),                                                                                                   
fstrWebNoticeReason VARCHAR(24),                                                                                                    
fstrApplication VARCHAR(40),                                                                                                        
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngWebLogonKey INT,                                                                                                                
flngParentNoticeKey INT,                                                                                                            
flngWebReqKey INT,                                                                                                                  
fstrSubject VARCHAR(510),                                                                                                           
fstrMessage VARCHAR(32767),                                                                                                         
fstrAdditionalInfo VARCHAR(510),                                                                                                    
fblnUrgent SMALLINT,                                                                                                                
fblnUser SMALLINT,                                                                                                                  
fblnPrivate SMALLINT,                                                                                                               
fstrLanguage VARCHAR(6),                                                                                                            
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;  

-- ref_lanofficelocation P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanofficelocation;                                        
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanofficelocation (                                               
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRDISTRICTOFFICE VARCHAR(12),                                                                                                     
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),     
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                 
 ) STORED AS PARQUET;  

-- ref_lannz_customersegments P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customersegments;                                   
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customersegments (                                          
fstrSegment VARCHAR(6),                                                                                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),   
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                   
 ) STORED AS PARQUET;  

-- ref_lannz_customerclass P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customerclass;                                      
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customerclass (                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrDecode1 VARCHAR(24),                                                                                                            
fstrDecode2 VARCHAR(60),                                                                                                            
fstrDescription VARCHAR(510),     
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;  


-- ref_lanIndicator P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanindicator (                                                    
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRINDICATOR VARCHAR(12),                                                                                                          
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000),    
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                
 ) STORED AS PARQUET; 

-- ref_lannz_customerclass P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lannz_customerclass;                                      
CREATE TABLE ${target_db=Enter the target database name here}.ref_lannz_customerclass (                                             
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrDecode1 VARCHAR(24),                                                                                                            
fstrDecode2 VARCHAR(60),                                                                                                            
fstrDescription VARCHAR(510),   
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                              
 ) STORED AS PARQUET;        

-- ref_lanIndicator P1

DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lanindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.ref_lanindicator (                                                    
FSTRLANGUAGE VARCHAR(6),                                                                                                            
FSTRINDICATOR VARCHAR(12),                                                                                                          
FSTRDECODE1 VARCHAR(60),                                                                                                            
FSTRDECODE2 VARCHAR(510),                                                                                                           
fstrDescription VARCHAR(2000), 
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                     
 ) STORED AS PARQUET;            


-- ref_lancustomertype P1
DROP TABLE if exists ${target_db=Enter the target database name here}.ref_lancustomertype;                                          
CREATE TABLE ${target_db=Enter the target database name here}.ref_lancustomertype (                                                 
fstrLanguage VARCHAR(6),                                                                                                            
fstrCustomerType VARCHAR(12),                                                                                                       
fstrDecode1 VARCHAR(60),                                                                                                            
fstrDecode2 VARCHAR(510),                                                                                                           
fstrDecodeWeb VARCHAR(510),                                                                                                         
FSTRDESCRIPTION VARCHAR(2000),  
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT                                                                                                    
 ) STORED AS PARQUET;   

-- dss_special_clients P1
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_special_clients_all;  
CREATE TABLE ${target_db=Enter the target database name here}.dss_special_clients_all
 (   
ird_number INT,   
special_classification VARCHAR(20), 
record_effective_timestamp TIMESTAMP, 
record_expiry_timestamp TIMESTAMP,
checksum VARCHAR(32),  
record_active_flag VARCHAR(1),
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,   
update_object_run_key INT ) 
STORED AS PARQUET ;


--dss_old_system_numbers P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_old_system_numbers;                                       
CREATE TABLE ${target_db=Enter the target database name here}.dss_old_system_numbers (                                              
OLD_SYSTEM_NUMBER INT,                                                                                                              
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;   

-- dss_offices P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_offices;                                                  
CREATE TABLE ${target_db=Enter the target database name here}.dss_offices (                                                         
OFFICE_CODE VARCHAR(4),                                                                                                             
DESCRIPTION VARCHAR(60),                                                                                                            
SERVICE_CENTRE_CODE VARCHAR(6),                                                                                                     
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
`TIMESTAMP` TIMESTAMP,  
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                              
 ) STORED AS PARQUET;           


-- dss_external_references P2H3
DROP TABLE ${target_db=Enter the target database name here}.dss_external_references;
CREATE TABLE ${target_db=Enter the target database name here}.dss_external_references (                                             
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
EXTERNAL_ORG_CODE VARCHAR(6),                                                                                                       
EXTERNAL_ID VARCHAR(40),                                                                                                            
DATE_START TIMESTAMP,                                                                                                               
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_END TIMESTAMP,                                                                                                                 
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
COUNTRY_CODE VARCHAR(6),  
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                          
 ) STORED AS PARQUET;                                                                                                               
                                 
-- app_tblaccount P2H2
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblaccount;                                               
CREATE TABLE ${target_db=Enter the target database name here}.app_tblaccount (                                                      
flngAccountKey INT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
flngCustomerKey INT,                                                                                                                
fintParentProfileNumber SMALLINT,                                                                                                   
fintProfileNumber SMALLINT,                                                                                                         
fstrAccountType VARCHAR(12),                                                                                                        
fstrFiling VARCHAR(12),                                                                                                             
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fstrStatus VARCHAR(60),                                                                                                             
fstrClosureReason VARCHAR(60),                                                                                                      
fblnMailForm SMALLINT,                                                                                                              
flngDocKey INT,                                                                                                                     
flngFolderKey INT,                                                                                                                  
fdtmCreated TIMESTAMP,                                                                                                              
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,  
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;         

--app_tblaccountinfo P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblaccountinfo;                                           
CREATE TABLE ${target_db=Enter the target database name here}.app_tblaccountinfo
 (  
 flngaccountkey INT,  
 fintparentprofilenumber SMALLINT, 
 fintprofilenumber SMALLINT, 
 flngcustomerkey INT, 
 flngjointcustomerkey INT,  
 flngjointaccountkey INT,   
 fblnprime SMALLINT,   
 fstraccounttype VARCHAR(12), 
 flngdockey INT,   
 flngfolderkey INT,   
 fstrfilingfrq VARCHAR(60),   
 fdtmcommence TIMESTAMP,   
 fdtmcease TIMESTAMP,   
 fdtmcreated TIMESTAMP,   
 fi64namekey BIGINT,   
 fintnamekey SMALLINT,   
 fstrdisplay VARCHAR(24), 
 fblnformatted SMALLINT,  
 fstrnametype VARCHAR(40),   
 fstrfamilyname VARCHAR(510),  
 fstrmiddlename VARCHAR(100),  
 fstrfirstname VARCHAR(100),  
 fstrnamecontrol VARCHAR(20),   
 fstrtitle VARCHAR(20),  
 fstrsuffix VARCHAR(20),  
 fstrfreeformatname VARCHAR(510),  
 fstrlistformatname VARCHAR(510),   
 fstradditionalname VARCHAR(510),  
 fstradditionalname2 VARCHAR(510),   
 fi64addresskey BIGINT,  
 fintaddresskey SMALLINT,  
 fstraddresstype VARCHAR(40), 
 fstrstreet VARCHAR(510),   
 fstrstreet2 VARCHAR(510),  
 fstrunittype VARCHAR(100),  
 fstrunit VARCHAR(60),   
 fstrcity VARCHAR(200),   
 fstrcounty VARCHAR(12),  
 fstrstate VARCHAR(12),  
 fstrzip VARCHAR(60),  
 fstrdistrictoffice VARCHAR(12),  
 fstrcountry VARCHAR(12),   
 fstrattention VARCHAR(510),  
 fstrlocationcode VARCHAR(60),
 fstrurbanization VARCHAR(100),  
 fstrmunicipality VARCHAR(60),  
 fstrdistrict VARCHAR(60),   
 fstrsubdistrict VARCHAR(60),  
 fstrsubprovince VARCHAR(100),  
 fstraddressdescription VARCHAR(510), 
 fstrlistformataddress VARCHAR(510),  
 flngidkey INT,   fstridtype VARCHAR(12),  
 fstrid VARCHAR(60),   
 fstrformattedid VARCHAR(60),  
 fstrcollectdistrictoffice VARCHAR(12),   
 fstrcollectcity VARCHAR(200),  
 fstrcustomertype VARCHAR(12),  
 fstrreviewtype VARCHAR(12), 
 fstrcustomerlevel VARCHAR(12),   
 fi64protecteddatasource BIGINT,  
 fdtmwhen TIMESTAMP, 
 record_effective_timestamp TIMESTAMP,  
 record_expiry_timestamp TIMESTAMP,  
 record_active_flag VARCHAR(1),  
 record_deleted_flag VARCHAR(1),  
 insert_object_run_key INT,  
 update_object_run_key INT ) STORED AS PARQUET ;



--  app_tblcrmextendedlog P2H2 
-- additional fields included to tblcrmlog
DROP TABLE ${target_db=Enter the target database name here}.app_tblcrmextendedlog;
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcrmextendedlog 
(   flngcrmkey INT,   
    flngver INT,   
    flngverlast INT,   
    fstrcrmsource VARCHAR(40),   
    fstrcrmtype VARCHAR(40),  
    flngparentcrmkey INT,   
    flngcustomerkey INT,   
    fintprofilenumber SMALLINT,  
    flngaccountkey INT,   
    fstraccounttype VARCHAR(12),  
    fdtmfilingperiod TIMESTAMP,  
    flngbillitemkey INT,  
    fintbillitem SMALLINT,   
    flngfolderkey INT,  
    fi64sourcekey BIGINT,   
    fstrsourceid VARCHAR(100),   
    fstrsourcetype VARCHAR(60),   
    fstrsourcedata VARCHAR(510),  
    fstrdata VARCHAR(32767), 
    fblnextended SMALLINT, 
    fblnprivate SMALLINT,   
    fblnhaschildren SMALLINT,  
    fblnhighimportance SMALLINT,   
    fblnsystem SMALLINT,
    fstreditedby VARCHAR(20),
    fdtmedited TIMESTAMP,  
    fstrcomment VARCHAR(2000),
    fblncommentexists SMALLINT,  
    fstrwho VARCHAR(20),   
    fdtmwhen TIMESTAMP, 
    change_capture TIMESTAMP,  
    record_effective_timestamp TIMESTAMP,   
    record_expiry_timestamp TIMESTAMP,   
    record_active_flag VARCHAR(1),  
    record_deleted_flag VARCHAR(1),   
    insert_object_run_key INT,   
    update_object_run_key INT ) STORED AS PARQUET;



--app_tblcustomer P2H2 
-- fdtmwhen_info  included
DROP TABLE ${target_db=Enter the target database name here}.app_tblcustomer;
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomer (   
flngcustomerkey INT,  
flngver INT,  
flngverlast INT,   
fstrcustomertype VARCHAR(12),  
fdtmcommence TIMESTAMP,  
fdtmcease TIMESTAMP,  
flngcustomerlevel INT,   
flngdockey INT,   
flngfolderkey INT, 
flngrefreshver INT,   
flngcustomerversion INT,   
flngwebversion INT,   
fdtmwebpublished TIMESTAMP,   
fdtmcreated TIMESTAMP,   
fstrwho VARCHAR(20),  
fdtmwhen TIMESTAMP,   
fdtmwhen_info TIMESTAMP,   
record_effective_timestamp TIMESTAMP,   
record_expiry_timestamp TIMESTAMP,   
record_active_flag VARCHAR(1),   
record_deleted_flag VARCHAR(1),   
insert_object_run_key INT,   
update_object_run_key INT ) 
STORED AS PARQUET ;



 
--app_tblcustomerhistory P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerhistory;                                       
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerhistory (                                              
flngCustomerKey INT,                                                                                                                
flngVerLast INT,                                                                                                                    
fstrCustomerTypeFrom VARCHAR(12),                                                                                                   
fstrCustomerTypeTo VARCHAR(12),                                                                                                     
flngDocKeyFrom INT,                                                                                                                 
flngDocKeyTo INT,                                                                                                                   
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;                                                                                                               
                          
--app_tblcustomerinfo P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerinfo;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerinfo (                                                 
flngCustomerKey INT,                                                                                                                
flngJointCustomerKey INT,                                                                                                           
fblnPrime SMALLINT,                                                                                                                 
fstrCustomerType VARCHAR(12),                                                                                                       
flngDocKey INT,                                                                                                                     
flngFolderKey INT,                                                                                                                  
fblnDefault SMALLINT,                                                                                                               
fintProfileNumber SMALLINT,                                                                                                         
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fdtmCreated TIMESTAMP,                                                                                                              
fi64NameKey BIGINT,                                                                                                                 
fintNameKey SMALLINT,                                                                                                               
fstrDisplay VARCHAR(24),                                                                                                            
fblnFormatted SMALLINT,                                                                                                             
fstrNameType VARCHAR(40),                                                                                                           
fstrFamilyName VARCHAR(510),                                                                                                        
fstrMiddleName VARCHAR(100),                                                                                                        
fstrFirstName VARCHAR(100),                                                                                                         
fstrNameControl VARCHAR(20),                                                                                                        
fstrTitle VARCHAR(20),                                                                                                              
fstrSuffix VARCHAR(20),                                                                                                             
fstrFreeFormatName VARCHAR(510),                                                                                                    
fstrListFormatName VARCHAR(510),                                                                                                    
fstrAdditionalName VARCHAR(510),                                                                                                    
fstrAdditionalName2 VARCHAR(510),                                                                                                   
fi64AddressKey BIGINT,                                                                                                              
fintAddressKey SMALLINT,                                                                                                            
fstrAddressType VARCHAR(40),                                                                                                        
fstrStreet VARCHAR(510),                                                                                                            
fstrStreet2 VARCHAR(510),                                                                                                           
fstrUnitType VARCHAR(100),                                                                                                          
fstrUnit VARCHAR(60),                                                                                                               
fstrCity VARCHAR(200),                                                                                                              
fstrCounty VARCHAR(12),                                                                                                             
fstrState VARCHAR(12),                                                                                                              
fstrZip VARCHAR(60),                                                                                                                
fstrCountry VARCHAR(12),                                                                                                            
fstrAttention VARCHAR(510),                                                                                                         
fstrLocationCode VARCHAR(60),                                                                                                       
fstrUrbanization VARCHAR(100),                                                                                                      
fstrMunicipality VARCHAR(60),                                                                                                       
fstrDistrict VARCHAR(60),                                                                                                           
fstrSubDistrict VARCHAR(60),                                                                                                        
fstrSubProvince VARCHAR(100),                                                                                                       
fstrAddressDescription VARCHAR(510),                                                                                                
fstrListFormatAddress VARCHAR(510),                                                                                                 
flngIDKey INT,                                                                                                                      
fstrIDType VARCHAR(12),                                                                                                             
fstrID VARCHAR(60),                                                                                                                 
fstrFormattedID VARCHAR(60),                                                                                                        
fstrDistrictOffice VARCHAR(12),                                                                                                     
fstrCollectDistrictOffice VARCHAR(12),                                                                                              
fstrReviewType VARCHAR(12),                                                                                                         
fstrCustomerLevel VARCHAR(12),                                                                                                      
fi64ProtectedDataSource BIGINT,                                                                                                     
fdtmWhen TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;  


--app_tblcustomerlevel P2H2
-- flngcustomerkey  included
DROP TABLE  ${target_db=Enter the target database name here}.app_tblcustomerlevel;
CREATE TABLE  ${target_db=Enter the target database name here}.app_tblcustomerlevel
(   
flngdockey INT,  
flngcustomerkey INT,   
fstrcustomerlevel VARCHAR(12),  
fstrwho VARCHAR(20),  
fdtmwhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,   
record_expiry_timestamp TIMESTAMP,  
record_active_flag VARCHAR(1),  
record_deleted_flag VARCHAR(1),  
insert_object_run_key INT,  
update_object_run_key INT ) 
STORED AS PARQUET ;
 

--app_tblcustomermail P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomermail;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomermail (                                                 
flngMailItemKey INT,                                                                                                                
fstrFormat VARCHAR(12),                                                                                                             
flngMailCategoryKey INT,                                                                                                            
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fintAddressKey SMALLINT,                                                                                                            
fintAddressProfile SMALLINT,                                                                                                        
fintNameKey SMALLINT,                                                                                                               
fintNameProfile SMALLINT,                                                                                                           
flngBillItemKey INT,                                                                                                                
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngMailItemTypeKey INT,                                                                                                            
flngTemplateKey INT,                                                                                                                
fstrLetterId VARCHAR(60),                                                                                                           
fstrMailType VARCHAR(24),                                                                                                           
fdtmRequest TIMESTAMP,                                                                                                              
fdtmReady TIMESTAMP,                                                                                                                
fdtmPrinted TIMESTAMP,                                                                                                              
fdtmRePrinted TIMESTAMP,                                                                                                            
fdtmResend TIMESTAMP,                                                                                                               
fdtmEmailed TIMESTAMP,                                                                                                              
fblnValid SMALLINT,                                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,      
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                             
 ) STORED AS PARQUET;   



--app_tblcustomerstd P2H2
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblcustomerstd;                                           
CREATE TABLE ${target_db=Enter the target database name here}.app_tblcustomerstd (                                                  
FLNGDOCKEY INT,                                                                                                                     
FDTMDOB TIMESTAMP,                                                                                                                  
FDTMDOD TIMESTAMP,                                                                                                                  
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;                                                                                                               
                         

--app_tbldocposttransaction P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tbldocposttransaction;                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tbldocposttransaction (                                           
flngDocKey INT,                                                                                                                     
fstrField VARCHAR(200),                                                                                                             
flngTableRow INT,                                                                                                                   
flngDocVerLast INT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fintPosting SMALLINT,                                                                                                               
fi64SourceKey BIGINT,                                                                                                               
fstrSource VARCHAR(40),                                                                                                             
fstrIdType VARCHAR(12),                                                                                                             
fstrId VARCHAR(60),                                                                                                                 
fstrNameControl VARCHAR(8),                                                                                                         
flngCustomerKey INT,                                                                                                                
flngAccountKey INT,                                                                                                                 
fstrAccountType VARCHAR(12),                                                                                                        
fdtmFilingPeriod TIMESTAMP,                                                                                                         
flngBillItemKey INT,                                                                                                                
fstrBillType VARCHAR(12),                                                                                                           
fdtmBillDue TIMESTAMP,                                                                                                              
fstrGroup VARCHAR(24),                                                                                                              
flngTransKey INT,                                                                                                                   
fstrTransType VARCHAR(12),                                                                                                          
fdtmEffect TIMESTAMP,                                                                                                               
fdtmReport TIMESTAMP,                                                                                                               
fcurAmount DECIMAL(19,4),                                                                                                           
fintWorkStatus SMALLINT,                                                                                                            
fblnProcessed SMALLINT,                                                                                                             
fdtmReviewed TIMESTAMP,                                                                                                             
fdtmPosted TIMESTAMP,                                                                                                               
fdtmReversed TIMESTAMP,                                                                                                             
fblnUpdatePeriod SMALLINT,                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,   
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;  


         
--app_tblid P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblid;                                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblid (                                                           
FLNGIDKEY INT,                                                                                                                      
FLNGVER INT,                                                                                                                        
FLNGCUSTOMERKEY INT,                                                                                                                
FSTRIDTYPE VARCHAR(12),                                                                                                             
FSTRID VARCHAR(60),                                                                                                                 
FLNGACCOUNTKEY INT,                                                                                                                 
FLNGVERLAST INT,                                                                                                                    
FBLNVALIDATED SMALLINT,                                                                                                             
FBLNACTIVE SMALLINT,                                                                                                                
FINTPROFILENUMBER SMALLINT,                                                                                                         
FBLNDEFAULT SMALLINT,                                                                                                               
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
flngImageKey INT,                                                                                                                   
flngDocKey INT,                                                                                                                     
flngCrmKey INT,                                                                                                                     
fi64ProtectedDataSource BIGINT,                                                                                                     
fintProtectLevel SMALLINT,                                                                                                          
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;  



--app_tblindicator P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblindicator;                                             
CREATE TABLE ${target_db=Enter the target database name here}.app_tblindicator (                                                    
FLNGINDICATORKEY INT,                                                                                                               
FLNGVER INT,                                                                                                                        
FLNGVERLAST INT,                                                                                                                    
FINTLEVEL SMALLINT,                                                                                                                 
FLNGCUSTOMERKEY INT,                                                                                                                
FINTPROFILENUMBER SMALLINT,                                                                                                         
FLNGACCOUNTKEY INT,                                                                                                                 
FSTRINDICATOR VARCHAR(12),                                                                                                          
FDTMCOMMENCE TIMESTAMP,                                                                                                             
FDTMFILINGPERIOD TIMESTAMP,                                                                                                         
FDTMFILINGPERIODTO TIMESTAMP,                                                                                                       
FCURAMOUNT DECIMAL(19,4),                                                                                                           
FDTMCEASE TIMESTAMP,                                                                                                                
FSTRREASON VARCHAR(12),                                                                                                             
FDTMCOMMENCE1 TIMESTAMP,                                                                                                            
FDTMCEASE1 TIMESTAMP,                                                                                                               
flngCrmKey INT,                                                                                                                     
FSTRCOMMENT VARCHAR(510),                                                                                                           
FSTRUSER VARCHAR(20),                                                                                                               
flngDocKey INT,                                                                                                                     
fblnActive SMALLINT,                                                                                                                
FSTRWHO VARCHAR(20),                                                                                                                
FDTMWHEN TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;                                                                                                               
                        

--app_tblmailitem P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblmailitem;                                              
CREATE TABLE ${target_db=Enter the target database name here}.app_tblmailitem (                                                     
flngMailItemKey INT,                                                                                                                
flngVerLast INT,                                                                                                                    
flngMailTypeKey INT,                                                                                                                
flngTemplateKey INT,                                                                                                                
flngCRMKey INT,                                                                                                                     
fstrRecipientKey VARCHAR(60),                                                                                                       
flngNameAddressHash INT,                                                                                                            
fstrSortKey VARCHAR(60),                                                                                                            
fdtmSortDate TIMESTAMP,                                                                                                             
fintMailTypeSort SMALLINT,                                                                                                          
fstrLanguage VARCHAR(6),                                                                                                            
fstrAddressBlock VARCHAR(4000),                                                                                                     
fstrEmailTo VARCHAR(510),                                                                                                           
fstrName VARCHAR(510),                                                                                                              
fstrDLN VARCHAR(60),                                                                                                                
fstrCity VARCHAR(510),                                                                                                              
fstrCountry VARCHAR(200),                                                                                                           
fstrZip VARCHAR(60),                                                                                                                
fblnValidAddress SMALLINT,                                                                                                          
fdtmCreated TIMESTAMP,                                                                                                              
fstrCreatedWho VARCHAR(20),                                                                                                         
fdtmBatched TIMESTAMP,                                                                                                              
fdtmPrinted TIMESTAMP,                                                                                                              
fstrPrintedWho VARCHAR(20),                                                                                                         
fstrPrinter VARCHAR(510),                                                                                                           
fdtmRePrinted TIMESTAMP,                                                                                                            
fstrReprintedWho VARCHAR(20),                                                                                                       
fstrRePrintPrinter VARCHAR(510),                                                                                                    
fdtmReady TIMESTAMP,                                                                                                                
fstrReadyWho VARCHAR(20),                                                                                                           
fdtmEmailedOn TIMESTAMP,                                                                                                            
flngPrintGroupKey INT,                                                                                                              
fblnValid SMALLINT,                                                                                                                 
fstrValidatedWho VARCHAR(20),                                                                                                       
fdtmValidatedWhen TIMESTAMP,                                                                                                        
fblnElectronicOnly SMALLINT,                                                                                                        
fstrRenderType VARCHAR(24),                                                                                                         
fstrDatabase VARCHAR(40),                                                                                                           
flngImageKey INT,                                                                                                                   
fblnLock SMALLINT,                                                                                                                  
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,  
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                 
 ) STORED AS PARQUET;      

--app_tblnaics P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnaics;                                                 
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnaics (                                                        
flngNAICSKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrNAICSVersion VARCHAR(24),                                                                                                       
fstrNAICS VARCHAR(60),                                                                                                              
fstrLevel1 VARCHAR(60),                                                                                                             
fstrLevel2 VARCHAR(60),                                                                                                             
fstrLevel3 VARCHAR(60),                                                                                                             
fstrLevel4 VARCHAR(60),                                                                                                             
fstrLevel5 VARCHAR(60),                                                                                                             
fstrLevel6 VARCHAR(60),                                                                                                             
flngCustomerKey INT,                                                                                                                
fintProfileNumber SMALLINT,                                                                                                         
flngAccountKey INT,                                                                                                                 
fdtmCommence TIMESTAMP,                                                                                                             
fdtmCease TIMESTAMP,                                                                                                                
fcurBusinessMakeup DECIMAL(19,4),                                                                                                   
fblnDefault SMALLINT,                                                                                                               
fblnActive SMALLINT,                                                                                                                
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;      

--app_tblnamerecord P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnamerecord;                                            
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnamerecord (                                                   
fi64NameKey BIGINT,                                                                                                                 
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fdtmEffectiveFrom TIMESTAMP,                                                                                                        
fdtmEffectiveTo TIMESTAMP,                                                                                                          
fdtmSystemFrom TIMESTAMP,                                                                                                           
fdtmSystemTo TIMESTAMP,                                                                                                             
fstrSource VARCHAR(40),                                                                                                             
flngCustomerKey INT,                                                                                                                
fintProfileNumber SMALLINT,                                                                                                         
fi64SourceKey BIGINT,                                                                                                               
fstrNameType VARCHAR(40),                                                                                                           
fstrDisplay VARCHAR(24),                                                                                                            
fblnFormatted SMALLINT,                                                                                                             
fstrLastName VARCHAR(100),                                                                                                          
fintLastModifier SMALLINT,                                                                                                          
fstrFirstName VARCHAR(100),                                                                                                         
fintFirstModifier SMALLINT,                                                                                                         
fstrMiddleName VARCHAR(100),                                                                                                        
fintMiddleModifier SMALLINT,                                                                                                        
fstrTitle VARCHAR(20),                                                                                                              
fintTitleModifier SMALLINT,                                                                                                         
fstrSuffix VARCHAR(20),                                                                                                             
fintSuffixModifier SMALLINT,                                                                                                        
fstrFreeFormatName VARCHAR(510),                                                                                                    
fintFreeFormatModifier SMALLINT,                                                                                                    
fstrAdditionalName VARCHAR(510),                                                                                                    
fintAdditionalModifier SMALLINT,                                                                                                    
fstrAdditionalName2 VARCHAR(510),                                                                                                   
fintAdditionalModifier2 SMALLINT,                                                                                                   
fstrListFormatName VARCHAR(510),                                                                                                    
fi64ProtectedDataSource BIGINT,                                                                                                     
flngCrmKey INT,                                                                                                                     
fblnBlank SMALLINT,                                                                                                                 
fblnCurrent SMALLINT,                                                                                                               
fblnActive SMALLINT,                                                                                                                
fintProtectLevel SMALLINT,                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                   
 ) STORED AS PARQUET;         

--app_tblnz_accidgedu P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_accidgedu;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_accidgedu (                                                 
flngDocKey INT,                                                                                                                     
fstrEducationProvider VARCHAR(100),                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;  

--app_tblnz_accidgovr P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_accidgovr;                                          
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_accidgovr (                                                 
flngDocKey INT,                                                                                                                     
fstrIssuingCountry VARCHAR(6),                                                                                                      
fblnTranslationReceived SMALLINT,                                                                                                   
flngEntryNumber INT,                                                                                                                
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;



--app_tblnz_calllog P2H1
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_calllog;                                            
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_calllog (                                                   
flngVisitKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrIrdNumber VARCHAR(20),                                                                                                          
fstrAuthIRDNumber VARCHAR(20),                                                                                                      
flngChildVisitKey INT,                                                                                                              
fstrUpdateReason VARCHAR(40),                                                                                                       
fstrIvrPath VARCHAR(4000),                                                                                                          
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                               
 ) STORED AS PARQUET;     

--app_tblnz_cstcominfo P2H2
                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_cstcominfo;    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_cstcominfo (                                                                                         
flngDocKey INT,                                                                                                                     
fstrURL VARCHAR(100),                                                                                                               
fblnNilCompany SMALLINT,                                                                                                            
fblnDonee SMALLINT,                                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;      

--app_tblnz_customerstd P2H2

                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_customerstd;                                        
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_customerstd (                                               
flngDocKey INT,                                                                                                                     
fstrCustomerSubTypeClass VARCHAR(12),                                                                                               
fstrCustomerSubType VARCHAR(12),                                                                                                    
fstrCustomerSegment VARCHAR(100),                                                                                                   
fstrSpecialFileType VARCHAR(12),                                                                                                    
fblnSpecialTaxResidency SMALLINT,                                                                                                   
fstrNonResidentType VARCHAR(100),                                                                                                   
fstrCurrentTaxResidency VARCHAR(100),                                                                                               
fstrClosureReason VARCHAR(12),                                                                                                      
fintSMSCountryCode SMALLINT,                                                                                                        
fstrSMSAreaCode VARCHAR(10),                                                                                                        
fstrSMSPhoneNumber VARCHAR(30),                                                                                                     
fdtmIncomeBalanceDate TIMESTAMP,                                                                                                    
fstrCustomerClass VARCHAR(12),                                                                                                      
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP, 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                
 ) STORED AS PARQUET;     

--app_tblnz_custsegmenthist P2H1

                                                                                                                                    
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_custsegmenthist;                                    
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_custsegmenthist (                                           
flngDocKey INT,                                                                                                                     
flngVerLast INT,                                                                                                                    
fstrCustomerSegment VARCHAR(100),                                                                                                   
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                                  
 ) STORED AS PARQUET;    

--app_tblnz_custtaxresidency P2H4
DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_custtaxresidency;                                   
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_custtaxresidency (                                          
flngDocKey INT,                                                                                                                     
fintSeq SMALLINT,                                                                                                                   
fstrTaxResidency VARCHAR(100),                                                                                                      
fdtmResStart TIMESTAMP,                                                                                                             
fdtmResEnd TIMESTAMP,                                                                                                               
fblnIsFinancial SMALLINT,                                                                                                           
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
                                                                                                                                    
 ) STORED AS PARQUET;         

--app_tblnz_visitmanagedcall P2H2

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblnz_visitmanagedcall;                                   
CREATE TABLE ${target_db=Enter the target database name here}.app_tblnz_visitmanagedcall (                                          
flngDocKey INT,                                                                                                                     
fstrCallerIrdNumber VARCHAR(20),                                                                                                    
fstrAuthorisedIrdNumber VARCHAR(20),                                                                                                
fstrTaxAgentName VARCHAR(100),                                                                                                      
fstrVoiceEnrolStatus VARCHAR(2),                                                                                                    
fstrVoiceOptOutStatus VARCHAR(2),                                                                                                   
fstrTransferReason VARCHAR(510),                                                                                                    
fstrCallerIntentCorrect VARCHAR(6),                                                                                                 
fstrCallerIntent VARCHAR(100),                                                                                                      
fstrCorrectedIntent VARCHAR(100),                                                                                                   
fstrCallQueue VARCHAR(100),                                                                                                         
fstrStageOneFeedback VARCHAR(24),                                                                                                   
fblnVirtualHold SMALLINT,                                                                                                           
fblnContactDetailsChecked SMALLINT,                                                                                                 
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET; 

--app_tblvisit P2H1

DROP TABLE if exists ${target_db=Enter the target database name here}.app_tblvisit;                                                 
CREATE TABLE ${target_db=Enter the target database name here}.app_tblvisit (                                                        
flngVisitKey INT,                                                                                                                   
flngVer INT,                                                                                                                        
flngVerLast INT,                                                                                                                    
fstrVisitSource VARCHAR(24),                                                                                                        
fstrVisitCategory VARCHAR(24),                                                                                                      
fstrVisitSubCategory VARCHAR(24),                                                                                                   
flngFolderKey INT,                                                                                                                  
flngCustomerKey INT,                                                                                                                
fblnUnregisteredVisitor SMALLINT,                                                                                                   
fi64NameKey BIGINT,                                                                                                                 
fi64AddressKey BIGINT,                                                                                                              
fstrVisitId VARCHAR(60),                                                                                                            
fstrTicketId VARCHAR(60),                                                                                                           
fstrExternalId VARCHAR(60),                                                                                                         
fstrIdType VARCHAR(12),                                                                                                             
fstrId VARCHAR(60),                                                                                                                 
fstrCountry VARCHAR(12),                                                                                                            
fintCountryCode SMALLINT,                                                                                                           
fstrAreaCode VARCHAR(10),                                                                                                           
fstrPhoneNumber VARCHAR(30),                                                                                                        
fblnVisitorVerified SMALLINT,                                                                                                       
fstrVerifyDocType VARCHAR(24),                                                                                                      
fintVerifyDocVer SMALLINT,                                                                                                          
fi64VerifyDocEditInProgressKey BIGINT,                                                                                              
flngVerifyDocKey INT,                                                                                                               
fstrDocType VARCHAR(24),                                                                                                            
fintDocVer SMALLINT,                                                                                                                
fi64DocEditInProgressKey BIGINT,                                                                                                    
flngDocKey INT,                                                                                                                     
flngXmlKey INT,                                                                                                                     
fstrOwner VARCHAR(20),                                                                                                              
fstrDistrictOffice VARCHAR(12),                                                                                                     
fblnHold SMALLINT,                                                                                                                  
fdtmVisitStart TIMESTAMP,                                                                                                           
fdtmVisitEnd TIMESTAMP,                                                                                                             
flngDuration INT,                                                                                                                   
flngWaitTime INT,                                                                                                                   
fblnActive SMALLINT,                                                                                                                
fdtmReversed TIMESTAMP,                                                                                                             
fstrWho VARCHAR(20),                                                                                                                
fdtmWhen TIMESTAMP,                                                                                                                 
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                           

--dss_agents P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_agents;                                                   
CREATE TABLE ${target_db=Enter the target database name here}.dss_agents (                                                          
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
AGT_DATE_START TIMESTAMP,                                                                                                           
AGT_DATE_END TIMESTAMP,                                                                                                             
AGENT_TYPE VARCHAR(2),                                                                                                              
OLD_SYSTEM_NUMBER INT,                                                                                                              
AGENCY_IRD_NUMBER INT,                                                                                                              
AGENCY_LOCATION_NUMBER INT,                                                                                                         
AGENT_TIME_EXTENSION VARCHAR(2),                                                                                                    
WITHDRAW_DATE TIMESTAMP,                                                                                                            
OFFICE_NUMBER INT,                                                                                                                  
SEGMNT VARCHAR(2),                                                                                                                  
MICRO_SEGMNT VARCHAR(4),                                                                                                            
ACCOUNT_MANAGER_ID VARCHAR(16),                                                                                                     
EFILE_ACCESS VARCHAR(2),                                                                                                            
EFILE_TARGET VARCHAR(2),                                                                                                            
`TIMESTAMP` TIMESTAMP,                                                                                                              
DATE_CEASED TIMESTAMP,                                                                                                              
PROFESSIONAL_ORG_CODE VARCHAR(2),                                                                                                   
PUBLIC_PRACTICE_CERT_IND VARCHAR(2),                                                                                                
EMPLOYER_RETURNS_IND VARCHAR(2),                                                                                                    
OTHER_RETURN_IND VARCHAR(2),                                                                                                        
EMAIL_ADDRESS VARCHAR(120),                                                                                                         
EFILE_IRD_NUMBER INT,                                                                                                               
EFILE_LOCATION_NUMBER INT,                                                                                                          
EFILE_REPORT_OPTION VARCHAR(2),                                                                                                     
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                               

--dss_client_codes P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_client_codes;                                             
CREATE TABLE ${target_db=Enter the target database name here}.dss_client_codes (                                                    
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
TAX_TYPE VARCHAR(6),                                                                                                                
CLIENT_CODE_TYPE VARCHAR(6),                                                                                                        
CLIENT_CODE_VALUE VARCHAR(6),                                                                                                       
DATE_START TIMESTAMP,                                                                                                               
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_END TIMESTAMP,                                                                                                                 
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
USER_ID VARCHAR(16),                                                                                                                
DATE_PROCESSED TIMESTAMP,                                                                                                           
CLIENT_CODE_KEY INT,                                                                                                                
BEGIN_CHANGE_REASON_CODE VARCHAR(8),                                                                                                
END_CHANGE_REASON_CODE VARCHAR(8),                                                                                                  
INBOUND_DOC_LODGE_NBR_PREFIX INT,                                                                                                   
INBOUND_DOC_LODGE_NBR INT,                                                                                                          
OUTBOUND_DOC_LODGE_NBR_PREFIX INT,                                                                                                  
OUTBOUND_DOC_LODGE_NBR INT,                                                                                                         
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;          

--dss_client_names P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_client_names;      
CREATE TABLE ${target_db=Enter the target database name here}.dss_client_names (                                                    
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
CLIENT_NAME_TYPE VARCHAR(4),                                                                                                        
SEQUENCE_NUMBER INT,                                                                                                                
DATE_APPLIED TIMESTAMP,                                                                                                             
FIRST_NAMES VARCHAR(74),                                                                                                            
SURNAME VARCHAR(62),                                                                                                                
TITLE VARCHAR(12),                                                                                                                  
ORGANISATION_NAME VARCHAR(148),                                                                                                     
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;      

--dss_clients P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_clients;   
CREATE TABLE ${target_db=Enter the target database name here}.dss_clients (                                                         
IRD_NUMBER INT,                                                                                                                     
ENTITY_TYPE VARCHAR(2),                                                                                                             
DATE_APPLIED TIMESTAMP,                                                                                                             
ENTITY_CLASS VARCHAR(4),                                                                                                            
CUST_TYPE VARCHAR(6),                                                                                                               
MASTER_LOCATION INT,                                                                                                                
DATE_CREATED TIMESTAMP,                                                                                                             
DATE_OF_BIRTH TIMESTAMP,                                                                                                            
ORG_COMMENCEMENT_DATE TIMESTAMP,                                                                                                    
CLIENT_STATUS VARCHAR(2),                                                                                                           
RESIDENT_IND VARCHAR(2),                                                                                                            
SIC_SOURCE VARCHAR(2),                                                                                                              
LOAN_IND VARCHAR(2),                                                                                                                
SECURE_IND VARCHAR(2),                                                                                                              
CLIENT_PASSWORD VARCHAR(20),                                                                                                        
RWT_RATE INT,                                                                                                                       
IDENTIFICATION_TYPE_CODE VARCHAR(2),                                                                                                
ID_SERIAL_NUMBER VARCHAR(40),                                                                                                       
PHONE_NUMBER VARCHAR(48),                                                                                                           
WORK_PHONE_NUMBER VARCHAR(48),                                                                                                      
CELL_PHONE_NUMBER VARCHAR(48),                                                                                                      
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
GENDER VARCHAR(2),                                                                                                                  
NOMINATED_GST_IRD_NUMBER INT,                                                                                                       
NOMINATED_GST_LOCATION_NUMBER INT,                                                                                                  
LATEST_INC_PERIOD_ASSESSED TIMESTAMP,                                                                                               
BALANCE_DATE INT,                                                                                                                   
PROVISIONAL_IND_CODE INT,                                                                                                           
RATIO_PERCENTAGE DECIMAL(8,2),                                                                                                      
RATIO_STATUS_CODE VARCHAR(6),                                                                                                       
RATIO_BASE_PERIOD_DATE TIMESTAMP,                                                                                                   
CURRENT_CAL_RATIO_START_DATE TIMESTAMP,                                                                                             
RATIO_PENDING_INDICATOR VARCHAR(2),                                                                                                 
INTERVIEW_REQUIRED_IND VARCHAR(2),                                                                                                  
NZ_CITIZEN_IND VARCHAR(2),                                                                                                          
VERIFIER_ORGANISATION_ID VARCHAR(6),                                                                                                
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;    

--dss_customers P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_customers;                                                
CREATE TABLE ${target_db=Enter the target database name here}.dss_customers (                                                       
IRD_NUMBER INT,                                                                                                                     
LOCATION_NUMBER INT,                                                                                                                
ENTITY_TYPE VARCHAR(2),                                                                                                             
ENTITY_CLASS VARCHAR(4),                                                                                                            
CLIENT_STATUS VARCHAR(2),                                                                                                           
SEGMENT_ID VARCHAR(40),                                                                                                             
MICRO_SEGMENT VARCHAR(40),                                                                                                          
DISTRICT_OFFICE VARCHAR(40),                                                                                                        
SERVICE_CENTRE VARCHAR(40),                                                                                                         
DATE_APPLIED TIMESTAMP,                                                                                                             
DATE_CEASED TIMESTAMP,                                                                                                              
DATE_OF_BIRTH TIMESTAMP,                                                                                                            
ORG_COMMENCEMENT_DATE TIMESTAMP,                                                                                                    
LOAN_INDICATOR VARCHAR(2),                                                                                                          
RESIDENT_INDICATOR VARCHAR(2),                                                                                                      
SIC_CODE VARCHAR(16),                                                                                                               
DATE_ADVISORY_VISIT TIMESTAMP,                                                                                                      
ADDRESS_STATUS VARCHAR(2),                                                                                                          
CUST_TYPE VARCHAR(6),                                                                                                               
DATE_CREATED TIMESTAMP,                                                                                                             
SIC_SOURCE VARCHAR(2),                                                                                                              
IDENTIFICATION_TYPE_CODE VARCHAR(2),                                                                                                
ID_SERIAL_NUMBER VARCHAR(40),                                                                                                       
PHONE_NUMBER VARCHAR(48),                                                                                                           
WORK_PHONE_NUMBER VARCHAR(48),                                                                                                      
CELL_PHONE_NUMBER VARCHAR(48),                                                                                                      
NATURE_OF_BUSINESS VARCHAR(100),                                                                                                    
MESH_BLOCK INT,                                                                                                                     
GENDER VARCHAR(2),                                                                                                                  
INTERVIEW_REQUIRED_IND VARCHAR(2),                                                                                                  
NZ_CITIZEN_IND VARCHAR(2),                                                                                                          
VERIFIER_ORGANISATION_ID VARCHAR(6),    
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                             
 ) STORED AS PARQUET;   

--dss_entity_classes P2H3

DROP TABLE if exists ${target_db=Enter the target database name here}.dss_entity_classes;                                           
CREATE TABLE ${target_db=Enter the target database name here}.dss_entity_classes (                                                  
ENTITY_CLASS_CODE VARCHAR(4),                                                                                                       
DATE_APPLIED TIMESTAMP,                                                                                                             
DESCRIPTION VARCHAR(120),                                                                                                           
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;      



--dss_entity_types P2H3
DROP TABLE if exists ${target_db=Enter the target database name here}.dss_entity_types;                                             
CREATE TABLE ${target_db=Enter the target database name here}.dss_entity_types (                                                    
ENTITY_TYPE_CODE VARCHAR(2),                                                                                                        
DATE_APPLIED TIMESTAMP,                                                                                                             
DESCRIPTION VARCHAR(120),                                                                                                           
DATE_CEASED TIMESTAMP,                                                                                                              
`TIMESTAMP` TIMESTAMP,                                                                                                              
VALIDATED VARCHAR(2),                                                                                                               
record_effective_timestamp TIMESTAMP,                                                                                               
record_expiry_timestamp TIMESTAMP,                                                                                                  
record_active_flag VARCHAR(1),                                                                                                      
record_deleted_flag VARCHAR(1),                                                                                                     
insert_object_run_key INT,                                                                                                          
update_object_run_key INT                                                                                                           
 ) STORED AS PARQUET;                                                                                                               
                         



-- crm_text_data table is used by cas views

CREATE TABLE ${target_db=Enter the target database name here}_raw.crm_text_data 
(   
flngcrmkey DOUBLE,  
flngver BIGINT,  
flngverlast BIGINT,   
fstrcrmsource VARCHAR(40),   
fstrcrmtype VARCHAR(40),   
flngparentcrmkey DOUBLE,   
flngcustomerkey BIGINT,  
fintprofilenumber DOUBLE,   
flngaccountkey DOUBLE,   
fstraccounttype VARCHAR(12),   
fdtmfilingperiod TIMESTAMP,   
flngbillitemkey DOUBLE,   fintbillitem DOUBLE,  
flngfolderkey BIGINT,  
fi64sourcekey DOUBLE,  
fstrsourceid VARCHAR(100),  
fstrsourcetype VARCHAR(60),  
fstrsourcedata VARCHAR(510),  
fstrdata VARCHAR(32767),   
fblnextended DOUBLE,   
fblnprivate DOUBLE,   
fblnhaschildren DOUBLE,  
fblnhighimportance DOUBLE,  
fblnsystem DOUBLE, 
fstreditedby VARCHAR(20),
fdtmedited TIMESTAMP, 
fstrcomment VARCHAR(2000),   
fblncommentexists DOUBLE,  
fstrwho VARCHAR(20),   
fdtmwhen TIMESTAMP,  
insert_object_run_key BIGINT,   
flngvisitkey BIGINT,   
fstrirdnumber VARCHAR(20),   
fstrauthirdnumber VARCHAR(20),  
flngchildvisitkey BIGINT,  
fstrivrpath VARCHAR(4000),  
fstrphonenumber VARCHAR(30),   
fblnhold INT,   
fstrupdatereason VARCHAR(40),  
record_effective_timestamp TIMESTAMP,   
record_expiry_timestamp TIMESTAMP, 
update_object_run_key INT,  
flngdockey BIGINT,   
fstrcallerirdnumber VARCHAR(20),  
fstrauthorisedirdnumber VARCHAR(20), 
fstrtaxagentname VARCHAR(100),  
fstrvoiceenrolstatus VARCHAR(2),  
fstrvoiceoptoutstatus VARCHAR(2),  
fstrtransferreason VARCHAR(510),  
fstrcallerintentcorrect VARCHAR(6), 
fstrcorrectedintent VARCHAR(100),  
fstrcallqueue VARCHAR(100),   
fstrstageonefeedback VARCHAR(24),  
fblnvirtualhold INT,  
fblncontactdetailschecked INT,  
fstrvisitsource VARCHAR(24),   
fstrvisitcategory VARCHAR(24),  
fstrvisitsubcategory VARCHAR(24),  
fblnunregisteredvisitor INT,  
fi64namekey DECIMAL(20,0),  
fi64addresskey DECIMAL(20,0),  
fstrvisitid VARCHAR(60),  
fstrticketid VARCHAR(60), 
fstrexternalid VARCHAR(60), 
fstridtype VARCHAR(12),  
fstrid VARCHAR(60),  
fstrcountry VARCHAR(12),  
fintcountrycode INT,  
fstrareacode VARCHAR(10),  
fblnvisitorverified INT,   
fstrverifydoctype VARCHAR(24), 
fintverifydocver INT,   
fi64verifydoceditinprogresskey DECIMAL(20,0),   
flngverifydockey BIGINT,  
fstrdoctype VARCHAR(24),  
fintdocver INT,   
fi64doceditinprogresskey DECIMAL(20,0),   
flngxmlkey BIGINT,   
fstrowner VARCHAR(20),   
fstrdistrictoffice VARCHAR(12),   
fdtmvisitstart TIMESTAMP,   
fdtmvisitend TIMESTAMP,  
flngduration BIGINT,   
flngwaittime BIGINT ) STORED AS PARQUET ;
 
