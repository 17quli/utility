



DROP VIEW IF EXISTS lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtype;
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtype                                                                                   
AS SELECT                                                                                                                           
z.fstrContributionDetailType,                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
FROM lab_nzsr4_raw.lannz_ksscontribdetailtype z;  

DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtype;
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtype                                                                                   
AS SELECT                                                                                                                           
z.fstrContributionDetailType,                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
FROM lab_nzsr4_raw.lannz_ksscontribdetailtype z;  



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtypereason;
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_ksscontribdetailtypereason                                                                            
AS SELECT                                                                                                                           
z.fstrReason,                                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
 FROM lab_nzsr4_raw.lannz_ksscontribreversalreason z;       

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_ksscontribdetailtypereason; 
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_ksscontribdetailtypereason                                                                            
AS SELECT                                                                                                                           
z.fstrReason,                                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
 FROM lab_nzsr4_raw. lannz_ksscontribreversalreason z;  
 


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_ksscontributionstatus  ;
CREATE VIEW          lab_nzsr4_raw_restricted_access.ref_lannz_ksscontributionstatus                                                                                
AS SELECT                                                                                                                           
z.fstrStatus,                                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                      
FROM lab_nzsr4_raw.lannz_ksscontributionstatus z;     
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_ksscontributionstatus;
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_ksscontributionstatus                                                                                
AS SELECT                                                                                                                           
z.fstrStatus,                                                                                                                       
z.fstrLanguage,                                                                                                                     
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                      
 FROM lab_nzsr4_raw.lannz_ksscontributionstatus z;     
 


                                                                                                                                  
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_ksscontributiontype ;                                                                                                                                     
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_ksscontributiontype                                                                            
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrContributionType,                                                                                                             
z.fdtmEffectiveFrom,                                                                                                                
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrWebDecode,                                                                                                                    
z.fstrDescription                                                                                                         
FROM lab_nzsr4_raw.lannz_ksscontributiontype z;                 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_ksscontributiontype;          
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_ksscontributiontype                                                                            
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrContributionType,                                                                                                             
z.fdtmEffectiveFrom,                                                                                                                
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrWebDecode,                                                                                                                    
z.fstrDescription                                                                                                         
FROM lab_nzsr4_raw.lannz_ksscontributiontype z;                 



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_kssfinhardshipreason;   
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_kssfinhardshipreason   
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrReason,                                                                                                                       
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription,                                                                                                                  
z.fstrWebDecode,                                                                                                                    
z.fstrWebDescription                                                                                                         
 FROM lab_nzsr4_raw.lannz_kssfinhardshipreason z  ;
 
DROP  VIEW lab_nzsr4_raw_full_access.ref_lannz_kssfinhardshipreason ;   
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_kssfinhardshipreason   
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrReason,                                                                                                                       
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription,                                                                                                                  
z.fstrWebDecode,                                                                                                                    
z.fstrWebDescription                                                                                                          
 FROM lab_nzsr4_raw.lannz_kssfinhardshipreason z  ; 
 

                                                    

DROP  VIEW IF EXISTS lab_nzsr4_raw_restricted_access.ref_lannz_kssmemberceasereason;  
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_kssmemberceasereason                                                                               
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrCeaseReason,                                                                                                                  
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                           
FROM lab_nzsr4_raw.lannz_kssmemberceasereason z;                                                                                

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_kssmemberceasereason  ;
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_kssmemberceasereason                                                                               
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrCeaseReason,                                                                                                                  
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                           
 FROM lab_nzsr4_raw.lannz_kssmemberceasereason z;    
 


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_kssschemechoicetype; 
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_kssschemechoicetype                                                                        
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrSchemeChoice,                                                                                                                 
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                         
FROM lab_nzsr4_raw.lannz_kssschemechoicetype z;  
 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_kssschemechoicetype;  
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_kssschemechoicetype                                                                        
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrSchemeChoice,                                                                                                                 
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                         
FROM lab_nzsr4_raw.lannz_kssschemechoicetype z;  



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_ksswithdrawalreason ;                                                                           
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_ksswithdrawalreason                                                                            
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrWithdrawalReason,                                                                                                             
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
 FROM lab_nzsr4_raw.lannz_ksswithdrawalreason z;     


DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_ksswithdrawalreason ;  
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_ksswithdrawalreason                                                                            
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrWithdrawalReason,                                                                                                             
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                          
 FROM lab_nzsr4_raw.lannz_ksswithdrawalreason z;     
 


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.ref_lannz_slsborrowertype ;
CREATE VIEW lab_nzsr4_raw_restricted_access.ref_lannz_slsborrowertype                                                                                
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrBorrowerType,                                                                                                                 
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                       
FROM lab_nzsr4_raw.lannz_slsborrowertype z;       

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.ref_lannz_slsborrowertype   ;
CREATE VIEW lab_nzsr4_raw_full_access.ref_lannz_slsborrowertype                                                                                
AS SELECT                                                                                                                           
z.fstrLanguage,                                                                                                                     
z.fstrBorrowerType,                                                                                                                 
z.fstrDecode1,                                                                                                                      
z.fstrDecode2,                                                                                                                      
z.fstrDescription                                                                                                       
FROM lab_nzsr4_raw.lannz_slsborrowertype z;    


 

DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_acckiwisavermemberinfo;    
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_acckiwisavermemberinfo                                           
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnHoldingPeriod,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_acckiwisavermemberinfo   z;      

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_acckiwisavermemberinfo;    
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_acckiwisavermemberinfo                                           
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnHoldingPeriod,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_acckiwisavermemberinfo   z;   



 
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_accksfinfo;   
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_accksfinfo                                                                                     
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fstrSchemeType,                                                                                                                   
z.fstrWebsite,                                                                                                                      
z.fstr0800Number,                                                                                                                   
z.fblnCheckDefault,                                                                                                                 
z.fblnCheckRestricted,                                                                                                              
z.fblnCheckWebsite,                                                                                                                 
z.fstrInvestmentProduct,                                                                                                            
z.fstrTradingPartner,                                                                                                               
z.fstrB2BType,                                                                                                                      
z.flngB2BBatchSize,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
 FROM lab_nzsr4_raw.tblnz_accksfinfo z;           
 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_accksfinfo  ; 
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_accksfinfo                                                                                     
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fstrSchemeType,                                                                                                                   
z.fstrWebsite,                                                                                                                      
z.fstr0800Number,                                                                                                                   
z.fblnCheckDefault,                                                                                                                 
z.fblnCheckRestricted,                                                                                                              
z.fblnCheckWebsite,                                                                                                                 
z.fstrInvestmentProduct,                                                                                                            
z.fstrTradingPartner,                                                                                                               
z.fstrB2BType,                                                                                                                      
z.flngB2BBatchSize,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
 FROM lab_nzsr4_raw.tblnz_accksfinfo z;           
 

                                                                                                                                    
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_acckssinfo;                                                                                     
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_acckssinfo                                                                                     
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnAutoEnrolled,                                                                                                                 
z.fstrSource,                                                                                                                       
z.fdtmActiveChoiceDate,                                                                                                             
z.fdtmIRFirstContribution,                                                                                                          
z.fdtmProviderFirstContribution,                                                                                                    
z.fblnHoldingPeriod,                                                                                                                
z.fdtmHoldingPeriodStart,                                                                                                           
z.fdtmHoldingPeriodEnd                                                                                                     
FROM lab_nzsr4_raw.tblnz_acckssinfo z;    

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_acckssinfo ;                                                                                    
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_acckssinfo                                                                                     
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnAutoEnrolled,                                                                                                                 
z.fstrSource,                                                                                                                       
z.fdtmActiveChoiceDate,                                                                                                             
z.fdtmIRFirstContribution,                                                                                                          
z.fdtmProviderFirstContribution,                                                                                                    
z.fblnHoldingPeriod,                                                                                                                
z.fdtmHoldingPeriodStart,                                                                                                           
z.fdtmHoldingPeriodEnd                                                                                                     
FROM lab_nzsr4_raw.tblnz_acckssinfo z;    




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_accsls  ; 
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_accsls                                                                                         
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnOffsetDebt,                                                                                                                   
z.fstrDisbursementOption,                                                                                                           
z.fblnOverseasBasedBorrower,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                      
 FROM lab_nzsr4_raw.tblnz_accsls z;         
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_accsls  ;                                                                                       
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_accsls                                                                                         
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fblnOffsetDebt,                                                                                                                   
z.fstrDisbursementOption,                                                                                                           
z.fblnOverseasBasedBorrower,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                      
 FROM lab_nzsr4_raw.tblnz_accsls z;       
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_accslshistory;                                                                                  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_accslshistory                                                                                  
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fblnObbStatus,                                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                       
 FROM lab_nzsr4_raw.tblnz_accslshistory z; 
 
 
DROP VIEW IF EXISTS   lab_nzsr4_raw_full_access.app_tblnz_accslshistory;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_accslshistory                                                                                  
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fblnObbStatus,                                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                       
 FROM lab_nzsr4_raw.tblnz_accslshistory z; 




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_casslsrecall;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_casslsrecall
AS SELECT
flngdockey	,
fstrreason,
fstrrecommendation,
flngtranswsdockey	,
fstrwho	,
fdtmwhen
FROM lab_nzsr4_raw.tblnz_casslsrecall;


DROP VIEW IF EXISTS   lab_nzsr4_raw_full_access.app_tblnz_casslsrecall;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_casslsrecall
AS SELECT
flngdockey	,
fstrreason,
fstrrecommendation,
flngtranswsdockey	,
fstrwho	,
fdtmwhen
FROM lab_nzsr4_raw.tblnz_casslsrecall;



DROP VIEW IF EXISTS   lab_nzsr4_raw_restricted_access.tblnz_customsals;
CREATE VIEW  lab_nzsr4_raw_restricted_access.tblnz_customsals                                                                                    
AS SELECT                                                                                                                           
z.fi64GatewayWebServiceOutKeyAdd,                                                                                                   
z.fi64GatewayWebServiceOutKeyDel,                                                                                                   
z.fi64BatchKey,                                                                                                                     
z.fintSeq,                                                                                                                          
z.flngAlertId,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrAccountType,                                                                                                                  
z.fstrIRDNumber,                                                                                                                    
z.fstrGivenName,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrPassportNumber,                                                                                                               
z.fstrPassportCountryCode,                                                                                                          
z.fdtmAdded,                                                                                                                        
z.fdtmDeleted,                                                                                                                      
z.fdtmLastProcessed,                                                                                                                
z.fblnAdd,                                                                                                                          
z.fblnDelete,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_customsals z                                                                                      
LEFT OUTER JOIN 
dev_raw.app_tblcustomerlevel cl 
ON z.flngcustomerkey = cl.flngcustomerkey
WHERE nvl(cl.fstrCustomerLevel, 'STD') = 'STD' 
AND nvl(cl.record_active_flag, 'Y') = 'Y' 
AND nvl(cl.record_deleted_flag, 'N') = 'N';


DROP VIEW IF EXISTS   lab_nzsr4_raw_full_access.tblnz_customsals; 
CREATE VIEW  lab_nzsr4_raw_full_access.tblnz_customsals                                                                                    
AS SELECT                                                                                                                           
z.fi64GatewayWebServiceOutKeyAdd,                                                                                                   
z.fi64GatewayWebServiceOutKeyDel,                                                                                                   
z.fi64BatchKey,                                                                                                                     
z.fintSeq,                                                                                                                          
z.flngAlertId,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrAccountType,                                                                                                                  
z.fstrIRDNumber,                                                                                                                    
z.fstrGivenName,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrPassportNumber,                                                                                                               
z.fstrPassportCountryCode,                                                                                                          
z.fdtmAdded,                                                                                                                        
z.fdtmDeleted,                                                                                                                      
z.fdtmLastProcessed,                                                                                                                
z.fblnAdd,                                                                                                                          
z.fblnDelete,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_customsals z                                                                                     
;


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_customspoi;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_customspoi                                                                                     
AS SELECT                                                                                                                           
z.fi64GatewayWebServiceOutKeyAdd,                                                                                                   
z.fi64GatewayWebServiceOutKeyDel,                                                                                                   
z.fi64BatchKey,                                                                                                                     
z.fstrPoiId,                                                                                                                        
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrAccountType,                                                                                                                  
z.fstrIRDNumber,                                                                                                                    
z.fstrGivenName,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrPassportNumber,                                                                                                               
z.fstrPassportCountryCode,                                                                                                          
z.fdtmAdded,                                                                                                                        
z.fdtmDeleted,                                                                                                                      
z.fdtmLastProcessed,                                                                                                                
z.fblnAdd,                                                                                                                          
z.fblnDelete,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                       
FROM lab_nzsr4_raw.tblnz_customspoi z
LEFT OUTER JOIN 
dev_raw.app_tblcustomerlevel cl 
ON z.flngcustomerkey = cl.flngcustomerkey
WHERE nvl(cl.fstrCustomerLevel, 'STD') = 'STD' 
AND nvl(cl.record_active_flag, 'Y') = 'Y' 
AND nvl(cl.record_deleted_flag, 'N') = 'N'; 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_customspoi ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_customspoi                                                                                     
AS SELECT                                                                                                                           
z.fi64GatewayWebServiceOutKeyAdd,                                                                                                   
z.fi64GatewayWebServiceOutKeyDel,                                                                                                   
z.fi64BatchKey,                                                                                                                     
z.fstrPoiId,                                                                                                                        
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrAccountType,                                                                                                                  
z.fstrIRDNumber,                                                                                                                    
z.fstrGivenName,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrPassportNumber,                                                                                                               
z.fstrPassportCountryCode,                                                                                                          
z.fdtmAdded,                                                                                                                        
z.fdtmDeleted,                                                                                                                      
z.fdtmLastProcessed,                                                                                                                
z.fblnAdd,                                                                                                                          
z.fblnDelete,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                       
FROM lab_nzsr4_raw.tblnz_customspoi z
;



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksemployerchosenschemes ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksemployerchosenschemes                                                                            
AS SELECT                                                                                                                           
z.flngRelationshipKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngEmployerAccountKey,                                                                                                           
z.flngEmployerCustomerKey,                                                                                                          
z.flngSchemeAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.fdtmCommence,                                                                                                                     
z.fdtmCease,                                                                                                                        
z.fstrCeaseReason,                                                                                                                  
z.fstrInvalidationReason,                                                                                                           
z.fblnValid,                                                                                                                        
z.flngAttachmentKey,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                    
 FROM lab_nzsr4_raw.tblnz_ksemployerchosenschemes z;
 
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksemployerchosenschemes  ; 
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksemployerchosenschemes                                                                            
AS SELECT                                                                                                                           
z.flngRelationshipKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngEmployerAccountKey,                                                                                                           
z.flngEmployerCustomerKey,                                                                                                          
z.flngSchemeAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.fdtmCommence,                                                                                                                     
z.fdtmCease,                                                                                                                        
z.fstrCeaseReason,                                                                                                                  
z.fstrInvalidationReason,                                                                                                           
z.fblnValid,                                                                                                                        
z.flngAttachmentKey,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                    
FROM lab_nzsr4_raw.tblnz_ksemployerchosenschemes z;
 
DROP  VIEW  IF EXISTS lab_nzsr4_raw_restricted_access.app_tblnz_kssproratainterest  ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssproratainterest                                                                             
AS SELECT                                                                                                                           
z.fi64InterestKey,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.fdtmCalculationDate,                                                                                                              
z.fi64InterestContributionKey,                                                                                                      
z.fcurCalculatedInterest,                                                                                                           
z.fcurInterestSentToScheme,                                                                                                         
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
 FROM lab_nzsr4_raw.tblnz_kssproratainterest z;     
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssproratainterest    ; 
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssproratainterest                                                                             
AS SELECT                                                                                                                           
z.fi64InterestKey,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.fdtmCalculationDate,                                                                                                              
z.fi64InterestContributionKey,                                                                                                      
z.fcurCalculatedInterest,                                                                                                           
z.fcurInterestSentToScheme,                                                                                                         
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
FROM lab_nzsr4_raw.tblnz_kssproratainterest z;     


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontribution;   
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontribution                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmContributionDate,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrSourceType,                                                                                                                   
z.fi64SourceKey,                                                                                                                    
z.fi64SourceItem,                                                                                                                   
z.fdtmSourceDate,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fstrReversalReason,                                                                                                               
z.fblnUpToDate,                                                                                                                     
z.fblnRA,                                                                                                                           
z.fblnResidual,                                                                                                                     
z.fblnUnclaimed,                                                                                                                    
z.fdtmUnclaimed,                                                                                                                    
z.flngDirectionAccountKey,                                                                                                          
z.fblnHistorical,                                                                                                                   
z.fblnError,                                                                                                                        
z.fblnCnvError,                                                                                                                     
z.flngCnvErrorWorkKey,                                                                                                              
z.fstrWho,
z.fdtmwhen
 FROM lab_nzsr4_raw.tblnz_ksscontribution z;                  

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontribution ;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontribution                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmContributionDate,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrSourceType,                                                                                                                   
z.fi64SourceKey,                                                                                                                    
z.fi64SourceItem,                                                                                                                   
z.fdtmSourceDate,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fstrReversalReason,                                                                                                               
z.fblnUpToDate,                                                                                                                     
z.fblnRA,                                                                                                                           
z.fblnResidual,                                                                                                                     
z.fblnUnclaimed,                                                                                                                    
z.fdtmUnclaimed,                                                                                                                    
z.flngDirectionAccountKey,                                                                                                          
z.fblnHistorical,                                                                                                                   
z.fblnError,                                                                                                                        
z.fblnCnvError,                                                                                                                     
z.flngCnvErrorWorkKey,                                                                                                              
z.fstrWho,
z.fdtmwhen
FROM lab_nzsr4_raw.tblnz_ksscontribution z;                  
 
 



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributionbalance;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributionbalance                                                                             
AS SELECT                                                                                                                           
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fintYear,                                                                                                                         
z.fcurContributionBalance,                                                                                                          
z.fcurPending,                                                                                                                      
z.fdtmNextEval,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                            
 FROM lab_nzsr4_raw.tblnz_ksscontributionbalance z;  

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontributionbalance; 
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontributionbalance                                                                             
AS SELECT                                                                                                                           
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fintYear,                                                                                                                         
z.fcurContributionBalance,                                                                                                          
z.fcurPending,                                                                                                                      
z.fdtmNextEval,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                            
 FROM lab_nzsr4_raw.tblnz_ksscontributionbalance z;    
 



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributiondetail ;       
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributiondetail                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionDetailKey,                                                                                                        
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fstrType,                                                                                                                         
z.fi64ContributionKey,                                                                                                              
z.fcurAmount,                                                                                                                       
z.fcurInterest,                                                                                                                     
z.fblnInterestCalculated,                                                                                                           
z.fi64InterestContributionKey,                                                                                                      
z.fdtmEffectiveDate,                                                                                                                
z.fdtmSent,                                                                                                                         
z.fdtmCreated,                                                                                                                      
z.fstrStatus,                                                                                                                       
z.fdtmStatusDate,                                                                                                                   
z.fdtmHoldTill,                                                                                                                     
z.fdtmFinal,                                                                                                                        
z.fblnPending,                                                                                                                      
z.flngTransKey,                                                                                                                     
z.fstrLegacyReferenceNumber,                                                                                                        
z.fstrLegacyLineNumber,                                                                                                             
z.fblnSmallBalance,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
 FROM lab_nzsr4_raw.tblnz_ksscontributiondetail  z;    

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontributiondetail;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontributiondetail                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionDetailKey,                                                                                                        
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fstrType,                                                                                                                         
z.fi64ContributionKey,                                                                                                              
z.fcurAmount,                                                                                                                       
z.fcurInterest,                                                                                                                     
z.fblnInterestCalculated,                                                                                                           
z.fi64InterestContributionKey,                                                                                                      
z.fdtmEffectiveDate,                                                                                                                
z.fdtmSent,                                                                                                                         
z.fdtmCreated,                                                                                                                      
z.fstrStatus,                                                                                                                       
z.fdtmStatusDate,                                                                                                                   
z.fdtmHoldTill,                                                                                                                     
z.fdtmFinal,                                                                                                                        
z.fblnPending,                                                                                                                      
z.flngTransKey,                                                                                                                     
z.fstrLegacyReferenceNumber,                                                                                                        
z.fstrLegacyLineNumber,                                                                                                             
z.fblnSmallBalance,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_ksscontributiondetail  z;    
 




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksfdefaultscheme  ; 
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksfdefaultscheme                                                                               
AS SELECT                                                                                                                           
z.flngDefaultSchemeKey,                                                                                                             
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fstrInvestmentProduct,                                                                                                            
z.fstrNZPostIdentifier,                                                                                                             
z.fblnActive,                                                                                                                       
z.flngAccountKey,                                                                                                                   
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_ksfdefaultscheme z;              


DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksfdefaultscheme ;   
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksfdefaultscheme                                                                               
AS SELECT                                                                                                                           
z.flngDefaultSchemeKey,                                                                                                             
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fstrInvestmentProduct,                                                                                                            
z.fstrNZPostIdentifier,                                                                                                             
z.fblnActive,                                                                                                                       
z.flngAccountKey,                                                                                                                   
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_ksfdefaultscheme z;              
 
 



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontribution  ;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontribution                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmContributionDate,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrSourceType,                                                                                                                   
z.fi64SourceKey,                                                                                                                    
z.fi64SourceItem,                                                                                                                   
z.fdtmSourceDate,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fstrReversalReason,                                                                                                               
z.fblnUpToDate,                                                                                                                     
z.fblnRA,                                                                                                                           
z.fblnResidual,                                                                                                                     
z.fblnUnclaimed,                                                                                                                    
z.fdtmUnclaimed,                                                                                                                    
z.flngDirectionAccountKey,                                                                                                          
z.fblnHistorical,                                                                                                                   
z.fblnError,                                                                                                                        
z.fblnCnvError,                                                                                                                     
z.flngCnvErrorWorkKey,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
 FROM lab_nzsr4_raw.tblnz_ksscontribution z;                        
 
   
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontribution ;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontribution                                                                                
AS SELECT                                                                                                                           
z.fi64ContributionKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmContributionDate,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrSourceType,                                                                                                                   
z.fi64SourceKey,                                                                                                                    
z.fi64SourceItem,                                                                                                                   
z.fdtmSourceDate,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fstrReversalReason,                                                                                                               
z.fblnUpToDate,                                                                                                                     
z.fblnRA,                                                                                                                           
z.fblnResidual,                                                                                                                     
z.fblnUnclaimed,                                                                                                                    
z.fdtmUnclaimed,                                                                                                                    
z.flngDirectionAccountKey,                                                                                                          
z.fblnHistorical,                                                                                                                   
z.fblnError,                                                                                                                        
z.fblnCnvError,                                                                                                                     
z.flngCnvErrorWorkKey,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_ksscontribution z;                        


 
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributionbalance   ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributionbalance                                                                                    
AS SELECT                                                                                                                           
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fintYear,                                                                                                                         
z.fcurContributionBalance,                                                                                                          
z.fcurPending,                                                                                                                      
z.fdtmNextEval,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_ksscontributionbalance z;                                                                                     
                                                   
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontributionbalance  ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontributionbalance                                                                                    
AS SELECT                                                                                                                           
z.flngCustomerKey,                                                                                                                  
z.flngAccountKey,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fintYear,                                                                                                                         
z.fcurContributionBalance,                                                                                                          
z.fcurPending,                                                                                                                      
z.fdtmNextEval,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_ksscontributionbalance z;                                                                                     
                                                   


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributiondetail   ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksscontributiondetail                                                                                    
AS SELECT                                                                                                                           
z.fi64ContributionDetailKey,                                                                                                        
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fstrType,                                                                                                                         
z.fi64ContributionKey,                                                                                                              
z.fcurAmount,                                                                                                                       
z.fcurInterest,                                                                                                                     
z.fblnInterestCalculated,                                                                                                           
z.fi64InterestContributionKey,                                                                                                      
z.fdtmEffectiveDate,                                                                                                                
z.fdtmSent,                                                                                                                         
z.fdtmCreated,                                                                                                                      
z.fstrStatus,                                                                                                                       
z.fdtmStatusDate,                                                                                                                   
z.fdtmHoldTill,                                                                                                                     
z.fdtmFinal,                                                                                                                        
z.fblnPending,                                                                                                                      
z.flngTransKey,                                                                                                                     
z.fstrLegacyReferenceNumber,                                                                                                        
z.fstrLegacyLineNumber,                                                                                                             
z.fblnSmallBalance,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_ksscontributiondetail z;     

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksscontributiondetail ; 
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksscontributiondetail                                                                                    
AS SELECT                                                                                                                           
z.fi64ContributionDetailKey,                                                                                                        
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.fstrType,                                                                                                                         
z.fi64ContributionKey,                                                                                                              
z.fcurAmount,                                                                                                                       
z.fcurInterest,                                                                                                                     
z.fblnInterestCalculated,                                                                                                           
z.fi64InterestContributionKey,                                                                                                      
z.fdtmEffectiveDate,                                                                                                                
z.fdtmSent,                                                                                                                         
z.fdtmCreated,                                                                                                                      
z.fstrStatus,                                                                                                                       
z.fdtmStatusDate,                                                                                                                   
z.fdtmHoldTill,                                                                                                                     
z.fdtmFinal,                                                                                                                        
z.fblnPending,                                                                                                                      
z.flngTransKey,                                                                                                                     
z.fstrLegacyReferenceNumber,                                                                                                        
z.fstrLegacyLineNumber,                                                                                                             
z.fblnSmallBalance,                                                                                                                 
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_ksscontributiondetail z;     
  



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssdefaultschemealloc    ; 
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssdefaultschemealloc                                                                                   
AS SELECT                                                                                                                           
z.flngDefaultSchemeKey,                                                                                                             
z.fblnAllocated,                                                                                                                    
z.flngAllocationCount,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_kssdefaultschemealloc z; 
   
   
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssdefaultschemealloc    ;         
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssdefaultschemealloc                                                                                   
AS SELECT                                                                                                                           
z.flngDefaultSchemeKey,                                                                                                             
z.fblnAllocated,                                                                                                                    
z.flngAllocationCount,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
 FROM lab_nzsr4_raw.tblnz_kssdefaultschemealloc z;     



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssholdtilldate;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssholdtilldate                                                                                    
AS SELECT                                                                                                                           
z.fdtmHoldTill,                                                                                                                     
z.fi64ContributionDetailKey,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
 FROM lab_nzsr4_raw.tblnz_kssholdtilldate z;     

DROP VIEW IF EXISTS lab_nzsr4_raw_full_access.app_tblnz_kssholdtilldate;                                                                                       
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssholdtilldate                                                                                    
AS SELECT                                                                                                                           
z.fdtmHoldTill,                                                                                                                     
z.fi64ContributionDetailKey,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
 FROM lab_nzsr4_raw.tblnz_kssholdtilldate z;                                                                                     
                                                                


 
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksspartialgvcclawback ; 
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksspartialgvcclawback                                                                                    
AS SELECT                                                                                                                           
z.flngGVCClawbackRequestKey,                                                                                                        
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fdtmProcessed                                                                                                        
 FROM lab_nzsr4_raw.tblnz_ksspartialgvcclawback z;  

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksspartialgvcclawback  ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksspartialgvcclawback                                                                                    
AS SELECT                                                                                                                           
z.flngGVCClawbackRequestKey,                                                                                                        
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fdtmProcessed                                                                                                        
 FROM lab_nzsr4_raw.tblnz_ksspartialgvcclawback z;   
 


     
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssproratainterest  ;    
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssproratainterest                                                                                  
AS SELECT                                                                                                                           
z.fi64InterestKey,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.fdtmCalculationDate,                                                                                                              
z.fi64InterestContributionKey,                                                                                                      
z.fcurCalculatedInterest,                                                                                                           
z.fcurInterestSentToScheme,                                                                                                         
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
 FROM lab_nzsr4_raw.tblnz_kssproratainterest z;  
   
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssproratainterest   ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssproratainterest                                                                                  
AS SELECT                                                                                                                           
z.fi64InterestKey,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.fdtmCalculationDate,                                                                                                              
z.fi64InterestContributionKey,                                                                                                      
z.fcurCalculatedInterest,                                                                                                           
z.fcurInterestSentToScheme,                                                                                                         
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
FROM lab_nzsr4_raw.tblnz_kssproratainterest z;        
     




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting ; 
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_kssprorataposting z;     

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting ;       
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_kssprorataposting z;     
     
     
     
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssresidual;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssresidual                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64ContributionKey,                                                                                                              
z.flngMemberAccountKey,                                                                                                             
z.fstrMemberIRD,                                                                                                                    
z.flngRelationshipKey,                                                                                                              
z.flngEmployerCustomerKey,                                                                                                          
z.flngEmployerAccountKey,                                                                                                           
z.fblnRegister,                                                                                                                     
z.flngCaseKey,                                                                                                                      
z.fblnWorkItem,                                                                                                                     
z.flngWorkKey,                                                                                                                      
z.fblnPartialOptOut,                                                                                                                
z.fblnComplete,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_kssresidual z;     

 
DROP VIEW lab_nzsr4_raw_full_access.app_tblnz_kssresidual   ;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssresidual                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64ContributionKey,                                                                                                              
z.flngMemberAccountKey,                                                                                                             
z.fstrMemberIRD,                                                                                                                    
z.flngRelationshipKey,                                                                                                              
z.flngEmployerCustomerKey,                                                                                                          
z.flngEmployerAccountKey,                                                                                                           
z.fblnRegister,                                                                                                                     
z.flngCaseKey,                                                                                                                      
z.fblnWorkItem,                                                                                                                     
z.flngWorkKey,                                                                                                                      
z.fblnPartialOptOut,                                                                                                                
z.fblnComplete,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_kssresidual z;     




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting    ;                                                                          
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_kssprorataposting z;     
 
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting    ;                                                                          
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_kssprorataposting z;     



DROP VIEW IF EXISTS  VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksswithdrawal;											   
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksswithdrawal                                                                                  
AS SELECT                                                                                                                           
z.flngWithdrawalKey,                                                                                                                
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fstrWithdrawalReason,                                                                                                             
z.fdtmWithdrawal,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fcurWithdrawalAmount,                                                                                                             
z.fcurGovernmentContribution,                                                                                                       
z.fdblMortgageDiversionPercent,                                                                                                     
z.fblnValid,                                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_ksswithdrawal z;  


DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_ksswithdrawal;   
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksswithdrawal                                                                                  
AS SELECT                                                                                                                           
z.flngWithdrawalKey,                                                                                                                
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fstrWithdrawalReason,                                                                                                             
z.fdtmWithdrawal,                                                                                                                   
z.fdtmReversed,                                                                                                                     
z.fcurWithdrawalAmount,                                                                                                             
z.fcurGovernmentContribution,                                                                                                       
z.fdblMortgageDiversionPercent,                                                                                                     
z.fblnValid,                                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_ksswithdrawal z;  


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_lnkksfadm            ;                                                                          
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_lnkksfadm                                                                                      
AS SELECT                                                                                                                           
flngwithdrawalkey,
flngver,
flngverlast,
flngmembercustomerkey,
flngmemberaccountkey,
flngschemecustomerkey,
flngschemeaccountkey,
fstrwithdrawalreason,
fdtmwithdrawal,
fdtmreversed,
fcurwithdrawalamount,
fcurgovernmentcontribution,
fdblmortgagediversionpercent,
fblnvalid,
fstrwho,
fdtmwhen                                                                                      
FROM lab_nzsr4_raw.tblnz_lnkksfadm z;

        
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_lnkksfadm  ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_lnkksfadm                                                                                      
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fstrContactName,                                                                                                                  
z.fstrContactEmail,                                                                                                                 
z.fstrPhoneNumber,                                                                                                                  
z.fstrPhoneNumber2,                                                                                                                 
z.fstrAttention,                                                                                                                    
z.fstrCity,                                                                                                                         
z.fstrDistrict,                                                                                                                     
z.fblnOverridden,                                                                                                                   
z.fstrRowID,                                                                                                                        
z.fstrStreet,                                                                                                                       
z.fstrSubDistrict,                                                                                                                  
z.fstrSubProvince,                                                                                                                  
z.fstrSuburb,                                                                                                                       
z.fstrUnit,                                                                                                                         
z.fstrUnitType,                                                                                                                     
z.fblnVerified,                                                                                                                     
z.fdtmVerifiredDt,                                                                                                                  
z.fstrZip,                                                                                                                          
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.app_tblnz_lnkksfadm z;
        



                                                                                                                                        
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_rtnkssgvc;                                                                                                                                           
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_rtnkssgvc                                                                                      
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fintClaimType,                                                                                                                    
z.fblnFirstClaim,                                                                                                                   
z.fdtmClaimStartDate,                                                                                                               
z.fblnFinalClaim,                                                                                                                   
z.fintFinalClaimEligibleDays,                                                                                                       
z.fstrSchemeIRDNumber,                                                                                                              
z.fblnAlternativeScheme,                                                                                                            
z.fcurGVCContributionAmount,                                                                                                        
z.fcurDirectMemberContributions,                                                                                                    
z.fintActualEligibleDays,                                                                                                           
z.fblnOverrideActualEligibleDays,                                                                                                   
z.fcurContributionsThroughIR,                                                                                                       
z.fblnTransferred,                                                                                                                  
z.fintSTARTFirstEligibleDays,                                                                                                       
z.fblnClaimedFullEntitlement,                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_rtnkssgvc z;      
                                                                                                                                        


DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_rtnkssgv;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_rtnkssgvc                                                                                      
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.fintClaimType,                                                                                                                    
z.fblnFirstClaim,                                                                                                                   
z.fdtmClaimStartDate,                                                                                                               
z.fblnFinalClaim,                                                                                                                   
z.fintFinalClaimEligibleDays,                                                                                                       
z.fstrSchemeIRDNumber,                                                                                                              
z.fblnAlternativeScheme,                                                                                                            
z.fcurGVCContributionAmount,                                                                                                        
z.fcurDirectMemberContributions,                                                                                                    
z.fintActualEligibleDays,                                                                                                           
z.fblnOverrideActualEligibleDays,                                                                                                   
z.fcurContributionsThroughIR,                                                                                                       
z.fblnTransferred,                                                                                                                  
z.fintSTARTFirstEligibleDays,                                                                                                       
z.fblnClaimedFullEntitlement,                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_rtnkssgvc z;                                                                                       






DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_slsborrowertype  ;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_slsborrowertype                                                                                
AS SELECT                                                                                                                           
z.flngAccountKey,                                                                                                                   
z.flngBorrowerTypeKey,                                                                                                              
z.flngVer,                                                                                                                          
z.fi64SourceKey,                                                                                                                    
z.flngVerLast,                                                                                                                      
z.fstrBorrowerType,                                                                                                                 
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fblnCurrent,                                                                                                                      
z.fblnActive,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_slsborrowertype z;     
    
DROP  VIEW lab_nzsr4_raw_full_access.app_tblnz_slsborrowertype  ;	
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_slsborrowertype                                                                                
AS SELECT                                                                                                                           
z.flngAccountKey,                                                                                                                   
z.flngBorrowerTypeKey,                                                                                                              
z.flngVer,                                                                                                                          
z.fi64SourceKey,                                                                                                                    
z.flngVerLast,                                                                                                                      
z.fstrBorrowerType,                                                                                                                 
z.fdtmStart,                                                                                                                        
z.fdtmEnd,                                                                                                                          
z.fblnCurrent,                                                                                                                      
z.fblnActive,                                                                                                                       
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_slsborrowertype z;     



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_slsunlinkeddeductions  ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_slsunlinkeddeductions                                                                              
AS SELECT                                                                                                                           
z.flngTransKey,                                                                                                                     
z.fdtmTransEffect,                                                                                                                  
z.fstrTransType,                                                                                                                    
z.fcurTransAmount,                                                                                                                  
z.flngReturnKey,                                                                                                                    
z.flngLineItemNumber,                                                                                                               
z.fstrEmployerIRD,                                                                                                                  
z.fstrEmployerLocation,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrDLNPrefix,                                                                                                                    
z.fstrDLNBody,                                                                                                                      
z.fstrDLNSuffix,                                                                                                                    
z.fdtmLinked,                                                                                                                       
z.fstrLinkedBy                                                                                                         
 FROM lab_nzsr4_raw.tblnz_slsunlinkeddeductions z; 
 
 
 
DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_slsunlinkeddeductions   ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_slsunlinkeddeductions                                                                              
AS SELECT                                                                                                                           
z.flngTransKey,                                                                                                                     
z.fdtmTransEffect,                                                                                                                  
z.fstrTransType,                                                                                                                    
z.fcurTransAmount,                                                                                                                  
z.flngReturnKey,                                                                                                                    
z.flngLineItemNumber,                                                                                                               
z.fstrEmployerIRD,                                                                                                                  
z.fstrEmployerLocation,                                                                                                             
z.flngEmployerAccountKey,                                                                                                           
z.fdtmEmployerFilingPeriod,                                                                                                         
z.fstrDLNPrefix,                                                                                                                    
z.fstrDLNBody,                                                                                                                      
z.fstrDLNSuffix,                                                                                                                    
z.fdtmLinked,                                                                                                                       
z.fstrLinkedBy                                                                                                         
 FROM lab_nzsr4_raw.tblnz_slsunlinkeddeductions z;  


DEOP VIEW lab_nzsr4_raw_restricted_access.app_tblnz_slsworldwideincome ;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_slsworldwideincome                                                                             
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fcurWorldwideIncome,                                                                                                              
z.fblnZeroFiling,                                                                                                                   
z.fdtmDue,                                                                                                                          
z.fdtmReceived,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                            
FROM lab_nzsr4_raw.tblnz_slsworldwideincome z; 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_slsworldwideincome ;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_slsworldwideincome                                                                             
AS SELECT                                                                                                                           
z.flngDocKey,                                                                                                                       
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fcurWorldwideIncome,                                                                                                              
z.fblnZeroFiling,                                                                                                                   
z.fdtmDue,                                                                                                                          
z.fdtmReceived,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                            
 FROM lab_nzsr4_raw.tblnz_slsworldwideincome z; 



DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_studylinkceaselog ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_studylinkceaselog                                                                              
AS SELECT                                                                                                                           
z.fi64CeaseLogKey,                                                                                                                  
z.flngDocKey,                                                                                                                       
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fstrDLN,                                                                                                                          
z.fdtmCease,                                                                                                                        
z.fstrCeaseReason,                                                                                                                  
z.fstrAccountType,                                                                                                                  
z.fstrStudyLinkAction,                                                                                                              
z.fdtmResponse,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_studylinkceaselog z
LEFT OUTER JOIN 
dev_raw.app_tblcustomerlevel cl 
ON z.flngdockey = cl.flngdockey
WHERE nvl(cl.fstrCustomerLevel, 'STD') = 'STD' 
AND nvl(cl.record_active_flag, 'Y') = 'Y' 
AND nvl(cl.record_deleted_flag, 'N') = 'N';   

DROP  VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkceaselog  ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkceaselog                                                                              
AS SELECT                                                                                                                           
z.fi64CeaseLogKey,                                                                                                                  
z.flngDocKey,                                                                                                                       
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fstrDLN,                                                                                                                          
z.fdtmCease,                                                                                                                        
z.fstrCeaseReason,                                                                                                                  
z.fstrAccountType,                                                                                                                  
z.fstrStudyLinkAction,                                                                                                              
z.fdtmResponse,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_studylinkceaselog z;   



DROP VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting    ;                                                            
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen,                                                                                                                         
z.record_effective_timestamp,                                                                                                       
z.record_expiry_timestamp,                                                                                                          
z.record_active_flag,                                                                                                               
z.record_deleted_flag,                                                                                                              
z.insert_object_run_key,                                                                                                            
z.update_object_run_key                                                                                                             
 FROM lab_nzsr4_raw.app_tblnz_kssprorataposting z;    
 
DROP VIEW lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting;                                                             
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssprorataposting                                                                              
AS SELECT                                                                                                                           
z.fi64ProRataKey,                                                                                                                   
z.fstrProRataType,                                                                                                                  
z.fi64ContributionKey,                                                                                                              
z.flngTransKey,                                                                                                                     
z.fdtmEffectiveDate,                                                                                                                
z.fcurAmount,                                                                                                                       
z.fblnProcessed,                                                                                                                    
z.fi64ContributionDetailKey,                                                                                                        
z.fi64RvsContributionDetailKey,                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen,                                                                                                                         
z.record_effective_timestamp,                                                                                                       
z.record_expiry_timestamp,                                                                                                          
z.record_active_flag,                                                                                                               
z.record_deleted_flag,                                                                                                              
z.insert_object_run_key,                                                                                                            
z.update_object_run_key                                                                                                             
 FROM lab_nzsr4_raw.app_tblnz_kssprorataposting z;    
 
 
 
 
 


DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_kssresidual;     
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssresidual                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64ContributionKey,                                                                                                              
z.flngMemberAccountKey,                                                                                                             
z.fstrMemberIRD,                                                                                                                    
z.flngRelationshipKey,                                                                                                              
z.flngEmployerCustomerKey,                                                                                                          
z.flngEmployerAccountKey,                                                                                                           
z.fblnRegister,                                                                                                                     
z.flngCaseKey,                                                                                                                      
z.fblnWorkItem,                                                                                                                     
z.flngWorkKey,                                                                                                                      
z.fblnPartialOptOut,                                                                                                                
z.fblnComplete,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
 FROM lab_nzsr4_raw.tblnz_kssresidual z;     


DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_kssresidual;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssresidual                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.fstrContributionType,                                                                                                             
z.fcurContributionAmount,                                                                                                           
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64ContributionKey,                                                                                                              
z.flngMemberAccountKey,                                                                                                             
z.fstrMemberIRD,                                                                                                                    
z.flngRelationshipKey,                                                                                                              
z.flngEmployerCustomerKey,                                                                                                          
z.flngEmployerAccountKey,                                                                                                           
z.fblnRegister,                                                                                                                     
z.flngCaseKey,                                                                                                                      
z.fblnWorkItem,                                                                                                                     
z.flngWorkKey,                                                                                                                      
z.fblnPartialOptOut,                                                                                                                
z.fblnComplete,                                                                                                                     
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                           
FROM lab_nzsr4_raw.tblnz_kssresidual z;     




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.tblnz_studylinkmaintainlog ;    
CREATE VIEW lab_nzsr4_raw_restricted_access.tblnz_studylinkmaintainlog                                                                               
AS SELECT                                                                                                                           
z.fi64MaintainLogKey,                                                                                                               
z.flngAccountKey,                                                                                                                   
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fstrMiddleName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrAccountType,                                                                                                                  
z.fstrAddressLine1,                                                                                                                 
z.fstrAddressLine2,                                                                                                                 
z.fstrSuburb,                                                                                                                       
z.fstrCity,                                                                                                                         
z.fstrPostCode,                                                                                                                     
z.fstrAddressAction,                                                                                                                
z.fblnAddressProcessed,                                                                                                             
z.fstrPhoneHome,                                                                                                                    
z.fstrPhoneHomeAction,                                                                                                              
z.fblnPhoneHomeProcessed,                                                                                                           
z.fstrPhoneWork,                                                                                                                    
z.fstrPhoneWorkAction,                                                                                                              
z.fblnPhoneWorkProcessed,                                                                                                           
z.fstrPhoneMobile,                                                                                                                  
z.fstrPhoneMobileAction,                                                                                                            
z.fblnPhoneMobileProcessed,                                                                                                         
z.fstrEmail,                                                                                                                        
z.fstrEmailAction,                                                                                                                  
z.fblnEmailProcessed,                                                                                                               
z.fdtmReceived,                                                                                                                     
z.fdtmProcessed,                                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
FROM lab_nzsr4_raw.tblnz_studylinkmaintainlog z
LEFT OUTER JOIN dev_raw.dss_special_clients_all sc ON cast(z.fstrIRDNumber as int) = CAST(sc.IRD_NUMBER as INT)
WHERE nvl(sc.special_classification, 'STD')='STD'
AND nvl( sc.record_active_flag,'Y')='Y'
AND nvl(sc.record_deleted_flag, 'N') = 'N';

 
 

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_blnz_studylinkmaintainlog    ;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkmaintainlog                                                                               
AS SELECT                                                                                                                           
z.fi64MaintainLogKey,                                                                                                               
z.flngAccountKey,                                                                                                                   
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fstrMiddleName,                                                                                                                   
z.fdtmDOB,                                                                                                                          
z.fstrAccountType,                                                                                                                  
z.fstrAddressLine1,                                                                                                                 
z.fstrAddressLine2,                                                                                                                 
z.fstrSuburb,                                                                                                                       
z.fstrCity,                                                                                                                         
z.fstrPostCode,                                                                                                                     
z.fstrAddressAction,                                                                                                                
z.fblnAddressProcessed,                                                                                                             
z.fstrPhoneHome,                                                                                                                    
z.fstrPhoneHomeAction,                                                                                                              
z.fblnPhoneHomeProcessed,                                                                                                           
z.fstrPhoneWork,                                                                                                                    
z.fstrPhoneWorkAction,                                                                                                              
z.fblnPhoneWorkProcessed,                                                                                                           
z.fstrPhoneMobile,                                                                                                                  
z.fstrPhoneMobileAction,                                                                                                            
z.fblnPhoneMobileProcessed,                                                                                                         
z.fstrEmail,                                                                                                                        
z.fstrEmailAction,                                                                                                                  
z.fblnEmailProcessed,                                                                                                               
z.fdtmReceived,                                                                                                                     
z.fdtmProcessed,                                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                         
FROM lab_nzsr4_raw.tblnz_studylinkmaintainlog z;    






DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_studylinkenrolmaintlog     ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_studylinkenrolmaintlog                                                                               
AS SELECT                                                                                                                           
z.fi64EnrolLogKey,                                                                                                                  
z.fi64ValidateLogKey,                                                                                                               
z.flngCaseKey,                                                                                                                      
z.flngDocKey,                                                                                                                       
z.flngCustomerKey,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fdtmDOB,                                                                                                                          
z.fdtmEnrolDate,                                                                                                                    
z.fstrAccountType,                                                                                                                  
z.fstrAddressLine1,                                                                                                                 
z.fstrAddressLine2,                                                                                                                 
z.fstrSuburb,                                                                                                                       
z.fstrCity,                                                                                                                         
z.fstrPostCode,                                                                                                                     
z.fstrAddressAction,                                                                                                                
z.fstrPhoneHome,                                                                                                                    
z.fstrPhoneHomeAction,                                                                                                              
z.fstrPhoneWork,                                                                                                                    
z.fstrPhoneWorkAction,                                                                                                              
z.fstrPhoneMobile,                                                                                                                  
z.fstrPhoneMobileAction,                                                                                                            
z.fstrEmail,                                                                                                                        
z.fstrEmailAction,                                                                                                                  
z.fstrACPIRDNumber,                                                                                                                 
z.fdtmACPDOB,                                                                                                                       
z.fstrACPFamilyName,                                                                                                                
z.fstrACPFirstName,                                                                                                                 
z.fstrACPMiddleName,                                                                                                                
z.fstrACPAddressLine1,                                                                                                              
z.fstrACPAddressLine2,                                                                                                              
z.fstrACPSuburb,                                                                                                                    
z.fstrACPCity,                                                                                                                      
z.fstrACPPostCode,                                                                                                                  
z.fstrACPPhoneHome,                                                                                                                 
z.fstrACPPhoneMobile,                                                                                                               
z.fstrACPPhoneWork,                                                                                                                 
z.fstrACPEmail,                                                                                                                     
z.fblnMaintenance,                                                                                                                  
z.fblnNewAccount,                                                                                                                   
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
FROM lab_nzsr4_raw.tblnz_studylinkenrolmaintlog z
LEFT OUTER JOIN dev_raw.dss_special_clients_all sc ON cast(z.fstrIRDNumber as int) = CAST(sc.IRD_NUMBER as INT)
WHERE nvl(sc.special_classification, 'STD')='STD'
AND nvl( sc.record_active_flag,'Y')='Y'
AND nvl(sc.record_deleted_flag, 'N') = 'N';

DROP VIEW IF EXISTS   lab_nzsr4_raw_full_access.app_tblnz_studylinkenrolmaintlog    ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkenrolmaintlog                                                                               
AS SELECT                                                                                                                           
z.fi64EnrolLogKey,                                                                                                                  
z.fi64ValidateLogKey,                                                                                                               
z.flngCaseKey,                                                                                                                      
z.flngDocKey,                                                                                                                       
z.flngCustomerKey,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fdtmDOB,                                                                                                                          
z.fdtmEnrolDate,                                                                                                                    
z.fstrAccountType,                                                                                                                  
z.fstrAddressLine1,                                                                                                                 
z.fstrAddressLine2,                                                                                                                 
z.fstrSuburb,                                                                                                                       
z.fstrCity,                                                                                                                         
z.fstrPostCode,                                                                                                                     
z.fstrAddressAction,                                                                                                                
z.fstrPhoneHome,                                                                                                                    
z.fstrPhoneHomeAction,                                                                                                              
z.fstrPhoneWork,                                                                                                                    
z.fstrPhoneWorkAction,                                                                                                              
z.fstrPhoneMobile,                                                                                                                  
z.fstrPhoneMobileAction,                                                                                                            
z.fstrEmail,                                                                                                                        
z.fstrEmailAction,                                                                                                                  
z.fstrACPIRDNumber,                                                                                                                 
z.fdtmACPDOB,                                                                                                                       
z.fstrACPFamilyName,                                                                                                                
z.fstrACPFirstName,                                                                                                                 
z.fstrACPMiddleName,                                                                                                                
z.fstrACPAddressLine1,                                                                                                              
z.fstrACPAddressLine2,                                                                                                              
z.fstrACPSuburb,                                                                                                                    
z.fstrACPCity,                                                                                                                      
z.fstrACPPostCode,                                                                                                                  
z.fstrACPPhoneHome,                                                                                                                 
z.fstrACPPhoneMobile,                                                                                                               
z.fstrACPPhoneWork,                                                                                                                 
z.fstrACPEmail,                                                                                                                     
z.fblnMaintenance,                                                                                                                  
z.fblnNewAccount,                                                                                                                   
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                          
FROM lab_nzsr4_raw.tblnz_studylinkenrolmaintlog z;




DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_studylinkvalidatelog;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_studylinkvalidatelog           
AS SELECT                                                                                                                           
z.fi64ValidateLogKey,                                                                                                               
z.flngDocKey,                                                                                                                       
z.flngCustomerKey,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fdtmApplicationDate,                                                                                                              
z.fdtmDOB,                                                                                                                          
z.fstrAccountType,                                                                                                                  
z.fintValidateIRD,                                                                                                                  
z.fintValidateDOB,                                                                                                                  
z.fintValidateName,                                                                                                                 
z.fintValidateDebt,                                                                                                                 
z.fblnPassedValidation,                                                                                                             
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                             
FROM lab_nzsr4_raw.tblnz_studylinkvalidatelog z
LEFT OUTER JOIN dev_raw.app_tblcustomerlevel cl 
ON z.flngcustomerkey = cl.flngcustomerkey
WHERE nvl(cl.fstrCustomerLevel, 'STD') = 'STD' 
AND nvl(cl.record_active_flag, 'Y') = 'Y' 
AND nvl(cl.record_deleted_flag, 'N') = 'N';                                                                              

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_studylinkvalidatelog ;         
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkvalidatelog           
AS SELECT                                                                                                                           
z.fi64ValidateLogKey,                                                                                                               
z.flngDocKey,                                                                                                                       
z.flngCustomerKey,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrIRDNumber,                                                                                                                    
z.fstrFamilyName,                                                                                                                   
z.fstrMiddleName,                                                                                                                   
z.fstrFirstName,                                                                                                                    
z.fdtmApplicationDate,                                                                                                              
z.fdtmDOB,                                                                                                                          
z.fstrAccountType,                                                                                                                  
z.fintValidateIRD,                                                                                                                  
z.fintValidateDOB,                                                                                                                  
z.fintValidateName,                                                                                                                 
z.fintValidateDebt,                                                                                                                 
z.fblnPassedValidation,                                                                                                             
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                             
FROM lab_nzsr4_raw.tblnz_studylinkvalidatelog z;
 
        


                                                                                                                                  
DROP VIEW IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_trstoborrowertype;      
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_trstoborrowertype                                                                              
AS SELECT                                                                                                                           
z.flngAccountKey,                                                                                                                   
z.flngIndicatorKey,                                                                                                                 
z.flngBorrowerTypeKey,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_trstoborrowertype z;   

DROP VIEW IF EXISTS  lab_nzsr4_raw_full_access.app_tblnz_trstoborrowertype;                                                                                                                                             
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_trstoborrowertype                                                                              
AS SELECT                                                                                                                           
z.flngAccountKey,                                                                                                                   
z.flngIndicatorKey,                                                                                                                 
z.flngBorrowerTypeKey,                                                                                                              
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
FROM lab_nzsr4_raw.tblnz_trstoborrowertype z;                                                                               
                                                    

DROP VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssholdtilldate;  
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssholdtilldate                                                                                
AS SELECT                                                                                                                           
z.fdtmHoldTill,                                                                                                                     
z.fi64ContributionDetailKey,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                     
 FROM lab_nzsr4_raw.app_tblnz_kssholdtilldate z;          

DROP VIEW lab_nzsr4_raw_full_access.app_tblnz_kssholdtilldate;  
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssholdtilldate                                                                                
AS SELECT                                                                                                                           
z.fdtmHoldTill,                                                                                                                     
z.fi64ContributionDetailKey,                                                                                                        
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                     
 FROM lab_nzsr4_raw.app_tblnz_kssholdtilldate z;   




DROP VIEW  IF EXISTS lab_nzsr4_raw_restricted_access.app_tblnz_ksslineitem ;    
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_ksslineitem                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64KSEContributionKey,                                                                                                           
z.fi64KSRContributionKey,                                                                                                           
z.fblnReversed,                                                                                                                     
z.fblnKSEConverted,                                                                                                                 
z.fblnKSRConverted,                                                                                                                 
z.fstrCnvIRDNumber,                                                                                                                 
z.fstrCnvEmployeeName,                                                                                                              
z.fstrCnvTaxCode,                                                                                                                   
z.fcurCnvKiwiSaverDeductions,                                                                                                       
z.fcurCnvKiwiSaverContributions,                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                         
 FROM lab_nzsr4_raw.tblnz_ksslineitem z;  
 
DROP VIEW  IF EXISTS  lab_nzsr4_raw_restricted_access.app_tblnz_ksslineitem  ;
 CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_ksslineitem                                                                                    
AS SELECT                                                                                                                           
z.flngReturnKey,                                                                                                                    
z.flngItemNumber,                                                                                                                   
z.flngAccountKey,                                                                                                                   
z.fdtmFilingPeriod,                                                                                                                 
z.fdtmPayDayPeriod,                                                                                                                 
z.fi64KSEContributionKey,                                                                                                           
z.fi64KSRContributionKey,                                                                                                           
z.fblnReversed,                                                                                                                     
z.fblnKSEConverted,                                                                                                                 
z.fblnKSRConverted,                                                                                                                 
z.fstrCnvIRDNumber,                                                                                                                 
z.fstrCnvEmployeeName,                                                                                                              
z.fstrCnvTaxCode,                                                                                                                   
z.fcurCnvKiwiSaverDeductions,                                                                                                       
z.fcurCnvKiwiSaverContributions,                                                                                                    
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                      
 FROM lab_nzsr4_raw.tblnz_ksslineitem z;  




DROP VIEW IF EXISTS lab_nzsr4_raw_restricted_access.app_tblnz_kssmembertoscheme   ;
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_kssmembertoscheme                                                                              
AS SELECT                                                                                                                           
z.flngRelationshipKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngIDKey,                                                                                                                        
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fdtmCommence,                                                                                                                     
z.fdtmCease,                                                                                                                        
z.fdtmSchemeLinkDate,                                                                                                               
z.fblnProvisional,                                                                                                                  
z.fstrSchemeChoiceType,                                                                                                             
z.fstrCeaseReason,                                                                                                                  
z.fstrClosureReason,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                      
 FROM lab_nzsr4_raw.tblnz_kssmembertoscheme z;       
 

DROP  VIEW IF EXISTS lab_nzsr4_raw_full_access.app_tblnz_kssmembertoscheme;                                                                              
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_kssmembertoscheme                                                                              
AS SELECT                                                                                                                           
z.flngRelationshipKey,                                                                                                              
z.flngVer,                                                                                                                          
z.flngVerLast,                                                                                                                      
z.flngMemberCustomerKey,                                                                                                            
z.flngMemberAccountKey,                                                                                                             
z.flngIDKey,                                                                                                                        
z.flngSchemeCustomerKey,                                                                                                            
z.flngSchemeAccountKey,                                                                                                             
z.fdtmCommence,                                                                                                                     
z.fdtmCease,                                                                                                                        
z.fdtmSchemeLinkDate,                                                                                                               
z.fblnProvisional,                                                                                                                  
z.fstrSchemeChoiceType,                                                                                                             
z.fstrCeaseReason,                                                                                                                  
z.fstrClosureReason,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                 
 FROM lab_nzsr4_raw.tblnz_kssmembertoscheme z;      


DROP VIEW lab_nzsr4_raw_restricted_access.app_tblnz_studylinkout ;   
CREATE VIEW lab_nzsr4_raw_restricted_access.app_tblnz_studylinkout                                                                                   
AS SELECT                                                                                                                           
z.fi64WebServiceGatewayOutKey,                                                                                                      
z.fstrRequestType,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                       
FROM lab_nzsr4_raw.tblnz_studylinkout z;  
 
 
DROP VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkout     ;
CREATE VIEW lab_nzsr4_raw_full_access.app_tblnz_studylinkout                                                                                   
AS SELECT                                                                                                                           
z.fi64WebServiceGatewayOutKey,                                                                                                      
z.fstrRequestType,                                                                                                                  
z.fstrCorrelationID,                                                                                                                
z.fstrWho,                                                                                                                          
z.fdtmWhen                                                                                                        
 FROM lab_nzsr4_raw.tblnz_studylinkout z;  
