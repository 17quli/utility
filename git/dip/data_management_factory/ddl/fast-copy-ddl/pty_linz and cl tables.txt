-- Create views for the tables in this job.
-- Tables with special clients filter are added at the end.

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_BUILDING_CONSENT
AS SELECT
CONSENT_ID,
CONSENT_NO,
QPID,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
TA_CODE,
ISSUE_DATE,
CONSENT_TYPE,
CONSENT_SECTOR,
DESCRIPTION,
FLOOR_AREA,
VALUE_OF_WORK,
BUILDER_NAME,
BUILDER_ADDRESS1,
BUILDER_ADDRESS2,
BUILDER_ADDRESS3,
BUILDER_ADDRESS4,
BUILDER_ADDRESS5,
BUILDER_PHONE,
BUILDER_FAX,
BUILDER_MOBILE,
OWNER_NAME,
OWNER_ADDRESS1,
OWNER_ADDRESS2,
OWNER_ADDRESS3,
OWNER_ADDRESS4,
OWNER_ADDRESS5,
OWNER_PHONE,
OWNER_FAX,
OWNER_MOBILE,
ADDITIONAL,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_BUILDING_CONSENT;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_BUILDING_CONSENT
AS SELECT
CONSENT_ID,
CONSENT_NO,
QPID,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
TA_CODE,
ISSUE_DATE,
CONSENT_TYPE,
CONSENT_SECTOR,
DESCRIPTION,
FLOOR_AREA,
VALUE_OF_WORK,
BUILDER_NAME,
BUILDER_ADDRESS1,
BUILDER_ADDRESS2,
BUILDER_ADDRESS3,
BUILDER_ADDRESS4,
BUILDER_ADDRESS5,
BUILDER_PHONE,
BUILDER_FAX,
BUILDER_MOBILE,
OWNER_NAME,
OWNER_ADDRESS1,
OWNER_ADDRESS2,
OWNER_ADDRESS3,
OWNER_ADDRESS4,
OWNER_ADDRESS5,
OWNER_PHONE,
OWNER_FAX,
OWNER_MOBILE,
ADDITIONAL,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_BUILDING_CONSENT;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_BUILDING_CONSENT_PARTY
AS SELECT
CONSENT_ID,
PARTY_ID,
PARTY_TYPE,
PARTY_NAME,
PARTY_ADDRESS,
PARTY_PHONE,
PARTY_FAX,
PARTY_MOBILE,
PARTY_TOKEN,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_BUILDING_CONSENT_PARTY;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_BUILDING_CONSENT_PARTY
AS SELECT
CONSENT_ID,
PARTY_ID,
PARTY_TYPE,
PARTY_NAME,
PARTY_ADDRESS,
PARTY_PHONE,
PARTY_FAX,
PARTY_MOBILE,
PARTY_TOKEN,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_BUILDING_CONSENT_PARTY;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_CATEGORY_LKP
AS SELECT 
CATEGORY_CODE,
CATEGORY_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_CATEGORY_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_CATEGORY_LKP
AS SELECT 
CATEGORY_CODE,
CATEGORY_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_CATEGORY_LKP;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_LAND_USE_LKP
AS SELECT 
LAND_USE_CODE,
LAND_USE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_LAND_USE_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_LAND_USE_LKP
AS SELECT 
LAND_USE_CODE,
LAND_USE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_LAND_USE_LKP;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_LAND_ZONE_LKP
AS SELECT 
LAND_ZONE_CODE,
LAND_ZONE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_LAND_ZONE_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_LAND_ZONE_LKP
AS SELECT 
LAND_ZONE_CODE,
LAND_ZONE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_LAND_ZONE_LKP;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_MATCH_QUALITY_LKP
AS SELECT 
MATCH_QUALITY,
MATCH_QUALITY_DESC
FROM
LAB_FCP_RAW.PTY_CL_MATCH_QUALITY_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_MATCH_QUALITY_LKP
AS SELECT 
MATCH_QUALITY,
MATCH_QUALITY_DESC
FROM
LAB_FCP_RAW.PTY_CL_MATCH_QUALITY_LKP;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_ON_THE_MARKET
AS SELECT 
CL_OTM_ID,
OTM_ID,
QPID,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
AGENCY,
AGENT1_SURNAME,
AGENT1_FIRST_NAME,
AGENT1_PHONE_NUMBER1,
AGENT1_PHONE_NUMBER2,
AGENCY_START,
AGENCY_END,
PRICE,
SALE_METHOD,
DATE_START,
DATE_END,
UPDATE_DATE,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_ON_THE_MARKET;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_ON_THE_MARKET
AS SELECT 
CL_OTM_ID,
OTM_ID,
QPID,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
AGENCY,
AGENT1_SURNAME,
AGENT1_FIRST_NAME,
AGENT1_PHONE_NUMBER1,
AGENT1_PHONE_NUMBER2,
AGENCY_START,
AGENCY_END,
PRICE,
SALE_METHOD,
DATE_START,
DATE_END,
UPDATE_DATE,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_ON_THE_MARKET;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_OWNER
AS SELECT 
SALE_ID,
QPID,
OWNER_TYPE,
OWNER_SEQUENCE,
DATE_START,
DATE_END,
OWNER_LAST_NAME,
OWNER_FIRST_NAME,
OWNER_SECOND_NAME,
OWNER_THIRD_NAME,
OWNER_POSTAL_ADDRESS_1,
OWNER_POSTAL_ADDRESS_2,
OWNER_POSTAL_ADDRESS_3,
OWNER_POSTAL_ADDRESS_4,
OWNER_POST_CODE,
OWNER_OCCUPIER_TYPE,
OWNER_COUNT,
IR_SALE_ID_QPID,
IR_OWNER_ID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_OWNER;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_OWNER
AS SELECT 
SALE_ID,
QPID,
OWNER_TYPE,
OWNER_SEQUENCE,
DATE_START,
DATE_END,
OWNER_LAST_NAME,
OWNER_FIRST_NAME,
OWNER_SECOND_NAME,
OWNER_THIRD_NAME,
OWNER_POSTAL_ADDRESS_1,
OWNER_POSTAL_ADDRESS_2,
OWNER_POSTAL_ADDRESS_3,
OWNER_POSTAL_ADDRESS_4,
OWNER_POST_CODE,
OWNER_OCCUPIER_TYPE,
OWNER_COUNT,
IR_SALE_ID_QPID,
IR_OWNER_ID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_OWNER;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_PROPERTY
AS SELECT 
QPID,
ACTIVE,
TA_CODE,
BUILDING_NAME,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
CATEGORY_CODE,
LAND_ZONE_CODE,
LAND_USE_CODE,
LAND_AREA,
BUILDING_FLOOR_AREA,
UNITS_OF_USE,
BUILDING_AGE,
TYPE_OF_OWNER,
UPDATE_DATE,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_PROPERTY
AS SELECT 
QPID,
ACTIVE,
TA_CODE,
BUILDING_NAME,
ADDRESS,
SUBURB,
TOWN,
POSTCODE,
CATEGORY_CODE,
LAND_ZONE_CODE,
LAND_USE_CODE,
LAND_AREA,
BUILDING_FLOOR_AREA,
UNITS_OF_USE,
BUILDING_AGE,
TYPE_OF_OWNER,
UPDATE_DATE,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_PROPERTY_MASTERLIST
AS SELECT 
QPID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY_MASTERLIST;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_PROPERTY_MASTERLIST
AS SELECT 
QPID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY_MASTERLIST;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_PROPERTY_MATCH
AS SELECT 
QPID,
CT,
MATCH_QUALITY,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY_MATCH;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_PROPERTY_MATCH
AS SELECT 
QPID,
CT,
MATCH_QUALITY,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_PROPERTY_MATCH;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_SALE
AS SELECT 
SALE_ID,
QPID,
SALE_DATE,
SETTLEMENT_DATE,
SALE_TYPE_CODE,
SALE_CV,
SALE_CATEGORY_CODE,
SALE_PRICE_GROSS,
SALE_PRICE_NET,
SALE_PRICE_CHATTELS,
SALE_PRICE_OTHER,
SALE_PRICE_GST,
IR_SALE_ID_QPID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_SALE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_SALE
AS SELECT 
SALE_ID,
QPID,
SALE_DATE,
SETTLEMENT_DATE,
SALE_TYPE_CODE,
SALE_CV,
SALE_CATEGORY_CODE,
SALE_PRICE_GROSS,
SALE_PRICE_NET,
SALE_PRICE_CHATTELS,
SALE_PRICE_OTHER,
SALE_PRICE_GST,
IR_SALE_ID_QPID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_SALE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_SALE_TYPE_LKP
AS SELECT 
SALE_TYPE_CODE,
SALE_TYPE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_SALE_TYPE_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_SALE_TYPE_LKP
AS SELECT 
SALE_TYPE_CODE,
SALE_TYPE_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_SALE_TYPE_LKP;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_TERRITORIAL_AUTHORITY_LKP
AS SELECT 
TA_CODE,
TA_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_TERRITORIAL_AUTHORITY_LKP;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_TERRITORIAL_AUTHORITY_LKP
AS SELECT 
TA_CODE,
TA_DESC,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_TERRITORIAL_AUTHORITY_LKP;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_CL_VALUATION
AS SELECT 
QPID,
CAPITAL_VALUE,
LAND_VALUE,
IMPROVEMENT_VALUE,
REVISION_DATE,
UPDATE_DATE,
IR_VALUATION_ID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_VALUATION;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_CL_VALUATION
AS SELECT 
QPID,
CAPITAL_VALUE,
LAND_VALUE,
IMPROVEMENT_VALUE,
REVISION_DATE,
UPDATE_DATE,
IR_VALUATION_ID,
SOURCE_LOG_ID
FROM
LAB_FCP_RAW.PTY_CL_VALUATION;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ACTION
AS SELECT 
ID,
TIN_ID,
ATT_TYPE,
AUDIT_ID,
SEQUENCE_NO,
SYSTEM_ACTION,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
STE_ID,
MODE,
FLAGS,
SOURCE
FROM
LAB_FCP_RAW.PTY_L_ACTION;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ACTION
AS SELECT 
ID,
TIN_ID,
ATT_TYPE,
AUDIT_ID,
SEQUENCE_NO,
SYSTEM_ACTION,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
STE_ID,
MODE,
FLAGS,
SOURCE
FROM
LAB_FCP_RAW.PTY_L_ACTION;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ACTION_TYPE
AS SELECT 
TYPE,
AUDIT_ID,
DESCRIPTION,
SYSTEM_ACTION,
SOB_NAME,
EXISTING_INST
FROM
LAB_FCP_RAW.PTY_L_ACTION_TYPE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ACTION_TYPE
AS SELECT 
TYPE,
AUDIT_ID,
DESCRIPTION,
SYSTEM_ACTION,
SOB_NAME,
EXISTING_INST
FROM
LAB_FCP_RAW.PTY_L_ACTION_TYPE;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ALIAS
AS SELECT 
ID,
PRP_ID,
SURNAME,
OTHER_NAMES
FROM
LAB_FCP_RAW.PTY_L_ALIAS;


CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ALIAS
AS SELECT 
ID,
PRP_ID,
SURNAME,
OTHER_NAMES
FROM
LAB_FCP_RAW.PTY_L_ALIAS;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ENCUMBRANCE
AS SELECT 
ID,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
STATUS,
TERM
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ENCUMBRANCE
AS SELECT 
ID,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
STATUS,
TERM
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ENCUMBRANCEE
AS SELECT 
ID,
ENS_ID,
STATUS,
NAME
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCEE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ENCUMBRANCEE
AS SELECT 
ID,
ENS_ID,
STATUS,
NAME
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCEE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ENCUMBRANCE_SHARE
AS SELECT 
ID,
ENC_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
ACT_ID_EXT,
ACT_TIN_ID_EXT,
STATUS,
SYSTEM_CRT,
SYSTEM_EXT
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCE_SHARE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ENCUMBRANCE_SHARE
AS SELECT 
ID,
ENC_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
ACT_ID_EXT,
ACT_TIN_ID_EXT,
STATUS,
SYSTEM_CRT,
SYSTEM_EXT
FROM
LAB_FCP_RAW.PTY_L_ENCUMBRANCE_SHARE;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_ESTATE_SHARE
AS SELECT 
ID,
ETT_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
SHARE,
STATUS,
ORIGINAL_FLAG,
SYSTEM_CRT,
EXECUTORSHIP,
SHARE_MEMORIAL
FROM
LAB_FCP_RAW.PTY_L_ESTATE_SHARE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_ESTATE_SHARE
AS SELECT 
ID,
ETT_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
SHARE,
STATUS,
ORIGINAL_FLAG,
SYSTEM_CRT,
EXECUTORSHIP,
SHARE_MEMORIAL
FROM
LAB_FCP_RAW.PTY_L_ESTATE_SHARE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_LEGAL_DESC
AS SELECT 
ID,
TTL_TITLE_NO,
AUDIT_ID,
TYPE,
STATUS,
TOTAL_AREA,
LEGAL_DESC_TEXT
FROM
LAB_FCP_RAW.PTY_L_LEGAL_DESC;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_LEGAL_DESC
AS SELECT 
ID,
TTL_TITLE_NO,
AUDIT_ID,
TYPE,
STATUS,
TOTAL_AREA,
LEGAL_DESC_TEXT
FROM
LAB_FCP_RAW.PTY_L_LEGAL_DESC;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_LEGAL_DESC_PARCEL
AS SELECT 
AUDIT_ID,
LGD_ID,
PAR_ID,
SEQUENCE,
PART_AFFECTED,
SHARE_CD,
SUR_WRK_ID_CRT
FROM
LAB_FCP_RAW.PTY_L_LEGAL_DESC_PARCEL;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_LEGAL_DESC_PARCEL
AS SELECT 
AUDIT_ID,
LGD_ID,
PAR_ID,
SEQUENCE,
PART_AFFECTED,
SHARE_CD,
SUR_WRK_ID_CRT
FROM
LAB_FCP_RAW.PTY_L_LEGAL_DESC_PARCEL;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_NOMINAL_INDEX
AS SELECT 
ID,
PRP_ID,
TTL_TITLE_NO,
STATUS,
NAME_TYPE,
CORPORATE_NAME,
SURNAME,
OTHER_NAMES
FROM
LAB_FCP_RAW.PTY_L_NOMINAL_INDEX;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_NOMINAL_INDEX
AS SELECT 
ID,
PRP_ID,
TTL_TITLE_NO,
STATUS,
NAME_TYPE,
CORPORATE_NAME,
SURNAME,
OTHER_NAMES
FROM
LAB_FCP_RAW.PTY_L_NOMINAL_INDEX;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_PARCEL
AS SELECT 
ID,
AUDIT_ID,
LDT_LOC_ID,
IMG_ID,
FEN_ID,
TOC_CODE,
ALT_ID,
AREA,
NONSURVEY_DEF,
APPELLATION_DATE,
PARCEL_INTENT,
STATUS,
TOTAL_AREA,
CALCULATED_AREA,
SE_ROW_ID,
'SHAPE'
FROM
LAB_FCP_RAW.PTY_L_PARCEL;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_PARCEL
AS SELECT 
ID,
AUDIT_ID,
LDT_LOC_ID,
IMG_ID,
FEN_ID,
TOC_CODE,
ALT_ID,
AREA,
NONSURVEY_DEF,
APPELLATION_DATE,
PARCEL_INTENT,
STATUS,
TOTAL_AREA,
CALCULATED_AREA,
SE_ROW_ID,
'SHAPE'
FROM
LAB_FCP_RAW.PTY_L_PARCEL;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_PROPRIETOR
AS SELECT 
ID,
ETS_ID,
STATUS,
ORIGINAL_FLAG,
TYPE,
CORPORATE_NAME,
PRIME_SURNAME,
PRIME_OTHER_NAMES,
NAME_SUFFIX
FROM
LAB_FCP_RAW.PTY_L_PROPRIETOR;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_PROPRIETOR
AS SELECT 
ID,
ETS_ID,
STATUS,
ORIGINAL_FLAG,
TYPE,
CORPORATE_NAME,
PRIME_SURNAME,
PRIME_OTHER_NAMES,
NAME_SUFFIX
FROM
LAB_FCP_RAW.PTY_L_PROPRIETOR;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_STATUS_CODES
AS SELECT 
SEQUENCE,
CODE,
'DESC'
FROM
LAB_FCP_RAW.PTY_L_STATUS_CODES;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_STATUS_CODES
AS SELECT 
SEQUENCE,
CODE,
'DESC'
FROM
LAB_FCP_RAW.PTY_L_STATUS_CODES;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_SUPERCEDE_REASONS
AS SELECT 
SEQUENCE,
CODE,
'DESC'
FROM
LAB_FCP_RAW.PTY_L_SUPERCEDE_REASONS;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_SUPERCEDE_REASONS
AS SELECT 
SEQUENCE,
CODE,
'DESC'
FROM
LAB_FCP_RAW.PTY_L_SUPERCEDE_REASONS;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TAX_EXEMPTION_REASON
AS SELECT 
TRANSFEROR_OR_TRANSFEREE,
CODE,
TYPE,
'DESC',
SEQUENCE
FROM
LAB_FCP_RAW.PTY_L_TAX_EXEMPTION_REASON;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TAX_EXEMPTION_REASON
AS SELECT 
TRANSFEROR_OR_TRANSFEREE,
CODE,
TYPE,
'DESC',
SEQUENCE
FROM
LAB_FCP_RAW.PTY_L_TAX_EXEMPTION_REASON;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE
AS SELECT 
TITLE_NO,
AUDIT_ID,
LDT_LOC_ID,
REGISTER_TYPE,
STE_ID,
ISSUE_DATE,
GUARANTEE_STATUS,
STATUS,
TYPE,
PROVISIONAL,
SUR_WRK_ID,
MAORI_LAND,
TTL_TITLE_NO_SRS,
TTL_TITLE_NO_HEAD_SRS
FROM
LAB_FCP_RAW.PTY_L_TITLE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE
AS SELECT 
TITLE_NO,
AUDIT_ID,
LDT_LOC_ID,
REGISTER_TYPE,
STE_ID,
ISSUE_DATE,
GUARANTEE_STATUS,
STATUS,
TYPE,
PROVISIONAL,
SUR_WRK_ID,
MAORI_LAND,
TTL_TITLE_NO_SRS,
TTL_TITLE_NO_HEAD_SRS
FROM
LAB_FCP_RAW.PTY_L_TITLE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_ACTION
AS SELECT 
AUDIT_ID,
TTL_TITLE_NO,
ACT_TIN_ID,
ACT_ID
FROM
LAB_FCP_RAW.PTY_L_TITLE_ACTION;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_ACTION
AS SELECT 
AUDIT_ID,
TTL_TITLE_NO,
ACT_TIN_ID,
ACT_ID
FROM
LAB_FCP_RAW.PTY_L_TITLE_ACTION;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_DOC_REF
AS SELECT 
ID,
TIN_ID,
TYPE,
REFERENCE_NO
FROM
LAB_FCP_RAW.PTY_L_TITLE_DOC_REF;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_DOC_REF
AS SELECT 
ID,
TIN_ID,
TYPE,
REFERENCE_NO
FROM
LAB_FCP_RAW.PTY_L_TITLE_DOC_REF;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_ENCUMBRANCE
AS SELECT 
ID,
ACT_TIN_ID_CRT,
TTL_TITLE_NO,
ENC_ID,
STATUS,
ACT_ID_CRT
FROM
LAB_FCP_RAW.PTY_L_TITLE_ENCUMBRANCE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_ENCUMBRANCE
AS SELECT 
ID,
ACT_TIN_ID_CRT,
TTL_TITLE_NO,
ENC_ID,
STATUS,
ACT_ID_CRT
FROM
LAB_FCP_RAW.PTY_L_TITLE_ENCUMBRANCE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_ESTATE
AS SELECT 
ID,
ACT_TIN_ID_CRT,
LGD_ID,
TTL_TITLE_NO,
ORIGINAL_FLAG,
TYPE,
STATUS,
ESTATE_SHARE,
TIN_ID_ORIG,
TERM,
TIMESHARE_WEEK_NO,
PURPOSE,
ACT_ID_CRT,
SHARE
FROM
LAB_FCP_RAW.PTY_L_TITLE_ESTATE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_ESTATE
AS SELECT 
ID,
ACT_TIN_ID_CRT,
LGD_ID,
TTL_TITLE_NO,
ORIGINAL_FLAG,
TYPE,
STATUS,
ESTATE_SHARE,
TIN_ID_ORIG,
TERM,
TIMESHARE_WEEK_NO,
PURPOSE,
ACT_ID_CRT,
SHARE
FROM
LAB_FCP_RAW.PTY_L_TITLE_ESTATE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_HIER
AS SELECT 
ID,
TDR_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
TTL_TITLE_NO_FLW,
TTL_TITLE_NO_PRIOR,
STATUS
FROM
LAB_FCP_RAW.PTY_L_TITLE_HIER;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_HIER
AS SELECT 
ID,
TDR_ID,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
TTL_TITLE_NO_FLW,
TTL_TITLE_NO_PRIOR,
STATUS
FROM
LAB_FCP_RAW.PTY_L_TITLE_HIER;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_INSTRUMENT
AS SELECT 
ID,
AUDIT_ID,
DLG_ID,
INST_NO,
PRIORITY_NO,
LDT_LOC_ID,
LODGED_DATETIME,
STATUS,
TRT_GRP,
TRT_TYPE,
TIN_ID_PARENT
FROM
LAB_FCP_RAW.PTY_L_TITLE_INSTRUMENT;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_INSTRUMENT
AS SELECT 
ID,
AUDIT_ID,
DLG_ID,
INST_NO,
PRIORITY_NO,
LDT_LOC_ID,
LODGED_DATETIME,
STATUS,
TRT_GRP,
TRT_TYPE,
TIN_ID_PARENT
FROM
LAB_FCP_RAW.PTY_L_TITLE_INSTRUMENT;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_INSTRUMENT_TITLE
AS SELECT 
AUDIT_ID,
TIN_ID,
TTL_TITLE_NO
FROM
LAB_FCP_RAW.PTY_L_TITLE_INSTRUMENT_TITLE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_INSTRUMENT_TITLE
AS SELECT 
AUDIT_ID,
TIN_ID,
TTL_TITLE_NO
FROM
LAB_FCP_RAW.PTY_L_TITLE_INSTRUMENT_TITLE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_MEMORIAL
AS SELECT 
ID,
TTL_TITLE_NO,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
MMT_CODE,
STATUS,
USER_CHANGED,
TEXT_TYPE,
REGISTER_ONLY_MEM,
PREV_FURTHER_REG,
CURR_HIST_FLAG,
DEFAULT_FLAG,
NUMBER_OF_COLS,
COL_1_SIZE,
COL_2_SIZE,
COL_3_SIZE,
COL_4_SIZE,
COL_5_SIZE,
COL_6_SIZE,
COL_7_SIZE,
ACT_ID_EXT,
ACT_TIN_ID_EXT
FROM
LAB_FCP_RAW.PTY_L_TITLE_MEMORIAL;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_MEMORIAL
AS SELECT 
ID,
TTL_TITLE_NO,
ACT_ID_ORIG,
ACT_TIN_ID_ORIG,
ACT_ID_CRT,
ACT_TIN_ID_CRT,
MMT_CODE,
STATUS,
USER_CHANGED,
TEXT_TYPE,
REGISTER_ONLY_MEM,
PREV_FURTHER_REG,
CURR_HIST_FLAG,
DEFAULT_FLAG,
NUMBER_OF_COLS,
COL_1_SIZE,
COL_2_SIZE,
COL_3_SIZE,
COL_4_SIZE,
COL_5_SIZE,
COL_6_SIZE,
COL_7_SIZE,
ACT_ID_EXT,
ACT_TIN_ID_EXT
FROM
LAB_FCP_RAW.PTY_L_TITLE_MEMORIAL;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_MEMORIAL_TEXT
AS SELECT 
AUDIT_ID,
TTM_ID,
SEQUENCE_NO,
CURR_HIST_FLAG,
STD_TEXT,
COL_1_TEXT,
COL_2_TEXT,
COL_3_TEXT,
COL_4_TEXT,
COL_5_TEXT,
COL_6_TEXT,
COL_7_TEXT
FROM
LAB_FCP_RAW.PTY_L_TITLE_MEMORIAL_TEXT;


CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_MEMORIAL_TEXT
AS SELECT 
AUDIT_ID,
TTM_ID,
SEQUENCE_NO,
CURR_HIST_FLAG,
STD_TEXT,
COL_1_TEXT,
COL_2_TEXT,
COL_3_TEXT,
COL_4_TEXT,
COL_5_TEXT,
COL_6_TEXT,
COL_7_TEXT
FROM
LAB_FCP_RAW.PTY_L_TITLE_MEMORIAL_TEXT;


CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TITLE_PARCEL_ASSOC
AS SELECT 
ID,
TTL_TITLE_NO,
PAR_ID,
SOURCE
FROM
LAB_FCP_RAW.PTY_L_TITLE_PARCEL_ASSOC;


CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TITLE_PARCEL_ASSOC
AS SELECT 
ID,
TTL_TITLE_NO,
PAR_ID,
SOURCE
FROM
LAB_FCP_RAW.PTY_L_TITLE_PARCEL_ASSOC;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TRANSACTION_TYPE
AS SELECT 
GRP,
TYPE,
AUDIT_ID,
DESCRIPTION
FROM
LAB_FCP_RAW.PTY_L_TRANSACTION_TYPE;

CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TRANSACTION_TYPE
AS SELECT 
GRP,
TYPE,
AUDIT_ID,
DESCRIPTION
FROM
LAB_FCP_RAW.PTY_L_TRANSACTION_TYPE;

CREATE VIEW LAB_FCP_RAW_RESTRICTED_ACCESS.PTY_L_TAX_STATEMENT
AS SELECT 
z.ID,
z.STATUS,
z.STATEMENT_DATE,
z.FULL_NAME,
z.TRANSFEROR_OR_TRANSFEREE,
z.EXEMPTION_CODE,
z.IRD_NUMBER,
z.NON_RESIDENT_FLAG,
z.COUNTRY_CODE,
z.TAX_INFORMATION_NUMBER,
z.TIN_ID,
z.TRT_TYPE,
z.INST_NO,
z.LODGED_DATETIME,
z.COMPLETION_DATE,
z.DEALING_TYPE,
z.CERTIFIER_NAME,
z.CERTIFIER_FIRM,
z.TINX_ID_SUPERCEDES,
z.SUPERCEDE_REASON,
z.COMMENTS,
z.DWELLING_ON_LAND,
z.CITIZEN_OR_NZ_VISA,
z.LIVE_IN_PROPERTY,
z.SETTLEMENT_DATE,
z.VALIDATION,
z.IR_IRD_NUMBER,
z.IR_ENTITY_TYPE,
z.STATEMENT_VERSION,
z.NOMINATOR_IND,
z.NOMINATOR_PERSON_IND,
z.NOMINATOR_MULTIPLE_IND,
z.NOMINATOR_NAME,
z.REPRESENT_CODE,
z.CITIZEN_CODE,
z.FAMCITIZEN_CODE,
z.COUNTRY_CODE2,
z.TAX_INFORMATION_NUMBER2,
z.COUNTRY_CODE3,
z.TAX_INFORMATION_NUMBER3,
z.COUNTRY_CODE4,
z.TAX_INFORMATION_NUMBER4
FROM
LAB_FCP_RAW.PTY_L_TAX_STATEMENT z 
LEFT OUTER JOIN LAB_FCP_RAW.dss_special_clients_all sc ON CAST(sc.IRD_NUMBER AS INT) = CAST(z.IRD_NUMBER AS INT) 
WHERE nvl(sc.special_classification, 'STD') = 'STD' 
  AND nvl(sc.record_active_flag, 'Y') = 'Y' 
  AND nvl(sc.record_deleted_flag, 'N') = 'N' 
 ;
 
CREATE VIEW LAB_FCP_RAW_FULL_ACCESS.PTY_L_TAX_STATEMENT
AS SELECT 
z.ID,
z.STATUS,
z.STATEMENT_DATE,
z.FULL_NAME,
z.TRANSFEROR_OR_TRANSFEREE,
z.EXEMPTION_CODE,
z.IRD_NUMBER,
z.NON_RESIDENT_FLAG,
z.COUNTRY_CODE,
z.TAX_INFORMATION_NUMBER,
z.TIN_ID,
z.TRT_TYPE,
z.INST_NO,
z.LODGED_DATETIME,
z.COMPLETION_DATE,
z.DEALING_TYPE,
z.CERTIFIER_NAME,
z.CERTIFIER_FIRM,
z.TINX_ID_SUPERCEDES,
z.SUPERCEDE_REASON,
z.COMMENTS,
z.DWELLING_ON_LAND,
z.CITIZEN_OR_NZ_VISA,
z.LIVE_IN_PROPERTY,
z.SETTLEMENT_DATE,
z.VALIDATION,
z.IR_IRD_NUMBER,
z.IR_ENTITY_TYPE,
z.STATEMENT_VERSION,
z.NOMINATOR_IND,
z.NOMINATOR_PERSON_IND,
z.NOMINATOR_MULTIPLE_IND,
z.NOMINATOR_NAME,
z.REPRESENT_CODE,
z.CITIZEN_CODE,
z.FAMCITIZEN_CODE,
z.COUNTRY_CODE2,
z.TAX_INFORMATION_NUMBER2,
z.COUNTRY_CODE3,
z.TAX_INFORMATION_NUMBER3,
z.COUNTRY_CODE4,
z.TAX_INFORMATION_NUMBER4
FROM
LAB_FCP_RAW.PTY_L_TAX_STATEMENT z 
;
