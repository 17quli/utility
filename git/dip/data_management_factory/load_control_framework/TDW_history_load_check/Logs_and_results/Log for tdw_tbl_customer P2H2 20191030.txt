1                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

1          ;*';*";*/;quit;run;
2          OPTIONS PAGENO=MIN;
3          %LET _CLIENTTASKLABEL='tdw_tbl_customer P2H2 20191030';
4          %LET _CLIENTPROCESSFLOWNAME='Process Flow';
5          %LET _CLIENTPROJECTPATH='';
6          %LET _CLIENTPROJECTPATHHOST='';
7          %LET _CLIENTPROJECTNAME='';
8          %LET _SASPROGRAMFILE='H:\DIP Data Management\Load Control Framework\3.8\tdw_tbl_customer P2H2 20191030.sas';
9          %LET _SASPROGRAMFILEHOST='IRDTS64';
10         
11         ODS _ALL_ CLOSE;
12         OPTIONS DEV=PNG;
13         FILENAME EGSR TEMP;
14         ODS tagsets.sasreport13(ID=EGSR) FILE=EGSR
15             STYLE=HTMLBlue
16             STYLESHEET=(URL="file:///H:/sso/sfw/sas_factory/940/x86/SASEnterpriseGuide/7.1/Styles/HTMLBlue.css")
17             NOGTITLE
18             NOGFOOTNOTE
19             GPATH=&sasworklocation
20             ENCODING=UTF8
21             options(rolap="on")
22         ;
NOTE: Writing TAGSETS.SASREPORT13(EGSR) Body file: EGSR
23         
24         /****************************************************************************
25          * Job:             tdw_tbl_customer P2H2                 A5IKCEC7.BR0000K5 *
26          * Description:                                                             *
27          *                                                                          *
28          * Metadata Server: ird10119au.vsp.sas.com                                  *
29          * Port:            8561                                                    *
30          * Location:        /IRD/DIP Data Management/5000 Processes/10 Raw          *
31          *                   Ingestion                                              *
32          *                                                                          *
33          * Server:          SASApp                                A5IKCEC7.AS000002 *
34          *                                                                          *
35          * Source Table:    TBL_CUSTOMER - edwtdw.TBL_CUSTOMER    A5IKCEC7.BE0000XD *
36          * Target Table:    tdw_tbl_customer -                    A5IKCEC7.BE0000XC *
37          *                   impraw.tdw_tbl_customer                                *
38          *                                                                          *
39          * Generated on:    Wednesday, October 30, 2019 10:59:59 AM NZDT            *
40          * Generated by:    ird0nxa                                                 *
41          * Version:         SAS Data Integration Studio 4.903                       *
42          ****************************************************************************/
43         
44         /* Generate the process id for job  */
45         %put Process ID: &SYSJOBID;
Process ID: 118135
46         
47         /* General macro variables  */
48         %let jobID = %quote(A5IKCEC7.BR0000K5);
49         %let etls_jobName = %nrquote(tdw_tbl_customer P2H2);
50         %let etls_userID = %nrquote(ird0nxa);
51         
52         /* Setup to capture return codes  */
53         %global job_rc trans_rc sqlrc;
54         %let sysrc = 0;
55         %let job_rc = 0;
56         %let trans_rc = 0;
2                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

57         %let sqlrc = 0;
58         %global etls_stepStartTime;
59         /* initialize syserr to 0 */
60         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      user cpu time       0.00 seconds
      system cpu time     0.00 seconds
      memory              316.68k
      OS Memory           18852.00k
      Timestamp           30/10/2019 11:10:46 AM
      Step Count                        2  Switch Count  0
      Page Faults                       0
      Page Reclaims                     56
      Page Swaps                        0
      Voluntary Context Switches        0
      Involuntary Context Switches      0
      Block Input Operations            0
      Block Output Operations           0
      

61         
62         %macro rcSet(error);
63            %if (&error gt &trans_rc) %then
64               %let trans_rc = &error;
65            %if (&error gt &job_rc) %then
66               %let job_rc = &error;
67         %mend rcSet;
68         
69         %macro rcSetDS(error);
70            if &error gt input(symget('trans_rc'),12.) then
71               call symput('trans_rc',trim(left(put(&error,12.))));
72            if &error gt input(symget('job_rc'),12.) then
73               call symput('job_rc',trim(left(put(&error,12.))));
74         %mend rcSetDS;
75         
76         /* Create metadata macro variables */
77         %let IOMServer      = %nrquote(SASApp);
78         %let metaPort       = %nrquote(8561);
79         %let metaServer     = %nrquote(ird10119au.vsp.sas.com);
80         
81         /* Setup for capturing job status  */
82         %let etls_startTime = %sysfunc(datetime(),datetime.);
83         %let etls_recordsBefore = 0;
84         %let etls_recordsAfter = 0;
85         %let etls_lib = 0;
86         %let etls_table = 0;
87         
88         %global etls_debug;
89         %macro etls_setDebug;
90            %if %str(&etls_debug) ne 0 %then
91               OPTIONS MPRINT%str(;);
92         %mend;
93         %etls_setDebug;
94         
95         /*==========================================================================*
96          * Step:            Change Extract                        A5IKCEC7.BT000AF4 *
3                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

97          * Transform:       Change Extract                                          *
98          * Description:                                                             *
99          *                                                                          *
100         * Source Table:    TBL_CUSTOMER - edwtdw.TBL_CUSTOMER    A5IKCEC7.BE0000XD *
101         * Target Table:    tdw_tbl_customer -                    A5IKCEC7.BE0000XC *
102         *                   impraw.tdw_tbl_customer                                *
103         *==========================================================================*/
104        
105        %let transformID = %quote(A5IKCEC7.BT000AF4);
106        %let trans_rc = 0;
107        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
108        
109        /* Access the data for EDW TDW (edwtdw)  */
110        LIBNAME edwtdw ORACLE  DBCOMMIT=0  DBMAX_TEXT=32767  DEFER=YES  PRESERVE_COL_NAMES=YES  PRESERVE_TAB_NAMES=YES
110      ! READBUFF=20000  encoding="utf-8" dbclient_max_bytes=2  PATH="DIP_VIP.external"  SCHEMA=TDW  AUTHDOMAIN="edw_prod" ;
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref EDWTDW was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: DIP_VIP.external
111        %rcSet(&syslibrc);
112        
113        /* Access the data for DIP Impala RAW (impraw)  */
114        LIBNAME impraw SASIOIMP  DATABASE=dev_raw  DBMAX_TEXT=32767  DSN=ClouderaImpala64  SCHEMA=dev_raw ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPRAW was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
115        %rcSet(&syslibrc);
116        
117        %let SYSLAST = %nrquote(edwtdw.TBL_CUSTOMER);
118        
119        %let _INPUT_count = 1;
120        %let _INPUT = edwtdw.TBL_CUSTOMER;
121        %let _INPUT_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
121      ! PATH="DIP_VIP.external" AUTHDOMAIN="edw_prod"
122        ;
123        %let _INPUT_engine = ORACLE;
124        %let _INPUT_memtype = DATA;
125        %let _INPUT_options = %nrquote();
126        %let _INPUT_alter = %nrquote();
127        %let _INPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/TBL_CUSTOMER%(Table%));
128        %let _INPUT_type = 1;
129        %let _INPUT_label = %nrquote();
130        
131        %let _Source = edwtdw.TBL_CUSTOMER;
132        %let _Source_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
132      ! PATH="DIP_VIP.external" AUTHDOMAIN="edw_prod"
133        ;
134        %let _Source_engine = ORACLE;
135        %let _Source_memtype = DATA;
136        %let _Source_options = %nrquote();
137        %let _Source_alter = %nrquote();
138        %let _Source_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/TBL_CUSTOMER%(Table%));
139        %let _Source_type = 1;
140        %let _Source_label = %nrquote();
141        
142        %let _OUTPUT_count = 1;
4                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

143        %let _OUTPUT = impraw.tdw_tbl_customer;
144        %let _OUTPUT_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
145        ;
146        %let _OUTPUT_engine = SASIOIMP;
147        %let _OUTPUT_memtype = DATA;
148        %let _OUTPUT_options = %nrquote();
149        %let _OUTPUT_alter = %nrquote();
150        %let _OUTPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/tdw_tbl_customer%(Table%));
151        %let _OUTPUT_type = 1;
152        %let _OUTPUT_label = %nrquote();
153        /* List of target columns to keep  */
154        %let _OUTPUT_keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
155                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
156                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
157                fstrwho effective_from effective_to current_rec_flag
158                record_effective_timestamp record_expiry_timestamp record_active_flag
159                record_deleted_flag insert_object_run_key update_object_run_key;
160        %let _OUTPUT_col_count = 24;
161        %let _OUTPUT_col0_name = flngcustomerkey;
162        %let _OUTPUT_col0_table = impraw.tdw_tbl_customer;
163        %let _OUTPUT_col0_length = 8;
164        %let _OUTPUT_col0_type = ;
165        %let _OUTPUT_col0_format = 20.;
166        %let _OUTPUT_col0_informat = 20.;
167        %let _OUTPUT_col0_label = %nrquote(flngcustomerkey);
168        %let _OUTPUT_col0_input0 = FLNGCUSTOMERKEY;
169        %let _OUTPUT_col0_input0_table = edwtdw.TBL_CUSTOMER;
170        %let _OUTPUT_col0_exp = ;
171        %let _OUTPUT_col0_input = FLNGCUSTOMERKEY;
172        %let _OUTPUT_col0_input_count = 1;
173        %let _OUTPUT_col1_name = flngver;
174        %let _OUTPUT_col1_table = impraw.tdw_tbl_customer;
175        %let _OUTPUT_col1_length = 8;
176        %let _OUTPUT_col1_type = ;
177        %let _OUTPUT_col1_format = 20.;
178        %let _OUTPUT_col1_informat = 20.;
179        %let _OUTPUT_col1_label = %nrquote(flngver);
180        %let _OUTPUT_col1_input0 = FLNGVER;
181        %let _OUTPUT_col1_input0_table = edwtdw.TBL_CUSTOMER;
182        %let _OUTPUT_col1_exp = ;
183        %let _OUTPUT_col1_input = FLNGVER;
184        %let _OUTPUT_col1_input_count = 1;
185        %let _OUTPUT_col2_name = flngverlast;
186        %let _OUTPUT_col2_table = impraw.tdw_tbl_customer;
187        %let _OUTPUT_col2_length = 8;
188        %let _OUTPUT_col2_type = ;
189        %let _OUTPUT_col2_format = 20.;
190        %let _OUTPUT_col2_informat = 20.;
191        %let _OUTPUT_col2_label = %nrquote(flngverlast);
192        %let _OUTPUT_col2_input0 = FLNGVERLAST;
193        %let _OUTPUT_col2_input0_table = edwtdw.TBL_CUSTOMER;
194        %let _OUTPUT_col2_exp = ;
195        %let _OUTPUT_col2_input = FLNGVERLAST;
196        %let _OUTPUT_col2_input_count = 1;
197        %let _OUTPUT_col3_name = fstrcustomertype;
198        %let _OUTPUT_col3_table = impraw.tdw_tbl_customer;
199        %let _OUTPUT_col3_length = 12;
200        %let _OUTPUT_col3_type = $;
5                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

201        %let _OUTPUT_col3_format = $12.;
202        %let _OUTPUT_col3_informat = $12.;
203        %let _OUTPUT_col3_label = %nrquote(fstrcustomertype);
204        %let _OUTPUT_col3_input0 = FSTRCUSTOMERTYPE;
205        %let _OUTPUT_col3_input0_table = edwtdw.TBL_CUSTOMER;
206        %let _OUTPUT_col3_exp = ;
207        %let _OUTPUT_col3_input = FSTRCUSTOMERTYPE;
208        %let _OUTPUT_col3_input_count = 1;
209        %let _OUTPUT_col4_name = fdtmcommence;
210        %let _OUTPUT_col4_table = impraw.tdw_tbl_customer;
211        %let _OUTPUT_col4_length = 8;
212        %let _OUTPUT_col4_type = ;
213        %let _OUTPUT_col4_format = DATETIME29.9;
214        %let _OUTPUT_col4_informat = DATETIME29.9;
215        %let _OUTPUT_col4_label = %nrquote(fdtmcommence);
216        %let _OUTPUT_col4_input0 = FDTMCOMMENCE;
217        %let _OUTPUT_col4_input0_table = edwtdw.TBL_CUSTOMER;
218        %let _OUTPUT_col4_exp = ;
219        %let _OUTPUT_col4_input = FDTMCOMMENCE;
220        %let _OUTPUT_col4_input_count = 1;
221        %let _OUTPUT_col5_name = fdtmcease;
222        %let _OUTPUT_col5_table = impraw.tdw_tbl_customer;
223        %let _OUTPUT_col5_length = 8;
224        %let _OUTPUT_col5_type = ;
225        %let _OUTPUT_col5_format = DATETIME29.9;
226        %let _OUTPUT_col5_informat = DATETIME29.9;
227        %let _OUTPUT_col5_label = %nrquote(fdtmcease);
228        %let _OUTPUT_col5_input0 = FDTMCEASE;
229        %let _OUTPUT_col5_input0_table = edwtdw.TBL_CUSTOMER;
230        %let _OUTPUT_col5_exp = ;
231        %let _OUTPUT_col5_input = FDTMCEASE;
232        %let _OUTPUT_col5_input_count = 1;
233        %let _OUTPUT_col6_name = flngcustomerlevel;
234        %let _OUTPUT_col6_table = impraw.tdw_tbl_customer;
235        %let _OUTPUT_col6_length = 8;
236        %let _OUTPUT_col6_type = ;
237        %let _OUTPUT_col6_format = 20.;
238        %let _OUTPUT_col6_informat = 20.;
239        %let _OUTPUT_col6_label = %nrquote(flngcustomerlevel);
240        %let _OUTPUT_col6_input0 = FLNGCUSTOMERLEVEL;
241        %let _OUTPUT_col6_input0_table = edwtdw.TBL_CUSTOMER;
242        %let _OUTPUT_col6_exp = ;
243        %let _OUTPUT_col6_input = FLNGCUSTOMERLEVEL;
244        %let _OUTPUT_col6_input_count = 1;
245        %let _OUTPUT_col7_name = flngdockey;
246        %let _OUTPUT_col7_table = impraw.tdw_tbl_customer;
247        %let _OUTPUT_col7_length = 8;
248        %let _OUTPUT_col7_type = ;
249        %let _OUTPUT_col7_format = 20.;
250        %let _OUTPUT_col7_informat = 20.;
251        %let _OUTPUT_col7_label = %nrquote(flngdockey);
252        %let _OUTPUT_col7_input0 = FLNGDOCKEY;
253        %let _OUTPUT_col7_input0_table = edwtdw.TBL_CUSTOMER;
254        %let _OUTPUT_col7_exp = ;
255        %let _OUTPUT_col7_input = FLNGDOCKEY;
256        %let _OUTPUT_col7_input_count = 1;
257        %let _OUTPUT_col8_name = flngfolderkey;
258        %let _OUTPUT_col8_table = impraw.tdw_tbl_customer;
6                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

259        %let _OUTPUT_col8_length = 8;
260        %let _OUTPUT_col8_type = ;
261        %let _OUTPUT_col8_format = 20.;
262        %let _OUTPUT_col8_informat = 20.;
263        %let _OUTPUT_col8_label = %nrquote(flngfolderkey);
264        %let _OUTPUT_col8_input0 = FLNGFOLDERKEY;
265        %let _OUTPUT_col8_input0_table = edwtdw.TBL_CUSTOMER;
266        %let _OUTPUT_col8_exp = ;
267        %let _OUTPUT_col8_input = FLNGFOLDERKEY;
268        %let _OUTPUT_col8_input_count = 1;
269        %let _OUTPUT_col9_name = flngrefreshver;
270        %let _OUTPUT_col9_table = impraw.tdw_tbl_customer;
271        %let _OUTPUT_col9_length = 8;
272        %let _OUTPUT_col9_type = ;
273        %let _OUTPUT_col9_format = 20.;
274        %let _OUTPUT_col9_informat = 20.;
275        %let _OUTPUT_col9_label = %nrquote(flngrefreshver);
276        %let _OUTPUT_col9_input0 = FLNGREFRESHVER;
277        %let _OUTPUT_col9_input0_table = edwtdw.TBL_CUSTOMER;
278        %let _OUTPUT_col9_exp = ;
279        %let _OUTPUT_col9_input = FLNGREFRESHVER;
280        %let _OUTPUT_col9_input_count = 1;
281        %let _OUTPUT_col10_name = flngcustomerversion;
282        %let _OUTPUT_col10_table = impraw.tdw_tbl_customer;
283        %let _OUTPUT_col10_length = 8;
284        %let _OUTPUT_col10_type = ;
285        %let _OUTPUT_col10_format = 20.;
286        %let _OUTPUT_col10_informat = 20.;
287        %let _OUTPUT_col10_label = %nrquote(flngcustomerversion);
288        %let _OUTPUT_col10_input0 = FLNGCUSTOMERVERSION;
289        %let _OUTPUT_col10_input0_table = edwtdw.TBL_CUSTOMER;
290        %let _OUTPUT_col10_exp = ;
291        %let _OUTPUT_col10_input = FLNGCUSTOMERVERSION;
292        %let _OUTPUT_col10_input_count = 1;
293        %let _OUTPUT_col11_name = flngwebversion;
294        %let _OUTPUT_col11_table = impraw.tdw_tbl_customer;
295        %let _OUTPUT_col11_length = 8;
296        %let _OUTPUT_col11_type = ;
297        %let _OUTPUT_col11_format = 20.;
298        %let _OUTPUT_col11_informat = 20.;
299        %let _OUTPUT_col11_label = %nrquote(flngwebversion);
300        %let _OUTPUT_col11_input0 = FLNGWEBVERSION;
301        %let _OUTPUT_col11_input0_table = edwtdw.TBL_CUSTOMER;
302        %let _OUTPUT_col11_exp = ;
303        %let _OUTPUT_col11_input = FLNGWEBVERSION;
304        %let _OUTPUT_col11_input_count = 1;
305        %let _OUTPUT_col12_name = fdtmwebpublished;
306        %let _OUTPUT_col12_table = impraw.tdw_tbl_customer;
307        %let _OUTPUT_col12_length = 8;
308        %let _OUTPUT_col12_type = ;
309        %let _OUTPUT_col12_format = DATETIME29.9;
310        %let _OUTPUT_col12_informat = DATETIME29.9;
311        %let _OUTPUT_col12_label = %nrquote(fdtmwebpublished);
312        %let _OUTPUT_col12_input0 = FDTMWEBPUBLISHED;
313        %let _OUTPUT_col12_input0_table = edwtdw.TBL_CUSTOMER;
314        %let _OUTPUT_col12_exp = ;
315        %let _OUTPUT_col12_input = FDTMWEBPUBLISHED;
316        %let _OUTPUT_col12_input_count = 1;
7                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

317        %let _OUTPUT_col13_name = fdtmcreated;
318        %let _OUTPUT_col13_table = impraw.tdw_tbl_customer;
319        %let _OUTPUT_col13_length = 8;
320        %let _OUTPUT_col13_type = ;
321        %let _OUTPUT_col13_format = DATETIME29.9;
322        %let _OUTPUT_col13_informat = DATETIME29.9;
323        %let _OUTPUT_col13_label = %nrquote(fdtmcreated);
324        %let _OUTPUT_col13_input0 = FDTMCREATED;
325        %let _OUTPUT_col13_input0_table = edwtdw.TBL_CUSTOMER;
326        %let _OUTPUT_col13_exp = ;
327        %let _OUTPUT_col13_input = FDTMCREATED;
328        %let _OUTPUT_col13_input_count = 1;
329        %let _OUTPUT_col14_name = fstrwho;
330        %let _OUTPUT_col14_table = impraw.tdw_tbl_customer;
331        %let _OUTPUT_col14_length = 20;
332        %let _OUTPUT_col14_type = $;
333        %let _OUTPUT_col14_format = $20.;
334        %let _OUTPUT_col14_informat = $20.;
335        %let _OUTPUT_col14_label = %nrquote(fstrwho);
336        %let _OUTPUT_col14_input0 = FSTRWHO;
337        %let _OUTPUT_col14_input0_table = edwtdw.TBL_CUSTOMER;
338        %let _OUTPUT_col14_exp = ;
339        %let _OUTPUT_col14_input = FSTRWHO;
340        %let _OUTPUT_col14_input_count = 1;
341        %let _OUTPUT_col15_name = effective_from;
342        %let _OUTPUT_col15_table = impraw.tdw_tbl_customer;
343        %let _OUTPUT_col15_length = 8;
344        %let _OUTPUT_col15_type = ;
345        %let _OUTPUT_col15_format = DATETIME29.9;
346        %let _OUTPUT_col15_informat = DATETIME29.9;
347        %let _OUTPUT_col15_label = %nrquote(effective_from);
348        %let _OUTPUT_col15_input0 = EFFECTIVE_FROM;
349        %let _OUTPUT_col15_input0_table = edwtdw.TBL_CUSTOMER;
350        %let _OUTPUT_col15_exp = ;
351        %let _OUTPUT_col15_input = EFFECTIVE_FROM;
352        %let _OUTPUT_col15_input_count = 1;
353        %let _OUTPUT_col16_name = effective_to;
354        %let _OUTPUT_col16_table = impraw.tdw_tbl_customer;
355        %let _OUTPUT_col16_length = 8;
356        %let _OUTPUT_col16_type = ;
357        %let _OUTPUT_col16_format = DATETIME29.9;
358        %let _OUTPUT_col16_informat = DATETIME29.9;
359        %let _OUTPUT_col16_label = %nrquote(effective_to);
360        %let _OUTPUT_col16_input0 = EFFECTIVE_TO;
361        %let _OUTPUT_col16_input0_table = edwtdw.TBL_CUSTOMER;
362        %let _OUTPUT_col16_exp = ;
363        %let _OUTPUT_col16_input = EFFECTIVE_TO;
364        %let _OUTPUT_col16_input_count = 1;
365        %let _OUTPUT_col17_name = current_rec_flag;
366        %let _OUTPUT_col17_table = impraw.tdw_tbl_customer;
367        %let _OUTPUT_col17_length = 2;
368        %let _OUTPUT_col17_type = $;
369        %let _OUTPUT_col17_format = $2.;
370        %let _OUTPUT_col17_informat = $2.;
371        %let _OUTPUT_col17_label = %nrquote(current_rec_flag);
372        %let _OUTPUT_col17_input0 = CURRENT_REC_FLAG;
373        %let _OUTPUT_col17_input0_table = edwtdw.TBL_CUSTOMER;
374        %let _OUTPUT_col17_exp = ;
8                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

375        %let _OUTPUT_col17_input = CURRENT_REC_FLAG;
376        %let _OUTPUT_col17_input_count = 1;
377        %let _OUTPUT_col18_name = record_effective_timestamp;
378        %let _OUTPUT_col18_table = impraw.tdw_tbl_customer;
379        %let _OUTPUT_col18_length = 8;
380        %let _OUTPUT_col18_type = ;
381        %let _OUTPUT_col18_format = DATETIME29.9;
382        %let _OUTPUT_col18_informat = DATETIME29.9;
383        %let _OUTPUT_col18_label = %nrquote(record_effective_timestamp);
384        %let _OUTPUT_col18_exp = ;
385        %let _OUTPUT_col18_input_count = 0;
386        %let _OUTPUT_col19_name = record_expiry_timestamp;
387        %let _OUTPUT_col19_table = impraw.tdw_tbl_customer;
388        %let _OUTPUT_col19_length = 8;
389        %let _OUTPUT_col19_type = ;
390        %let _OUTPUT_col19_format = DATETIME29.9;
391        %let _OUTPUT_col19_informat = DATETIME29.9;
392        %let _OUTPUT_col19_label = %nrquote(record_expiry_timestamp);
393        %let _OUTPUT_col19_exp = ;
394        %let _OUTPUT_col19_input_count = 0;
395        %let _OUTPUT_col20_name = record_active_flag;
396        %let _OUTPUT_col20_table = impraw.tdw_tbl_customer;
397        %let _OUTPUT_col20_length = 1;
398        %let _OUTPUT_col20_type = $;
399        %let _OUTPUT_col20_format = $1.;
400        %let _OUTPUT_col20_informat = $1.;
401        %let _OUTPUT_col20_label = %nrquote(record_active_flag);
402        %let _OUTPUT_col20_exp = ;
403        %let _OUTPUT_col20_input_count = 0;
404        %let _OUTPUT_col21_name = record_deleted_flag;
405        %let _OUTPUT_col21_table = impraw.tdw_tbl_customer;
406        %let _OUTPUT_col21_length = 1;
407        %let _OUTPUT_col21_type = $;
408        %let _OUTPUT_col21_format = $1.;
409        %let _OUTPUT_col21_informat = $1.;
410        %let _OUTPUT_col21_label = %nrquote(record_deleted_flag);
411        %let _OUTPUT_col21_exp = ;
412        %let _OUTPUT_col21_input_count = 0;
413        %let _OUTPUT_col22_name = insert_object_run_key;
414        %let _OUTPUT_col22_table = impraw.tdw_tbl_customer;
415        %let _OUTPUT_col22_length = 8;
416        %let _OUTPUT_col22_type = ;
417        %let _OUTPUT_col22_format = 11.;
418        %let _OUTPUT_col22_informat = 11.;
419        %let _OUTPUT_col22_label = %nrquote(insert_object_run_key);
420        %let _OUTPUT_col22_exp = ;
421        %let _OUTPUT_col22_input_count = 0;
422        %let _OUTPUT_col23_name = update_object_run_key;
423        %let _OUTPUT_col23_table = impraw.tdw_tbl_customer;
424        %let _OUTPUT_col23_length = 8;
425        %let _OUTPUT_col23_type = ;
426        %let _OUTPUT_col23_format = 11.;
427        %let _OUTPUT_col23_informat = 11.;
428        %let _OUTPUT_col23_label = %nrquote(update_object_run_key);
429        %let _OUTPUT_col23_exp = ;
430        %let _OUTPUT_col23_input_count = 0;
431        
432        %let _target = impraw.tdw_tbl_customer;
9                                                          The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

433        %let _target_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
434        ;
435        %let _target_engine = SASIOIMP;
436        %let _target_memtype = DATA;
437        %let _target_options = %nrquote();
438        %let _target_alter = %nrquote();
439        %let _target_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/tdw_tbl_customer%(Table%));
440        %let _target_type = 1;
441        %let _target_label = %nrquote();
442        /* List of target columns to keep  */
443        %let _target_keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
444                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
445                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
446                fstrwho effective_from effective_to current_rec_flag
447                record_effective_timestamp record_expiry_timestamp record_active_flag
448                record_deleted_flag insert_object_run_key update_object_run_key;
449        %let _target_col_count = 24;
450        %let _target_col0_name = flngcustomerkey;
451        %let _target_col0_table = impraw.tdw_tbl_customer;
452        %let _target_col0_length = 8;
453        %let _target_col0_type = ;
454        %let _target_col0_format = 20.;
455        %let _target_col0_informat = 20.;
456        %let _target_col0_label = %nrquote(flngcustomerkey);
457        %let _target_col0_input0 = FLNGCUSTOMERKEY;
458        %let _target_col0_input0_table = edwtdw.TBL_CUSTOMER;
459        %let _target_col0_exp = ;
460        %let _target_col0_input = FLNGCUSTOMERKEY;
461        %let _target_col0_input_count = 1;
462        %let _target_col1_name = flngver;
463        %let _target_col1_table = impraw.tdw_tbl_customer;
464        %let _target_col1_length = 8;
465        %let _target_col1_type = ;
466        %let _target_col1_format = 20.;
467        %let _target_col1_informat = 20.;
468        %let _target_col1_label = %nrquote(flngver);
469        %let _target_col1_input0 = FLNGVER;
470        %let _target_col1_input0_table = edwtdw.TBL_CUSTOMER;
471        %let _target_col1_exp = ;
472        %let _target_col1_input = FLNGVER;
473        %let _target_col1_input_count = 1;
474        %let _target_col2_name = flngverlast;
475        %let _target_col2_table = impraw.tdw_tbl_customer;
476        %let _target_col2_length = 8;
477        %let _target_col2_type = ;
478        %let _target_col2_format = 20.;
479        %let _target_col2_informat = 20.;
480        %let _target_col2_label = %nrquote(flngverlast);
481        %let _target_col2_input0 = FLNGVERLAST;
482        %let _target_col2_input0_table = edwtdw.TBL_CUSTOMER;
483        %let _target_col2_exp = ;
484        %let _target_col2_input = FLNGVERLAST;
485        %let _target_col2_input_count = 1;
486        %let _target_col3_name = fstrcustomertype;
487        %let _target_col3_table = impraw.tdw_tbl_customer;
488        %let _target_col3_length = 12;
489        %let _target_col3_type = $;
490        %let _target_col3_format = $12.;
10                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

491        %let _target_col3_informat = $12.;
492        %let _target_col3_label = %nrquote(fstrcustomertype);
493        %let _target_col3_input0 = FSTRCUSTOMERTYPE;
494        %let _target_col3_input0_table = edwtdw.TBL_CUSTOMER;
495        %let _target_col3_exp = ;
496        %let _target_col3_input = FSTRCUSTOMERTYPE;
497        %let _target_col3_input_count = 1;
498        %let _target_col4_name = fdtmcommence;
499        %let _target_col4_table = impraw.tdw_tbl_customer;
500        %let _target_col4_length = 8;
501        %let _target_col4_type = ;
502        %let _target_col4_format = DATETIME29.9;
503        %let _target_col4_informat = DATETIME29.9;
504        %let _target_col4_label = %nrquote(fdtmcommence);
505        %let _target_col4_input0 = FDTMCOMMENCE;
506        %let _target_col4_input0_table = edwtdw.TBL_CUSTOMER;
507        %let _target_col4_exp = ;
508        %let _target_col4_input = FDTMCOMMENCE;
509        %let _target_col4_input_count = 1;
510        %let _target_col5_name = fdtmcease;
511        %let _target_col5_table = impraw.tdw_tbl_customer;
512        %let _target_col5_length = 8;
513        %let _target_col5_type = ;
514        %let _target_col5_format = DATETIME29.9;
515        %let _target_col5_informat = DATETIME29.9;
516        %let _target_col5_label = %nrquote(fdtmcease);
517        %let _target_col5_input0 = FDTMCEASE;
518        %let _target_col5_input0_table = edwtdw.TBL_CUSTOMER;
519        %let _target_col5_exp = ;
520        %let _target_col5_input = FDTMCEASE;
521        %let _target_col5_input_count = 1;
522        %let _target_col6_name = flngcustomerlevel;
523        %let _target_col6_table = impraw.tdw_tbl_customer;
524        %let _target_col6_length = 8;
525        %let _target_col6_type = ;
526        %let _target_col6_format = 20.;
527        %let _target_col6_informat = 20.;
528        %let _target_col6_label = %nrquote(flngcustomerlevel);
529        %let _target_col6_input0 = FLNGCUSTOMERLEVEL;
530        %let _target_col6_input0_table = edwtdw.TBL_CUSTOMER;
531        %let _target_col6_exp = ;
532        %let _target_col6_input = FLNGCUSTOMERLEVEL;
533        %let _target_col6_input_count = 1;
534        %let _target_col7_name = flngdockey;
535        %let _target_col7_table = impraw.tdw_tbl_customer;
536        %let _target_col7_length = 8;
537        %let _target_col7_type = ;
538        %let _target_col7_format = 20.;
539        %let _target_col7_informat = 20.;
540        %let _target_col7_label = %nrquote(flngdockey);
541        %let _target_col7_input0 = FLNGDOCKEY;
542        %let _target_col7_input0_table = edwtdw.TBL_CUSTOMER;
543        %let _target_col7_exp = ;
544        %let _target_col7_input = FLNGDOCKEY;
545        %let _target_col7_input_count = 1;
546        %let _target_col8_name = flngfolderkey;
547        %let _target_col8_table = impraw.tdw_tbl_customer;
548        %let _target_col8_length = 8;
11                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

549        %let _target_col8_type = ;
550        %let _target_col8_format = 20.;
551        %let _target_col8_informat = 20.;
552        %let _target_col8_label = %nrquote(flngfolderkey);
553        %let _target_col8_input0 = FLNGFOLDERKEY;
554        %let _target_col8_input0_table = edwtdw.TBL_CUSTOMER;
555        %let _target_col8_exp = ;
556        %let _target_col8_input = FLNGFOLDERKEY;
557        %let _target_col8_input_count = 1;
558        %let _target_col9_name = flngrefreshver;
559        %let _target_col9_table = impraw.tdw_tbl_customer;
560        %let _target_col9_length = 8;
561        %let _target_col9_type = ;
562        %let _target_col9_format = 20.;
563        %let _target_col9_informat = 20.;
564        %let _target_col9_label = %nrquote(flngrefreshver);
565        %let _target_col9_input0 = FLNGREFRESHVER;
566        %let _target_col9_input0_table = edwtdw.TBL_CUSTOMER;
567        %let _target_col9_exp = ;
568        %let _target_col9_input = FLNGREFRESHVER;
569        %let _target_col9_input_count = 1;
570        %let _target_col10_name = flngcustomerversion;
571        %let _target_col10_table = impraw.tdw_tbl_customer;
572        %let _target_col10_length = 8;
573        %let _target_col10_type = ;
574        %let _target_col10_format = 20.;
575        %let _target_col10_informat = 20.;
576        %let _target_col10_label = %nrquote(flngcustomerversion);
577        %let _target_col10_input0 = FLNGCUSTOMERVERSION;
578        %let _target_col10_input0_table = edwtdw.TBL_CUSTOMER;
579        %let _target_col10_exp = ;
580        %let _target_col10_input = FLNGCUSTOMERVERSION;
581        %let _target_col10_input_count = 1;
582        %let _target_col11_name = flngwebversion;
583        %let _target_col11_table = impraw.tdw_tbl_customer;
584        %let _target_col11_length = 8;
585        %let _target_col11_type = ;
586        %let _target_col11_format = 20.;
587        %let _target_col11_informat = 20.;
588        %let _target_col11_label = %nrquote(flngwebversion);
589        %let _target_col11_input0 = FLNGWEBVERSION;
590        %let _target_col11_input0_table = edwtdw.TBL_CUSTOMER;
591        %let _target_col11_exp = ;
592        %let _target_col11_input = FLNGWEBVERSION;
593        %let _target_col11_input_count = 1;
594        %let _target_col12_name = fdtmwebpublished;
595        %let _target_col12_table = impraw.tdw_tbl_customer;
596        %let _target_col12_length = 8;
597        %let _target_col12_type = ;
598        %let _target_col12_format = DATETIME29.9;
599        %let _target_col12_informat = DATETIME29.9;
600        %let _target_col12_label = %nrquote(fdtmwebpublished);
601        %let _target_col12_input0 = FDTMWEBPUBLISHED;
602        %let _target_col12_input0_table = edwtdw.TBL_CUSTOMER;
603        %let _target_col12_exp = ;
604        %let _target_col12_input = FDTMWEBPUBLISHED;
605        %let _target_col12_input_count = 1;
606        %let _target_col13_name = fdtmcreated;
12                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

607        %let _target_col13_table = impraw.tdw_tbl_customer;
608        %let _target_col13_length = 8;
609        %let _target_col13_type = ;
610        %let _target_col13_format = DATETIME29.9;
611        %let _target_col13_informat = DATETIME29.9;
612        %let _target_col13_label = %nrquote(fdtmcreated);
613        %let _target_col13_input0 = FDTMCREATED;
614        %let _target_col13_input0_table = edwtdw.TBL_CUSTOMER;
615        %let _target_col13_exp = ;
616        %let _target_col13_input = FDTMCREATED;
617        %let _target_col13_input_count = 1;
618        %let _target_col14_name = fstrwho;
619        %let _target_col14_table = impraw.tdw_tbl_customer;
620        %let _target_col14_length = 20;
621        %let _target_col14_type = $;
622        %let _target_col14_format = $20.;
623        %let _target_col14_informat = $20.;
624        %let _target_col14_label = %nrquote(fstrwho);
625        %let _target_col14_input0 = FSTRWHO;
626        %let _target_col14_input0_table = edwtdw.TBL_CUSTOMER;
627        %let _target_col14_exp = ;
628        %let _target_col14_input = FSTRWHO;
629        %let _target_col14_input_count = 1;
630        %let _target_col15_name = effective_from;
631        %let _target_col15_table = impraw.tdw_tbl_customer;
632        %let _target_col15_length = 8;
633        %let _target_col15_type = ;
634        %let _target_col15_format = DATETIME29.9;
635        %let _target_col15_informat = DATETIME29.9;
636        %let _target_col15_label = %nrquote(effective_from);
637        %let _target_col15_input0 = EFFECTIVE_FROM;
638        %let _target_col15_input0_table = edwtdw.TBL_CUSTOMER;
639        %let _target_col15_exp = ;
640        %let _target_col15_input = EFFECTIVE_FROM;
641        %let _target_col15_input_count = 1;
642        %let _target_col16_name = effective_to;
643        %let _target_col16_table = impraw.tdw_tbl_customer;
644        %let _target_col16_length = 8;
645        %let _target_col16_type = ;
646        %let _target_col16_format = DATETIME29.9;
647        %let _target_col16_informat = DATETIME29.9;
648        %let _target_col16_label = %nrquote(effective_to);
649        %let _target_col16_input0 = EFFECTIVE_TO;
650        %let _target_col16_input0_table = edwtdw.TBL_CUSTOMER;
651        %let _target_col16_exp = ;
652        %let _target_col16_input = EFFECTIVE_TO;
653        %let _target_col16_input_count = 1;
654        %let _target_col17_name = current_rec_flag;
655        %let _target_col17_table = impraw.tdw_tbl_customer;
656        %let _target_col17_length = 2;
657        %let _target_col17_type = $;
658        %let _target_col17_format = $2.;
659        %let _target_col17_informat = $2.;
660        %let _target_col17_label = %nrquote(current_rec_flag);
661        %let _target_col17_input0 = CURRENT_REC_FLAG;
662        %let _target_col17_input0_table = edwtdw.TBL_CUSTOMER;
663        %let _target_col17_exp = ;
664        %let _target_col17_input = CURRENT_REC_FLAG;
13                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

665        %let _target_col17_input_count = 1;
666        %let _target_col18_name = record_effective_timestamp;
667        %let _target_col18_table = impraw.tdw_tbl_customer;
668        %let _target_col18_length = 8;
669        %let _target_col18_type = ;
670        %let _target_col18_format = DATETIME29.9;
671        %let _target_col18_informat = DATETIME29.9;
672        %let _target_col18_label = %nrquote(record_effective_timestamp);
673        %let _target_col18_exp = ;
674        %let _target_col18_input_count = 0;
675        %let _target_col19_name = record_expiry_timestamp;
676        %let _target_col19_table = impraw.tdw_tbl_customer;
677        %let _target_col19_length = 8;
678        %let _target_col19_type = ;
679        %let _target_col19_format = DATETIME29.9;
680        %let _target_col19_informat = DATETIME29.9;
681        %let _target_col19_label = %nrquote(record_expiry_timestamp);
682        %let _target_col19_exp = ;
683        %let _target_col19_input_count = 0;
684        %let _target_col20_name = record_active_flag;
685        %let _target_col20_table = impraw.tdw_tbl_customer;
686        %let _target_col20_length = 1;
687        %let _target_col20_type = $;
688        %let _target_col20_format = $1.;
689        %let _target_col20_informat = $1.;
690        %let _target_col20_label = %nrquote(record_active_flag);
691        %let _target_col20_exp = ;
692        %let _target_col20_input_count = 0;
693        %let _target_col21_name = record_deleted_flag;
694        %let _target_col21_table = impraw.tdw_tbl_customer;
695        %let _target_col21_length = 1;
696        %let _target_col21_type = $;
697        %let _target_col21_format = $1.;
698        %let _target_col21_informat = $1.;
699        %let _target_col21_label = %nrquote(record_deleted_flag);
700        %let _target_col21_exp = ;
701        %let _target_col21_input_count = 0;
702        %let _target_col22_name = insert_object_run_key;
703        %let _target_col22_table = impraw.tdw_tbl_customer;
704        %let _target_col22_length = 8;
705        %let _target_col22_type = ;
706        %let _target_col22_format = 11.;
707        %let _target_col22_informat = 11.;
708        %let _target_col22_label = %nrquote(insert_object_run_key);
709        %let _target_col22_exp = ;
710        %let _target_col22_input_count = 0;
711        %let _target_col23_name = update_object_run_key;
712        %let _target_col23_table = impraw.tdw_tbl_customer;
713        %let _target_col23_length = 8;
714        %let _target_col23_type = ;
715        %let _target_col23_format = 11.;
716        %let _target_col23_informat = 11.;
717        %let _target_col23_label = %nrquote(update_object_run_key);
718        %let _target_col23_exp = ;
719        %let _target_col23_input_count = 0;
720        
721        
722        %let ep_key_cols = flngcustomerkey;
14                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

723        %let ep_key_cols_count = 1;
724        %let ep_key_cols0 = 1;
725        %let ep_key_cols1 = flngcustomerkey;
726        %let where = ;
727        %let change_capture_timestamp = EFFECTIVE_FROM;
728        %let change_capture_timestamp_count = 1;
729        %let change_capture_timestamp0 = 1;
730        %let change_capture_timestamp1 = EFFECTIVE_FROM;
731        %let history_type = %nrquote(H2);
732        %let duplication_grain = %nrquote(1);
733        %let h2_effective_column = ;
734        %let h2_effective_column_count = 0;
735        %let h2_effective_column0 = 0;
736        %let effective_column = ;
737        %let effective_column_count = 0;
738        %let effective_column0 = 0;
739        %let to_timestamp = ;
740        %let to_timestamp_count = 0;
741        %let to_timestamp0 = 0;
742        %let effective_timestamp_grain = %nrquote(Seconds);
743        %let purge_grain = %nrquote(1);
744        %let debug = %nrquote(No);
745        %let ep_db_create_opts = %nrquote(with serdeproperties %(%'field.delim%'=%'\u0006%', %'line.delim%'=%'\u0007%',
745      ! %'serialization.format%'=%'\u0006%',%'serialization.escape.crlf%'=%'true%'%) stored as textfile);
746        %let lcf = lcf.OBJECT;
747        %let lcf_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
747      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
748        ;
749        %let lcf_engine = ORACLE;
750        %let lcf_memtype = DATA;
751        %let lcf_options = %nrquote();
752        %let lcf_alter = %nrquote();
753        %let lcf_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT%(Table%));
754        %let lcf_type = 1;
755        %let lcf_label = %nrquote();
756        %let ep_db_opts_count = %nrquote(1);
757        %let ep_db_opts = %nrquote(stored as parquet);
758        %let ep_db_opts1 = %nrquote(stored as parquet);
759        %let logging = lcf.OBJECT_RUN;
760        %let logging_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
760      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
761        ;
762        %let logging_engine = ORACLE;
763        %let logging_memtype = DATA;
764        %let logging_options = %nrquote();
765        %let logging_alter = %nrquote();
766        %let logging_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT_RUN%(Table%));
767        %let logging_type = 1;
768        %let logging_label = %nrquote();
769        /* Access the data for DIP Hive Staging (hivestg)  */
770        LIBNAME hivestg HADOOP  URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;
770      ! ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"  HDFS_TEMPDIR="/env/1_dev/landing/"
770      ! LOGIN_TIMEOUT=0  DEFER=YES
771        PORT=10001 SERVER="ird26au.vsp.sas.com"  SCHEMA=dev_staging ;
NOTE: Libref HIVESTG was successfully assigned as follows: 
      Engine:        HADOOP 
      Physical Name: jdbc:hive2://ird26au.vsp.sas.com:10001/
772        %rcSet(&syslibrc);
15                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

773        
774        %let stg_hive_connect =  DEFER=YES URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;
774      ! principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"
774      ! HDFS_TEMPDIR="/env/1_dev/landing/" LOGIN_TIMEOUT=0 SERVER="ird26au.vsp.sas.com"  PORT=10001
775        ;
776        %let stg_hive_engine = HADOOP;
777        %let stg_hive_path = /IRD/DIP Data Management/1000 Libraries/DIP Hive Staging (hivestg)(Library);
778        %let stg_hive = hivestg;
779        /* Access the data for DIP Impala Staging (impstg)  */
780        LIBNAME impstg SASIOIMP  DATABASE=dev_staging  HDFS_TEMPDIR="/env/1_dev/landing/"  DSN=ClouderaImpala64
780      ! SCHEMA=dev_staging ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPSTG was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
781        %rcSet(&syslibrc);
782        
783        %let ep_staging_library_connect =  DATABASE=dev_staging DSN=ClouderaImpala64
784        ;
785        %let ep_staging_library_engine = SASIOIMP;
786        %let ep_staging_library = impstg;
787        %let ep_staging_library_path = /IRD/DIP Data Management/1000 Libraries/DIP Impala Staging (impstg)(Library);
788        %let Source_table_type = %nrquote(view);
789        %let tagsort = %nrquote(No);
790        
791        /* List of target columns to keep  */
792        %let _keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
793                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
794                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
795                fstrwho effective_from effective_to current_rec_flag
796                record_effective_timestamp record_expiry_timestamp record_active_flag
797                record_deleted_flag insert_object_run_key update_object_run_key;
798        /* List of target columns to keep  */
799        %let keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
800                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
801                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
802                fstrwho effective_from effective_to current_rec_flag
803                record_effective_timestamp record_expiry_timestamp record_active_flag
804                record_deleted_flag insert_object_run_key update_object_run_key;
805        %change_extract;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   option nosymbolgen nomlogic validvarname=any validmemname=extend spool mprint 
mprintnest nofullstimer notes bufno=3000 bufsize=65535 ibufno=10000 ibufsize=32767 compress=no;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do connect = "DATABASE=dev_staging DSN=ClouderaImpala64", 
"DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i + 1;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if i = 1 then prefix = 'stg';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else prefix = 'tgt';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 6;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'SCHEMA');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if schema_index = 0 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'DATABASE');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 8;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema = dequote(scan(substr(connect, schema_index + schema_length + 
1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   auth_index = index(connect, 'AUTHDOMAIN');
16                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if auth_index then auth = dequote(scan(substr(connect, auth_index + 10 
+ 1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else auth = ' ';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_schema', cats('`', schema, '`'));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_auth', strip(auth));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tbl_customer, tdw_tbl_customer);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('source_table', lowcase(vname(tbl_customer)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('_target_name', lowcase(vname(tdw_tbl_customer)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   array col $ 1 flngcustomerkey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length key_cols by_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(key_cols, by_cols);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do over col;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   key_cols = catx(', ', key_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   by_cols = catx(' ', by_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('key_order', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('by_order', strip(by_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   connect to ORACLE(DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" 
READBUFF=20000 dbclient_max_bytes=2 PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev");
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   select object_run_key format=best. into :object_run_key 
trimmed from connection to ORACLE (select lcf.seq_object_run_key.nextval as object_run_key from dual);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   disconnect from ORACLE;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.38 seconds
      cpu time            0.17 seconds
      
17                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM


MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   data _object_run(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if 0 then set lcf.OBJECT_RUN;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_run_key = 9093;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   start_time = "30OCT2019:11:10:47"dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_prg_name = "tdw_tbl_customer P2H2";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status_message = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_read = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_written = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   log_position = getoption('log');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if not missing(log_position) then object_log_name = 
substr(log_position, index(log_position, 'Logs/') + 5);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   load_pattern_name = "Change Extract";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   output;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   drop log_position;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: The data set WORK._OBJECT_RUN has 1 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.35 seconds
      cpu time            0.17 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc append base=lcf.OBJECT_RUN data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: Appending WORK._OBJECT_RUN to LCF.OBJECT_RUN.
NOTE: There were 1 observations read from the data set WORK._OBJECT_RUN.
NOTE: 1 observations added.
NOTE: The data set LCF.OBJECT_RUN has . observations and 35 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.92 seconds
      cpu time            0.52 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc delete data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;
NOTE: Deleting WORK._OBJECT_RUN (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tdw_tbl_customer);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('meta_target_name', 
strip(lowcase(vname(tdw_tbl_customer))), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(EFFECTIVE_FROM);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('effective_column', lowcase(vname(EFFECTIVE_FROM)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
18                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   retain table "tdw_tbl_customer";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length table_suffix $ 40 suffix $ 5;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do suffix = '', '_chgt', '_chgd', '_new', '_old', '_dt', '_unwd', 
'_nr';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_suffix = cats(table, suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_length = length(table);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   suffix_length = length(suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if suffix = '_nr' and length(table_suffix) > 32 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   status_msg = catx(' ', 'Table name length too long:', table_suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('status_msg', strip(status_msg));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('hadoop_table' || suffix, cats('`', table_suffix, '`'), 
'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('sas_table' || suffix, table_suffix, 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _tdw_tbl_customer(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: The data set WORK._TDW_TBL_CUSTOMER has 0 observations and 0 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select object_key, coalesce(days_to_backfill, 
0) as days_to_backfill into :object_key trimmed, :backfill trimmed from lcf.OBJECT where lowcase(sas_lib_ref) = "edwtdw" and 
lowcase(target_object_name) = "tdw_tbl_customer";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.29 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   connect to SASIOIMP(DBMAX_TEXT=32767 
DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select row_count format=best20., 
int(ifn(max_timestamp ne '1jan1800:0:0'dt, max_timestamp - 10, max_timestamp)) format=is8601dt26.3 into :_nobs trimmed, 
:max_timestamp trimmed from connection to SASIOIMP (select count(*) as `row_count`, coalesce( days_add(max(`effective_from`), -0) , 
19                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

'1800-01-01T00:00:00') as `max_timestamp` from `dev_raw`.`tdw_tbl_customer`);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.24 seconds
      cpu time            0.12 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   delete _source_v _source_v_dedup _source_v2 _source_v3 existing_keys 
_source_date_selection;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 500, object_name = 
"tdw_tbl_customer", prev_high_water_mark_value = inputn("1800-01-01T00:00:00.000", 'is8601dt23.0'), task1 = "Read Source", 
task1_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.84 seconds
      cpu time            0.64 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   create view _source_v as select flngcustomerkey length=8 format=20. , flngver 
length=8 format=20. , flngverlast length=8 format=20. , fstrcustomertype length=12 format=$12. , fdtmcommence length=8 
format=DATETIME29.9 , fdtmcease length=8 format=DATETIME29.9 , flngcustomerlevel length=8 format=20. , flngdockey length=8 
format=20. , flngfolderkey length=8 format=20. , flngrefreshver length=8 format=20. , flngcustomerversion length=8 format=20. , 
flngwebversion length=8 format=20. , fdtmwebpublished length=8 format=DATETIME29.9 , fdtmcreated length=8 format=DATETIME29.9 , 
fstrwho length=20 format=$20. , effective_from length=8 format=DATETIME29.9 , effective_to length=8 format=DATETIME29.9 , 
current_rec_flag length=2 format=$2. from edwtdw.TBL_CUSTOMER where ( EFFECTIVE_FROM between "01JAN1800:00:00:00.000"dt and 
"30OCT2019:11:10:51.167"dt) order by flngcustomerkey, effective_from ;
NOTE: SQL view WORK._SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
20                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence 
fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated 
fstrwho effective_from effective_to current_rec_flag;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   attrib sas_cols hadoop_cols length=$ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   sas_cols = catx(', ', sas_cols, strip(lowcase(vname(cols))));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   hadoop_cols = catx(', ', hadoop_cols, cats("`", lowcase(vname(cols)), "`"));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('sas_cols', strip(sas_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_cols', strip(hadoop_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_effective_column', cats('`', lowcase(vname(effective_from)), 
'`'), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name into :date_vars separated by ' ' from dictionary.columns where libname = 
'WORK' and memname = '_SOURCE_V' and format like 'DATE%' and format not like 'DATETIME%';
NOTE: No rows were selected.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.14 seconds
      cpu time            0.12 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v2 / view=_source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   retain flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence fdtmcease 
flngcustomerlevel flngdockey flngfolderkey flngrefreshver flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated fstrwho 
effective_from effective_to current_rec_flag ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 500, task1 = "Read 
Source", task1_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
21                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 500, task2 = 
"Validation", task2_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngcustomerkey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   length key_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   key_cols = catx(', ', key_cols, lowcase(vname(cols)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symput('key_cols', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):   option compress=no missing=' ' nomprint nonotes
There are no rows in work.mismatched_error.
There are no rows in work.mismatched_warning.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 500, task2 = 
"Validation", task2_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 500, task3 = "Table 
22                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

Load", task3_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name, cats(name, '_x'), catx(' = ', cats(name, '_x'), name) into 
:datetime_names separated by ' ', :datetime_names_char separated by ' ', :datetime_rename separated by ' ' from dictionary.columns 
where libname = 'WORK' and memname = '_SOURCE_V2' and format like 'DATETIME%';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v3(label="Datetimes converted to ISO8601 timestamps") / view=_source_v3;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array from_dt fdtmcommence fdtmcease fdtmwebpublished fdtmcreated effective_from 
effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array to_dt $ 26 fdtmcommence_x fdtmcease_x fdtmwebpublished_x fdtmcreated_x 
effective_from_x effective_to_x;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over from_dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   to_dt[_i_] = put(from_dt, is8601dt26.3);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   drop fdtmcommence fdtmcease fdtmwebpublished fdtmcreated effective_from effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   rename fdtmcommence_x = fdtmcommence fdtmcease_x = fdtmcease fdtmwebpublished_x = 
fdtmwebpublished fdtmcreated_x = fdtmcreated effective_from_x = effective_from effective_to_x = effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V3.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View WORK._SOURCE_V2.VIEW used (Total process time):
      real time           0.08 seconds
      cpu time            0.00 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_dt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_nr`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
23                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_chgt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_chgd`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customer_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.26 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select ifc(format not like 'DATETIME%', cats('`', name, '`'), cat('cast(null as 
varchar(26)) as `', strip(name), '`')) into :create_string separated by ', ' from dictionary.columns where libname = "IMPRAW" and 
upcase(memname) = "TDW_TBL_CUSTOMER" and lowcase(name) notin('record_effective_timestamp', 'record_expiry_timestamp', 
'record_active_flag', 'record_deleted_flag', 'insert_object_run_key', 'update_object_run_key') ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`tdw_tbl_customer` with serdeproperties 
('field.delim'='\u0006', 'line.delim'='\u0007', 'serialization.format'='\u0006','serialization.escape.crlf'='true') stored as 
textfile as select `flngcustomerkey`, `flngver`, `flngverlast`, `fstrcustomertype`, cast(null as varchar(26)) as `fdtmcommence`, 
cast(null as varchar(26)) as `fdtmcease`, `flngcustomerlevel`, `flngdockey`, `flngfolderkey`, `flngrefreshver`, 
`flngcustomerversion`, `flngwebversion`, cast(null as varchar(26)) as `fdtmwebpublished`, cast(null as varchar(26)) as 
`fdtmcreated`, `fstrwho`, cast(null as varchar(26)) as `effective_from`, cast(null as varchar(26)) as `effective_to`, 
`current_rec_flag` from `dev_raw`.`tdw_tbl_customer` where false) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   insert into hivestg.tdw_tbl_customer(bulkload=yes) select flngcustomerkey, flngver, 
flngverlast, fstrcustomertype, fdtmcommence, fdtmcease, flngcustomerlevel, flngdockey, flngfolderkey, flngrefreshver, 
flngcustomerversion, flngwebversion, fdtmwebpublished, fdtmcreated, fstrwho, effective_from, effective_to, current_rec_flag from 
_source_v3;
NOTE: There were 9803355 observations read from the data set WORK._SOURCE_V.
NOTE: View WORK._SOURCE_V3.VIEW used (Total process time):
      real time           5:41.65
      cpu time            1:12.79
      
NOTE: There were 9803355 observations read from the data set WORK._SOURCE_V2.
NOTE: 9803355 rows were inserted into HIVESTG.TDW_TBL_CUSTOMER.
24                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM


MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           5:48.19
      cpu time            1:13.15
      


INFO: 9,803,355 observations inserted
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are no observations in impstg.tdw_tbl_customer (dev_staging.tdw_tbl_customer) where `flngcustomerkey` is null or 
`effective_from` is null.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql dquote=ansi noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select count(*) into :date_columns_count trimmed from dictionary.columns where 
libname = 'WORK' and memname = '_SOURCE_V2' and ( format like 'DATETIME%' or format like 'IS8601DT%');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select case when format like 'DATETIME%' or format like 'IS8601DT%' then 
cat('cast(`', strip(lowcase(name)), '` as timestamp) as `', strip(name), '`') else cats('`', name, '`') end as select_clause into 
:select_clause separated by ', ' from dictionary.columns where libname = 'WORK' and memname = '_SOURCE_V2';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`tdw_tbl_customer_dt` stored as parquet as 
select `flngcustomerkey`, `flngver`, `flngverlast`, `fstrcustomertype`, cast(`fdtmcommence` as timestamp) as `fdtmcommence`, 
cast(`fdtmcease` as timestamp) as `fdtmcease`, `flngcustomerlevel`, `flngdockey`, `flngfolderkey`, `flngrefreshver`, 
`flngcustomerversion`, `flngwebversion`, cast(`fdtmwebpublished` as timestamp) as `fdtmwebpublished`, cast(`fdtmcreated` as 
timestamp) as `fdtmcreated`, `fstrwho`, cast(`effective_from` as timestamp) as `effective_from`, cast(`effective_to` as timestamp) 
as `effective_to`, `current_rec_flag` from `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customer_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (drop table `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (alter table `dev_staging`.`tdw_tbl_customer_dt` rename to 
`dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (compute stats `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           19.23 seconds
      cpu time            0.22 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
25                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute(create table `dev_staging`.`tdw_tbl_customer_nr` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, 
_left.`effective_to`, _left.`current_rec_flag` from `dev_staging`.`tdw_tbl_customer` as _left left join 
`dev_raw`.`tdw_tbl_customer` as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey` and _left.`effective_from` = 
_right.`effective_from` where _right.`flngcustomerkey` is null) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.97 seconds
      cpu time            0.09 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are 9,803,355 observations in impstg.tdw_tbl_customer_nr (dev_staging.tdw_tbl_customer_nr).
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task3 = 
"Table Load", task3_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task4 = "Capture Changes", 
task4_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.44 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql noprint;
26                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT):   execute (refresh `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`tdw_tbl_customer_chgt` stored as parquet as with new_min as (select 
`flngcustomerkey`, min(`effective_from`) as `effective_ts` from `dev_staging`.`tdw_tbl_customer_nr` group by `flngcustomerkey`), 
current_max as (select `flngcustomerkey`, max(record_effective_timestamp) as `effective_ts` from `dev_raw`.`tdw_tbl_customer` group 
by `flngcustomerkey`), new_ranked as (select `flngcustomerkey`, `effective_from` as `effective_ts`, rank() over(partition by 
`flngcustomerkey` order by `effective_from`) as `rank` from `dev_staging`.`tdw_tbl_customer_nr`), previous_active as (select 
distinct `flngcustomerkey`, `effective_ts`, `rank` - 1 as `rank` from new_ranked) select _left.`flngcustomerkey`, 
_left.`effective_ts`, _left.`effective_ts` as `record_effective_timestamp`, milliseconds_add(_right.`effective_ts`, -1) as 
`record_expiry_timestamp`, cast('U' as varchar(1)) as `operation`, cast(9093 as int) as `object_run_key` from current_max as _left 
left join new_min as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey` where _right.`flngcustomerkey` is not null union 
all select _left.`flngcustomerkey`, _left.`effective_ts`, case when _left.`rank` = 1 then cast('1800-01-01T00:00:00' as timestamp) 
else _left.`effective_ts` end as `record_effective_timestamp`, coalesce(milliseconds_add(_right.`effective_ts`, -1), 
cast('9000-12-31T00:00:00' as timestamp)) as `record_expiry_timestamp`, cast('I' as varchar(1)) as `operation`, cast(9093 as int) 
as `object_run_key` from new_ranked as _left left join previous_active as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.`rank` = _right.`rank`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   select count into :_nobs from connection to SASIOIMP (select count(*) as `count` from 
`dev_staging`.`tdw_tbl_customer_chgt`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           11.44 seconds
      cpu time            0.16 seconds
      


INFO: There are 9,803,355 rows in tdw_tbl_customer_chgt
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`tdw_tbl_customer_chgd` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, 
_left.`effective_to`, _left.`current_rec_flag`, _right.record_effective_timestamp, _right.record_expiry_timestamp, 
_right.operation, _right.object_run_key from `dev_staging`.`tdw_tbl_customer_nr` as _left inner join 
`dev_staging`.`tdw_tbl_customer_chgt` as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey` and _left.`effective_from` = 
_right.`effective_ts` and _right.operation = 'I' union all select _left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, 
_left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, _left.`flngcustomerlevel`, _left.`flngdockey`, 
_left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, _left.`flngwebversion`, _left.`fdtmwebpublished`, 
_left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, _left.`effective_to`, _left.`current_rec_flag`, 
_right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, _right.object_run_key from 
`dev_raw`.`tdw_tbl_customer` as _left inner join `dev_staging`.`tdw_tbl_customer_chgt` as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.record_effective_timestamp = _right.record_effective_timestamp and _right.operation = 'U') by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.06 seconds
27                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

      cpu time            0.11 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task4 = "Capture Changes", 
task4_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.65 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task5 = "Apply Changes", 
task5_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.65 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_raw`.`tdw_tbl_customer_new` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, 
_left.`effective_to`, _left.`current_rec_flag`, _left.record_effective_timestamp, _left.record_expiry_timestamp, 
_left.record_active_flag, _left.record_deleted_flag, _left.insert_object_run_key, _left.update_object_run_key from 
`dev_raw`.`tdw_tbl_customer` as _left left join `dev_staging`.`tdw_tbl_customer_chgd` as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.record_effective_timestamp = _right.record_effective_timestamp and _right.object_run_key = 9093 
where _right.`flngcustomerkey` is null union all select _left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, 
_left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, _left.`flngcustomerlevel`, _left.`flngdockey`, 
_left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, _left.`flngwebversion`, _left.`fdtmwebpublished`, 
_left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, _left.`effective_to`, _left.`current_rec_flag`, 
record_effective_timestamp, record_expiry_timestamp, cast(case when record_expiry_timestamp >= cast("9000-12-31T00:00:00" as 
timestamp) then 'Y' else 'N' end as varchar(1)) as record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, 
object_run_key as insert_object_run_key, object_run_key as update_object_run_key from `dev_staging`.`tdw_tbl_customer_chgd` as 
_left where object_run_key = 9093 and operation = 'I' union all select _left.`flngcustomerkey`, _left.`flngver`, 
_left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, _left.`flngcustomerlevel`, 
_left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, _left.`flngwebversion`, 
_left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`effective_from`, _left.`effective_to`, 
_left.`current_rec_flag`, _left.record_effective_timestamp, _left.record_expiry_timestamp, cast('N' as varchar(1)) as 
record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, _right.insert_object_run_key, _left.object_run_key as 
28                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

update_object_run_key from `dev_staging`.`tdw_tbl_customer_chgd` as _left inner join `dev_raw`.`tdw_tbl_customer` as _right on 
_left.`flngcustomerkey` = _right.`flngcustomerkey` and _left.record_effective_timestamp = _right.record_effective_timestamp and 
_left.object_run_key = 9093 and _left.operation = 'U') by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           13.23 seconds
      cpu time            0.11 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task5 = "Apply Changes", 
task5_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.76 seconds
      cpu time            0.57 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task6 = "Reconciliation", 
task6_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.45 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc sql;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
29                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_source_v as select 'Source' as type length=6, measure length=6, count as 
source_count format=comma14. from connection to SASIOIMP (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_staging`.`tdw_tbl_customer_nr` union all select cast('update' as varchar(6)) as measure, count(distinct 
_left.`flngcustomerkey`) as count from `dev_staging`.`tdw_tbl_customer_nr` as _left inner join (select distinct `flngcustomerkey` 
from `dev_raw`.`tdw_tbl_customer`) as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey`);
NOTE: SQL view WORK.COUNT_SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_target_v as select 'Target' as type length=6, measure length=6, count as 
target_count format=comma14. from connection to sasioimp (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_raw`.`tdw_tbl_customer_new` as _left inner join (select distinct object_run_key from `dev_staging`.`tdw_tbl_customer_chgt`) as 
_right on _left.insert_object_run_key = _right.object_run_key union all select cast('update' as varchar) as measure, count(*) as 
count from `dev_raw`.`tdw_tbl_customer_new` as _left inner join (select distinct object_run_key from 
`dev_staging`.`tdw_tbl_customer_chgt`) as _right on _left.update_object_run_key = _right.object_run_key where update_object_run_key 
!= insert_object_run_key);
NOTE: SQL view WORK.COUNT_TARGET_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.06 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   data _null_;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   merge count_source_v(in=in_source) count_target_v(in=in_target);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   by measure;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   format source_count target_count comma14.;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   retain m1 -1 error 0;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   attrib status_msg length=$ 32767;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   if source_count ne target_count then do;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   status_msg = cat('ERROR: Mismatch on ', strip(measure), ': Source count ', 
strip(putn(source_count, 'comma14.')), '; Target count: ', strip(putn(target_count, 'comma14.')), '.');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call symputx('status_msg', strip(status_msg), 'g');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   stop;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   end;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   else putlog 'Matched on ' measure +m1 ': rows ' source_count;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   run;

Matched on insert: rows 9,803,355
Matched on update: rows 0
NOTE: There were 2 observations read from the data set WORK.COUNT_SOURCE_V.
NOTE: There were 2 observations read from the data set WORK.COUNT_TARGET_V.
NOTE: DATA statement used (Total process time):
      real time           0.95 seconds
      cpu time            0.09 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: Deleting WORK.COUNT_SOURCE_V (memtype=VIEW).
NOTE: Deleting WORK.COUNT_TARGET_V (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
30                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.COUNT):   run;
MPRINT(CHANGE_EXTRACT.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.COUNT):   option nomprint nonotes
There are no observations in impraw.tdw_tbl_customer_new (dev_raw.tdw_tbl_customer_new) where record_effective_timestamp > 
record_expiry_timestamp.
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task6 = "Reconciliation", 
task6_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.75 seconds
      cpu time            0.55 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task7 = "Commit", 
task7_start_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.44 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute (refresh `dev_raw`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`tdw_tbl_customer` rename to 
`dev_raw`.`tdw_tbl_customer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`tdw_tbl_customer_new` rename to 
`dev_raw`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(drop table `dev_raw`.`tdw_tbl_customer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(refresh `dev_raw`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
31                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(compute stats `dev_raw`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           8.94 seconds
      cpu time            0.16 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9803355, object_key = 500, task7 = "Commit", 
task7_end_time = datetime() where object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.65 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.LOGGING):   select coalesce(max_timestamp, '1jan1800:0:0'dt) as max_timestamp format=datetime26.3 into 
:max_timestamp trimmed from connection to SASIOIMP (select max(effective_from) as max_timestamp from `dev_raw`.`tdw_tbl_customer`);
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.03 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   run;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   option nomprint nonotes
There are 9,803,355 observations in impraw.tdw_tbl_customer (dev_raw.tdw_tbl_customer) where update_object_run_key = 9093.
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set end_time = datetime(), records_written = 9803355, high_water_mark_value 
= "29OCT2019:20:54:48.950"dt, status = "Job Successful", status_message = "9,803,355 rows updated on tdw_tbl_customer" where 
object_run_key = 9093;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.91 seconds
32                                                         The SAS System                     Wednesday, 30 October 2019 11:10:00 AM

      cpu time            0.71 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_nr`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_chgt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customer_chgd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customer_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.64 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):  ;
845        
846        %rcSet(&syserr);
847        %rcSet(&sysrc);
848        %rcSet(&sqlrc);
849        
850        
851        
852        /** Step end Change Extract **/
853        
854        %let etls_endTime = %sysfunc(datetime(),datetime.);
855        
856        
857        
858        
859        %LET _CLIENTTASKLABEL=;
860        %LET _CLIENTPROCESSFLOWNAME=;
861        %LET _CLIENTPROJECTPATH=;
862        %LET _CLIENTPROJECTPATHHOST=;
863        %LET _CLIENTPROJECTNAME=;
864        %LET _SASPROGRAMFILE=;
865        %LET _SASPROGRAMFILEHOST=;
866        
867        ;*';*";*/;quit;run;
868        ODS _ALL_ CLOSE;
869        
870        
871        QUIT; RUN;
872        
