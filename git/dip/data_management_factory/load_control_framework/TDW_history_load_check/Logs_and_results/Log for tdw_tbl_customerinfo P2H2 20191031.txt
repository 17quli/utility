1                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1          ;*';*";*/;quit;run;
2          OPTIONS PAGENO=MIN;
3          %LET _CLIENTTASKLABEL='tdw_tbl_customerinfo P2H2 20191031';
4          %LET _CLIENTPROCESSFLOWNAME='Process Flow';
5          %LET _CLIENTPROJECTPATH='';
6          %LET _CLIENTPROJECTPATHHOST='';
7          %LET _CLIENTPROJECTNAME='';
8          %LET _SASPROGRAMFILE='H:\DIP Data Management\Load Control Framework\3.8\tdw_tbl_customerinfo P2H2 20191031.sas';
9          %LET _SASPROGRAMFILEHOST='IRDTS64';
10         
11         ODS _ALL_ CLOSE;
12         OPTIONS DEV=PNG;
13         FILENAME EGSR TEMP;
14         ODS tagsets.sasreport13(ID=EGSR) FILE=EGSR
15             STYLE=HTMLBlue
16             STYLESHEET=(URL="file:///H:/sso/sfw/sas_factory/940/x86/SASEnterpriseGuide/7.1/Styles/HTMLBlue.css")
17             NOGTITLE
18             NOGFOOTNOTE
19             GPATH=&sasworklocation
20             ENCODING=UTF8
21             options(rolap="on")
22         ;
NOTE: Writing TAGSETS.SASREPORT13(EGSR) Body file: EGSR
23         
24         /****************************************************************************
25          * Job:             tdw_tbl_customerinfo P2H2             A5IKCEC7.BR00004B *
26          * Description:                                                             *
27          *                                                                          *
28          * Metadata Server: ird10119au.vsp.sas.com                                  *
29          * Port:            8561                                                    *
30          * Location:        /IRD/DIP Data Management/5000 Processes/10 Raw          *
31          *                   Ingestion                                              *
32          *                                                                          *
33          * Server:          SASApp                                A5IKCEC7.AS000002 *
34          *                                                                          *
35          * Source Table:    TBL_CUSTOMERINFO -                    A5IKCEC7.BE00001Z *
36          *                   edwtdw.TBL_CUSTOMERINFO                                *
37          * Target Table:    tdw_tbl_customerinfo -                A5IKCEC7.BE00006U *
38          *                   impraw.tdw_tbl_customerinfo                            *
39          *                                                                          *
40          * Generated on:    Thursday, October 31, 2019 11:24:01 AM NZDT             *
41          * Generated by:    ird0nxa                                                 *
42          * Version:         SAS Data Integration Studio 4.903                       *
43          ****************************************************************************/
44         
45         /* Generate the process id for job  */
46         %put Process ID: &SYSJOBID;
Process ID: 70028
47         
48         /* General macro variables  */
49         %let jobID = %quote(A5IKCEC7.BR00004B);
50         %let etls_jobName = %nrquote(tdw_tbl_customerinfo P2H2);
51         %let etls_userID = %nrquote(ird0nxa);
52         
53         /* Setup to capture return codes  */
54         %global job_rc trans_rc sqlrc;
55         %let sysrc = 0;
56         %let job_rc = 0;
2                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

57         %let trans_rc = 0;
58         %let sqlrc = 0;
59         %global etls_stepStartTime;
60         /* initialize syserr to 0 */
61         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      user cpu time       0.00 seconds
      system cpu time     0.00 seconds
      memory              319.53k
      OS Memory           19108.00k
      Timestamp           31/10/2019 11:29:54 AM
      Step Count                        2  Switch Count  0
      Page Faults                       0
      Page Reclaims                     54
      Page Swaps                        0
      Voluntary Context Switches        0
      Involuntary Context Switches      0
      Block Input Operations            0
      Block Output Operations           0
      

62         
63         %macro rcSet(error);
64            %if (&error gt &trans_rc) %then
65               %let trans_rc = &error;
66            %if (&error gt &job_rc) %then
67               %let job_rc = &error;
68         %mend rcSet;
69         
70         %macro rcSetDS(error);
71            if &error gt input(symget('trans_rc'),12.) then
72               call symput('trans_rc',trim(left(put(&error,12.))));
73            if &error gt input(symget('job_rc'),12.) then
74               call symput('job_rc',trim(left(put(&error,12.))));
75         %mend rcSetDS;
76         
77         /* Create metadata macro variables */
78         %let IOMServer      = %nrquote(SASApp);
79         %let metaPort       = %nrquote(8561);
80         %let metaServer     = %nrquote(ird10119au.vsp.sas.com);
81         
82         /* Setup for capturing job status  */
83         %let etls_startTime = %sysfunc(datetime(),datetime.);
84         %let etls_recordsBefore = 0;
85         %let etls_recordsAfter = 0;
86         %let etls_lib = 0;
87         %let etls_table = 0;
88         
89         %global etls_debug;
90         %macro etls_setDebug;
91            %if %str(&etls_debug) ne 0 %then
92               OPTIONS MPRINT%str(;);
93         %mend;
94         %etls_setDebug;
95         
96         /*==========================================================================*
3                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

97          * Step:            Change Extract                        A5IKCEC7.BT0001F0 *
98          * Transform:       Change Extract                                          *
99          * Description:                                                             *
100         *                                                                          *
101         * Source Table:    TBL_CUSTOMERINFO -                    A5IKCEC7.BE00001Z *
102         *                   edwtdw.TBL_CUSTOMERINFO                                *
103         * Target Table:    tdw_tbl_customerinfo -                A5IKCEC7.BE00006U *
104         *                   impraw.tdw_tbl_customerinfo                            *
105         *==========================================================================*/
106        
107        %let transformID = %quote(A5IKCEC7.BT0001F0);
108        %let trans_rc = 0;
109        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
110        
111        /* Access the data for EDW TDW (edwtdw)  */
112        LIBNAME edwtdw ORACLE  DBCOMMIT=0  DBMAX_TEXT=32767  DEFER=YES  PRESERVE_COL_NAMES=YES  PRESERVE_TAB_NAMES=YES
112      ! READBUFF=20000  encoding="utf-8" dbclient_max_bytes=2  PATH="DIP_VIP.external"  SCHEMA=TDW  AUTHDOMAIN="edw_prod" ;
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref EDWTDW was successfully assigned as follows: 
      Engine:        ORACLE 
      Physical Name: DIP_VIP.external
113        %rcSet(&syslibrc);
114        
115        /* Access the data for DIP Impala RAW (impraw)  */
116        LIBNAME impraw SASIOIMP  DATABASE=dev_raw  DBMAX_TEXT=32767  DSN=ClouderaImpala64  SCHEMA=dev_raw ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPRAW was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
117        %rcSet(&syslibrc);
118        
119        %let SYSLAST = %nrquote(edwtdw.TBL_CUSTOMERINFO);
120        
121        %let _INPUT_count = 1;
122        %let _INPUT = edwtdw.TBL_CUSTOMERINFO;
123        %let _INPUT_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
123      ! PATH="DIP_VIP.external" AUTHDOMAIN="edw_prod"
124        ;
125        %let _INPUT_engine = ORACLE;
126        %let _INPUT_memtype = DATA;
127        %let _INPUT_options = %nrquote();
128        %let _INPUT_alter = %nrquote();
129        %let _INPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/TBL_CUSTOMERINFO%(Table%));
130        %let _INPUT_type = 1;
131        %let _INPUT_label = %nrquote();
132        
133        %let _Source = edwtdw.TBL_CUSTOMERINFO;
134        %let _Source_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
134      ! PATH="DIP_VIP.external" AUTHDOMAIN="edw_prod"
135        ;
136        %let _Source_engine = ORACLE;
137        %let _Source_memtype = DATA;
138        %let _Source_options = %nrquote();
139        %let _Source_alter = %nrquote();
140        %let _Source_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/EDW/EDW TDW/TBL_CUSTOMERINFO%(Table%));
141        %let _Source_type = 1;
142        %let _Source_label = %nrquote();
4                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

143        
144        %let _OUTPUT_count = 1;
145        %let _OUTPUT = impraw.tdw_tbl_customerinfo;
146        %let _OUTPUT_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
147        ;
148        %let _OUTPUT_engine = SASIOIMP;
149        %let _OUTPUT_memtype = DATA;
150        %let _OUTPUT_options = %nrquote();
151        %let _OUTPUT_alter = %nrquote();
152        %let _OUTPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/tdw_tbl_customerinfo%(Table%))
152      ! ;
153        %let _OUTPUT_type = 1;
154        %let _OUTPUT_label = %nrquote();
155        /* List of target columns to keep  */
156        %let _OUTPUT_keep = customer_key joint_customer_key prime_flag customer_type
157                customer_document_key folder_key default_flag profile_number
158                commence_date cease_date created_date name_key namekeyseq display_flag
159                formatted_flag name_type family_name middle_name first_name
160                name_control title suffix free_format_name list_format_name
161                additional_name additional_name_2 address_key address_key_sequence
162                address_type street_1 street_2 unit_type unit city county state zip
163                country attention locationcode urbanisation municipality district
164                subdistrict subprovince address_description list_format_address idkey
165                id_type ird_number formatted_id district_office
166                collect_district_office review_type customer_level
167                protected_data_source effective_from effective_to current_rec_flag
168                record_effective_timestamp record_expiry_timestamp record_active_flag
169                record_deleted_flag insert_object_run_key update_object_run_key;
170        %let _OUTPUT_col_count = 65;
171        %let _OUTPUT_col0_name = customer_key;
172        %let _OUTPUT_col0_table = impraw.tdw_tbl_customerinfo;
173        %let _OUTPUT_col0_length = 8;
174        %let _OUTPUT_col0_type = ;
175        %let _OUTPUT_col0_format = 20.;
176        %let _OUTPUT_col0_informat = 20.;
177        %let _OUTPUT_col0_label = %nrquote(customer_key);
178        %let _OUTPUT_col0_input0 = CUSTOMER_KEY;
179        %let _OUTPUT_col0_input0_table = edwtdw.TBL_CUSTOMERINFO;
180        %let _OUTPUT_col0_exp = ;
181        %let _OUTPUT_col0_input = CUSTOMER_KEY;
182        %let _OUTPUT_col0_input_count = 1;
183        %let _OUTPUT_col1_name = joint_customer_key;
184        %let _OUTPUT_col1_table = impraw.tdw_tbl_customerinfo;
185        %let _OUTPUT_col1_length = 8;
186        %let _OUTPUT_col1_type = ;
187        %let _OUTPUT_col1_format = 20.;
188        %let _OUTPUT_col1_informat = 20.;
189        %let _OUTPUT_col1_label = %nrquote(joint_customer_key);
190        %let _OUTPUT_col1_input0 = JOINT_CUSTOMER_KEY;
191        %let _OUTPUT_col1_input0_table = edwtdw.TBL_CUSTOMERINFO;
192        %let _OUTPUT_col1_exp = ;
193        %let _OUTPUT_col1_input = JOINT_CUSTOMER_KEY;
194        %let _OUTPUT_col1_input_count = 1;
195        %let _OUTPUT_col2_name = prime_flag;
196        %let _OUTPUT_col2_table = impraw.tdw_tbl_customerinfo;
197        %let _OUTPUT_col2_length = 10;
198        %let _OUTPUT_col2_type = $;
199        %let _OUTPUT_col2_format = $10.;
5                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

200        %let _OUTPUT_col2_informat = $10.;
201        %let _OUTPUT_col2_label = %nrquote(prime_flag);
202        %let _OUTPUT_col2_input0 = PRIME_FLAG;
203        %let _OUTPUT_col2_input0_table = edwtdw.TBL_CUSTOMERINFO;
204        %let _OUTPUT_col2_exp = ;
205        %let _OUTPUT_col2_input = PRIME_FLAG;
206        %let _OUTPUT_col2_input_count = 1;
207        %let _OUTPUT_col3_name = customer_type;
208        %let _OUTPUT_col3_table = impraw.tdw_tbl_customerinfo;
209        %let _OUTPUT_col3_length = 12;
210        %let _OUTPUT_col3_type = $;
211        %let _OUTPUT_col3_format = $12.;
212        %let _OUTPUT_col3_informat = $12.;
213        %let _OUTPUT_col3_label = %nrquote(customer_type);
214        %let _OUTPUT_col3_input0 = CUSTOMER_TYPE;
215        %let _OUTPUT_col3_input0_table = edwtdw.TBL_CUSTOMERINFO;
216        %let _OUTPUT_col3_exp = ;
217        %let _OUTPUT_col3_input = CUSTOMER_TYPE;
218        %let _OUTPUT_col3_input_count = 1;
219        %let _OUTPUT_col4_name = customer_document_key;
220        %let _OUTPUT_col4_table = impraw.tdw_tbl_customerinfo;
221        %let _OUTPUT_col4_length = 8;
222        %let _OUTPUT_col4_type = ;
223        %let _OUTPUT_col4_format = 20.;
224        %let _OUTPUT_col4_informat = 20.;
225        %let _OUTPUT_col4_label = %nrquote(customer_document_key);
226        %let _OUTPUT_col4_input0 = CUSTOMER_DOCUMENT_KEY;
227        %let _OUTPUT_col4_input0_table = edwtdw.TBL_CUSTOMERINFO;
228        %let _OUTPUT_col4_exp = ;
229        %let _OUTPUT_col4_input = CUSTOMER_DOCUMENT_KEY;
230        %let _OUTPUT_col4_input_count = 1;
231        %let _OUTPUT_col5_name = folder_key;
232        %let _OUTPUT_col5_table = impraw.tdw_tbl_customerinfo;
233        %let _OUTPUT_col5_length = 8;
234        %let _OUTPUT_col5_type = ;
235        %let _OUTPUT_col5_format = 20.;
236        %let _OUTPUT_col5_informat = 20.;
237        %let _OUTPUT_col5_label = %nrquote(folder_key);
238        %let _OUTPUT_col5_input0 = FOLDER_KEY;
239        %let _OUTPUT_col5_input0_table = edwtdw.TBL_CUSTOMERINFO;
240        %let _OUTPUT_col5_exp = ;
241        %let _OUTPUT_col5_input = FOLDER_KEY;
242        %let _OUTPUT_col5_input_count = 1;
243        %let _OUTPUT_col6_name = default_flag;
244        %let _OUTPUT_col6_table = impraw.tdw_tbl_customerinfo;
245        %let _OUTPUT_col6_length = 10;
246        %let _OUTPUT_col6_type = $;
247        %let _OUTPUT_col6_format = $10.;
248        %let _OUTPUT_col6_informat = $10.;
249        %let _OUTPUT_col6_label = %nrquote(default_flag);
250        %let _OUTPUT_col6_input0 = DEFAULT_FLAG;
251        %let _OUTPUT_col6_input0_table = edwtdw.TBL_CUSTOMERINFO;
252        %let _OUTPUT_col6_exp = ;
253        %let _OUTPUT_col6_input = DEFAULT_FLAG;
254        %let _OUTPUT_col6_input_count = 1;
255        %let _OUTPUT_col7_name = profile_number;
256        %let _OUTPUT_col7_table = impraw.tdw_tbl_customerinfo;
257        %let _OUTPUT_col7_length = 8;
6                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

258        %let _OUTPUT_col7_type = ;
259        %let _OUTPUT_col7_format = 20.;
260        %let _OUTPUT_col7_informat = 20.;
261        %let _OUTPUT_col7_label = %nrquote(profile_number);
262        %let _OUTPUT_col7_input0 = PROFILE_NUMBER;
263        %let _OUTPUT_col7_input0_table = edwtdw.TBL_CUSTOMERINFO;
264        %let _OUTPUT_col7_exp = ;
265        %let _OUTPUT_col7_input = PROFILE_NUMBER;
266        %let _OUTPUT_col7_input_count = 1;
267        %let _OUTPUT_col8_name = commence_date;
268        %let _OUTPUT_col8_table = impraw.tdw_tbl_customerinfo;
269        %let _OUTPUT_col8_length = 8;
270        %let _OUTPUT_col8_type = ;
271        %let _OUTPUT_col8_format = DATETIME29.9;
272        %let _OUTPUT_col8_informat = DATETIME29.9;
273        %let _OUTPUT_col8_label = %nrquote(commence_date);
274        %let _OUTPUT_col8_input0 = COMMENCE_DATE;
275        %let _OUTPUT_col8_input0_table = edwtdw.TBL_CUSTOMERINFO;
276        %let _OUTPUT_col8_exp = ;
277        %let _OUTPUT_col8_input = COMMENCE_DATE;
278        %let _OUTPUT_col8_input_count = 1;
279        %let _OUTPUT_col9_name = cease_date;
280        %let _OUTPUT_col9_table = impraw.tdw_tbl_customerinfo;
281        %let _OUTPUT_col9_length = 8;
282        %let _OUTPUT_col9_type = ;
283        %let _OUTPUT_col9_format = DATETIME29.9;
284        %let _OUTPUT_col9_informat = DATETIME29.9;
285        %let _OUTPUT_col9_label = %nrquote(cease_date);
286        %let _OUTPUT_col9_input0 = CEASE_DATE;
287        %let _OUTPUT_col9_input0_table = edwtdw.TBL_CUSTOMERINFO;
288        %let _OUTPUT_col9_exp = ;
289        %let _OUTPUT_col9_input = CEASE_DATE;
290        %let _OUTPUT_col9_input_count = 1;
291        %let _OUTPUT_col10_name = created_date;
292        %let _OUTPUT_col10_table = impraw.tdw_tbl_customerinfo;
293        %let _OUTPUT_col10_length = 8;
294        %let _OUTPUT_col10_type = ;
295        %let _OUTPUT_col10_format = DATETIME29.9;
296        %let _OUTPUT_col10_informat = DATETIME29.9;
297        %let _OUTPUT_col10_label = %nrquote(created_date);
298        %let _OUTPUT_col10_input0 = CREATED_DATE;
299        %let _OUTPUT_col10_input0_table = edwtdw.TBL_CUSTOMERINFO;
300        %let _OUTPUT_col10_exp = ;
301        %let _OUTPUT_col10_input = CREATED_DATE;
302        %let _OUTPUT_col10_input_count = 1;
303        %let _OUTPUT_col11_name = name_key;
304        %let _OUTPUT_col11_table = impraw.tdw_tbl_customerinfo;
305        %let _OUTPUT_col11_length = 8;
306        %let _OUTPUT_col11_type = ;
307        %let _OUTPUT_col11_format = 20.;
308        %let _OUTPUT_col11_informat = 20.;
309        %let _OUTPUT_col11_label = %nrquote(name_key);
310        %let _OUTPUT_col11_input0 = NAME_KEY;
311        %let _OUTPUT_col11_input0_table = edwtdw.TBL_CUSTOMERINFO;
312        %let _OUTPUT_col11_exp = ;
313        %let _OUTPUT_col11_input = NAME_KEY;
314        %let _OUTPUT_col11_input_count = 1;
315        %let _OUTPUT_col12_name = namekeyseq;
7                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

316        %let _OUTPUT_col12_table = impraw.tdw_tbl_customerinfo;
317        %let _OUTPUT_col12_length = 8;
318        %let _OUTPUT_col12_type = ;
319        %let _OUTPUT_col12_format = 20.;
320        %let _OUTPUT_col12_informat = 20.;
321        %let _OUTPUT_col12_label = %nrquote(namekeyseq);
322        %let _OUTPUT_col12_input0 = NAMEKEYSEQ;
323        %let _OUTPUT_col12_input0_table = edwtdw.TBL_CUSTOMERINFO;
324        %let _OUTPUT_col12_exp = ;
325        %let _OUTPUT_col12_input = NAMEKEYSEQ;
326        %let _OUTPUT_col12_input_count = 1;
327        %let _OUTPUT_col13_name = display_flag;
328        %let _OUTPUT_col13_table = impraw.tdw_tbl_customerinfo;
329        %let _OUTPUT_col13_length = 24;
330        %let _OUTPUT_col13_type = $;
331        %let _OUTPUT_col13_format = $24.;
332        %let _OUTPUT_col13_informat = $24.;
333        %let _OUTPUT_col13_label = %nrquote(display_flag);
334        %let _OUTPUT_col13_input0 = DISPLAY_FLAG;
335        %let _OUTPUT_col13_input0_table = edwtdw.TBL_CUSTOMERINFO;
336        %let _OUTPUT_col13_exp = ;
337        %let _OUTPUT_col13_input = DISPLAY_FLAG;
338        %let _OUTPUT_col13_input_count = 1;
339        %let _OUTPUT_col14_name = formatted_flag;
340        %let _OUTPUT_col14_table = impraw.tdw_tbl_customerinfo;
341        %let _OUTPUT_col14_length = 10;
342        %let _OUTPUT_col14_type = $;
343        %let _OUTPUT_col14_format = $10.;
344        %let _OUTPUT_col14_informat = $10.;
345        %let _OUTPUT_col14_label = %nrquote(formatted_flag);
346        %let _OUTPUT_col14_input0 = FORMATTED_FLAG;
347        %let _OUTPUT_col14_input0_table = edwtdw.TBL_CUSTOMERINFO;
348        %let _OUTPUT_col14_exp = ;
349        %let _OUTPUT_col14_input = FORMATTED_FLAG;
350        %let _OUTPUT_col14_input_count = 1;
351        %let _OUTPUT_col15_name = name_type;
352        %let _OUTPUT_col15_table = impraw.tdw_tbl_customerinfo;
353        %let _OUTPUT_col15_length = 40;
354        %let _OUTPUT_col15_type = $;
355        %let _OUTPUT_col15_format = $40.;
356        %let _OUTPUT_col15_informat = $40.;
357        %let _OUTPUT_col15_label = %nrquote(name_type);
358        %let _OUTPUT_col15_input0 = NAME_TYPE;
359        %let _OUTPUT_col15_input0_table = edwtdw.TBL_CUSTOMERINFO;
360        %let _OUTPUT_col15_exp = ;
361        %let _OUTPUT_col15_input = NAME_TYPE;
362        %let _OUTPUT_col15_input_count = 1;
363        %let _OUTPUT_col16_name = family_name;
364        %let _OUTPUT_col16_table = impraw.tdw_tbl_customerinfo;
365        %let _OUTPUT_col16_length = 510;
366        %let _OUTPUT_col16_type = $;
367        %let _OUTPUT_col16_format = $510.;
368        %let _OUTPUT_col16_informat = $510.;
369        %let _OUTPUT_col16_label = %nrquote(family_name);
370        %let _OUTPUT_col16_input0 = FAMILY_NAME;
371        %let _OUTPUT_col16_input0_table = edwtdw.TBL_CUSTOMERINFO;
372        %let _OUTPUT_col16_exp = ;
373        %let _OUTPUT_col16_input = FAMILY_NAME;
8                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

374        %let _OUTPUT_col16_input_count = 1;
375        %let _OUTPUT_col17_name = middle_name;
376        %let _OUTPUT_col17_table = impraw.tdw_tbl_customerinfo;
377        %let _OUTPUT_col17_length = 100;
378        %let _OUTPUT_col17_type = $;
379        %let _OUTPUT_col17_format = $100.;
380        %let _OUTPUT_col17_informat = $100.;
381        %let _OUTPUT_col17_label = %nrquote(middle_name);
382        %let _OUTPUT_col17_input0 = MIDDLE_NAME;
383        %let _OUTPUT_col17_input0_table = edwtdw.TBL_CUSTOMERINFO;
384        %let _OUTPUT_col17_exp = ;
385        %let _OUTPUT_col17_input = MIDDLE_NAME;
386        %let _OUTPUT_col17_input_count = 1;
387        %let _OUTPUT_col18_name = first_name;
388        %let _OUTPUT_col18_table = impraw.tdw_tbl_customerinfo;
389        %let _OUTPUT_col18_length = 100;
390        %let _OUTPUT_col18_type = $;
391        %let _OUTPUT_col18_format = $100.;
392        %let _OUTPUT_col18_informat = $100.;
393        %let _OUTPUT_col18_label = %nrquote(first_name);
394        %let _OUTPUT_col18_input0 = FIRST_NAME;
395        %let _OUTPUT_col18_input0_table = edwtdw.TBL_CUSTOMERINFO;
396        %let _OUTPUT_col18_exp = ;
397        %let _OUTPUT_col18_input = FIRST_NAME;
398        %let _OUTPUT_col18_input_count = 1;
399        %let _OUTPUT_col19_name = name_control;
400        %let _OUTPUT_col19_table = impraw.tdw_tbl_customerinfo;
401        %let _OUTPUT_col19_length = 20;
402        %let _OUTPUT_col19_type = $;
403        %let _OUTPUT_col19_format = $20.;
404        %let _OUTPUT_col19_informat = $20.;
405        %let _OUTPUT_col19_label = %nrquote(name_control);
406        %let _OUTPUT_col19_input0 = NAME_CONTROL;
407        %let _OUTPUT_col19_input0_table = edwtdw.TBL_CUSTOMERINFO;
408        %let _OUTPUT_col19_exp = ;
409        %let _OUTPUT_col19_input = NAME_CONTROL;
410        %let _OUTPUT_col19_input_count = 1;
411        %let _OUTPUT_col20_name = title;
412        %let _OUTPUT_col20_table = impraw.tdw_tbl_customerinfo;
413        %let _OUTPUT_col20_length = 20;
414        %let _OUTPUT_col20_type = $;
415        %let _OUTPUT_col20_format = $20.;
416        %let _OUTPUT_col20_informat = $20.;
417        %let _OUTPUT_col20_label = %nrquote(title);
418        %let _OUTPUT_col20_input0 = TITLE;
419        %let _OUTPUT_col20_input0_table = edwtdw.TBL_CUSTOMERINFO;
420        %let _OUTPUT_col20_exp = ;
421        %let _OUTPUT_col20_input = TITLE;
422        %let _OUTPUT_col20_input_count = 1;
423        %let _OUTPUT_col21_name = suffix;
424        %let _OUTPUT_col21_table = impraw.tdw_tbl_customerinfo;
425        %let _OUTPUT_col21_length = 20;
426        %let _OUTPUT_col21_type = $;
427        %let _OUTPUT_col21_format = $20.;
428        %let _OUTPUT_col21_informat = $20.;
429        %let _OUTPUT_col21_label = %nrquote(suffix);
430        %let _OUTPUT_col21_input0 = SUFFIX;
431        %let _OUTPUT_col21_input0_table = edwtdw.TBL_CUSTOMERINFO;
9                                                          The SAS System                      Thursday, 31 October 2019 11:29:00 AM

432        %let _OUTPUT_col21_exp = ;
433        %let _OUTPUT_col21_input = SUFFIX;
434        %let _OUTPUT_col21_input_count = 1;
435        %let _OUTPUT_col22_name = free_format_name;
436        %let _OUTPUT_col22_table = impraw.tdw_tbl_customerinfo;
437        %let _OUTPUT_col22_length = 510;
438        %let _OUTPUT_col22_type = $;
439        %let _OUTPUT_col22_format = $510.;
440        %let _OUTPUT_col22_informat = $510.;
441        %let _OUTPUT_col22_label = %nrquote(free_format_name);
442        %let _OUTPUT_col22_input0 = FREE_FORMAT_NAME;
443        %let _OUTPUT_col22_input0_table = edwtdw.TBL_CUSTOMERINFO;
444        %let _OUTPUT_col22_exp = ;
445        %let _OUTPUT_col22_input = FREE_FORMAT_NAME;
446        %let _OUTPUT_col22_input_count = 1;
447        %let _OUTPUT_col23_name = list_format_name;
448        %let _OUTPUT_col23_table = impraw.tdw_tbl_customerinfo;
449        %let _OUTPUT_col23_length = 510;
450        %let _OUTPUT_col23_type = $;
451        %let _OUTPUT_col23_format = $510.;
452        %let _OUTPUT_col23_informat = $510.;
453        %let _OUTPUT_col23_label = %nrquote(list_format_name);
454        %let _OUTPUT_col23_input0 = LIST_FORMAT_NAME;
455        %let _OUTPUT_col23_input0_table = edwtdw.TBL_CUSTOMERINFO;
456        %let _OUTPUT_col23_exp = ;
457        %let _OUTPUT_col23_input = LIST_FORMAT_NAME;
458        %let _OUTPUT_col23_input_count = 1;
459        %let _OUTPUT_col24_name = additional_name;
460        %let _OUTPUT_col24_table = impraw.tdw_tbl_customerinfo;
461        %let _OUTPUT_col24_length = 510;
462        %let _OUTPUT_col24_type = $;
463        %let _OUTPUT_col24_format = $510.;
464        %let _OUTPUT_col24_informat = $510.;
465        %let _OUTPUT_col24_label = %nrquote(additional_name);
466        %let _OUTPUT_col24_input0 = ADDITIONAL_NAME;
467        %let _OUTPUT_col24_input0_table = edwtdw.TBL_CUSTOMERINFO;
468        %let _OUTPUT_col24_exp = ;
469        %let _OUTPUT_col24_input = ADDITIONAL_NAME;
470        %let _OUTPUT_col24_input_count = 1;
471        %let _OUTPUT_col25_name = additional_name_2;
472        %let _OUTPUT_col25_table = impraw.tdw_tbl_customerinfo;
473        %let _OUTPUT_col25_length = 510;
474        %let _OUTPUT_col25_type = $;
475        %let _OUTPUT_col25_format = $510.;
476        %let _OUTPUT_col25_informat = $510.;
477        %let _OUTPUT_col25_label = %nrquote(additional_name_2);
478        %let _OUTPUT_col25_input0 = ADDITIONAL_NAME_2;
479        %let _OUTPUT_col25_input0_table = edwtdw.TBL_CUSTOMERINFO;
480        %let _OUTPUT_col25_exp = ;
481        %let _OUTPUT_col25_input = ADDITIONAL_NAME_2;
482        %let _OUTPUT_col25_input_count = 1;
483        %let _OUTPUT_col26_name = address_key;
484        %let _OUTPUT_col26_table = impraw.tdw_tbl_customerinfo;
485        %let _OUTPUT_col26_length = 8;
486        %let _OUTPUT_col26_type = ;
487        %let _OUTPUT_col26_format = 20.;
488        %let _OUTPUT_col26_informat = 20.;
489        %let _OUTPUT_col26_label = %nrquote(address_key);
10                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

490        %let _OUTPUT_col26_input0 = ADDRESS_KEY;
491        %let _OUTPUT_col26_input0_table = edwtdw.TBL_CUSTOMERINFO;
492        %let _OUTPUT_col26_exp = ;
493        %let _OUTPUT_col26_input = ADDRESS_KEY;
494        %let _OUTPUT_col26_input_count = 1;
495        %let _OUTPUT_col27_name = address_key_sequence;
496        %let _OUTPUT_col27_table = impraw.tdw_tbl_customerinfo;
497        %let _OUTPUT_col27_length = 8;
498        %let _OUTPUT_col27_type = ;
499        %let _OUTPUT_col27_format = 20.;
500        %let _OUTPUT_col27_informat = 20.;
501        %let _OUTPUT_col27_label = %nrquote(address_key_sequence);
502        %let _OUTPUT_col27_input0 = ADDRESS_KEY_SEQUENCE;
503        %let _OUTPUT_col27_input0_table = edwtdw.TBL_CUSTOMERINFO;
504        %let _OUTPUT_col27_exp = ;
505        %let _OUTPUT_col27_input = ADDRESS_KEY_SEQUENCE;
506        %let _OUTPUT_col27_input_count = 1;
507        %let _OUTPUT_col28_name = address_type;
508        %let _OUTPUT_col28_table = impraw.tdw_tbl_customerinfo;
509        %let _OUTPUT_col28_length = 40;
510        %let _OUTPUT_col28_type = $;
511        %let _OUTPUT_col28_format = $40.;
512        %let _OUTPUT_col28_informat = $40.;
513        %let _OUTPUT_col28_label = %nrquote(address_type);
514        %let _OUTPUT_col28_input0 = ADDRESS_TYPE;
515        %let _OUTPUT_col28_input0_table = edwtdw.TBL_CUSTOMERINFO;
516        %let _OUTPUT_col28_exp = ;
517        %let _OUTPUT_col28_input = ADDRESS_TYPE;
518        %let _OUTPUT_col28_input_count = 1;
519        %let _OUTPUT_col29_name = street_1;
520        %let _OUTPUT_col29_table = impraw.tdw_tbl_customerinfo;
521        %let _OUTPUT_col29_length = 510;
522        %let _OUTPUT_col29_type = $;
523        %let _OUTPUT_col29_format = $510.;
524        %let _OUTPUT_col29_informat = $510.;
525        %let _OUTPUT_col29_label = %nrquote(street_1);
526        %let _OUTPUT_col29_input0 = STREET_1;
527        %let _OUTPUT_col29_input0_table = edwtdw.TBL_CUSTOMERINFO;
528        %let _OUTPUT_col29_exp = ;
529        %let _OUTPUT_col29_input = STREET_1;
530        %let _OUTPUT_col29_input_count = 1;
531        %let _OUTPUT_col30_name = street_2;
532        %let _OUTPUT_col30_table = impraw.tdw_tbl_customerinfo;
533        %let _OUTPUT_col30_length = 510;
534        %let _OUTPUT_col30_type = $;
535        %let _OUTPUT_col30_format = $510.;
536        %let _OUTPUT_col30_informat = $510.;
537        %let _OUTPUT_col30_label = %nrquote(street_2);
538        %let _OUTPUT_col30_input0 = STREET_2;
539        %let _OUTPUT_col30_input0_table = edwtdw.TBL_CUSTOMERINFO;
540        %let _OUTPUT_col30_exp = ;
541        %let _OUTPUT_col30_input = STREET_2;
542        %let _OUTPUT_col30_input_count = 1;
543        %let _OUTPUT_col31_name = unit_type;
544        %let _OUTPUT_col31_table = impraw.tdw_tbl_customerinfo;
545        %let _OUTPUT_col31_length = 100;
546        %let _OUTPUT_col31_type = $;
547        %let _OUTPUT_col31_format = $100.;
11                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

548        %let _OUTPUT_col31_informat = $100.;
549        %let _OUTPUT_col31_label = %nrquote(unit_type);
550        %let _OUTPUT_col31_input0 = UNIT_TYPE;
551        %let _OUTPUT_col31_input0_table = edwtdw.TBL_CUSTOMERINFO;
552        %let _OUTPUT_col31_exp = ;
553        %let _OUTPUT_col31_input = UNIT_TYPE;
554        %let _OUTPUT_col31_input_count = 1;
555        %let _OUTPUT_col32_name = unit;
556        %let _OUTPUT_col32_table = impraw.tdw_tbl_customerinfo;
557        %let _OUTPUT_col32_length = 60;
558        %let _OUTPUT_col32_type = $;
559        %let _OUTPUT_col32_format = $60.;
560        %let _OUTPUT_col32_informat = $60.;
561        %let _OUTPUT_col32_label = %nrquote(unit);
562        %let _OUTPUT_col32_input0 = UNIT;
563        %let _OUTPUT_col32_input0_table = edwtdw.TBL_CUSTOMERINFO;
564        %let _OUTPUT_col32_exp = ;
565        %let _OUTPUT_col32_input = UNIT;
566        %let _OUTPUT_col32_input_count = 1;
567        %let _OUTPUT_col33_name = city;
568        %let _OUTPUT_col33_table = impraw.tdw_tbl_customerinfo;
569        %let _OUTPUT_col33_length = 200;
570        %let _OUTPUT_col33_type = $;
571        %let _OUTPUT_col33_format = $200.;
572        %let _OUTPUT_col33_informat = $200.;
573        %let _OUTPUT_col33_label = %nrquote(city);
574        %let _OUTPUT_col33_input0 = CITY;
575        %let _OUTPUT_col33_input0_table = edwtdw.TBL_CUSTOMERINFO;
576        %let _OUTPUT_col33_exp = ;
577        %let _OUTPUT_col33_input = CITY;
578        %let _OUTPUT_col33_input_count = 1;
579        %let _OUTPUT_col34_name = county;
580        %let _OUTPUT_col34_table = impraw.tdw_tbl_customerinfo;
581        %let _OUTPUT_col34_length = 12;
582        %let _OUTPUT_col34_type = $;
583        %let _OUTPUT_col34_format = $12.;
584        %let _OUTPUT_col34_informat = $12.;
585        %let _OUTPUT_col34_label = %nrquote(county);
586        %let _OUTPUT_col34_input0 = COUNTY;
587        %let _OUTPUT_col34_input0_table = edwtdw.TBL_CUSTOMERINFO;
588        %let _OUTPUT_col34_exp = ;
589        %let _OUTPUT_col34_input = COUNTY;
590        %let _OUTPUT_col34_input_count = 1;
591        %let _OUTPUT_col35_name = state;
592        %let _OUTPUT_col35_table = impraw.tdw_tbl_customerinfo;
593        %let _OUTPUT_col35_length = 12;
594        %let _OUTPUT_col35_type = $;
595        %let _OUTPUT_col35_format = $12.;
596        %let _OUTPUT_col35_informat = $12.;
597        %let _OUTPUT_col35_label = %nrquote(state);
598        %let _OUTPUT_col35_input0 = STATE;
599        %let _OUTPUT_col35_input0_table = edwtdw.TBL_CUSTOMERINFO;
600        %let _OUTPUT_col35_exp = ;
601        %let _OUTPUT_col35_input = STATE;
602        %let _OUTPUT_col35_input_count = 1;
603        %let _OUTPUT_col36_name = zip;
604        %let _OUTPUT_col36_table = impraw.tdw_tbl_customerinfo;
605        %let _OUTPUT_col36_length = 60;
12                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

606        %let _OUTPUT_col36_type = $;
607        %let _OUTPUT_col36_format = $60.;
608        %let _OUTPUT_col36_informat = $60.;
609        %let _OUTPUT_col36_label = %nrquote(zip);
610        %let _OUTPUT_col36_input0 = ZIP;
611        %let _OUTPUT_col36_input0_table = edwtdw.TBL_CUSTOMERINFO;
612        %let _OUTPUT_col36_exp = ;
613        %let _OUTPUT_col36_input = ZIP;
614        %let _OUTPUT_col36_input_count = 1;
615        %let _OUTPUT_col37_name = country;
616        %let _OUTPUT_col37_table = impraw.tdw_tbl_customerinfo;
617        %let _OUTPUT_col37_length = 12;
618        %let _OUTPUT_col37_type = $;
619        %let _OUTPUT_col37_format = $12.;
620        %let _OUTPUT_col37_informat = $12.;
621        %let _OUTPUT_col37_label = %nrquote(country);
622        %let _OUTPUT_col37_input0 = COUNTRY;
623        %let _OUTPUT_col37_input0_table = edwtdw.TBL_CUSTOMERINFO;
624        %let _OUTPUT_col37_exp = ;
625        %let _OUTPUT_col37_input = COUNTRY;
626        %let _OUTPUT_col37_input_count = 1;
627        %let _OUTPUT_col38_name = attention;
628        %let _OUTPUT_col38_table = impraw.tdw_tbl_customerinfo;
629        %let _OUTPUT_col38_length = 510;
630        %let _OUTPUT_col38_type = $;
631        %let _OUTPUT_col38_format = $510.;
632        %let _OUTPUT_col38_informat = $510.;
633        %let _OUTPUT_col38_label = %nrquote(attention);
634        %let _OUTPUT_col38_input0 = ATTENTION;
635        %let _OUTPUT_col38_input0_table = edwtdw.TBL_CUSTOMERINFO;
636        %let _OUTPUT_col38_exp = ;
637        %let _OUTPUT_col38_input = ATTENTION;
638        %let _OUTPUT_col38_input_count = 1;
639        %let _OUTPUT_col39_name = locationcode;
640        %let _OUTPUT_col39_table = impraw.tdw_tbl_customerinfo;
641        %let _OUTPUT_col39_length = 60;
642        %let _OUTPUT_col39_type = $;
643        %let _OUTPUT_col39_format = $60.;
644        %let _OUTPUT_col39_informat = $60.;
645        %let _OUTPUT_col39_label = %nrquote(locationcode);
646        %let _OUTPUT_col39_input0 = LOCATIONCODE;
647        %let _OUTPUT_col39_input0_table = edwtdw.TBL_CUSTOMERINFO;
648        %let _OUTPUT_col39_exp = ;
649        %let _OUTPUT_col39_input = LOCATIONCODE;
650        %let _OUTPUT_col39_input_count = 1;
651        %let _OUTPUT_col40_name = urbanisation;
652        %let _OUTPUT_col40_table = impraw.tdw_tbl_customerinfo;
653        %let _OUTPUT_col40_length = 100;
654        %let _OUTPUT_col40_type = $;
655        %let _OUTPUT_col40_format = $100.;
656        %let _OUTPUT_col40_informat = $100.;
657        %let _OUTPUT_col40_label = %nrquote(urbanisation);
658        %let _OUTPUT_col40_input0 = URBANISATION;
659        %let _OUTPUT_col40_input0_table = edwtdw.TBL_CUSTOMERINFO;
660        %let _OUTPUT_col40_exp = ;
661        %let _OUTPUT_col40_input = URBANISATION;
662        %let _OUTPUT_col40_input_count = 1;
663        %let _OUTPUT_col41_name = municipality;
13                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

664        %let _OUTPUT_col41_table = impraw.tdw_tbl_customerinfo;
665        %let _OUTPUT_col41_length = 60;
666        %let _OUTPUT_col41_type = $;
667        %let _OUTPUT_col41_format = $60.;
668        %let _OUTPUT_col41_informat = $60.;
669        %let _OUTPUT_col41_label = %nrquote(municipality);
670        %let _OUTPUT_col41_input0 = MUNICIPALITY;
671        %let _OUTPUT_col41_input0_table = edwtdw.TBL_CUSTOMERINFO;
672        %let _OUTPUT_col41_exp = ;
673        %let _OUTPUT_col41_input = MUNICIPALITY;
674        %let _OUTPUT_col41_input_count = 1;
675        %let _OUTPUT_col42_name = district;
676        %let _OUTPUT_col42_table = impraw.tdw_tbl_customerinfo;
677        %let _OUTPUT_col42_length = 60;
678        %let _OUTPUT_col42_type = $;
679        %let _OUTPUT_col42_format = $60.;
680        %let _OUTPUT_col42_informat = $60.;
681        %let _OUTPUT_col42_label = %nrquote(district);
682        %let _OUTPUT_col42_input0 = DISTRICT;
683        %let _OUTPUT_col42_input0_table = edwtdw.TBL_CUSTOMERINFO;
684        %let _OUTPUT_col42_exp = ;
685        %let _OUTPUT_col42_input = DISTRICT;
686        %let _OUTPUT_col42_input_count = 1;
687        %let _OUTPUT_col43_name = subdistrict;
688        %let _OUTPUT_col43_table = impraw.tdw_tbl_customerinfo;
689        %let _OUTPUT_col43_length = 60;
690        %let _OUTPUT_col43_type = $;
691        %let _OUTPUT_col43_format = $60.;
692        %let _OUTPUT_col43_informat = $60.;
693        %let _OUTPUT_col43_label = %nrquote(subdistrict);
694        %let _OUTPUT_col43_input0 = SUBDISTRICT;
695        %let _OUTPUT_col43_input0_table = edwtdw.TBL_CUSTOMERINFO;
696        %let _OUTPUT_col43_exp = ;
697        %let _OUTPUT_col43_input = SUBDISTRICT;
698        %let _OUTPUT_col43_input_count = 1;
699        %let _OUTPUT_col44_name = subprovince;
700        %let _OUTPUT_col44_table = impraw.tdw_tbl_customerinfo;
701        %let _OUTPUT_col44_length = 100;
702        %let _OUTPUT_col44_type = $;
703        %let _OUTPUT_col44_format = $100.;
704        %let _OUTPUT_col44_informat = $100.;
705        %let _OUTPUT_col44_label = %nrquote(subprovince);
706        %let _OUTPUT_col44_input0 = SUBPROVINCE;
707        %let _OUTPUT_col44_input0_table = edwtdw.TBL_CUSTOMERINFO;
708        %let _OUTPUT_col44_exp = ;
709        %let _OUTPUT_col44_input = SUBPROVINCE;
710        %let _OUTPUT_col44_input_count = 1;
711        %let _OUTPUT_col45_name = address_description;
712        %let _OUTPUT_col45_table = impraw.tdw_tbl_customerinfo;
713        %let _OUTPUT_col45_length = 510;
714        %let _OUTPUT_col45_type = $;
715        %let _OUTPUT_col45_format = $510.;
716        %let _OUTPUT_col45_informat = $510.;
717        %let _OUTPUT_col45_label = %nrquote(address_description);
718        %let _OUTPUT_col45_input0 = ADDRESS_DESCRIPTION;
719        %let _OUTPUT_col45_input0_table = edwtdw.TBL_CUSTOMERINFO;
720        %let _OUTPUT_col45_exp = ;
721        %let _OUTPUT_col45_input = ADDRESS_DESCRIPTION;
14                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

722        %let _OUTPUT_col45_input_count = 1;
723        %let _OUTPUT_col46_name = list_format_address;
724        %let _OUTPUT_col46_table = impraw.tdw_tbl_customerinfo;
725        %let _OUTPUT_col46_length = 510;
726        %let _OUTPUT_col46_type = $;
727        %let _OUTPUT_col46_format = $510.;
728        %let _OUTPUT_col46_informat = $510.;
729        %let _OUTPUT_col46_label = %nrquote(list_format_address);
730        %let _OUTPUT_col46_input0 = LIST_FORMAT_ADDRESS;
731        %let _OUTPUT_col46_input0_table = edwtdw.TBL_CUSTOMERINFO;
732        %let _OUTPUT_col46_exp = ;
733        %let _OUTPUT_col46_input = LIST_FORMAT_ADDRESS;
734        %let _OUTPUT_col46_input_count = 1;
735        %let _OUTPUT_col47_name = idkey;
736        %let _OUTPUT_col47_table = impraw.tdw_tbl_customerinfo;
737        %let _OUTPUT_col47_length = 8;
738        %let _OUTPUT_col47_type = ;
739        %let _OUTPUT_col47_format = 20.;
740        %let _OUTPUT_col47_informat = 20.;
741        %let _OUTPUT_col47_label = %nrquote(idkey);
742        %let _OUTPUT_col47_input0 = IDKEY;
743        %let _OUTPUT_col47_input0_table = edwtdw.TBL_CUSTOMERINFO;
744        %let _OUTPUT_col47_exp = ;
745        %let _OUTPUT_col47_input = IDKEY;
746        %let _OUTPUT_col47_input_count = 1;
747        %let _OUTPUT_col48_name = id_type;
748        %let _OUTPUT_col48_table = impraw.tdw_tbl_customerinfo;
749        %let _OUTPUT_col48_length = 12;
750        %let _OUTPUT_col48_type = $;
751        %let _OUTPUT_col48_format = $12.;
752        %let _OUTPUT_col48_informat = $12.;
753        %let _OUTPUT_col48_label = %nrquote(id_type);
754        %let _OUTPUT_col48_input0 = ID_TYPE;
755        %let _OUTPUT_col48_input0_table = edwtdw.TBL_CUSTOMERINFO;
756        %let _OUTPUT_col48_exp = ;
757        %let _OUTPUT_col48_input = ID_TYPE;
758        %let _OUTPUT_col48_input_count = 1;
759        %let _OUTPUT_col49_name = ird_number;
760        %let _OUTPUT_col49_table = impraw.tdw_tbl_customerinfo;
761        %let _OUTPUT_col49_length = 60;
762        %let _OUTPUT_col49_type = $;
763        %let _OUTPUT_col49_format = $60.;
764        %let _OUTPUT_col49_informat = $60.;
765        %let _OUTPUT_col49_label = %nrquote(ird_number);
766        %let _OUTPUT_col49_input0 = IRD_NUMBER;
767        %let _OUTPUT_col49_input0_table = edwtdw.TBL_CUSTOMERINFO;
768        %let _OUTPUT_col49_exp = ;
769        %let _OUTPUT_col49_input = IRD_NUMBER;
770        %let _OUTPUT_col49_input_count = 1;
771        %let _OUTPUT_col50_name = formatted_id;
772        %let _OUTPUT_col50_table = impraw.tdw_tbl_customerinfo;
773        %let _OUTPUT_col50_length = 60;
774        %let _OUTPUT_col50_type = $;
775        %let _OUTPUT_col50_format = $60.;
776        %let _OUTPUT_col50_informat = $60.;
777        %let _OUTPUT_col50_label = %nrquote(formatted_id);
778        %let _OUTPUT_col50_input0 = FORMATTED_ID;
779        %let _OUTPUT_col50_input0_table = edwtdw.TBL_CUSTOMERINFO;
15                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

780        %let _OUTPUT_col50_exp = ;
781        %let _OUTPUT_col50_input = FORMATTED_ID;
782        %let _OUTPUT_col50_input_count = 1;
783        %let _OUTPUT_col51_name = district_office;
784        %let _OUTPUT_col51_table = impraw.tdw_tbl_customerinfo;
785        %let _OUTPUT_col51_length = 12;
786        %let _OUTPUT_col51_type = $;
787        %let _OUTPUT_col51_format = $12.;
788        %let _OUTPUT_col51_informat = $12.;
789        %let _OUTPUT_col51_label = %nrquote(district_office);
790        %let _OUTPUT_col51_input0 = DISTRICT_OFFICE;
791        %let _OUTPUT_col51_input0_table = edwtdw.TBL_CUSTOMERINFO;
792        %let _OUTPUT_col51_exp = ;
793        %let _OUTPUT_col51_input = DISTRICT_OFFICE;
794        %let _OUTPUT_col51_input_count = 1;
795        %let _OUTPUT_col52_name = collect_district_office;
796        %let _OUTPUT_col52_table = impraw.tdw_tbl_customerinfo;
797        %let _OUTPUT_col52_length = 12;
798        %let _OUTPUT_col52_type = $;
799        %let _OUTPUT_col52_format = $12.;
800        %let _OUTPUT_col52_informat = $12.;
801        %let _OUTPUT_col52_label = %nrquote(collect_district_office);
802        %let _OUTPUT_col52_input0 = COLLECT_DISTRICT_OFFICE;
803        %let _OUTPUT_col52_input0_table = edwtdw.TBL_CUSTOMERINFO;
804        %let _OUTPUT_col52_exp = ;
805        %let _OUTPUT_col52_input = COLLECT_DISTRICT_OFFICE;
806        %let _OUTPUT_col52_input_count = 1;
807        %let _OUTPUT_col53_name = review_type;
808        %let _OUTPUT_col53_table = impraw.tdw_tbl_customerinfo;
809        %let _OUTPUT_col53_length = 12;
810        %let _OUTPUT_col53_type = $;
811        %let _OUTPUT_col53_format = $12.;
812        %let _OUTPUT_col53_informat = $12.;
813        %let _OUTPUT_col53_label = %nrquote(review_type);
814        %let _OUTPUT_col53_input0 = REVIEW_TYPE;
815        %let _OUTPUT_col53_input0_table = edwtdw.TBL_CUSTOMERINFO;
816        %let _OUTPUT_col53_exp = ;
817        %let _OUTPUT_col53_input = REVIEW_TYPE;
818        %let _OUTPUT_col53_input_count = 1;
819        %let _OUTPUT_col54_name = customer_level;
820        %let _OUTPUT_col54_table = impraw.tdw_tbl_customerinfo;
821        %let _OUTPUT_col54_length = 12;
822        %let _OUTPUT_col54_type = $;
823        %let _OUTPUT_col54_format = $12.;
824        %let _OUTPUT_col54_informat = $12.;
825        %let _OUTPUT_col54_label = %nrquote(customer_level);
826        %let _OUTPUT_col54_input0 = CUSTOMER_LEVEL;
827        %let _OUTPUT_col54_input0_table = edwtdw.TBL_CUSTOMERINFO;
828        %let _OUTPUT_col54_exp = ;
829        %let _OUTPUT_col54_input = CUSTOMER_LEVEL;
830        %let _OUTPUT_col54_input_count = 1;
831        %let _OUTPUT_col55_name = protected_data_source;
832        %let _OUTPUT_col55_table = impraw.tdw_tbl_customerinfo;
833        %let _OUTPUT_col55_length = 8;
834        %let _OUTPUT_col55_type = ;
835        %let _OUTPUT_col55_format = 20.;
836        %let _OUTPUT_col55_informat = 20.;
837        %let _OUTPUT_col55_label = %nrquote(protected_data_source);
16                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

838        %let _OUTPUT_col55_input0 = PROTECTED_DATA_SOURCE;
839        %let _OUTPUT_col55_input0_table = edwtdw.TBL_CUSTOMERINFO;
840        %let _OUTPUT_col55_exp = ;
841        %let _OUTPUT_col55_input = PROTECTED_DATA_SOURCE;
842        %let _OUTPUT_col55_input_count = 1;
843        %let _OUTPUT_col56_name = effective_from;
844        %let _OUTPUT_col56_table = impraw.tdw_tbl_customerinfo;
845        %let _OUTPUT_col56_length = 8;
846        %let _OUTPUT_col56_type = ;
847        %let _OUTPUT_col56_format = DATETIME29.9;
848        %let _OUTPUT_col56_informat = DATETIME29.9;
849        %let _OUTPUT_col56_label = %nrquote(effective_from);
850        %let _OUTPUT_col56_input0 = EFFECTIVE_FROM;
851        %let _OUTPUT_col56_input0_table = edwtdw.TBL_CUSTOMERINFO;
852        %let _OUTPUT_col56_exp = ;
853        %let _OUTPUT_col56_input = EFFECTIVE_FROM;
854        %let _OUTPUT_col56_input_count = 1;
855        %let _OUTPUT_col57_name = effective_to;
856        %let _OUTPUT_col57_table = impraw.tdw_tbl_customerinfo;
857        %let _OUTPUT_col57_length = 8;
858        %let _OUTPUT_col57_type = ;
859        %let _OUTPUT_col57_format = DATETIME29.9;
860        %let _OUTPUT_col57_informat = DATETIME29.9;
861        %let _OUTPUT_col57_label = %nrquote(effective_to);
862        %let _OUTPUT_col57_input0 = EFFECTIVE_TO;
863        %let _OUTPUT_col57_input0_table = edwtdw.TBL_CUSTOMERINFO;
864        %let _OUTPUT_col57_exp = ;
865        %let _OUTPUT_col57_input = EFFECTIVE_TO;
866        %let _OUTPUT_col57_input_count = 1;
867        %let _OUTPUT_col58_name = current_rec_flag;
868        %let _OUTPUT_col58_table = impraw.tdw_tbl_customerinfo;
869        %let _OUTPUT_col58_length = 2;
870        %let _OUTPUT_col58_type = $;
871        %let _OUTPUT_col58_format = $2.;
872        %let _OUTPUT_col58_informat = $2.;
873        %let _OUTPUT_col58_label = %nrquote(current_rec_flag);
874        %let _OUTPUT_col58_input0 = CURRENT_REC_FLAG;
875        %let _OUTPUT_col58_input0_table = edwtdw.TBL_CUSTOMERINFO;
876        %let _OUTPUT_col58_exp = ;
877        %let _OUTPUT_col58_input = CURRENT_REC_FLAG;
878        %let _OUTPUT_col58_input_count = 1;
879        %let _OUTPUT_col59_name = record_effective_timestamp;
880        %let _OUTPUT_col59_table = impraw.tdw_tbl_customerinfo;
881        %let _OUTPUT_col59_length = 8;
882        %let _OUTPUT_col59_type = ;
883        %let _OUTPUT_col59_format = DATETIME29.9;
884        %let _OUTPUT_col59_informat = DATETIME29.9;
885        %let _OUTPUT_col59_label = %nrquote(record_effective_timestamp);
886        %let _OUTPUT_col59_exp = ;
887        %let _OUTPUT_col59_input_count = 0;
888        %let _OUTPUT_col60_name = record_expiry_timestamp;
889        %let _OUTPUT_col60_table = impraw.tdw_tbl_customerinfo;
890        %let _OUTPUT_col60_length = 8;
891        %let _OUTPUT_col60_type = ;
892        %let _OUTPUT_col60_format = DATETIME29.9;
893        %let _OUTPUT_col60_informat = DATETIME29.9;
894        %let _OUTPUT_col60_label = %nrquote(record_expiry_timestamp);
895        %let _OUTPUT_col60_exp = ;
17                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

896        %let _OUTPUT_col60_input_count = 0;
897        %let _OUTPUT_col61_name = record_active_flag;
898        %let _OUTPUT_col61_table = impraw.tdw_tbl_customerinfo;
899        %let _OUTPUT_col61_length = 1;
900        %let _OUTPUT_col61_type = $;
901        %let _OUTPUT_col61_format = $1.;
902        %let _OUTPUT_col61_informat = $1.;
903        %let _OUTPUT_col61_label = %nrquote(record_active_flag);
904        %let _OUTPUT_col61_exp = ;
905        %let _OUTPUT_col61_input_count = 0;
906        %let _OUTPUT_col62_name = record_deleted_flag;
907        %let _OUTPUT_col62_table = impraw.tdw_tbl_customerinfo;
908        %let _OUTPUT_col62_length = 1;
909        %let _OUTPUT_col62_type = $;
910        %let _OUTPUT_col62_format = $1.;
911        %let _OUTPUT_col62_informat = $1.;
912        %let _OUTPUT_col62_label = %nrquote(record_deleted_flag);
913        %let _OUTPUT_col62_exp = ;
914        %let _OUTPUT_col62_input_count = 0;
915        %let _OUTPUT_col63_name = insert_object_run_key;
916        %let _OUTPUT_col63_table = impraw.tdw_tbl_customerinfo;
917        %let _OUTPUT_col63_length = 8;
918        %let _OUTPUT_col63_type = ;
919        %let _OUTPUT_col63_format = 11.;
920        %let _OUTPUT_col63_informat = 11.;
921        %let _OUTPUT_col63_label = %nrquote(insert_object_run_key);
922        %let _OUTPUT_col63_exp = ;
923        %let _OUTPUT_col63_input_count = 0;
924        %let _OUTPUT_col64_name = update_object_run_key;
925        %let _OUTPUT_col64_table = impraw.tdw_tbl_customerinfo;
926        %let _OUTPUT_col64_length = 8;
927        %let _OUTPUT_col64_type = ;
928        %let _OUTPUT_col64_format = 11.;
929        %let _OUTPUT_col64_informat = 11.;
930        %let _OUTPUT_col64_label = %nrquote(update_object_run_key);
931        %let _OUTPUT_col64_exp = ;
932        %let _OUTPUT_col64_input_count = 0;
933        
934        %let _target = impraw.tdw_tbl_customerinfo;
935        %let _target_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
936        ;
937        %let _target_engine = SASIOIMP;
938        %let _target_memtype = DATA;
939        %let _target_options = %nrquote();
940        %let _target_alter = %nrquote();
941        %let _target_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/tdw_tbl_customerinfo%(Table%))
941      ! ;
942        %let _target_type = 1;
943        %let _target_label = %nrquote();
944        /* List of target columns to keep  */
945        %let _target_keep = customer_key joint_customer_key prime_flag customer_type
946                customer_document_key folder_key default_flag profile_number
947                commence_date cease_date created_date name_key namekeyseq display_flag
948                formatted_flag name_type family_name middle_name first_name
949                name_control title suffix free_format_name list_format_name
950                additional_name additional_name_2 address_key address_key_sequence
951                address_type street_1 street_2 unit_type unit city county state zip
952                country attention locationcode urbanisation municipality district
18                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

953                subdistrict subprovince address_description list_format_address idkey
954                id_type ird_number formatted_id district_office
955                collect_district_office review_type customer_level
956                protected_data_source effective_from effective_to current_rec_flag
957                record_effective_timestamp record_expiry_timestamp record_active_flag
958                record_deleted_flag insert_object_run_key update_object_run_key;
959        %let _target_col_count = 65;
960        %let _target_col0_name = customer_key;
961        %let _target_col0_table = impraw.tdw_tbl_customerinfo;
962        %let _target_col0_length = 8;
963        %let _target_col0_type = ;
964        %let _target_col0_format = 20.;
965        %let _target_col0_informat = 20.;
966        %let _target_col0_label = %nrquote(customer_key);
967        %let _target_col0_input0 = CUSTOMER_KEY;
968        %let _target_col0_input0_table = edwtdw.TBL_CUSTOMERINFO;
969        %let _target_col0_exp = ;
970        %let _target_col0_input = CUSTOMER_KEY;
971        %let _target_col0_input_count = 1;
972        %let _target_col1_name = joint_customer_key;
973        %let _target_col1_table = impraw.tdw_tbl_customerinfo;
974        %let _target_col1_length = 8;
975        %let _target_col1_type = ;
976        %let _target_col1_format = 20.;
977        %let _target_col1_informat = 20.;
978        %let _target_col1_label = %nrquote(joint_customer_key);
979        %let _target_col1_input0 = JOINT_CUSTOMER_KEY;
980        %let _target_col1_input0_table = edwtdw.TBL_CUSTOMERINFO;
981        %let _target_col1_exp = ;
982        %let _target_col1_input = JOINT_CUSTOMER_KEY;
983        %let _target_col1_input_count = 1;
984        %let _target_col2_name = prime_flag;
985        %let _target_col2_table = impraw.tdw_tbl_customerinfo;
986        %let _target_col2_length = 10;
987        %let _target_col2_type = $;
988        %let _target_col2_format = $10.;
989        %let _target_col2_informat = $10.;
990        %let _target_col2_label = %nrquote(prime_flag);
991        %let _target_col2_input0 = PRIME_FLAG;
992        %let _target_col2_input0_table = edwtdw.TBL_CUSTOMERINFO;
993        %let _target_col2_exp = ;
994        %let _target_col2_input = PRIME_FLAG;
995        %let _target_col2_input_count = 1;
996        %let _target_col3_name = customer_type;
997        %let _target_col3_table = impraw.tdw_tbl_customerinfo;
998        %let _target_col3_length = 12;
999        %let _target_col3_type = $;
1000       %let _target_col3_format = $12.;
1001       %let _target_col3_informat = $12.;
1002       %let _target_col3_label = %nrquote(customer_type);
1003       %let _target_col3_input0 = CUSTOMER_TYPE;
1004       %let _target_col3_input0_table = edwtdw.TBL_CUSTOMERINFO;
1005       %let _target_col3_exp = ;
1006       %let _target_col3_input = CUSTOMER_TYPE;
1007       %let _target_col3_input_count = 1;
1008       %let _target_col4_name = customer_document_key;
1009       %let _target_col4_table = impraw.tdw_tbl_customerinfo;
1010       %let _target_col4_length = 8;
19                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1011       %let _target_col4_type = ;
1012       %let _target_col4_format = 20.;
1013       %let _target_col4_informat = 20.;
1014       %let _target_col4_label = %nrquote(customer_document_key);
1015       %let _target_col4_input0 = CUSTOMER_DOCUMENT_KEY;
1016       %let _target_col4_input0_table = edwtdw.TBL_CUSTOMERINFO;
1017       %let _target_col4_exp = ;
1018       %let _target_col4_input = CUSTOMER_DOCUMENT_KEY;
1019       %let _target_col4_input_count = 1;
1020       %let _target_col5_name = folder_key;
1021       %let _target_col5_table = impraw.tdw_tbl_customerinfo;
1022       %let _target_col5_length = 8;
1023       %let _target_col5_type = ;
1024       %let _target_col5_format = 20.;
1025       %let _target_col5_informat = 20.;
1026       %let _target_col5_label = %nrquote(folder_key);
1027       %let _target_col5_input0 = FOLDER_KEY;
1028       %let _target_col5_input0_table = edwtdw.TBL_CUSTOMERINFO;
1029       %let _target_col5_exp = ;
1030       %let _target_col5_input = FOLDER_KEY;
1031       %let _target_col5_input_count = 1;
1032       %let _target_col6_name = default_flag;
1033       %let _target_col6_table = impraw.tdw_tbl_customerinfo;
1034       %let _target_col6_length = 10;
1035       %let _target_col6_type = $;
1036       %let _target_col6_format = $10.;
1037       %let _target_col6_informat = $10.;
1038       %let _target_col6_label = %nrquote(default_flag);
1039       %let _target_col6_input0 = DEFAULT_FLAG;
1040       %let _target_col6_input0_table = edwtdw.TBL_CUSTOMERINFO;
1041       %let _target_col6_exp = ;
1042       %let _target_col6_input = DEFAULT_FLAG;
1043       %let _target_col6_input_count = 1;
1044       %let _target_col7_name = profile_number;
1045       %let _target_col7_table = impraw.tdw_tbl_customerinfo;
1046       %let _target_col7_length = 8;
1047       %let _target_col7_type = ;
1048       %let _target_col7_format = 20.;
1049       %let _target_col7_informat = 20.;
1050       %let _target_col7_label = %nrquote(profile_number);
1051       %let _target_col7_input0 = PROFILE_NUMBER;
1052       %let _target_col7_input0_table = edwtdw.TBL_CUSTOMERINFO;
1053       %let _target_col7_exp = ;
1054       %let _target_col7_input = PROFILE_NUMBER;
1055       %let _target_col7_input_count = 1;
1056       %let _target_col8_name = commence_date;
1057       %let _target_col8_table = impraw.tdw_tbl_customerinfo;
1058       %let _target_col8_length = 8;
1059       %let _target_col8_type = ;
1060       %let _target_col8_format = DATETIME29.9;
1061       %let _target_col8_informat = DATETIME29.9;
1062       %let _target_col8_label = %nrquote(commence_date);
1063       %let _target_col8_input0 = COMMENCE_DATE;
1064       %let _target_col8_input0_table = edwtdw.TBL_CUSTOMERINFO;
1065       %let _target_col8_exp = ;
1066       %let _target_col8_input = COMMENCE_DATE;
1067       %let _target_col8_input_count = 1;
1068       %let _target_col9_name = cease_date;
20                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1069       %let _target_col9_table = impraw.tdw_tbl_customerinfo;
1070       %let _target_col9_length = 8;
1071       %let _target_col9_type = ;
1072       %let _target_col9_format = DATETIME29.9;
1073       %let _target_col9_informat = DATETIME29.9;
1074       %let _target_col9_label = %nrquote(cease_date);
1075       %let _target_col9_input0 = CEASE_DATE;
1076       %let _target_col9_input0_table = edwtdw.TBL_CUSTOMERINFO;
1077       %let _target_col9_exp = ;
1078       %let _target_col9_input = CEASE_DATE;
1079       %let _target_col9_input_count = 1;
1080       %let _target_col10_name = created_date;
1081       %let _target_col10_table = impraw.tdw_tbl_customerinfo;
1082       %let _target_col10_length = 8;
1083       %let _target_col10_type = ;
1084       %let _target_col10_format = DATETIME29.9;
1085       %let _target_col10_informat = DATETIME29.9;
1086       %let _target_col10_label = %nrquote(created_date);
1087       %let _target_col10_input0 = CREATED_DATE;
1088       %let _target_col10_input0_table = edwtdw.TBL_CUSTOMERINFO;
1089       %let _target_col10_exp = ;
1090       %let _target_col10_input = CREATED_DATE;
1091       %let _target_col10_input_count = 1;
1092       %let _target_col11_name = name_key;
1093       %let _target_col11_table = impraw.tdw_tbl_customerinfo;
1094       %let _target_col11_length = 8;
1095       %let _target_col11_type = ;
1096       %let _target_col11_format = 20.;
1097       %let _target_col11_informat = 20.;
1098       %let _target_col11_label = %nrquote(name_key);
1099       %let _target_col11_input0 = NAME_KEY;
1100       %let _target_col11_input0_table = edwtdw.TBL_CUSTOMERINFO;
1101       %let _target_col11_exp = ;
1102       %let _target_col11_input = NAME_KEY;
1103       %let _target_col11_input_count = 1;
1104       %let _target_col12_name = namekeyseq;
1105       %let _target_col12_table = impraw.tdw_tbl_customerinfo;
1106       %let _target_col12_length = 8;
1107       %let _target_col12_type = ;
1108       %let _target_col12_format = 20.;
1109       %let _target_col12_informat = 20.;
1110       %let _target_col12_label = %nrquote(namekeyseq);
1111       %let _target_col12_input0 = NAMEKEYSEQ;
1112       %let _target_col12_input0_table = edwtdw.TBL_CUSTOMERINFO;
1113       %let _target_col12_exp = ;
1114       %let _target_col12_input = NAMEKEYSEQ;
1115       %let _target_col12_input_count = 1;
1116       %let _target_col13_name = display_flag;
1117       %let _target_col13_table = impraw.tdw_tbl_customerinfo;
1118       %let _target_col13_length = 24;
1119       %let _target_col13_type = $;
1120       %let _target_col13_format = $24.;
1121       %let _target_col13_informat = $24.;
1122       %let _target_col13_label = %nrquote(display_flag);
1123       %let _target_col13_input0 = DISPLAY_FLAG;
1124       %let _target_col13_input0_table = edwtdw.TBL_CUSTOMERINFO;
1125       %let _target_col13_exp = ;
1126       %let _target_col13_input = DISPLAY_FLAG;
21                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1127       %let _target_col13_input_count = 1;
1128       %let _target_col14_name = formatted_flag;
1129       %let _target_col14_table = impraw.tdw_tbl_customerinfo;
1130       %let _target_col14_length = 10;
1131       %let _target_col14_type = $;
1132       %let _target_col14_format = $10.;
1133       %let _target_col14_informat = $10.;
1134       %let _target_col14_label = %nrquote(formatted_flag);
1135       %let _target_col14_input0 = FORMATTED_FLAG;
1136       %let _target_col14_input0_table = edwtdw.TBL_CUSTOMERINFO;
1137       %let _target_col14_exp = ;
1138       %let _target_col14_input = FORMATTED_FLAG;
1139       %let _target_col14_input_count = 1;
1140       %let _target_col15_name = name_type;
1141       %let _target_col15_table = impraw.tdw_tbl_customerinfo;
1142       %let _target_col15_length = 40;
1143       %let _target_col15_type = $;
1144       %let _target_col15_format = $40.;
1145       %let _target_col15_informat = $40.;
1146       %let _target_col15_label = %nrquote(name_type);
1147       %let _target_col15_input0 = NAME_TYPE;
1148       %let _target_col15_input0_table = edwtdw.TBL_CUSTOMERINFO;
1149       %let _target_col15_exp = ;
1150       %let _target_col15_input = NAME_TYPE;
1151       %let _target_col15_input_count = 1;
1152       %let _target_col16_name = family_name;
1153       %let _target_col16_table = impraw.tdw_tbl_customerinfo;
1154       %let _target_col16_length = 510;
1155       %let _target_col16_type = $;
1156       %let _target_col16_format = $510.;
1157       %let _target_col16_informat = $510.;
1158       %let _target_col16_label = %nrquote(family_name);
1159       %let _target_col16_input0 = FAMILY_NAME;
1160       %let _target_col16_input0_table = edwtdw.TBL_CUSTOMERINFO;
1161       %let _target_col16_exp = ;
1162       %let _target_col16_input = FAMILY_NAME;
1163       %let _target_col16_input_count = 1;
1164       %let _target_col17_name = middle_name;
1165       %let _target_col17_table = impraw.tdw_tbl_customerinfo;
1166       %let _target_col17_length = 100;
1167       %let _target_col17_type = $;
1168       %let _target_col17_format = $100.;
1169       %let _target_col17_informat = $100.;
1170       %let _target_col17_label = %nrquote(middle_name);
1171       %let _target_col17_input0 = MIDDLE_NAME;
1172       %let _target_col17_input0_table = edwtdw.TBL_CUSTOMERINFO;
1173       %let _target_col17_exp = ;
1174       %let _target_col17_input = MIDDLE_NAME;
1175       %let _target_col17_input_count = 1;
1176       %let _target_col18_name = first_name;
1177       %let _target_col18_table = impraw.tdw_tbl_customerinfo;
1178       %let _target_col18_length = 100;
1179       %let _target_col18_type = $;
1180       %let _target_col18_format = $100.;
1181       %let _target_col18_informat = $100.;
1182       %let _target_col18_label = %nrquote(first_name);
1183       %let _target_col18_input0 = FIRST_NAME;
1184       %let _target_col18_input0_table = edwtdw.TBL_CUSTOMERINFO;
22                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1185       %let _target_col18_exp = ;
1186       %let _target_col18_input = FIRST_NAME;
1187       %let _target_col18_input_count = 1;
1188       %let _target_col19_name = name_control;
1189       %let _target_col19_table = impraw.tdw_tbl_customerinfo;
1190       %let _target_col19_length = 20;
1191       %let _target_col19_type = $;
1192       %let _target_col19_format = $20.;
1193       %let _target_col19_informat = $20.;
1194       %let _target_col19_label = %nrquote(name_control);
1195       %let _target_col19_input0 = NAME_CONTROL;
1196       %let _target_col19_input0_table = edwtdw.TBL_CUSTOMERINFO;
1197       %let _target_col19_exp = ;
1198       %let _target_col19_input = NAME_CONTROL;
1199       %let _target_col19_input_count = 1;
1200       %let _target_col20_name = title;
1201       %let _target_col20_table = impraw.tdw_tbl_customerinfo;
1202       %let _target_col20_length = 20;
1203       %let _target_col20_type = $;
1204       %let _target_col20_format = $20.;
1205       %let _target_col20_informat = $20.;
1206       %let _target_col20_label = %nrquote(title);
1207       %let _target_col20_input0 = TITLE;
1208       %let _target_col20_input0_table = edwtdw.TBL_CUSTOMERINFO;
1209       %let _target_col20_exp = ;
1210       %let _target_col20_input = TITLE;
1211       %let _target_col20_input_count = 1;
1212       %let _target_col21_name = suffix;
1213       %let _target_col21_table = impraw.tdw_tbl_customerinfo;
1214       %let _target_col21_length = 20;
1215       %let _target_col21_type = $;
1216       %let _target_col21_format = $20.;
1217       %let _target_col21_informat = $20.;
1218       %let _target_col21_label = %nrquote(suffix);
1219       %let _target_col21_input0 = SUFFIX;
1220       %let _target_col21_input0_table = edwtdw.TBL_CUSTOMERINFO;
1221       %let _target_col21_exp = ;
1222       %let _target_col21_input = SUFFIX;
1223       %let _target_col21_input_count = 1;
1224       %let _target_col22_name = free_format_name;
1225       %let _target_col22_table = impraw.tdw_tbl_customerinfo;
1226       %let _target_col22_length = 510;
1227       %let _target_col22_type = $;
1228       %let _target_col22_format = $510.;
1229       %let _target_col22_informat = $510.;
1230       %let _target_col22_label = %nrquote(free_format_name);
1231       %let _target_col22_input0 = FREE_FORMAT_NAME;
1232       %let _target_col22_input0_table = edwtdw.TBL_CUSTOMERINFO;
1233       %let _target_col22_exp = ;
1234       %let _target_col22_input = FREE_FORMAT_NAME;
1235       %let _target_col22_input_count = 1;
1236       %let _target_col23_name = list_format_name;
1237       %let _target_col23_table = impraw.tdw_tbl_customerinfo;
1238       %let _target_col23_length = 510;
1239       %let _target_col23_type = $;
1240       %let _target_col23_format = $510.;
1241       %let _target_col23_informat = $510.;
1242       %let _target_col23_label = %nrquote(list_format_name);
23                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1243       %let _target_col23_input0 = LIST_FORMAT_NAME;
1244       %let _target_col23_input0_table = edwtdw.TBL_CUSTOMERINFO;
1245       %let _target_col23_exp = ;
1246       %let _target_col23_input = LIST_FORMAT_NAME;
1247       %let _target_col23_input_count = 1;
1248       %let _target_col24_name = additional_name;
1249       %let _target_col24_table = impraw.tdw_tbl_customerinfo;
1250       %let _target_col24_length = 510;
1251       %let _target_col24_type = $;
1252       %let _target_col24_format = $510.;
1253       %let _target_col24_informat = $510.;
1254       %let _target_col24_label = %nrquote(additional_name);
1255       %let _target_col24_input0 = ADDITIONAL_NAME;
1256       %let _target_col24_input0_table = edwtdw.TBL_CUSTOMERINFO;
1257       %let _target_col24_exp = ;
1258       %let _target_col24_input = ADDITIONAL_NAME;
1259       %let _target_col24_input_count = 1;
1260       %let _target_col25_name = additional_name_2;
1261       %let _target_col25_table = impraw.tdw_tbl_customerinfo;
1262       %let _target_col25_length = 510;
1263       %let _target_col25_type = $;
1264       %let _target_col25_format = $510.;
1265       %let _target_col25_informat = $510.;
1266       %let _target_col25_label = %nrquote(additional_name_2);
1267       %let _target_col25_input0 = ADDITIONAL_NAME_2;
1268       %let _target_col25_input0_table = edwtdw.TBL_CUSTOMERINFO;
1269       %let _target_col25_exp = ;
1270       %let _target_col25_input = ADDITIONAL_NAME_2;
1271       %let _target_col25_input_count = 1;
1272       %let _target_col26_name = address_key;
1273       %let _target_col26_table = impraw.tdw_tbl_customerinfo;
1274       %let _target_col26_length = 8;
1275       %let _target_col26_type = ;
1276       %let _target_col26_format = 20.;
1277       %let _target_col26_informat = 20.;
1278       %let _target_col26_label = %nrquote(address_key);
1279       %let _target_col26_input0 = ADDRESS_KEY;
1280       %let _target_col26_input0_table = edwtdw.TBL_CUSTOMERINFO;
1281       %let _target_col26_exp = ;
1282       %let _target_col26_input = ADDRESS_KEY;
1283       %let _target_col26_input_count = 1;
1284       %let _target_col27_name = address_key_sequence;
1285       %let _target_col27_table = impraw.tdw_tbl_customerinfo;
1286       %let _target_col27_length = 8;
1287       %let _target_col27_type = ;
1288       %let _target_col27_format = 20.;
1289       %let _target_col27_informat = 20.;
1290       %let _target_col27_label = %nrquote(address_key_sequence);
1291       %let _target_col27_input0 = ADDRESS_KEY_SEQUENCE;
1292       %let _target_col27_input0_table = edwtdw.TBL_CUSTOMERINFO;
1293       %let _target_col27_exp = ;
1294       %let _target_col27_input = ADDRESS_KEY_SEQUENCE;
1295       %let _target_col27_input_count = 1;
1296       %let _target_col28_name = address_type;
1297       %let _target_col28_table = impraw.tdw_tbl_customerinfo;
1298       %let _target_col28_length = 40;
1299       %let _target_col28_type = $;
1300       %let _target_col28_format = $40.;
24                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1301       %let _target_col28_informat = $40.;
1302       %let _target_col28_label = %nrquote(address_type);
1303       %let _target_col28_input0 = ADDRESS_TYPE;
1304       %let _target_col28_input0_table = edwtdw.TBL_CUSTOMERINFO;
1305       %let _target_col28_exp = ;
1306       %let _target_col28_input = ADDRESS_TYPE;
1307       %let _target_col28_input_count = 1;
1308       %let _target_col29_name = street_1;
1309       %let _target_col29_table = impraw.tdw_tbl_customerinfo;
1310       %let _target_col29_length = 510;
1311       %let _target_col29_type = $;
1312       %let _target_col29_format = $510.;
1313       %let _target_col29_informat = $510.;
1314       %let _target_col29_label = %nrquote(street_1);
1315       %let _target_col29_input0 = STREET_1;
1316       %let _target_col29_input0_table = edwtdw.TBL_CUSTOMERINFO;
1317       %let _target_col29_exp = ;
1318       %let _target_col29_input = STREET_1;
1319       %let _target_col29_input_count = 1;
1320       %let _target_col30_name = street_2;
1321       %let _target_col30_table = impraw.tdw_tbl_customerinfo;
1322       %let _target_col30_length = 510;
1323       %let _target_col30_type = $;
1324       %let _target_col30_format = $510.;
1325       %let _target_col30_informat = $510.;
1326       %let _target_col30_label = %nrquote(street_2);
1327       %let _target_col30_input0 = STREET_2;
1328       %let _target_col30_input0_table = edwtdw.TBL_CUSTOMERINFO;
1329       %let _target_col30_exp = ;
1330       %let _target_col30_input = STREET_2;
1331       %let _target_col30_input_count = 1;
1332       %let _target_col31_name = unit_type;
1333       %let _target_col31_table = impraw.tdw_tbl_customerinfo;
1334       %let _target_col31_length = 100;
1335       %let _target_col31_type = $;
1336       %let _target_col31_format = $100.;
1337       %let _target_col31_informat = $100.;
1338       %let _target_col31_label = %nrquote(unit_type);
1339       %let _target_col31_input0 = UNIT_TYPE;
1340       %let _target_col31_input0_table = edwtdw.TBL_CUSTOMERINFO;
1341       %let _target_col31_exp = ;
1342       %let _target_col31_input = UNIT_TYPE;
1343       %let _target_col31_input_count = 1;
1344       %let _target_col32_name = unit;
1345       %let _target_col32_table = impraw.tdw_tbl_customerinfo;
1346       %let _target_col32_length = 60;
1347       %let _target_col32_type = $;
1348       %let _target_col32_format = $60.;
1349       %let _target_col32_informat = $60.;
1350       %let _target_col32_label = %nrquote(unit);
1351       %let _target_col32_input0 = UNIT;
1352       %let _target_col32_input0_table = edwtdw.TBL_CUSTOMERINFO;
1353       %let _target_col32_exp = ;
1354       %let _target_col32_input = UNIT;
1355       %let _target_col32_input_count = 1;
1356       %let _target_col33_name = city;
1357       %let _target_col33_table = impraw.tdw_tbl_customerinfo;
1358       %let _target_col33_length = 200;
25                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1359       %let _target_col33_type = $;
1360       %let _target_col33_format = $200.;
1361       %let _target_col33_informat = $200.;
1362       %let _target_col33_label = %nrquote(city);
1363       %let _target_col33_input0 = CITY;
1364       %let _target_col33_input0_table = edwtdw.TBL_CUSTOMERINFO;
1365       %let _target_col33_exp = ;
1366       %let _target_col33_input = CITY;
1367       %let _target_col33_input_count = 1;
1368       %let _target_col34_name = county;
1369       %let _target_col34_table = impraw.tdw_tbl_customerinfo;
1370       %let _target_col34_length = 12;
1371       %let _target_col34_type = $;
1372       %let _target_col34_format = $12.;
1373       %let _target_col34_informat = $12.;
1374       %let _target_col34_label = %nrquote(county);
1375       %let _target_col34_input0 = COUNTY;
1376       %let _target_col34_input0_table = edwtdw.TBL_CUSTOMERINFO;
1377       %let _target_col34_exp = ;
1378       %let _target_col34_input = COUNTY;
1379       %let _target_col34_input_count = 1;
1380       %let _target_col35_name = state;
1381       %let _target_col35_table = impraw.tdw_tbl_customerinfo;
1382       %let _target_col35_length = 12;
1383       %let _target_col35_type = $;
1384       %let _target_col35_format = $12.;
1385       %let _target_col35_informat = $12.;
1386       %let _target_col35_label = %nrquote(state);
1387       %let _target_col35_input0 = STATE;
1388       %let _target_col35_input0_table = edwtdw.TBL_CUSTOMERINFO;
1389       %let _target_col35_exp = ;
1390       %let _target_col35_input = STATE;
1391       %let _target_col35_input_count = 1;
1392       %let _target_col36_name = zip;
1393       %let _target_col36_table = impraw.tdw_tbl_customerinfo;
1394       %let _target_col36_length = 60;
1395       %let _target_col36_type = $;
1396       %let _target_col36_format = $60.;
1397       %let _target_col36_informat = $60.;
1398       %let _target_col36_label = %nrquote(zip);
1399       %let _target_col36_input0 = ZIP;
1400       %let _target_col36_input0_table = edwtdw.TBL_CUSTOMERINFO;
1401       %let _target_col36_exp = ;
1402       %let _target_col36_input = ZIP;
1403       %let _target_col36_input_count = 1;
1404       %let _target_col37_name = country;
1405       %let _target_col37_table = impraw.tdw_tbl_customerinfo;
1406       %let _target_col37_length = 12;
1407       %let _target_col37_type = $;
1408       %let _target_col37_format = $12.;
1409       %let _target_col37_informat = $12.;
1410       %let _target_col37_label = %nrquote(country);
1411       %let _target_col37_input0 = COUNTRY;
1412       %let _target_col37_input0_table = edwtdw.TBL_CUSTOMERINFO;
1413       %let _target_col37_exp = ;
1414       %let _target_col37_input = COUNTRY;
1415       %let _target_col37_input_count = 1;
1416       %let _target_col38_name = attention;
26                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1417       %let _target_col38_table = impraw.tdw_tbl_customerinfo;
1418       %let _target_col38_length = 510;
1419       %let _target_col38_type = $;
1420       %let _target_col38_format = $510.;
1421       %let _target_col38_informat = $510.;
1422       %let _target_col38_label = %nrquote(attention);
1423       %let _target_col38_input0 = ATTENTION;
1424       %let _target_col38_input0_table = edwtdw.TBL_CUSTOMERINFO;
1425       %let _target_col38_exp = ;
1426       %let _target_col38_input = ATTENTION;
1427       %let _target_col38_input_count = 1;
1428       %let _target_col39_name = locationcode;
1429       %let _target_col39_table = impraw.tdw_tbl_customerinfo;
1430       %let _target_col39_length = 60;
1431       %let _target_col39_type = $;
1432       %let _target_col39_format = $60.;
1433       %let _target_col39_informat = $60.;
1434       %let _target_col39_label = %nrquote(locationcode);
1435       %let _target_col39_input0 = LOCATIONCODE;
1436       %let _target_col39_input0_table = edwtdw.TBL_CUSTOMERINFO;
1437       %let _target_col39_exp = ;
1438       %let _target_col39_input = LOCATIONCODE;
1439       %let _target_col39_input_count = 1;
1440       %let _target_col40_name = urbanisation;
1441       %let _target_col40_table = impraw.tdw_tbl_customerinfo;
1442       %let _target_col40_length = 100;
1443       %let _target_col40_type = $;
1444       %let _target_col40_format = $100.;
1445       %let _target_col40_informat = $100.;
1446       %let _target_col40_label = %nrquote(urbanisation);
1447       %let _target_col40_input0 = URBANISATION;
1448       %let _target_col40_input0_table = edwtdw.TBL_CUSTOMERINFO;
1449       %let _target_col40_exp = ;
1450       %let _target_col40_input = URBANISATION;
1451       %let _target_col40_input_count = 1;
1452       %let _target_col41_name = municipality;
1453       %let _target_col41_table = impraw.tdw_tbl_customerinfo;
1454       %let _target_col41_length = 60;
1455       %let _target_col41_type = $;
1456       %let _target_col41_format = $60.;
1457       %let _target_col41_informat = $60.;
1458       %let _target_col41_label = %nrquote(municipality);
1459       %let _target_col41_input0 = MUNICIPALITY;
1460       %let _target_col41_input0_table = edwtdw.TBL_CUSTOMERINFO;
1461       %let _target_col41_exp = ;
1462       %let _target_col41_input = MUNICIPALITY;
1463       %let _target_col41_input_count = 1;
1464       %let _target_col42_name = district;
1465       %let _target_col42_table = impraw.tdw_tbl_customerinfo;
1466       %let _target_col42_length = 60;
1467       %let _target_col42_type = $;
1468       %let _target_col42_format = $60.;
1469       %let _target_col42_informat = $60.;
1470       %let _target_col42_label = %nrquote(district);
1471       %let _target_col42_input0 = DISTRICT;
1472       %let _target_col42_input0_table = edwtdw.TBL_CUSTOMERINFO;
1473       %let _target_col42_exp = ;
1474       %let _target_col42_input = DISTRICT;
27                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1475       %let _target_col42_input_count = 1;
1476       %let _target_col43_name = subdistrict;
1477       %let _target_col43_table = impraw.tdw_tbl_customerinfo;
1478       %let _target_col43_length = 60;
1479       %let _target_col43_type = $;
1480       %let _target_col43_format = $60.;
1481       %let _target_col43_informat = $60.;
1482       %let _target_col43_label = %nrquote(subdistrict);
1483       %let _target_col43_input0 = SUBDISTRICT;
1484       %let _target_col43_input0_table = edwtdw.TBL_CUSTOMERINFO;
1485       %let _target_col43_exp = ;
1486       %let _target_col43_input = SUBDISTRICT;
1487       %let _target_col43_input_count = 1;
1488       %let _target_col44_name = subprovince;
1489       %let _target_col44_table = impraw.tdw_tbl_customerinfo;
1490       %let _target_col44_length = 100;
1491       %let _target_col44_type = $;
1492       %let _target_col44_format = $100.;
1493       %let _target_col44_informat = $100.;
1494       %let _target_col44_label = %nrquote(subprovince);
1495       %let _target_col44_input0 = SUBPROVINCE;
1496       %let _target_col44_input0_table = edwtdw.TBL_CUSTOMERINFO;
1497       %let _target_col44_exp = ;
1498       %let _target_col44_input = SUBPROVINCE;
1499       %let _target_col44_input_count = 1;
1500       %let _target_col45_name = address_description;
1501       %let _target_col45_table = impraw.tdw_tbl_customerinfo;
1502       %let _target_col45_length = 510;
1503       %let _target_col45_type = $;
1504       %let _target_col45_format = $510.;
1505       %let _target_col45_informat = $510.;
1506       %let _target_col45_label = %nrquote(address_description);
1507       %let _target_col45_input0 = ADDRESS_DESCRIPTION;
1508       %let _target_col45_input0_table = edwtdw.TBL_CUSTOMERINFO;
1509       %let _target_col45_exp = ;
1510       %let _target_col45_input = ADDRESS_DESCRIPTION;
1511       %let _target_col45_input_count = 1;
1512       %let _target_col46_name = list_format_address;
1513       %let _target_col46_table = impraw.tdw_tbl_customerinfo;
1514       %let _target_col46_length = 510;
1515       %let _target_col46_type = $;
1516       %let _target_col46_format = $510.;
1517       %let _target_col46_informat = $510.;
1518       %let _target_col46_label = %nrquote(list_format_address);
1519       %let _target_col46_input0 = LIST_FORMAT_ADDRESS;
1520       %let _target_col46_input0_table = edwtdw.TBL_CUSTOMERINFO;
1521       %let _target_col46_exp = ;
1522       %let _target_col46_input = LIST_FORMAT_ADDRESS;
1523       %let _target_col46_input_count = 1;
1524       %let _target_col47_name = idkey;
1525       %let _target_col47_table = impraw.tdw_tbl_customerinfo;
1526       %let _target_col47_length = 8;
1527       %let _target_col47_type = ;
1528       %let _target_col47_format = 20.;
1529       %let _target_col47_informat = 20.;
1530       %let _target_col47_label = %nrquote(idkey);
1531       %let _target_col47_input0 = IDKEY;
1532       %let _target_col47_input0_table = edwtdw.TBL_CUSTOMERINFO;
28                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1533       %let _target_col47_exp = ;
1534       %let _target_col47_input = IDKEY;
1535       %let _target_col47_input_count = 1;
1536       %let _target_col48_name = id_type;
1537       %let _target_col48_table = impraw.tdw_tbl_customerinfo;
1538       %let _target_col48_length = 12;
1539       %let _target_col48_type = $;
1540       %let _target_col48_format = $12.;
1541       %let _target_col48_informat = $12.;
1542       %let _target_col48_label = %nrquote(id_type);
1543       %let _target_col48_input0 = ID_TYPE;
1544       %let _target_col48_input0_table = edwtdw.TBL_CUSTOMERINFO;
1545       %let _target_col48_exp = ;
1546       %let _target_col48_input = ID_TYPE;
1547       %let _target_col48_input_count = 1;
1548       %let _target_col49_name = ird_number;
1549       %let _target_col49_table = impraw.tdw_tbl_customerinfo;
1550       %let _target_col49_length = 60;
1551       %let _target_col49_type = $;
1552       %let _target_col49_format = $60.;
1553       %let _target_col49_informat = $60.;
1554       %let _target_col49_label = %nrquote(ird_number);
1555       %let _target_col49_input0 = IRD_NUMBER;
1556       %let _target_col49_input0_table = edwtdw.TBL_CUSTOMERINFO;
1557       %let _target_col49_exp = ;
1558       %let _target_col49_input = IRD_NUMBER;
1559       %let _target_col49_input_count = 1;
1560       %let _target_col50_name = formatted_id;
1561       %let _target_col50_table = impraw.tdw_tbl_customerinfo;
1562       %let _target_col50_length = 60;
1563       %let _target_col50_type = $;
1564       %let _target_col50_format = $60.;
1565       %let _target_col50_informat = $60.;
1566       %let _target_col50_label = %nrquote(formatted_id);
1567       %let _target_col50_input0 = FORMATTED_ID;
1568       %let _target_col50_input0_table = edwtdw.TBL_CUSTOMERINFO;
1569       %let _target_col50_exp = ;
1570       %let _target_col50_input = FORMATTED_ID;
1571       %let _target_col50_input_count = 1;
1572       %let _target_col51_name = district_office;
1573       %let _target_col51_table = impraw.tdw_tbl_customerinfo;
1574       %let _target_col51_length = 12;
1575       %let _target_col51_type = $;
1576       %let _target_col51_format = $12.;
1577       %let _target_col51_informat = $12.;
1578       %let _target_col51_label = %nrquote(district_office);
1579       %let _target_col51_input0 = DISTRICT_OFFICE;
1580       %let _target_col51_input0_table = edwtdw.TBL_CUSTOMERINFO;
1581       %let _target_col51_exp = ;
1582       %let _target_col51_input = DISTRICT_OFFICE;
1583       %let _target_col51_input_count = 1;
1584       %let _target_col52_name = collect_district_office;
1585       %let _target_col52_table = impraw.tdw_tbl_customerinfo;
1586       %let _target_col52_length = 12;
1587       %let _target_col52_type = $;
1588       %let _target_col52_format = $12.;
1589       %let _target_col52_informat = $12.;
1590       %let _target_col52_label = %nrquote(collect_district_office);
29                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1591       %let _target_col52_input0 = COLLECT_DISTRICT_OFFICE;
1592       %let _target_col52_input0_table = edwtdw.TBL_CUSTOMERINFO;
1593       %let _target_col52_exp = ;
1594       %let _target_col52_input = COLLECT_DISTRICT_OFFICE;
1595       %let _target_col52_input_count = 1;
1596       %let _target_col53_name = review_type;
1597       %let _target_col53_table = impraw.tdw_tbl_customerinfo;
1598       %let _target_col53_length = 12;
1599       %let _target_col53_type = $;
1600       %let _target_col53_format = $12.;
1601       %let _target_col53_informat = $12.;
1602       %let _target_col53_label = %nrquote(review_type);
1603       %let _target_col53_input0 = REVIEW_TYPE;
1604       %let _target_col53_input0_table = edwtdw.TBL_CUSTOMERINFO;
1605       %let _target_col53_exp = ;
1606       %let _target_col53_input = REVIEW_TYPE;
1607       %let _target_col53_input_count = 1;
1608       %let _target_col54_name = customer_level;
1609       %let _target_col54_table = impraw.tdw_tbl_customerinfo;
1610       %let _target_col54_length = 12;
1611       %let _target_col54_type = $;
1612       %let _target_col54_format = $12.;
1613       %let _target_col54_informat = $12.;
1614       %let _target_col54_label = %nrquote(customer_level);
1615       %let _target_col54_input0 = CUSTOMER_LEVEL;
1616       %let _target_col54_input0_table = edwtdw.TBL_CUSTOMERINFO;
1617       %let _target_col54_exp = ;
1618       %let _target_col54_input = CUSTOMER_LEVEL;
1619       %let _target_col54_input_count = 1;
1620       %let _target_col55_name = protected_data_source;
1621       %let _target_col55_table = impraw.tdw_tbl_customerinfo;
1622       %let _target_col55_length = 8;
1623       %let _target_col55_type = ;
1624       %let _target_col55_format = 20.;
1625       %let _target_col55_informat = 20.;
1626       %let _target_col55_label = %nrquote(protected_data_source);
1627       %let _target_col55_input0 = PROTECTED_DATA_SOURCE;
1628       %let _target_col55_input0_table = edwtdw.TBL_CUSTOMERINFO;
1629       %let _target_col55_exp = ;
1630       %let _target_col55_input = PROTECTED_DATA_SOURCE;
1631       %let _target_col55_input_count = 1;
1632       %let _target_col56_name = effective_from;
1633       %let _target_col56_table = impraw.tdw_tbl_customerinfo;
1634       %let _target_col56_length = 8;
1635       %let _target_col56_type = ;
1636       %let _target_col56_format = DATETIME29.9;
1637       %let _target_col56_informat = DATETIME29.9;
1638       %let _target_col56_label = %nrquote(effective_from);
1639       %let _target_col56_input0 = EFFECTIVE_FROM;
1640       %let _target_col56_input0_table = edwtdw.TBL_CUSTOMERINFO;
1641       %let _target_col56_exp = ;
1642       %let _target_col56_input = EFFECTIVE_FROM;
1643       %let _target_col56_input_count = 1;
1644       %let _target_col57_name = effective_to;
1645       %let _target_col57_table = impraw.tdw_tbl_customerinfo;
1646       %let _target_col57_length = 8;
1647       %let _target_col57_type = ;
1648       %let _target_col57_format = DATETIME29.9;
30                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1649       %let _target_col57_informat = DATETIME29.9;
1650       %let _target_col57_label = %nrquote(effective_to);
1651       %let _target_col57_input0 = EFFECTIVE_TO;
1652       %let _target_col57_input0_table = edwtdw.TBL_CUSTOMERINFO;
1653       %let _target_col57_exp = ;
1654       %let _target_col57_input = EFFECTIVE_TO;
1655       %let _target_col57_input_count = 1;
1656       %let _target_col58_name = current_rec_flag;
1657       %let _target_col58_table = impraw.tdw_tbl_customerinfo;
1658       %let _target_col58_length = 2;
1659       %let _target_col58_type = $;
1660       %let _target_col58_format = $2.;
1661       %let _target_col58_informat = $2.;
1662       %let _target_col58_label = %nrquote(current_rec_flag);
1663       %let _target_col58_input0 = CURRENT_REC_FLAG;
1664       %let _target_col58_input0_table = edwtdw.TBL_CUSTOMERINFO;
1665       %let _target_col58_exp = ;
1666       %let _target_col58_input = CURRENT_REC_FLAG;
1667       %let _target_col58_input_count = 1;
1668       %let _target_col59_name = record_effective_timestamp;
1669       %let _target_col59_table = impraw.tdw_tbl_customerinfo;
1670       %let _target_col59_length = 8;
1671       %let _target_col59_type = ;
1672       %let _target_col59_format = DATETIME29.9;
1673       %let _target_col59_informat = DATETIME29.9;
1674       %let _target_col59_label = %nrquote(record_effective_timestamp);
1675       %let _target_col59_exp = ;
1676       %let _target_col59_input_count = 0;
1677       %let _target_col60_name = record_expiry_timestamp;
1678       %let _target_col60_table = impraw.tdw_tbl_customerinfo;
1679       %let _target_col60_length = 8;
1680       %let _target_col60_type = ;
1681       %let _target_col60_format = DATETIME29.9;
1682       %let _target_col60_informat = DATETIME29.9;
1683       %let _target_col60_label = %nrquote(record_expiry_timestamp);
1684       %let _target_col60_exp = ;
1685       %let _target_col60_input_count = 0;
1686       %let _target_col61_name = record_active_flag;
1687       %let _target_col61_table = impraw.tdw_tbl_customerinfo;
1688       %let _target_col61_length = 1;
1689       %let _target_col61_type = $;
1690       %let _target_col61_format = $1.;
1691       %let _target_col61_informat = $1.;
1692       %let _target_col61_label = %nrquote(record_active_flag);
1693       %let _target_col61_exp = ;
1694       %let _target_col61_input_count = 0;
1695       %let _target_col62_name = record_deleted_flag;
1696       %let _target_col62_table = impraw.tdw_tbl_customerinfo;
1697       %let _target_col62_length = 1;
1698       %let _target_col62_type = $;
1699       %let _target_col62_format = $1.;
1700       %let _target_col62_informat = $1.;
1701       %let _target_col62_label = %nrquote(record_deleted_flag);
1702       %let _target_col62_exp = ;
1703       %let _target_col62_input_count = 0;
1704       %let _target_col63_name = insert_object_run_key;
1705       %let _target_col63_table = impraw.tdw_tbl_customerinfo;
1706       %let _target_col63_length = 8;
31                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1707       %let _target_col63_type = ;
1708       %let _target_col63_format = 11.;
1709       %let _target_col63_informat = 11.;
1710       %let _target_col63_label = %nrquote(insert_object_run_key);
1711       %let _target_col63_exp = ;
1712       %let _target_col63_input_count = 0;
1713       %let _target_col64_name = update_object_run_key;
1714       %let _target_col64_table = impraw.tdw_tbl_customerinfo;
1715       %let _target_col64_length = 8;
1716       %let _target_col64_type = ;
1717       %let _target_col64_format = 11.;
1718       %let _target_col64_informat = 11.;
1719       %let _target_col64_label = %nrquote(update_object_run_key);
1720       %let _target_col64_exp = ;
1721       %let _target_col64_input_count = 0;
1722       
1723       
1724       %let ep_key_cols = customer_key;
1725       %let ep_key_cols_count = 1;
1726       %let ep_key_cols0 = 1;
1727       %let ep_key_cols1 = customer_key;
1728       %let where = ;
1729       %let change_capture_timestamp = EFFECTIVE_FROM;
1730       %let change_capture_timestamp_count = 1;
1731       %let change_capture_timestamp0 = 1;
1732       %let change_capture_timestamp1 = EFFECTIVE_FROM;
1733       %let history_type = %nrquote(H2);
1734       %let duplication_grain = %nrquote(1);
1735       %let h2_effective_column = EFFECTIVE_TO;
1736       %let h2_effective_column_count = 1;
1737       %let h2_effective_column0 = 1;
1738       %let h2_effective_column1 = EFFECTIVE_TO;
1739       %let effective_column = effective_from;
1740       %let effective_column_count = 1;
1741       %let effective_column0 = 1;
1742       %let effective_column1 = effective_from;
1743       %let to_timestamp = ;
1744       %let to_timestamp_count = 0;
1745       %let to_timestamp0 = 0;
1746       %let effective_timestamp_grain = %nrquote(Seconds);
1747       %let purge_grain = %nrquote(1);
1748       %let debug = %nrquote(No);
1749       %let ep_db_create_opts = %nrquote(with serdeproperties %(%'field.delim%'=%'\u0006%', %'line.delim%'=%'\u0007%',
1749     ! %'serialization.format%'=%'\u0006%',%'serialization.escape.crlf%'=%'true%'%) stored as textfile);
1750       %let lcf = lcf.OBJECT;
1751       %let lcf_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
1751     ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
1752       ;
1753       %let lcf_engine = ORACLE;
1754       %let lcf_memtype = DATA;
1755       %let lcf_options = %nrquote();
1756       %let lcf_alter = %nrquote();
1757       %let lcf_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT%(Table%));
1758       %let lcf_type = 1;
1759       %let lcf_label = %nrquote();
1760       %let ep_db_opts_count = %nrquote(1);
1761       %let ep_db_opts = %nrquote(stored as parquet);
1762       %let ep_db_opts1 = %nrquote(stored as parquet);
32                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1763       %let logging = lcf.OBJECT_RUN;
1764       %let logging_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
1764     ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
1765       ;
1766       %let logging_engine = ORACLE;
1767       %let logging_memtype = DATA;
1768       %let logging_options = %nrquote();
1769       %let logging_alter = %nrquote();
1770       %let logging_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT_RUN%(Table%));
1771       %let logging_type = 1;
1772       %let logging_label = %nrquote();
1773       /* Access the data for DIP Hive Staging (hivestg)  */
1774       LIBNAME hivestg HADOOP  URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;
1774     ! ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"  HDFS_TEMPDIR="/env/1_dev/landing/"
1774     ! LOGIN_TIMEOUT=0  DEFER=YES
1775       PORT=10001 SERVER="ird26au.vsp.sas.com"  SCHEMA=dev_staging ;
NOTE: Libref HIVESTG was successfully assigned as follows: 
      Engine:        HADOOP 
      Physical Name: jdbc:hive2://ird26au.vsp.sas.com:10001/
1776       %rcSet(&syslibrc);
1777       
1778       %let stg_hive_connect =  DEFER=YES URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;
1778     ! principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"
1778     ! HDFS_TEMPDIR="/env/1_dev/landing/" LOGIN_TIMEOUT=0 SERVER="ird26au.vsp.sas.com"  PORT=10001
1779       ;
1780       %let stg_hive_engine = HADOOP;
1781       %let stg_hive_path = /IRD/DIP Data Management/1000 Libraries/DIP Hive Staging (hivestg)(Library);
1782       %let stg_hive = hivestg;
1783       /* Access the data for DIP Impala Staging (impstg)  */
1784       LIBNAME impstg SASIOIMP  DATABASE=dev_staging  HDFS_TEMPDIR="/env/1_dev/landing/"  DSN=ClouderaImpala64
1784     ! SCHEMA=dev_staging ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPSTG was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
1785       %rcSet(&syslibrc);
1786       
1787       %let ep_staging_library_connect =  DATABASE=dev_staging DSN=ClouderaImpala64
1788       ;
1789       %let ep_staging_library_engine = SASIOIMP;
1790       %let ep_staging_library = impstg;
1791       %let ep_staging_library_path = /IRD/DIP Data Management/1000 Libraries/DIP Impala Staging (impstg)(Library);
1792       %let Source_table_type = %nrquote(dataset);
1793       %let tagsort = %nrquote(Yes);
1794       
1795       /* List of target columns to keep  */
1796       %let _keep = customer_key joint_customer_key prime_flag customer_type
1797               customer_document_key folder_key default_flag profile_number
1798               commence_date cease_date created_date name_key namekeyseq display_flag
1799               formatted_flag name_type family_name middle_name first_name
1800               name_control title suffix free_format_name list_format_name
1801               additional_name additional_name_2 address_key address_key_sequence
1802               address_type street_1 street_2 unit_type unit city county state zip
1803               country attention locationcode urbanisation municipality district
1804               subdistrict subprovince address_description list_format_address idkey
1805               id_type ird_number formatted_id district_office
1806               collect_district_office review_type customer_level
1807               protected_data_source effective_from effective_to current_rec_flag
33                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

1808               record_effective_timestamp record_expiry_timestamp record_active_flag
1809               record_deleted_flag insert_object_run_key update_object_run_key;
1810       /* List of target columns to keep  */
1811       %let keep = customer_key joint_customer_key prime_flag customer_type
1812               customer_document_key folder_key default_flag profile_number
1813               commence_date cease_date created_date name_key namekeyseq display_flag
1814               formatted_flag name_type family_name middle_name first_name
1815               name_control title suffix free_format_name list_format_name
1816               additional_name additional_name_2 address_key address_key_sequence
1817               address_type street_1 street_2 unit_type unit city county state zip
1818               country attention locationcode urbanisation municipality district
1819               subdistrict subprovince address_description list_format_address idkey
1820               id_type ird_number formatted_id district_office
1821               collect_district_office review_type customer_level
1822               protected_data_source effective_from effective_to current_rec_flag
1823               record_effective_timestamp record_expiry_timestamp record_active_flag
1824               record_deleted_flag insert_object_run_key update_object_run_key;
1825       %change_extract;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   option nosymbolgen nomlogic validvarname=any validmemname=extend spool mprint 
mprintnest nofullstimer notes bufno=3000 bufsize=65535 ibufno=10000 ibufsize=32767 compress=no;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do connect = "DATABASE=dev_staging DSN=ClouderaImpala64", 
"DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i + 1;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if i = 1 then prefix = 'stg';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else prefix = 'tgt';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 6;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'SCHEMA');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if schema_index = 0 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'DATABASE');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 8;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema = dequote(scan(substr(connect, schema_index + schema_length + 
1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   auth_index = index(connect, 'AUTHDOMAIN');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if auth_index then auth = dequote(scan(substr(connect, auth_index + 10 
+ 1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else auth = ' ';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_schema', cats('`', schema, '`'));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_auth', strip(auth));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tbl_customerinfo, tdw_tbl_customerinfo);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('source_table', lowcase(vname(tbl_customerinfo)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('_target_name', lowcase(vname(tdw_tbl_customerinfo)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
34                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   array col $ 1 customer_key;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length key_cols by_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(key_cols, by_cols);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do over col;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   key_cols = catx(', ', key_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   by_cols = catx(' ', by_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('key_order', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('by_order', strip(by_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   connect to ORACLE(DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" 
READBUFF=20000 dbclient_max_bytes=2 PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev");
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   select object_run_key format=best. into :object_run_key 
trimmed from connection to ORACLE (select lcf.seq_object_run_key.nextval as object_run_key from dual);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   disconnect from ORACLE;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.39 seconds
      cpu time            0.17 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   data _object_run(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if 0 then set lcf.OBJECT_RUN;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_run_key = 9170;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   start_time = "31OCT2019:11:29:54"dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_prg_name = "tdw_tbl_customerinfo P2H2";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status_message = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_read = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_written = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   log_position = getoption('log');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if not missing(log_position) then object_log_name = 
substr(log_position, index(log_position, 'Logs/') + 5);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   load_pattern_name = "Change Extract";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   output;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   drop log_position;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: The data set WORK._OBJECT_RUN has 1 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.35 seconds
35                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

      cpu time            0.16 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc append base=lcf.OBJECT_RUN data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: Appending WORK._OBJECT_RUN to LCF.OBJECT_RUN.
NOTE: There were 1 observations read from the data set WORK._OBJECT_RUN.
NOTE: 1 observations added.
NOTE: The data set LCF.OBJECT_RUN has . observations and 35 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.72 seconds
      cpu time            0.32 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc delete data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;
NOTE: Deleting WORK._OBJECT_RUN (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tdw_tbl_customerinfo);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('meta_target_name', 
strip(lowcase(vname(tdw_tbl_customerinfo))), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(effective_from);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('effective_column', lowcase(vname(effective_from)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   retain table "tdw_tbl_customerinfo";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length table_suffix $ 40 suffix $ 5;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do suffix = '', '_chgt', '_chgd', '_new', '_old', '_dt', '_unwd', 
'_nr';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_suffix = cats(table, suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_length = length(table);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   suffix_length = length(suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if suffix = '_nr' and length(table_suffix) > 32 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   status_msg = catx(' ', 'Table name length too long:', table_suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('status_msg', strip(status_msg));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('hadoop_table' || suffix, cats('`', table_suffix, '`'), 
'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('sas_table' || suffix, table_suffix, 'g');
36                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _tdw_tbl_customerinfo(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: The data set WORK._TDW_TBL_CUSTOMERINFO has 0 observations and 0 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select object_key, coalesce(days_to_backfill, 
0) as days_to_backfill into :object_key trimmed, :backfill trimmed from lcf.OBJECT where lowcase(sas_lib_ref) = "edwtdw" and 
lowcase(target_object_name) = "tdw_tbl_customerinfo";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.27 seconds
      cpu time            0.26 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   connect to SASIOIMP(DBMAX_TEXT=32767 
DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select row_count format=best20., 
int(ifn(max_timestamp ne '1jan1800:0:0'dt, max_timestamp - 10, max_timestamp)) format=is8601dt26.3 into :_nobs trimmed, 
:max_timestamp trimmed from connection to SASIOIMP (select count(*) as `row_count`, coalesce( days_add(max(`effective_from`), -0) , 
'1800-01-01T00:00:00') as `max_timestamp` from `dev_raw`.`tdw_tbl_customerinfo`);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.22 seconds
      cpu time            0.12 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   delete _source_v _source_v_dedup _source_v2 _source_v3 existing_keys 
_source_date_selection;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

37                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 343, object_name = 
"tdw_tbl_customerinfo", prev_high_water_mark_value = inputn("1800-01-01T00:00:00.000", 'is8601dt23.0'), task1 = "Read Source", 
task1_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.79 seconds
      cpu time            0.60 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   create table _source(compress=binary) as select customer_key length=8 format=20. , 
joint_customer_key length=8 format=20. , prime_flag length=10 format=$10. , customer_type length=12 format=$12. , 
customer_document_key length=8 format=20. , folder_key length=8 format=20. , default_flag length=10 format=$10. , profile_number 
length=8 format=20. , commence_date length=8 format=DATETIME29.9 , cease_date length=8 format=DATETIME29.9 , created_date length=8 
format=DATETIME29.9 , name_key length=8 format=20. , namekeyseq length=8 format=20. , display_flag length=24 format=$24. , 
formatted_flag length=10 format=$10. , name_type length=40 format=$40. , family_name length=510 format=$510. , middle_name 
length=100 format=$100. , first_name length=100 format=$100. , name_control length=20 format=$20. , title length=20 format=$20. , 
suffix length=20 format=$20. , free_format_name length=510 format=$510. , list_format_name length=510 format=$510. , 
additional_name length=510 format=$510. , additional_name_2 length=510 format=$510. , address_key length=8 format=20. , 
address_key_sequence length=8 format=20. , address_type length=40 format=$40. , street_1 length=510 format=$510. , street_2 
length=510 format=$510. , unit_type length=100 format=$100. , unit length=60 format=$60. , city length=200 format=$200. , county 
length=12 format=$12. , state length=12 format=$12. , zip length=60 format=$60. , country length=12 format=$12. , attention 
length=510 format=$510. , locationcode length=60 format=$60. , urbanisation length=100 format=$100. , municipality length=60 
format=$60. , district length=60 format=$60. , subdistrict length=60 format=$60. , subprovince length=100 format=$100. , 
address_description length=510 format=$510. , list_format_address length=510 format=$510. , idkey length=8 format=20. , id_type 
length=12 format=$12. , ird_number length=60 format=$60. , formatted_id length=60 format=$60. , district_office length=12 
format=$12. , collect_district_office length=12 format=$12. , review_type length=12 format=$12. , customer_level length=12 
format=$12. , protected_data_source length=8 format=20. , effective_from length=8 format=DATETIME29.9 , effective_to length=8 
format=DATETIME29.9 , current_rec_flag length=2 format=$2. from edwtdw.TBL_CUSTOMERINFO where ( EFFECTIVE_FROM between 
"01JAN1800:00:00:00.000"dt and "31OCT2019:11:29:58.332"dt) ;
NOTE: Compressing data set WORK._SOURCE decreased size by 95.58 percent. 
      Compressed is 245701 pages; un-compressed would require 5552886 pages.
NOTE: Table WORK._SOURCE created, with 49975967 rows and 59 columns.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           50:17.54
      cpu time            19:13.70
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sort data=_source noequals tagsort;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   by customer_key effective_from ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: Tagsort reads each observation of the input data set twice.
NOTE: The data set WORK._SOURCE has 49975967 observations and 59 variables.
NOTE: Compressing data set WORK._SOURCE decreased size by 95.57 percent. 
      Compressed is 245740 pages; un-compressed would require 5552886 pages.
38                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

NOTE: PROCEDURE SORT used (Total process time):
      real time           19:36.06
      cpu time            19:36.18
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 customer_key joint_customer_key prime_flag customer_type 
customer_document_key folder_key default_flag profile_number commence_date cease_date created_date name_key namekeyseq display_flag 
formatted_flag name_type family_name middle_name first_name name_control title suffix free_format_name list_format_name 
additional_name additional_name_2 address_key address_key_sequence address_type street_1 street_2 unit_type unit city county state 
zip country attention locationcode urbanisation municipality district subdistrict subprovince address_description 
list_format_address idkey id_type ird_number formatted_id district_office collect_district_office review_type customer_level 
protected_data_source effective_from effective_to current_rec_flag;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   attrib sas_cols hadoop_cols length=$ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   sas_cols = catx(', ', sas_cols, strip(lowcase(vname(cols))));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   hadoop_cols = catx(', ', hadoop_cols, cats("`", lowcase(vname(cols)), "`"));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('sas_cols', strip(sas_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_cols', strip(hadoop_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_effective_column', cats('`', lowcase(vname(effective_from)), 
'`'), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name into :date_vars separated by ' ' from dictionary.columns where libname = 
'WORK' and memname = '_SOURCE_V' and format like 'DATE%' and format not like 'DATETIME%';
NOTE: No rows were selected.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v2 / view=_source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   retain customer_key joint_customer_key prime_flag customer_type 
customer_document_key folder_key default_flag profile_number commence_date cease_date created_date name_key namekeyseq display_flag 
formatted_flag name_type family_name middle_name first_name name_control title suffix free_format_name list_format_name 
additional_name additional_name_2 address_key address_key_sequence address_type street_1 street_2 unit_type unit city county state 
zip country attention locationcode urbanisation municipality district subdistrict subprovince address_description 
list_format_address idkey id_type ird_number formatted_id district_office collect_district_office review_type customer_level 
protected_data_source effective_from effective_to current_rec_flag ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.12 seconds
      cpu time            0.13 seconds
      
39                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM


MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 343, task1 = "Read 
Source", task1_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 343, task2 = 
"Validation", task2_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 customer_key;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   length key_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   key_cols = catx(', ', key_cols, lowcase(vname(cols)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symput('key_cols', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):   option compress=no missing=' ' nomprint nonotes
There are no rows in work.mismatched_error.
There are 59 rows in work.mismatched_warning.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 343, task2 = 
40                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

"Validation", task2_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;

WARNING: Mismatched columns between source and target
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 343, task3 = "Table 
Load", task3_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name, cats(name, '_x'), catx(' = ', cats(name, '_x'), name) into 
:datetime_names separated by ' ', :datetime_names_char separated by ' ', :datetime_rename separated by ' ' from dictionary.columns 
where libname = 'WORK' and memname = '_SOURCE_V2' and format like 'DATETIME%';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v3(label="Datetimes converted to ISO8601 timestamps") / view=_source_v3;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array from_dt commence_date cease_date created_date effective_from effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array to_dt $ 26 commence_date_x cease_date_x created_date_x effective_from_x 
effective_to_x;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over from_dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   to_dt[_i_] = put(from_dt, is8601dt26.3);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   drop commence_date cease_date created_date effective_from effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   rename commence_date_x = commence_date cease_date_x = cease_date created_date_x = 
created_date effective_from_x = effective_from effective_to_x = effective_to;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V3.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View WORK._SOURCE_V2.VIEW used (Total process time):
41                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

      real time           0.02 seconds
      cpu time            0.04 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.11 seconds
      cpu time            0.13 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_dt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_nr`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_chgt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_chgd`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customerinfo_new`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customerinfo_old`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.04 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select ifc(format not like 'DATETIME%', cats('`', name, '`'), cat('cast(null as 
varchar(26)) as `', strip(name), '`')) into :create_string separated by ', ' from dictionary.columns where libname = "IMPRAW" and 
upcase(memname) = "TDW_TBL_CUSTOMERINFO" and lowcase(name) notin('record_effective_timestamp', 'record_expiry_timestamp', 
'record_active_flag', 'record_deleted_flag', 'insert_object_run_key', 'update_object_run_key') ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`tdw_tbl_customerinfo` with serdeproperties 
('field.delim'='\u0006', 'line.delim'='\u0007', 'serialization.format'='\u0006','serialization.escape.crlf'='true') stored as 
textfile as select `customer_key`, `joint_customer_key`, `prime_flag`, `customer_type`, `customer_document_key`, `folder_key`, 
`default_flag`, `profile_number`, cast(null as varchar(26)) as `commence_date`, cast(null as varchar(26)) as `cease_date`, 
42                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

cast(null as varchar(26)) as `created_date`, `name_key`, `namekeyseq`, `display_flag`, `formatted_flag`, `name_type`, 
`family_name`, `middle_name`, `first_name`, `name_control`, `title`, `suffix`, `free_format_name`, `list_format_name`, 
`additional_name`, `additional_name_2`, `address_key`, `address_key_sequence`, `address_type`, `street_1`, `street_2`, `unit_type`, 
`unit`, `city`, `county`, `state`, `zip`, `country`, `attention`, `locationcode`, `urbanisation`, `municipality`, `district`, 
`subdistrict`, `subprovince`, `address_description`, `list_format_address`, `idkey`, `id_type`, `ird_number`, `formatted_id`, 
`district_office`, `collect_district_office`, `review_type`, `customer_level`, `protected_data_source`, cast(null as varchar(26)) 
as `effective_from`, cast(null as varchar(26)) as `effective_to`, `current_rec_flag` from `dev_raw`.`tdw_tbl_customerinfo` where 
false) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   insert into hivestg.tdw_tbl_customerinfo(bulkload=yes) select customer_key, 
joint_customer_key, prime_flag, customer_type, customer_document_key, folder_key, default_flag, profile_number, commence_date, 
cease_date, created_date, name_key, namekeyseq, display_flag, formatted_flag, name_type, family_name, middle_name, first_name, 
name_control, title, suffix, free_format_name, list_format_name, additional_name, additional_name_2, address_key, 
address_key_sequence, address_type, street_1, street_2, unit_type, unit, city, county, state, zip, country, attention, 
locationcode, urbanisation, municipality, district, subdistrict, subprovince, address_description, list_format_address, idkey, 
id_type, ird_number, formatted_id, district_office, collect_district_office, review_type, customer_level, protected_data_source, 
effective_from, effective_to, current_rec_flag from _source_v3;
NOTE: There were 49975967 observations read from the data set WORK._SOURCE.
NOTE: View WORK._SOURCE_V3.VIEW used (Total process time):
      real time           22:25.61
      cpu time            15:40.61
      
NOTE: There were 49975967 observations read from the data set WORK._SOURCE_V2.
NOTE: 49975967 rows were inserted into HIVESTG.TDW_TBL_CUSTOMERINFO.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           22:36.05
      cpu time            15:40.91
      


INFO: 49,975,967 observations inserted
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are no observations in impstg.tdw_tbl_customerinfo (dev_staging.tdw_tbl_customerinfo) where `customer_key` is null or 
`effective_from` is null.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql dquote=ansi noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select count(*) into :date_columns_count trimmed from dictionary.columns where 
libname = 'WORK' and memname = '_SOURCE_V2' and ( format like 'DATETIME%' or format like 'IS8601DT%');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select case when format like 'DATETIME%' or format like 'IS8601DT%' then 
cat('cast(`', strip(lowcase(name)), '` as timestamp) as `', strip(name), '`') else cats('`', name, '`') end as select_clause into 
43                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

:select_clause separated by ', ' from dictionary.columns where libname = 'WORK' and memname = '_SOURCE_V2';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`tdw_tbl_customerinfo_dt` stored as parquet as 
select `customer_key`, `joint_customer_key`, `prime_flag`, `customer_type`, `customer_document_key`, `folder_key`, `default_flag`, 
`profile_number`, cast(`commence_date` as timestamp) as `commence_date`, cast(`cease_date` as timestamp) as `cease_date`, 
cast(`created_date` as timestamp) as `created_date`, `name_key`, `namekeyseq`, `display_flag`, `formatted_flag`, `name_type`, 
`family_name`, `middle_name`, `first_name`, `name_control`, `title`, `suffix`, `free_format_name`, `list_format_name`, 
`additional_name`, `additional_name_2`, `address_key`, `address_key_sequence`, `address_type`, `street_1`, `street_2`, `unit_type`, 
`unit`, `city`, `county`, `state`, `zip`, `country`, `attention`, `locationcode`, `urbanisation`, `municipality`, `district`, 
`subdistrict`, `subprovince`, `address_description`, `list_format_address`, `idkey`, `id_type`, `ird_number`, `formatted_id`, 
`district_office`, `collect_district_office`, `review_type`, `customer_level`, `protected_data_source`, cast(`effective_from` as 
timestamp) as `effective_from`, cast(`effective_to` as timestamp) as `effective_to`, `current_rec_flag` from 
`dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`tdw_tbl_customerinfo_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (drop table `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (alter table `dev_staging`.`tdw_tbl_customerinfo_dt` rename to 
`dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (compute stats `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:08.86
      cpu time            0.51 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute(create table `dev_staging`.`tdw_tbl_customerinfo_nr` stored as parquet as 
select _left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, _left.`customer_document_key`, 
_left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, _left.`cease_date`, _left.`created_date`, 
_left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, _left.`name_type`, _left.`family_name`, 
_left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, _left.`suffix`, _left.`free_format_name`, 
_left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, _left.`address_key`, _left.`address_key_sequence`, 
_left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, _left.`unit`, _left.`city`, _left.`county`, 
_left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, _left.`urbanisation`, _left.`municipality`, 
_left.`district`, _left.`subdistrict`, _left.`subprovince`, _left.`address_description`, _left.`list_format_address`, 
_left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, _left.`district_office`, _left.`collect_district_office`, 
_left.`review_type`, _left.`customer_level`, _left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, 
_left.`current_rec_flag` from `dev_staging`.`tdw_tbl_customerinfo` as _left left join `dev_raw`.`tdw_tbl_customerinfo` as _right on 
_left.`customer_key` = _right.`customer_key` and _left.`effective_from` = _right.`effective_from` where _right.`customer_key` is 
null) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           55.93 seconds
      cpu time            0.32 seconds
      

44                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are 49,975,967 observations in impstg.tdw_tbl_customerinfo_nr (dev_staging.tdw_tbl_customerinfo_nr).
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task3 = 
"Table Load", task3_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.71 seconds
      cpu time            0.51 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task4 = "Capture Changes", 
task4_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.69 seconds
      cpu time            0.50 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql noprint;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (invalidate metadata `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT):   execute (refresh `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`tdw_tbl_customerinfo_chgt` stored as parquet as with new_min as 
(select `customer_key`, min(`effective_from`) as `effective_ts` from `dev_staging`.`tdw_tbl_customerinfo_nr` group by 
`customer_key`), current_max as (select `customer_key`, max(record_effective_timestamp) as `effective_ts` from 
`dev_raw`.`tdw_tbl_customerinfo` group by `customer_key`), new_ranked as (select `customer_key`, `effective_from` as 
`effective_ts`, rank() over(partition by `customer_key` order by `effective_from`) as `rank` from 
`dev_staging`.`tdw_tbl_customerinfo_nr`), previous_active as (select distinct `customer_key`, `effective_ts`, `rank` - 1 as `rank` 
from new_ranked) select _left.`customer_key`, _left.`effective_ts`, _left.`effective_ts` as `record_effective_timestamp`, 
milliseconds_add(_right.`effective_ts`, -1) as `record_expiry_timestamp`, cast('U' as varchar(1)) as `operation`, cast(9170 as int) 
as `object_run_key` from current_max as _left left join new_min as _right on _left.`customer_key` = _right.`customer_key` where 
_right.`customer_key` is not null union all select _left.`customer_key`, _left.`effective_ts`, case when _left.`rank` = 1 then 
cast('1800-01-01T00:00:00' as timestamp) else _left.`effective_ts` end as `record_effective_timestamp`, 
45                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

coalesce(milliseconds_add(_right.`effective_ts`, -1), cast('9000-12-31T00:00:00' as timestamp)) as `record_expiry_timestamp`, 
cast('I' as varchar(1)) as `operation`, cast(9170 as int) as `object_run_key` from new_ranked as _left left join previous_active as 
_right on _left.`customer_key` = _right.`customer_key` and _left.`rank` = _right.`rank`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   select count into :_nobs from connection to SASIOIMP (select count(*) as `count` from 
`dev_staging`.`tdw_tbl_customerinfo_chgt`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           41.56 seconds
      cpu time            0.33 seconds
      


INFO: There are 49,975,967 rows in tdw_tbl_customerinfo_chgt
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`tdw_tbl_customerinfo_chgd` stored as parquet as select 
_left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, _left.`customer_document_key`, 
_left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, _left.`cease_date`, _left.`created_date`, 
_left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, _left.`name_type`, _left.`family_name`, 
_left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, _left.`suffix`, _left.`free_format_name`, 
_left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, _left.`address_key`, _left.`address_key_sequence`, 
_left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, _left.`unit`, _left.`city`, _left.`county`, 
_left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, _left.`urbanisation`, _left.`municipality`, 
_left.`district`, _left.`subdistrict`, _left.`subprovince`, _left.`address_description`, _left.`list_format_address`, 
_left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, _left.`district_office`, _left.`collect_district_office`, 
_left.`review_type`, _left.`customer_level`, _left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, 
_left.`current_rec_flag`, _right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, 
_right.object_run_key from `dev_staging`.`tdw_tbl_customerinfo_nr` as _left inner join `dev_staging`.`tdw_tbl_customerinfo_chgt` as 
_right on _left.`customer_key` = _right.`customer_key` and _left.`effective_from` = _right.`effective_ts` and _right.operation = 
'I' union all select _left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, 
_left.`customer_document_key`, _left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, 
_left.`cease_date`, _left.`created_date`, _left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, 
_left.`name_type`, _left.`family_name`, _left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, 
_left.`suffix`, _left.`free_format_name`, _left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, 
_left.`address_key`, _left.`address_key_sequence`, _left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, 
_left.`unit`, _left.`city`, _left.`county`, _left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, 
_left.`urbanisation`, _left.`municipality`, _left.`district`, _left.`subdistrict`, _left.`subprovince`, 
_left.`address_description`, _left.`list_format_address`, _left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, 
_left.`district_office`, _left.`collect_district_office`, _left.`review_type`, _left.`customer_level`, 
_left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, _left.`current_rec_flag`, 
_right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, _right.object_run_key from 
`dev_raw`.`tdw_tbl_customerinfo` as _left inner join `dev_staging`.`tdw_tbl_customerinfo_chgt` as _right on _left.`customer_key` = 
_right.`customer_key` and _left.record_effective_timestamp = _right.record_effective_timestamp and _right.operation = 'U') by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:55.60
      cpu time            0.60 seconds
      
46                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM


MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task4 = "Capture Changes", 
task4_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.69 seconds
      cpu time            0.49 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task5 = "Apply Changes", 
task5_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.70 seconds
      cpu time            0.50 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_raw`.`tdw_tbl_customerinfo_new` stored as parquet as select 
_left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, _left.`customer_document_key`, 
_left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, _left.`cease_date`, _left.`created_date`, 
_left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, _left.`name_type`, _left.`family_name`, 
_left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, _left.`suffix`, _left.`free_format_name`, 
_left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, _left.`address_key`, _left.`address_key_sequence`, 
_left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, _left.`unit`, _left.`city`, _left.`county`, 
_left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, _left.`urbanisation`, _left.`municipality`, 
_left.`district`, _left.`subdistrict`, _left.`subprovince`, _left.`address_description`, _left.`list_format_address`, 
_left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, _left.`district_office`, _left.`collect_district_office`, 
_left.`review_type`, _left.`customer_level`, _left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, 
_left.`current_rec_flag`, _left.record_effective_timestamp, _left.record_expiry_timestamp, _left.record_active_flag, 
_left.record_deleted_flag, _left.insert_object_run_key, _left.update_object_run_key from `dev_raw`.`tdw_tbl_customerinfo` as _left 
left join `dev_staging`.`tdw_tbl_customerinfo_chgd` as _right on _left.`customer_key` = _right.`customer_key` and 
_left.record_effective_timestamp = _right.record_effective_timestamp and _right.object_run_key = 9170 where _right.`customer_key` 
is null union all select _left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, 
_left.`customer_document_key`, _left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, 
_left.`cease_date`, _left.`created_date`, _left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, 
_left.`name_type`, _left.`family_name`, _left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, 
_left.`suffix`, _left.`free_format_name`, _left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, 
_left.`address_key`, _left.`address_key_sequence`, _left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, 
_left.`unit`, _left.`city`, _left.`county`, _left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, 
_left.`urbanisation`, _left.`municipality`, _left.`district`, _left.`subdistrict`, _left.`subprovince`, 
47                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

_left.`address_description`, _left.`list_format_address`, _left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, 
_left.`district_office`, _left.`collect_district_office`, _left.`review_type`, _left.`customer_level`, 
_left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, _left.`current_rec_flag`, record_effective_timestamp, 
record_expiry_timestamp, cast(case when record_expiry_timestamp >= cast("9000-12-31T00:00:00" as timestamp) then 'Y' else 'N' end 
as varchar(1)) as record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, object_run_key as insert_object_run_key, 
object_run_key as update_object_run_key from `dev_staging`.`tdw_tbl_customerinfo_chgd` as _left where object_run_key = 9170 and 
operation = 'I' union all select _left.`customer_key`, _left.`joint_customer_key`, _left.`prime_flag`, _left.`customer_type`, 
_left.`customer_document_key`, _left.`folder_key`, _left.`default_flag`, _left.`profile_number`, _left.`commence_date`, 
_left.`cease_date`, _left.`created_date`, _left.`name_key`, _left.`namekeyseq`, _left.`display_flag`, _left.`formatted_flag`, 
_left.`name_type`, _left.`family_name`, _left.`middle_name`, _left.`first_name`, _left.`name_control`, _left.`title`, 
_left.`suffix`, _left.`free_format_name`, _left.`list_format_name`, _left.`additional_name`, _left.`additional_name_2`, 
_left.`address_key`, _left.`address_key_sequence`, _left.`address_type`, _left.`street_1`, _left.`street_2`, _left.`unit_type`, 
_left.`unit`, _left.`city`, _left.`county`, _left.`state`, _left.`zip`, _left.`country`, _left.`attention`, _left.`locationcode`, 
_left.`urbanisation`, _left.`municipality`, _left.`district`, _left.`subdistrict`, _left.`subprovince`, 
_left.`address_description`, _left.`list_format_address`, _left.`idkey`, _left.`id_type`, _left.`ird_number`, _left.`formatted_id`, 
_left.`district_office`, _left.`collect_district_office`, _left.`review_type`, _left.`customer_level`, 
_left.`protected_data_source`, _left.`effective_from`, _left.`effective_to`, _left.`current_rec_flag`, 
_left.record_effective_timestamp, _left.record_expiry_timestamp, cast('N' as varchar(1)) as record_active_flag, cast('N' as 
varchar(1)) as record_deleted_flag, _right.insert_object_run_key, _left.object_run_key as update_object_run_key from 
`dev_staging`.`tdw_tbl_customerinfo_chgd` as _left inner join `dev_raw`.`tdw_tbl_customerinfo` as _right on _left.`customer_key` = 
_right.`customer_key` and _left.record_effective_timestamp = _right.record_effective_timestamp and _left.object_run_key = 9170 and 
_left.operation = 'U') by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1:33.55
      cpu time            0.50 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task5 = "Apply Changes", 
task5_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task6 = "Reconciliation", 
task6_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
48                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc sql;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_source_v as select 'Source' as type length=6, measure length=6, count as 
source_count format=comma14. from connection to SASIOIMP (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_staging`.`tdw_tbl_customerinfo_nr` union all select cast('update' as varchar(6)) as measure, count(distinct 
_left.`customer_key`) as count from `dev_staging`.`tdw_tbl_customerinfo_nr` as _left inner join (select distinct `customer_key` 
from `dev_raw`.`tdw_tbl_customerinfo`) as _right on _left.`customer_key` = _right.`customer_key`);
NOTE: SQL view WORK.COUNT_SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_target_v as select 'Target' as type length=6, measure length=6, count as 
target_count format=comma14. from connection to sasioimp (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_raw`.`tdw_tbl_customerinfo_new` as _left inner join (select distinct object_run_key from 
`dev_staging`.`tdw_tbl_customerinfo_chgt`) as _right on _left.insert_object_run_key = _right.object_run_key union all select 
cast('update' as varchar) as measure, count(*) as count from `dev_raw`.`tdw_tbl_customerinfo_new` as _left inner join (select 
distinct object_run_key from `dev_staging`.`tdw_tbl_customerinfo_chgt`) as _right on _left.update_object_run_key = 
_right.object_run_key where update_object_run_key != insert_object_run_key);
NOTE: SQL view WORK.COUNT_TARGET_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.03 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   data _null_;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   merge count_source_v(in=in_source) count_target_v(in=in_target);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   by measure;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   format source_count target_count comma14.;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   retain m1 -1 error 0;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   attrib status_msg length=$ 32767;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   if source_count ne target_count then do;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   status_msg = cat('ERROR: Mismatch on ', strip(measure), ': Source count ', 
strip(putn(source_count, 'comma14.')), '; Target count: ', strip(putn(target_count, 'comma14.')), '.');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call symputx('status_msg', strip(status_msg), 'g');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   stop;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   end;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   else putlog 'Matched on ' measure +m1 ': rows ' source_count;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   run;
49                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM


Matched on insert: rows 49,975,967
Matched on update: rows 0
NOTE: There were 2 observations read from the data set WORK.COUNT_SOURCE_V.
NOTE: There were 2 observations read from the data set WORK.COUNT_TARGET_V.
NOTE: DATA statement used (Total process time):
      real time           1.22 seconds
      cpu time            0.07 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: Deleting WORK.COUNT_SOURCE_V (memtype=VIEW).
NOTE: Deleting WORK.COUNT_TARGET_V (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   select count into :_nobs trimmed from connection to SASIOIMP (select count(*) as `count` from 
`dev_raw`.`tdw_tbl_customerinfo_new` where `record_effective_timestamp` > `record_expiry_timestamp`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.03 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task6 = "Reconciliation", 
task6_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task7 = "Commit", 
task7_start_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
50                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute (refresh `dev_raw`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`tdw_tbl_customerinfo` rename to 
`dev_raw`.`tdw_tbl_customerinfo_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`tdw_tbl_customerinfo_new` rename to 
`dev_raw`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(drop table `dev_raw`.`tdw_tbl_customerinfo_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(refresh `dev_raw`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(compute stats `dev_raw`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           22.72 seconds
      cpu time            0.23 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 49975967, object_key = 343, task7 = "Commit", 
task7_end_time = datetime() where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
51                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT.LOGGING):   select coalesce(max_timestamp, '1jan1800:0:0'dt) as max_timestamp format=datetime26.3 into 
:max_timestamp trimmed from connection to SASIOIMP (select max(effective_from) as max_timestamp from 
`dev_raw`.`tdw_tbl_customerinfo`);
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.33 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   run;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   option nomprint nonotes
There are 49,975,967 observations in impraw.tdw_tbl_customerinfo (dev_raw.tdw_tbl_customerinfo) where update_object_run_key = 9170.

WARNING: Job Ended with Warnings in insertion into `dev_raw`.`tdw_tbl_customerinfo`
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set end_time = datetime(), records_written = 49975967, 
high_water_mark_value = "31OCT2019:04:22:26.000"dt, status = "Job Ended with Warnings in insertion into 
`dev_raw`.`tdw_tbl_customerinfo`", status_message = "49,975,967 rows updated on tdw_tbl_customerinfo" where object_run_key = 9170;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.94 seconds
      cpu time            0.76 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_nr`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_chgt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`tdw_tbl_customerinfo_chgd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customerinfo_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`tdw_tbl_customerinfo_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.19 seconds
      

52                                                         The SAS System                      Thursday, 31 October 2019 11:29:00 AM

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.EXIT_RETURN_CODE):   data _null_;
MPRINT(CHANGE_EXTRACT.EXIT_RETURN_CODE):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
1855       
1856       %rcSet(&syserr);
1857       %rcSet(&sysrc);
1858       %rcSet(&sqlrc);
1859       
1860       
1861       
1862       /** Step end Change Extract **/
1863       
1864       %let etls_endTime = %sysfunc(datetime(),datetime.);
1865       
1866       
1867       
1868       
1869       %LET _CLIENTTASKLABEL=;
1870       %LET _CLIENTPROCESSFLOWNAME=;
1871       %LET _CLIENTPROJECTPATH=;
1872       %LET _CLIENTPROJECTPATHHOST=;
1873       %LET _CLIENTPROJECTNAME=;
1874       %LET _SASPROGRAMFILE=;
1875       %LET _SASPROGRAMFILEHOST=;
1876       
1877       ;*';*";*/;quit;run;
1878       ODS _ALL_ CLOSE;
1879       
1880       
1881       QUIT; RUN;
1882       
