1                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

1          ;*';*";*/;quit;run;
2          OPTIONS PAGENO=MIN;
3          %LET _CLIENTTASKLABEL='app_tblnz_customerstd P2H2 20191030';
4          %LET _CLIENTPROCESSFLOWNAME='Process Flow';
5          %LET _CLIENTPROJECTPATH='';
6          %LET _CLIENTPROJECTPATHHOST='';
7          %LET _CLIENTPROJECTNAME='';
8          %LET _SASPROGRAMFILE='H:\DIP Data Management\Load Control Framework\3.8\app_tblnz_customerstd P2H2 20191030.sas';
9          %LET _SASPROGRAMFILEHOST='IRDTS64';
10         
11         ODS _ALL_ CLOSE;
12         OPTIONS DEV=PNG;
13         FILENAME EGSR TEMP;
14         ODS tagsets.sasreport13(ID=EGSR) FILE=EGSR
15             STYLE=HTMLBlue
16             STYLESHEET=(URL="file:///H:/sso/sfw/sas_factory/940/x86/SASEnterpriseGuide/7.1/Styles/HTMLBlue.css")
17             NOGTITLE
18             NOGFOOTNOTE
19             GPATH=&sasworklocation
20             ENCODING=UTF8
21             options(rolap="on")
22         ;
NOTE: Writing TAGSETS.SASREPORT13(EGSR) Body file: EGSR
23         
24         /****************************************************************************
25          * Job:             app_tblnz_customerstd P2H2            A5IKCEC7.BR00008K *
26          * Description:                                                             *
27          *                                                                          *
28          * Metadata Server: ird10119au.vsp.sas.com                                  *
29          * Port:            8561                                                    *
30          * Location:        /IRD/DIP Data Management/5000 Processes/10 Raw          *
31          *                   Ingestion                                              *
32          *                                                                          *
33          * Server:          SASApp                                A5IKCEC7.AS000002 *
34          *                                                                          *
35          * Source Table:    tblNZ_CustomerStd -                   A5IKCEC7.BE00002H *
36          *                   strapp.tblNZ_CustomerStd                               *
37          * Target Table:    app_tblnz_customerstd -               A5IKCEC7.BE00001G *
38          *                   impraw.app_tblnz_customerstd                           *
39          *                                                                          *
40          * Generated on:    Wednesday, October 30, 2019 3:46:13 PM NZDT             *
41          * Generated by:    ird0nxa                                                 *
42          * Version:         SAS Data Integration Studio 4.903                       *
43          ****************************************************************************/
44         
45         /* Generate the process id for job  */
46         %put Process ID: &SYSJOBID;
Process ID: 60249
47         
48         /* General macro variables  */
49         %let jobID = %quote(A5IKCEC7.BR00008K);
50         %let etls_jobName = %nrquote(app_tblnz_customerstd P2H2);
51         %let etls_userID = %nrquote(ird0nxa);
52         
53         /* Setup to capture return codes  */
54         %global job_rc trans_rc sqlrc;
55         %let sysrc = 0;
56         %let job_rc = 0;
2                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

57         %let trans_rc = 0;
58         %let sqlrc = 0;
59         %global etls_stepStartTime;
60         /* initialize syserr to 0 */
61         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      user cpu time       0.00 seconds
      system cpu time     0.00 seconds
      memory              316.75k
      OS Memory           37640.00k
      Timestamp           30/10/2019 04:39:34 PM
      Step Count                        10  Switch Count  0
      Page Faults                       0
      Page Reclaims                     45
      Page Swaps                        0
      Voluntary Context Switches        0
      Involuntary Context Switches      0
      Block Input Operations            0
      Block Output Operations           0
      

62         
63         %macro rcSet(error);
64            %if (&error gt &trans_rc) %then
65               %let trans_rc = &error;
66            %if (&error gt &job_rc) %then
67               %let job_rc = &error;
68         %mend rcSet;
69         
70         %macro rcSetDS(error);
71            if &error gt input(symget('trans_rc'),12.) then
72               call symput('trans_rc',trim(left(put(&error,12.))));
73            if &error gt input(symget('job_rc'),12.) then
74               call symput('job_rc',trim(left(put(&error,12.))));
75         %mend rcSetDS;
76         
77         /* Create metadata macro variables */
78         %let IOMServer      = %nrquote(SASApp);
79         %let metaPort       = %nrquote(8561);
80         %let metaServer     = %nrquote(ird10119au.vsp.sas.com);
81         
82         /* Setup for capturing job status  */
83         %let etls_startTime = %sysfunc(datetime(),datetime.);
84         %let etls_recordsBefore = 0;
85         %let etls_recordsAfter = 0;
86         %let etls_lib = 0;
87         %let etls_table = 0;
88         
89         %global etls_debug;
90         %macro etls_setDebug;
91            %if %str(&etls_debug) ne 0 %then
92               OPTIONS MPRINT%str(;);
93         %mend;
94         %etls_setDebug;
95         
96         /*==========================================================================*
3                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

97          * Step:            Change Extract                        A5IKCEC7.BT0002JX *
98          * Transform:       Change Extract                                          *
99          * Description:                                                             *
100         *                                                                          *
101         * Source Table:    tblNZ_CustomerStd -                   A5IKCEC7.BE00002H *
102         *                   strapp.tblNZ_CustomerStd                               *
103         * Target Table:    app_tblnz_customerstd -               A5IKCEC7.BE00001G *
104         *                   impraw.app_tblnz_customerstd                           *
105         *==========================================================================*/
106        
107        %let transformID = %quote(A5IKCEC7.BT0002JX);
108        %let trans_rc = 0;
109        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
110        
111        /* Access the data for START GTAPP (strapp)  */
112        LIBNAME strapp SQLSVR  PRESERVE_TAB_NAMES=YES  DBMAX_TEXT=32767  PRESERVE_COL_NAMES=YES  Datasrc=NZO_GTAPP  SCHEMA=dbo
112      ! AUTHDOMAIN="start_operations" ;
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref STRAPP was successfully assigned as follows: 
      Engine:        SQLSVR 
      Physical Name: NZO_GTAPP
113        %rcSet(&syslibrc);
114        
115        /* Access the data for DIP Impala RAW (impraw)  */
116        LIBNAME impraw SASIOIMP  DATABASE=dev_raw  DBMAX_TEXT=32767  DSN=ClouderaImpala64  SCHEMA=dev_raw ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPRAW was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
117        %rcSet(&syslibrc);
118        
119        %let SYSLAST = %nrquote(strapp.tblNZ_CustomerStd);
120        
121        %let _INPUT_count = 1;
122        %let _INPUT = strapp.tblNZ_CustomerStd;
123        %let _INPUT_connect =  DBMAX_TEXT=32767 DATASRC=NZO_GTAPP AUTHDOMAIN="start_operations"
124        ;
125        %let _INPUT_engine = SQLSVR;
126        %let _INPUT_memtype = DATA;
127        %let _INPUT_options = %nrquote();
128        %let _INPUT_alter = %nrquote();
129        %let _INPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/START/START GTAPP/tblNZ_CustomerStd%(Table%));
130        %let _INPUT_type = 1;
131        %let _INPUT_label = %nrquote();
132        
133        %let _Source = strapp.tblNZ_CustomerStd;
134        %let _Source_connect =  DBMAX_TEXT=32767 DATASRC=NZO_GTAPP AUTHDOMAIN="start_operations"
135        ;
136        %let _Source_engine = SQLSVR;
137        %let _Source_memtype = DATA;
138        %let _Source_options = %nrquote();
139        %let _Source_alter = %nrquote();
140        %let _Source_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/START/START GTAPP/tblNZ_CustomerStd%(Table%));
141        %let _Source_type = 1;
142        %let _Source_label = %nrquote();
143        
144        %let _OUTPUT_count = 1;
4                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

145        %let _OUTPUT = impraw.app_tblnz_customerstd;
146        %let _OUTPUT_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
147        ;
148        %let _OUTPUT_engine = SASIOIMP;
149        %let _OUTPUT_memtype = DATA;
150        %let _OUTPUT_options = %nrquote();
151        %let _OUTPUT_alter = %nrquote();
152        %let _OUTPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala
152      ! Raw/app_tblnz_customerstd%(Table%));
153        %let _OUTPUT_type = 1;
154        %let _OUTPUT_label = %nrquote();
155        /* List of target columns to keep  */
156        %let _OUTPUT_keep = flngdockey fstrcustomersubtypeclass fstrcustomersubtype
157                fstrcustomersegment fstrspecialfiletype fblnspecialtaxresidency
158                fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason
159                fintsmscountrycode fstrsmsareacode fstrsmsphonenumber
160                fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen
161                record_effective_timestamp record_expiry_timestamp record_active_flag
162                record_deleted_flag insert_object_run_key update_object_run_key;
163        %let _OUTPUT_col_count = 22;
164        %let _OUTPUT_col0_name = flngdockey;
165        %let _OUTPUT_col0_table = impraw.app_tblnz_customerstd;
166        %let _OUTPUT_col0_length = 8;
167        %let _OUTPUT_col0_type = ;
168        %let _OUTPUT_col0_format = 11.;
169        %let _OUTPUT_col0_informat = 11.;
170        %let _OUTPUT_col0_label = %nrquote(flngdockey);
171        %let _OUTPUT_col0_input0 = flngDocKey;
172        %let _OUTPUT_col0_input0_table = strapp.tblNZ_CustomerStd;
173        %let _OUTPUT_col0_exp = ;
174        %let _OUTPUT_col0_input = flngDocKey;
175        %let _OUTPUT_col0_input_count = 1;
176        %let _OUTPUT_col1_name = fstrcustomersubtypeclass;
177        %let _OUTPUT_col1_table = impraw.app_tblnz_customerstd;
178        %let _OUTPUT_col1_length = 12;
179        %let _OUTPUT_col1_type = $;
180        %let _OUTPUT_col1_format = $12.;
181        %let _OUTPUT_col1_informat = $12.;
182        %let _OUTPUT_col1_label = %nrquote(fstrcustomersubtypeclass);
183        %let _OUTPUT_col1_input0 = fstrCustomerSubTypeClass;
184        %let _OUTPUT_col1_input0_table = strapp.tblNZ_CustomerStd;
185        %let _OUTPUT_col1_exp = ;
186        %let _OUTPUT_col1_input = fstrCustomerSubTypeClass;
187        %let _OUTPUT_col1_input_count = 1;
188        %let _OUTPUT_col2_name = fstrcustomersubtype;
189        %let _OUTPUT_col2_table = impraw.app_tblnz_customerstd;
190        %let _OUTPUT_col2_length = 12;
191        %let _OUTPUT_col2_type = $;
192        %let _OUTPUT_col2_format = $12.;
193        %let _OUTPUT_col2_informat = $12.;
194        %let _OUTPUT_col2_label = %nrquote(fstrcustomersubtype);
195        %let _OUTPUT_col2_input0 = fstrCustomerSubType;
196        %let _OUTPUT_col2_input0_table = strapp.tblNZ_CustomerStd;
197        %let _OUTPUT_col2_exp = ;
198        %let _OUTPUT_col2_input = fstrCustomerSubType;
199        %let _OUTPUT_col2_input_count = 1;
200        %let _OUTPUT_col3_name = fstrcustomersegment;
201        %let _OUTPUT_col3_table = impraw.app_tblnz_customerstd;
5                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

202        %let _OUTPUT_col3_length = 100;
203        %let _OUTPUT_col3_type = $;
204        %let _OUTPUT_col3_format = $100.;
205        %let _OUTPUT_col3_informat = $100.;
206        %let _OUTPUT_col3_label = %nrquote(fstrcustomersegment);
207        %let _OUTPUT_col3_input0 = fstrCustomerSegment;
208        %let _OUTPUT_col3_input0_table = strapp.tblNZ_CustomerStd;
209        %let _OUTPUT_col3_exp = ;
210        %let _OUTPUT_col3_input = fstrCustomerSegment;
211        %let _OUTPUT_col3_input_count = 1;
212        %let _OUTPUT_col4_name = fstrspecialfiletype;
213        %let _OUTPUT_col4_table = impraw.app_tblnz_customerstd;
214        %let _OUTPUT_col4_length = 12;
215        %let _OUTPUT_col4_type = $;
216        %let _OUTPUT_col4_format = $12.;
217        %let _OUTPUT_col4_informat = $12.;
218        %let _OUTPUT_col4_label = %nrquote(fstrspecialfiletype);
219        %let _OUTPUT_col4_input0 = fstrSpecialFileType;
220        %let _OUTPUT_col4_input0_table = strapp.tblNZ_CustomerStd;
221        %let _OUTPUT_col4_exp = ;
222        %let _OUTPUT_col4_input = fstrSpecialFileType;
223        %let _OUTPUT_col4_input_count = 1;
224        %let _OUTPUT_col5_name = fblnspecialtaxresidency;
225        %let _OUTPUT_col5_table = impraw.app_tblnz_customerstd;
226        %let _OUTPUT_col5_length = 8;
227        %let _OUTPUT_col5_type = ;
228        %let _OUTPUT_col5_format = 6.;
229        %let _OUTPUT_col5_informat = 6.;
230        %let _OUTPUT_col5_label = %nrquote(fblnspecialtaxresidency);
231        %let _OUTPUT_col5_input0 = fblnSpecialTaxResidency;
232        %let _OUTPUT_col5_input0_table = strapp.tblNZ_CustomerStd;
233        %let _OUTPUT_col5_exp = ;
234        %let _OUTPUT_col5_input = fblnSpecialTaxResidency;
235        %let _OUTPUT_col5_input_count = 1;
236        %let _OUTPUT_col6_name = fstrnonresidenttype;
237        %let _OUTPUT_col6_table = impraw.app_tblnz_customerstd;
238        %let _OUTPUT_col6_length = 100;
239        %let _OUTPUT_col6_type = $;
240        %let _OUTPUT_col6_format = $100.;
241        %let _OUTPUT_col6_informat = $100.;
242        %let _OUTPUT_col6_label = %nrquote(fstrnonresidenttype);
243        %let _OUTPUT_col6_input0 = fstrNonResidentType;
244        %let _OUTPUT_col6_input0_table = strapp.tblNZ_CustomerStd;
245        %let _OUTPUT_col6_exp = ;
246        %let _OUTPUT_col6_input = fstrNonResidentType;
247        %let _OUTPUT_col6_input_count = 1;
248        %let _OUTPUT_col7_name = fstrcurrenttaxresidency;
249        %let _OUTPUT_col7_table = impraw.app_tblnz_customerstd;
250        %let _OUTPUT_col7_length = 100;
251        %let _OUTPUT_col7_type = $;
252        %let _OUTPUT_col7_format = $100.;
253        %let _OUTPUT_col7_informat = $100.;
254        %let _OUTPUT_col7_label = %nrquote(fstrcurrenttaxresidency);
255        %let _OUTPUT_col7_input0 = fstrCurrentTaxResidency;
256        %let _OUTPUT_col7_input0_table = strapp.tblNZ_CustomerStd;
257        %let _OUTPUT_col7_exp = ;
258        %let _OUTPUT_col7_input = fstrCurrentTaxResidency;
259        %let _OUTPUT_col7_input_count = 1;
6                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

260        %let _OUTPUT_col8_name = fstrclosurereason;
261        %let _OUTPUT_col8_table = impraw.app_tblnz_customerstd;
262        %let _OUTPUT_col8_length = 12;
263        %let _OUTPUT_col8_type = $;
264        %let _OUTPUT_col8_format = $12.;
265        %let _OUTPUT_col8_informat = $12.;
266        %let _OUTPUT_col8_label = %nrquote(fstrclosurereason);
267        %let _OUTPUT_col8_input0 = fstrClosureReason;
268        %let _OUTPUT_col8_input0_table = strapp.tblNZ_CustomerStd;
269        %let _OUTPUT_col8_exp = ;
270        %let _OUTPUT_col8_input = fstrClosureReason;
271        %let _OUTPUT_col8_input_count = 1;
272        %let _OUTPUT_col9_name = fintsmscountrycode;
273        %let _OUTPUT_col9_table = impraw.app_tblnz_customerstd;
274        %let _OUTPUT_col9_length = 8;
275        %let _OUTPUT_col9_type = ;
276        %let _OUTPUT_col9_format = 6.;
277        %let _OUTPUT_col9_informat = 6.;
278        %let _OUTPUT_col9_label = %nrquote(fintsmscountrycode);
279        %let _OUTPUT_col9_input0 = fintSMSCountryCode;
280        %let _OUTPUT_col9_input0_table = strapp.tblNZ_CustomerStd;
281        %let _OUTPUT_col9_exp = ;
282        %let _OUTPUT_col9_input = fintSMSCountryCode;
283        %let _OUTPUT_col9_input_count = 1;
284        %let _OUTPUT_col10_name = fstrsmsareacode;
285        %let _OUTPUT_col10_table = impraw.app_tblnz_customerstd;
286        %let _OUTPUT_col10_length = 10;
287        %let _OUTPUT_col10_type = $;
288        %let _OUTPUT_col10_format = $10.;
289        %let _OUTPUT_col10_informat = $10.;
290        %let _OUTPUT_col10_label = %nrquote(fstrsmsareacode);
291        %let _OUTPUT_col10_input0 = fstrSMSAreaCode;
292        %let _OUTPUT_col10_input0_table = strapp.tblNZ_CustomerStd;
293        %let _OUTPUT_col10_exp = ;
294        %let _OUTPUT_col10_input = fstrSMSAreaCode;
295        %let _OUTPUT_col10_input_count = 1;
296        %let _OUTPUT_col11_name = fstrsmsphonenumber;
297        %let _OUTPUT_col11_table = impraw.app_tblnz_customerstd;
298        %let _OUTPUT_col11_length = 30;
299        %let _OUTPUT_col11_type = $;
300        %let _OUTPUT_col11_format = $30.;
301        %let _OUTPUT_col11_informat = $30.;
302        %let _OUTPUT_col11_label = %nrquote(fstrsmsphonenumber);
303        %let _OUTPUT_col11_input0 = fstrSMSPhoneNumber;
304        %let _OUTPUT_col11_input0_table = strapp.tblNZ_CustomerStd;
305        %let _OUTPUT_col11_exp = ;
306        %let _OUTPUT_col11_input = fstrSMSPhoneNumber;
307        %let _OUTPUT_col11_input_count = 1;
308        %let _OUTPUT_col12_name = fdtmincomebalancedate;
309        %let _OUTPUT_col12_table = impraw.app_tblnz_customerstd;
310        %let _OUTPUT_col12_length = 8;
311        %let _OUTPUT_col12_type = ;
312        %let _OUTPUT_col12_format = DATETIME29.9;
313        %let _OUTPUT_col12_informat = DATETIME29.9;
314        %let _OUTPUT_col12_label = %nrquote(fdtmincomebalancedate);
315        %let _OUTPUT_col12_input0 = fdtmIncomeBalanceDate;
316        %let _OUTPUT_col12_input0_table = strapp.tblNZ_CustomerStd;
317        %let _OUTPUT_col12_exp = ;
7                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

318        %let _OUTPUT_col12_input = fdtmIncomeBalanceDate;
319        %let _OUTPUT_col12_input_count = 1;
320        %let _OUTPUT_col13_name = fstrcustomerclass;
321        %let _OUTPUT_col13_table = impraw.app_tblnz_customerstd;
322        %let _OUTPUT_col13_length = 12;
323        %let _OUTPUT_col13_type = $;
324        %let _OUTPUT_col13_format = $12.;
325        %let _OUTPUT_col13_informat = $12.;
326        %let _OUTPUT_col13_label = %nrquote(fstrcustomerclass);
327        %let _OUTPUT_col13_input0 = fstrCustomerClass;
328        %let _OUTPUT_col13_input0_table = strapp.tblNZ_CustomerStd;
329        %let _OUTPUT_col13_exp = ;
330        %let _OUTPUT_col13_input = fstrCustomerClass;
331        %let _OUTPUT_col13_input_count = 1;
332        %let _OUTPUT_col14_name = fstrwho;
333        %let _OUTPUT_col14_table = impraw.app_tblnz_customerstd;
334        %let _OUTPUT_col14_length = 20;
335        %let _OUTPUT_col14_type = $;
336        %let _OUTPUT_col14_format = $20.;
337        %let _OUTPUT_col14_informat = $20.;
338        %let _OUTPUT_col14_label = %nrquote(fstrwho);
339        %let _OUTPUT_col14_input0 = fstrWho;
340        %let _OUTPUT_col14_input0_table = strapp.tblNZ_CustomerStd;
341        %let _OUTPUT_col14_exp = ;
342        %let _OUTPUT_col14_input = fstrWho;
343        %let _OUTPUT_col14_input_count = 1;
344        %let _OUTPUT_col15_name = fdtmwhen;
345        %let _OUTPUT_col15_table = impraw.app_tblnz_customerstd;
346        %let _OUTPUT_col15_length = 8;
347        %let _OUTPUT_col15_type = ;
348        %let _OUTPUT_col15_format = DATETIME29.9;
349        %let _OUTPUT_col15_informat = DATETIME29.9;
350        %let _OUTPUT_col15_label = %nrquote(fdtmwhen);
351        %let _OUTPUT_col15_input0 = fdtmWhen;
352        %let _OUTPUT_col15_input0_table = strapp.tblNZ_CustomerStd;
353        %let _OUTPUT_col15_exp = ;
354        %let _OUTPUT_col15_input = fdtmWhen;
355        %let _OUTPUT_col15_input_count = 1;
356        %let _OUTPUT_col16_name = record_effective_timestamp;
357        %let _OUTPUT_col16_table = impraw.app_tblnz_customerstd;
358        %let _OUTPUT_col16_length = 8;
359        %let _OUTPUT_col16_type = ;
360        %let _OUTPUT_col16_format = DATETIME29.9;
361        %let _OUTPUT_col16_informat = DATETIME29.9;
362        %let _OUTPUT_col16_label = %nrquote(record_effective_timestamp);
363        %let _OUTPUT_col16_exp = ;
364        %let _OUTPUT_col16_input_count = 0;
365        %let _OUTPUT_col17_name = record_expiry_timestamp;
366        %let _OUTPUT_col17_table = impraw.app_tblnz_customerstd;
367        %let _OUTPUT_col17_length = 8;
368        %let _OUTPUT_col17_type = ;
369        %let _OUTPUT_col17_format = DATETIME29.9;
370        %let _OUTPUT_col17_informat = DATETIME29.9;
371        %let _OUTPUT_col17_label = %nrquote(record_expiry_timestamp);
372        %let _OUTPUT_col17_exp = ;
373        %let _OUTPUT_col17_input_count = 0;
374        %let _OUTPUT_col18_name = record_active_flag;
375        %let _OUTPUT_col18_table = impraw.app_tblnz_customerstd;
8                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

376        %let _OUTPUT_col18_length = 1;
377        %let _OUTPUT_col18_type = $;
378        %let _OUTPUT_col18_format = $1.;
379        %let _OUTPUT_col18_informat = $1.;
380        %let _OUTPUT_col18_label = %nrquote(record_active_flag);
381        %let _OUTPUT_col18_exp = ;
382        %let _OUTPUT_col18_input_count = 0;
383        %let _OUTPUT_col19_name = record_deleted_flag;
384        %let _OUTPUT_col19_table = impraw.app_tblnz_customerstd;
385        %let _OUTPUT_col19_length = 1;
386        %let _OUTPUT_col19_type = $;
387        %let _OUTPUT_col19_format = $1.;
388        %let _OUTPUT_col19_informat = $1.;
389        %let _OUTPUT_col19_label = %nrquote(record_deleted_flag);
390        %let _OUTPUT_col19_exp = ;
391        %let _OUTPUT_col19_input_count = 0;
392        %let _OUTPUT_col20_name = insert_object_run_key;
393        %let _OUTPUT_col20_table = impraw.app_tblnz_customerstd;
394        %let _OUTPUT_col20_length = 8;
395        %let _OUTPUT_col20_type = ;
396        %let _OUTPUT_col20_format = 11.;
397        %let _OUTPUT_col20_informat = 11.;
398        %let _OUTPUT_col20_label = %nrquote(insert_object_run_key);
399        %let _OUTPUT_col20_exp = ;
400        %let _OUTPUT_col20_input_count = 0;
401        %let _OUTPUT_col21_name = update_object_run_key;
402        %let _OUTPUT_col21_table = impraw.app_tblnz_customerstd;
403        %let _OUTPUT_col21_length = 8;
404        %let _OUTPUT_col21_type = ;
405        %let _OUTPUT_col21_format = 11.;
406        %let _OUTPUT_col21_informat = 11.;
407        %let _OUTPUT_col21_label = %nrquote(update_object_run_key);
408        %let _OUTPUT_col21_exp = ;
409        %let _OUTPUT_col21_input_count = 0;
410        
411        %let _target = impraw.app_tblnz_customerstd;
412        %let _target_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
413        ;
414        %let _target_engine = SASIOIMP;
415        %let _target_memtype = DATA;
416        %let _target_options = %nrquote();
417        %let _target_alter = %nrquote();
418        %let _target_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala
418      ! Raw/app_tblnz_customerstd%(Table%));
419        %let _target_type = 1;
420        %let _target_label = %nrquote();
421        /* List of target columns to keep  */
422        %let _target_keep = flngdockey fstrcustomersubtypeclass fstrcustomersubtype
423                fstrcustomersegment fstrspecialfiletype fblnspecialtaxresidency
424                fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason
425                fintsmscountrycode fstrsmsareacode fstrsmsphonenumber
426                fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen
427                record_effective_timestamp record_expiry_timestamp record_active_flag
428                record_deleted_flag insert_object_run_key update_object_run_key;
429        %let _target_col_count = 22;
430        %let _target_col0_name = flngdockey;
431        %let _target_col0_table = impraw.app_tblnz_customerstd;
432        %let _target_col0_length = 8;
9                                                          The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

433        %let _target_col0_type = ;
434        %let _target_col0_format = 11.;
435        %let _target_col0_informat = 11.;
436        %let _target_col0_label = %nrquote(flngdockey);
437        %let _target_col0_input0 = flngDocKey;
438        %let _target_col0_input0_table = strapp.tblNZ_CustomerStd;
439        %let _target_col0_exp = ;
440        %let _target_col0_input = flngDocKey;
441        %let _target_col0_input_count = 1;
442        %let _target_col1_name = fstrcustomersubtypeclass;
443        %let _target_col1_table = impraw.app_tblnz_customerstd;
444        %let _target_col1_length = 12;
445        %let _target_col1_type = $;
446        %let _target_col1_format = $12.;
447        %let _target_col1_informat = $12.;
448        %let _target_col1_label = %nrquote(fstrcustomersubtypeclass);
449        %let _target_col1_input0 = fstrCustomerSubTypeClass;
450        %let _target_col1_input0_table = strapp.tblNZ_CustomerStd;
451        %let _target_col1_exp = ;
452        %let _target_col1_input = fstrCustomerSubTypeClass;
453        %let _target_col1_input_count = 1;
454        %let _target_col2_name = fstrcustomersubtype;
455        %let _target_col2_table = impraw.app_tblnz_customerstd;
456        %let _target_col2_length = 12;
457        %let _target_col2_type = $;
458        %let _target_col2_format = $12.;
459        %let _target_col2_informat = $12.;
460        %let _target_col2_label = %nrquote(fstrcustomersubtype);
461        %let _target_col2_input0 = fstrCustomerSubType;
462        %let _target_col2_input0_table = strapp.tblNZ_CustomerStd;
463        %let _target_col2_exp = ;
464        %let _target_col2_input = fstrCustomerSubType;
465        %let _target_col2_input_count = 1;
466        %let _target_col3_name = fstrcustomersegment;
467        %let _target_col3_table = impraw.app_tblnz_customerstd;
468        %let _target_col3_length = 100;
469        %let _target_col3_type = $;
470        %let _target_col3_format = $100.;
471        %let _target_col3_informat = $100.;
472        %let _target_col3_label = %nrquote(fstrcustomersegment);
473        %let _target_col3_input0 = fstrCustomerSegment;
474        %let _target_col3_input0_table = strapp.tblNZ_CustomerStd;
475        %let _target_col3_exp = ;
476        %let _target_col3_input = fstrCustomerSegment;
477        %let _target_col3_input_count = 1;
478        %let _target_col4_name = fstrspecialfiletype;
479        %let _target_col4_table = impraw.app_tblnz_customerstd;
480        %let _target_col4_length = 12;
481        %let _target_col4_type = $;
482        %let _target_col4_format = $12.;
483        %let _target_col4_informat = $12.;
484        %let _target_col4_label = %nrquote(fstrspecialfiletype);
485        %let _target_col4_input0 = fstrSpecialFileType;
486        %let _target_col4_input0_table = strapp.tblNZ_CustomerStd;
487        %let _target_col4_exp = ;
488        %let _target_col4_input = fstrSpecialFileType;
489        %let _target_col4_input_count = 1;
490        %let _target_col5_name = fblnspecialtaxresidency;
10                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

491        %let _target_col5_table = impraw.app_tblnz_customerstd;
492        %let _target_col5_length = 8;
493        %let _target_col5_type = ;
494        %let _target_col5_format = 6.;
495        %let _target_col5_informat = 6.;
496        %let _target_col5_label = %nrquote(fblnspecialtaxresidency);
497        %let _target_col5_input0 = fblnSpecialTaxResidency;
498        %let _target_col5_input0_table = strapp.tblNZ_CustomerStd;
499        %let _target_col5_exp = ;
500        %let _target_col5_input = fblnSpecialTaxResidency;
501        %let _target_col5_input_count = 1;
502        %let _target_col6_name = fstrnonresidenttype;
503        %let _target_col6_table = impraw.app_tblnz_customerstd;
504        %let _target_col6_length = 100;
505        %let _target_col6_type = $;
506        %let _target_col6_format = $100.;
507        %let _target_col6_informat = $100.;
508        %let _target_col6_label = %nrquote(fstrnonresidenttype);
509        %let _target_col6_input0 = fstrNonResidentType;
510        %let _target_col6_input0_table = strapp.tblNZ_CustomerStd;
511        %let _target_col6_exp = ;
512        %let _target_col6_input = fstrNonResidentType;
513        %let _target_col6_input_count = 1;
514        %let _target_col7_name = fstrcurrenttaxresidency;
515        %let _target_col7_table = impraw.app_tblnz_customerstd;
516        %let _target_col7_length = 100;
517        %let _target_col7_type = $;
518        %let _target_col7_format = $100.;
519        %let _target_col7_informat = $100.;
520        %let _target_col7_label = %nrquote(fstrcurrenttaxresidency);
521        %let _target_col7_input0 = fstrCurrentTaxResidency;
522        %let _target_col7_input0_table = strapp.tblNZ_CustomerStd;
523        %let _target_col7_exp = ;
524        %let _target_col7_input = fstrCurrentTaxResidency;
525        %let _target_col7_input_count = 1;
526        %let _target_col8_name = fstrclosurereason;
527        %let _target_col8_table = impraw.app_tblnz_customerstd;
528        %let _target_col8_length = 12;
529        %let _target_col8_type = $;
530        %let _target_col8_format = $12.;
531        %let _target_col8_informat = $12.;
532        %let _target_col8_label = %nrquote(fstrclosurereason);
533        %let _target_col8_input0 = fstrClosureReason;
534        %let _target_col8_input0_table = strapp.tblNZ_CustomerStd;
535        %let _target_col8_exp = ;
536        %let _target_col8_input = fstrClosureReason;
537        %let _target_col8_input_count = 1;
538        %let _target_col9_name = fintsmscountrycode;
539        %let _target_col9_table = impraw.app_tblnz_customerstd;
540        %let _target_col9_length = 8;
541        %let _target_col9_type = ;
542        %let _target_col9_format = 6.;
543        %let _target_col9_informat = 6.;
544        %let _target_col9_label = %nrquote(fintsmscountrycode);
545        %let _target_col9_input0 = fintSMSCountryCode;
546        %let _target_col9_input0_table = strapp.tblNZ_CustomerStd;
547        %let _target_col9_exp = ;
548        %let _target_col9_input = fintSMSCountryCode;
11                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

549        %let _target_col9_input_count = 1;
550        %let _target_col10_name = fstrsmsareacode;
551        %let _target_col10_table = impraw.app_tblnz_customerstd;
552        %let _target_col10_length = 10;
553        %let _target_col10_type = $;
554        %let _target_col10_format = $10.;
555        %let _target_col10_informat = $10.;
556        %let _target_col10_label = %nrquote(fstrsmsareacode);
557        %let _target_col10_input0 = fstrSMSAreaCode;
558        %let _target_col10_input0_table = strapp.tblNZ_CustomerStd;
559        %let _target_col10_exp = ;
560        %let _target_col10_input = fstrSMSAreaCode;
561        %let _target_col10_input_count = 1;
562        %let _target_col11_name = fstrsmsphonenumber;
563        %let _target_col11_table = impraw.app_tblnz_customerstd;
564        %let _target_col11_length = 30;
565        %let _target_col11_type = $;
566        %let _target_col11_format = $30.;
567        %let _target_col11_informat = $30.;
568        %let _target_col11_label = %nrquote(fstrsmsphonenumber);
569        %let _target_col11_input0 = fstrSMSPhoneNumber;
570        %let _target_col11_input0_table = strapp.tblNZ_CustomerStd;
571        %let _target_col11_exp = ;
572        %let _target_col11_input = fstrSMSPhoneNumber;
573        %let _target_col11_input_count = 1;
574        %let _target_col12_name = fdtmincomebalancedate;
575        %let _target_col12_table = impraw.app_tblnz_customerstd;
576        %let _target_col12_length = 8;
577        %let _target_col12_type = ;
578        %let _target_col12_format = DATETIME29.9;
579        %let _target_col12_informat = DATETIME29.9;
580        %let _target_col12_label = %nrquote(fdtmincomebalancedate);
581        %let _target_col12_input0 = fdtmIncomeBalanceDate;
582        %let _target_col12_input0_table = strapp.tblNZ_CustomerStd;
583        %let _target_col12_exp = ;
584        %let _target_col12_input = fdtmIncomeBalanceDate;
585        %let _target_col12_input_count = 1;
586        %let _target_col13_name = fstrcustomerclass;
587        %let _target_col13_table = impraw.app_tblnz_customerstd;
588        %let _target_col13_length = 12;
589        %let _target_col13_type = $;
590        %let _target_col13_format = $12.;
591        %let _target_col13_informat = $12.;
592        %let _target_col13_label = %nrquote(fstrcustomerclass);
593        %let _target_col13_input0 = fstrCustomerClass;
594        %let _target_col13_input0_table = strapp.tblNZ_CustomerStd;
595        %let _target_col13_exp = ;
596        %let _target_col13_input = fstrCustomerClass;
597        %let _target_col13_input_count = 1;
598        %let _target_col14_name = fstrwho;
599        %let _target_col14_table = impraw.app_tblnz_customerstd;
600        %let _target_col14_length = 20;
601        %let _target_col14_type = $;
602        %let _target_col14_format = $20.;
603        %let _target_col14_informat = $20.;
604        %let _target_col14_label = %nrquote(fstrwho);
605        %let _target_col14_input0 = fstrWho;
606        %let _target_col14_input0_table = strapp.tblNZ_CustomerStd;
12                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

607        %let _target_col14_exp = ;
608        %let _target_col14_input = fstrWho;
609        %let _target_col14_input_count = 1;
610        %let _target_col15_name = fdtmwhen;
611        %let _target_col15_table = impraw.app_tblnz_customerstd;
612        %let _target_col15_length = 8;
613        %let _target_col15_type = ;
614        %let _target_col15_format = DATETIME29.9;
615        %let _target_col15_informat = DATETIME29.9;
616        %let _target_col15_label = %nrquote(fdtmwhen);
617        %let _target_col15_input0 = fdtmWhen;
618        %let _target_col15_input0_table = strapp.tblNZ_CustomerStd;
619        %let _target_col15_exp = ;
620        %let _target_col15_input = fdtmWhen;
621        %let _target_col15_input_count = 1;
622        %let _target_col16_name = record_effective_timestamp;
623        %let _target_col16_table = impraw.app_tblnz_customerstd;
624        %let _target_col16_length = 8;
625        %let _target_col16_type = ;
626        %let _target_col16_format = DATETIME29.9;
627        %let _target_col16_informat = DATETIME29.9;
628        %let _target_col16_label = %nrquote(record_effective_timestamp);
629        %let _target_col16_exp = ;
630        %let _target_col16_input_count = 0;
631        %let _target_col17_name = record_expiry_timestamp;
632        %let _target_col17_table = impraw.app_tblnz_customerstd;
633        %let _target_col17_length = 8;
634        %let _target_col17_type = ;
635        %let _target_col17_format = DATETIME29.9;
636        %let _target_col17_informat = DATETIME29.9;
637        %let _target_col17_label = %nrquote(record_expiry_timestamp);
638        %let _target_col17_exp = ;
639        %let _target_col17_input_count = 0;
640        %let _target_col18_name = record_active_flag;
641        %let _target_col18_table = impraw.app_tblnz_customerstd;
642        %let _target_col18_length = 1;
643        %let _target_col18_type = $;
644        %let _target_col18_format = $1.;
645        %let _target_col18_informat = $1.;
646        %let _target_col18_label = %nrquote(record_active_flag);
647        %let _target_col18_exp = ;
648        %let _target_col18_input_count = 0;
649        %let _target_col19_name = record_deleted_flag;
650        %let _target_col19_table = impraw.app_tblnz_customerstd;
651        %let _target_col19_length = 1;
652        %let _target_col19_type = $;
653        %let _target_col19_format = $1.;
654        %let _target_col19_informat = $1.;
655        %let _target_col19_label = %nrquote(record_deleted_flag);
656        %let _target_col19_exp = ;
657        %let _target_col19_input_count = 0;
658        %let _target_col20_name = insert_object_run_key;
659        %let _target_col20_table = impraw.app_tblnz_customerstd;
660        %let _target_col20_length = 8;
661        %let _target_col20_type = ;
662        %let _target_col20_format = 11.;
663        %let _target_col20_informat = 11.;
664        %let _target_col20_label = %nrquote(insert_object_run_key);
13                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

665        %let _target_col20_exp = ;
666        %let _target_col20_input_count = 0;
667        %let _target_col21_name = update_object_run_key;
668        %let _target_col21_table = impraw.app_tblnz_customerstd;
669        %let _target_col21_length = 8;
670        %let _target_col21_type = ;
671        %let _target_col21_format = 11.;
672        %let _target_col21_informat = 11.;
673        %let _target_col21_label = %nrquote(update_object_run_key);
674        %let _target_col21_exp = ;
675        %let _target_col21_input_count = 0;
676        
677        
678        %let ep_key_cols = flngdockey;
679        %let ep_key_cols_count = 1;
680        %let ep_key_cols0 = 1;
681        %let ep_key_cols1 = flngdockey;
682        %let where = ;
683        %let change_capture_timestamp = fdtmWhen;
684        %let change_capture_timestamp_count = 1;
685        %let change_capture_timestamp0 = 1;
686        %let change_capture_timestamp1 = fdtmWhen;
687        %let history_type = %nrquote(H2);
688        %let duplication_grain = %nrquote(1);
689        %let h2_effective_column = ;
690        %let h2_effective_column_count = 0;
691        %let h2_effective_column0 = 0;
692        %let effective_column = ;
693        %let effective_column_count = 0;
694        %let effective_column0 = 0;
695        %let to_timestamp = ;
696        %let to_timestamp_count = 0;
697        %let to_timestamp0 = 0;
698        %let effective_timestamp_grain = %nrquote(Seconds);
699        %let purge_grain = %nrquote(1);
700        %let debug = %nrquote(No);
701        %let ep_db_create_opts = %nrquote(with serdeproperties %(%'field.delim%'=%'\u0006%', %'line.delim%'=%'\u0007%',
701      ! %'serialization.format%'=%'\u0006%',%'serialization.escape.crlf%'=%'true%'%) stored as textfile);
702        %let lcf = lcf.OBJECT;
703        %let lcf_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
703      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
704        ;
705        %let lcf_engine = ORACLE;
706        %let lcf_memtype = DATA;
707        %let lcf_options = %nrquote();
708        %let lcf_alter = %nrquote();
709        %let lcf_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT%(Table%));
710        %let lcf_type = 1;
711        %let lcf_label = %nrquote();
712        %let ep_db_opts_count = %nrquote(1);
713        %let ep_db_opts = %nrquote(stored as parquet);
714        %let ep_db_opts1 = %nrquote(stored as parquet);
715        %let logging = lcf.OBJECT_RUN;
716        %let logging_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
716      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
717        ;
718        %let logging_engine = ORACLE;
719        %let logging_memtype = DATA;
14                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

720        %let logging_options = %nrquote();
721        %let logging_alter = %nrquote();
722        %let logging_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT_RUN%(Table%));
723        %let logging_type = 1;
724        %let logging_label = %nrquote();
725        /* Access the data for DIP Hive Staging (hivestg)  */
726        LIBNAME hivestg HADOOP  URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;
726      ! ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"  HDFS_TEMPDIR="/env/1_dev/landing/"
726      ! LOGIN_TIMEOUT=0  DEFER=YES
727        PORT=10001 SERVER="ird26au.vsp.sas.com"  SCHEMA=dev_staging ;
NOTE: Libref HIVESTG was successfully assigned as follows: 
      Engine:        HADOOP 
      Physical Name: jdbc:hive2://ird26au.vsp.sas.com:10001/
728        %rcSet(&syslibrc);
729        
730        %let stg_hive_connect =  DEFER=YES URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;
730      ! principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"
730      ! HDFS_TEMPDIR="/env/1_dev/landing/" LOGIN_TIMEOUT=0 SERVER="ird26au.vsp.sas.com"  PORT=10001
731        ;
732        %let stg_hive_engine = HADOOP;
733        %let stg_hive_path = /IRD/DIP Data Management/1000 Libraries/DIP Hive Staging (hivestg)(Library);
734        %let stg_hive = hivestg;
735        /* Access the data for DIP Impala Staging (impstg)  */
736        LIBNAME impstg SASIOIMP  DATABASE=dev_staging  HDFS_TEMPDIR="/env/1_dev/landing/"  DSN=ClouderaImpala64
736      ! SCHEMA=dev_staging ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPSTG was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
737        %rcSet(&syslibrc);
738        
739        %let ep_staging_library_connect =  DATABASE=dev_staging DSN=ClouderaImpala64
740        ;
741        %let ep_staging_library_engine = SASIOIMP;
742        %let ep_staging_library = impstg;
743        %let ep_staging_library_path = /IRD/DIP Data Management/1000 Libraries/DIP Impala Staging (impstg)(Library);
744        %let Source_table_type = %nrquote(view);
745        %let tagsort = %nrquote(No);
746        
747        /* List of target columns to keep  */
748        %let _keep = flngdockey fstrcustomersubtypeclass fstrcustomersubtype
749                fstrcustomersegment fstrspecialfiletype fblnspecialtaxresidency
750                fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason
751                fintsmscountrycode fstrsmsareacode fstrsmsphonenumber
752                fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen
753                record_effective_timestamp record_expiry_timestamp record_active_flag
754                record_deleted_flag insert_object_run_key update_object_run_key;
755        /* List of target columns to keep  */
756        %let keep = flngdockey fstrcustomersubtypeclass fstrcustomersubtype
757                fstrcustomersegment fstrspecialfiletype fblnspecialtaxresidency
758                fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason
759                fintsmscountrycode fstrsmsareacode fstrsmsphonenumber
760                fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen
761                record_effective_timestamp record_expiry_timestamp record_active_flag
762                record_deleted_flag insert_object_run_key update_object_run_key;
763        %change_extract;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   option nosymbolgen nomlogic validvarname=any validmemname=extend spool mprint 
mprintnest nofullstimer notes bufno=3000 bufsize=65535 ibufno=10000 ibufsize=32767 compress=no;
15                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do connect = "DATABASE=dev_staging DSN=ClouderaImpala64", 
"DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i + 1;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if i = 1 then prefix = 'stg';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else prefix = 'tgt';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 6;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'SCHEMA');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if schema_index = 0 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'DATABASE');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 8;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema = dequote(scan(substr(connect, schema_index + schema_length + 
1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   auth_index = index(connect, 'AUTHDOMAIN');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if auth_index then auth = dequote(scan(substr(connect, auth_index + 10 
+ 1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else auth = ' ';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_schema', cats('`', schema, '`'));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_auth', strip(auth));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tblnz_customerstd, app_tblnz_customerstd);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('source_table', lowcase(vname(tblnz_customerstd)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('_target_name', lowcase(vname(app_tblnz_customerstd)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   array col $ 1 flngdockey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length key_cols by_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(key_cols, by_cols);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do over col;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   key_cols = catx(', ', key_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   by_cols = catx(' ', by_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('key_order', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('by_order', strip(by_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
16                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   connect to ORACLE(DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" 
READBUFF=20000 dbclient_max_bytes=2 PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev");
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   select object_run_key format=best. into :object_run_key 
trimmed from connection to ORACLE (select lcf.seq_object_run_key.nextval as object_run_key from dual);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   disconnect from ORACLE;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.38 seconds
      cpu time            0.17 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   data _object_run(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if 0 then set lcf.OBJECT_RUN;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_run_key = 9113;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   start_time = "30OCT2019:16:39:35"dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_prg_name = "app_tblnz_customerstd P2H2";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status_message = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_read = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_written = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   log_position = getoption('log');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if not missing(log_position) then object_log_name = 
substr(log_position, index(log_position, 'Logs/') + 5);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   load_pattern_name = "Change Extract";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   output;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   drop log_position;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: The data set WORK._OBJECT_RUN has 1 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc append base=lcf.OBJECT_RUN data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: Appending WORK._OBJECT_RUN to LCF.OBJECT_RUN.
NOTE: There were 1 observations read from the data set WORK._OBJECT_RUN.
NOTE: 1 observations added.
NOTE: The data set LCF.OBJECT_RUN has . observations and 35 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.35 seconds
      cpu time            0.17 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc delete data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;
NOTE: Deleting WORK._OBJECT_RUN (memtype=DATA).
17                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(app_tblnz_customerstd);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('meta_target_name', 
strip(lowcase(vname(app_tblnz_customerstd))), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(fdtmWhen);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('effective_column', lowcase(vname(fdtmWhen)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   retain table "app_tblnz_customerstd";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length table_suffix $ 40 suffix $ 5;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do suffix = '', '_chgt', '_chgd', '_new', '_old', '_dt', '_unwd', 
'_nr';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_suffix = cats(table, suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_length = length(table);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   suffix_length = length(suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if suffix = '_nr' and length(table_suffix) > 32 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   status_msg = catx(' ', 'Table name length too long:', table_suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('status_msg', strip(status_msg));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('hadoop_table' || suffix, cats('`', table_suffix, '`'), 
'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('sas_table' || suffix, table_suffix, 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _app_tblnz_customerstd(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: The data set WORK._APP_TBLNZ_CUSTOMERSTD has 0 observations and 0 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select object_key, coalesce(days_to_backfill, 
18                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

0) as days_to_backfill into :object_key trimmed, :backfill trimmed from lcf.OBJECT where lowcase(sas_lib_ref) = "strapp" and 
lowcase(target_object_name) = "app_tblnz_customerstd";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.27 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   connect to SASIOIMP(DBMAX_TEXT=32767 
DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select row_count format=best20., 
int(ifn(max_timestamp ne '1jan1800:0:0'dt, max_timestamp - 10, max_timestamp)) format=is8601dt26.3 into :_nobs trimmed, 
:max_timestamp trimmed from connection to SASIOIMP (select count(*) as `row_count`, coalesce( days_add(max(`fdtmwhen`), -5) , 
'1800-01-01T00:00:00') as `max_timestamp` from `dev_raw`.`app_tblnz_customerstd`);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.52 seconds
      cpu time            0.11 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   delete _source_v _source_v_dedup _source_v2 _source_v3 existing_keys 
_source_date_selection;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 31, object_name = 
"app_tblnz_customerstd", prev_high_water_mark_value = inputn("2019-10-24T20:54:41.000", 'is8601dt23.0'), task1 = "Read Source", 
task1_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.80 seconds
      cpu time            0.60 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   create view _source_v as select flngdockey length=8 format=11. , 
fstrcustomersubtypeclass length=12 format=$12. , fstrcustomersubtype length=12 format=$12. , fstrcustomersegment length=100 
19                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

format=$100. , fstrspecialfiletype length=12 format=$12. , fblnspecialtaxresidency length=8 format=6. , fstrnonresidenttype 
length=100 format=$100. , fstrcurrenttaxresidency length=100 format=$100. , fstrclosurereason length=12 format=$12. , 
fintsmscountrycode length=8 format=6. , fstrsmsareacode length=10 format=$10. , fstrsmsphonenumber length=30 format=$30. , 
fdtmincomebalancedate length=8 format=DATETIME29.9 , fstrcustomerclass length=12 format=$12. , fstrwho length=20 format=$20. , 
fdtmwhen length=8 format=DATETIME29.9 from strapp.tblNZ_CustomerStd where ( fdtmWhen between "24OCT2019:20:54:41.000"dt and 
"30OCT2019:16:39:38.654"dt) order by flngdockey, fdtmwhen ;
NOTE: SQL view WORK._SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngdockey fstrcustomersubtypeclass fstrcustomersubtype 
fstrcustomersegment fstrspecialfiletype fblnspecialtaxresidency fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason 
fintsmscountrycode fstrsmsareacode fstrsmsphonenumber fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   attrib sas_cols hadoop_cols length=$ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   sas_cols = catx(', ', sas_cols, strip(lowcase(vname(cols))));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   hadoop_cols = catx(', ', hadoop_cols, cats("`", lowcase(vname(cols)), "`"));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('sas_cols', strip(sas_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_cols', strip(hadoop_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_effective_column', cats('`', lowcase(vname(fdtmwhen)), '`'), 
'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name into :date_vars separated by ' ' from dictionary.columns where libname = 
'WORK' and memname = '_SOURCE_V' and format like 'DATE%' and format not like 'DATETIME%';
NOTE: No rows were selected.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.47 seconds
      cpu time            0.32 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v2 / view=_source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   retain flngdockey fstrcustomersubtypeclass fstrcustomersubtype fstrcustomersegment 
fstrspecialfiletype fblnspecialtaxresidency fstrnonresidenttype fstrcurrenttaxresidency fstrclosurereason fintsmscountrycode 
fstrsmsareacode fstrsmsphonenumber fdtmincomebalancedate fstrcustomerclass fstrwho fdtmwhen ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           1.48 seconds
      cpu time            0.32 seconds
      
20                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM


MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 31, task1 = "Read 
Source", task1_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 31, task2 = 
"Validation", task2_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngdockey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   length key_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   key_cols = catx(', ', key_cols, lowcase(vname(cols)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symput('key_cols', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):   option compress=no missing=' ' nomprint nonotes
There are no rows in work.mismatched_error.
There are no rows in work.mismatched_warning.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 31, task2 = 
21                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

"Validation", task2_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 31, task3 = "Table 
Load", task3_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name, cats(name, '_x'), catx(' = ', cats(name, '_x'), name) into 
:datetime_names separated by ' ', :datetime_names_char separated by ' ', :datetime_rename separated by ' ' from dictionary.columns 
where libname = 'WORK' and memname = '_SOURCE_V2' and format like 'DATETIME%';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v3(label="Datetimes converted to ISO8601 timestamps") / view=_source_v3;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array from_dt fdtmincomebalancedate fdtmwhen;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array to_dt $ 26 fdtmincomebalancedate_x fdtmwhen_x;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over from_dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   to_dt[_i_] = put(from_dt, is8601dt26.3);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   drop fdtmincomebalancedate fdtmwhen;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   rename fdtmincomebalancedate_x = fdtmincomebalancedate fdtmwhen_x = fdtmwhen;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V3.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View WORK._SOURCE_V2.VIEW used (Total process time):
      real time           1.80 seconds
      cpu time            0.33 seconds
      
NOTE: DATA statement used (Total process time):
      real time           1.80 seconds
22                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

      cpu time            0.33 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_dt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_nr`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_chgt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_chgd`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblnz_customerstd_new`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblnz_customerstd_old`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.27 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select ifc(format not like 'DATETIME%', cats('`', name, '`'), cat('cast(null as 
varchar(26)) as `', strip(name), '`')) into :create_string separated by ', ' from dictionary.columns where libname = "IMPRAW" and 
upcase(memname) = "APP_TBLNZ_CUSTOMERSTD" and lowcase(name) notin('record_effective_timestamp', 'record_expiry_timestamp', 
'record_active_flag', 'record_deleted_flag', 'insert_object_run_key', 'update_object_run_key') ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.08 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`app_tblnz_customerstd` with serdeproperties 
('field.delim'='\u0006', 'line.delim'='\u0007', 'serialization.format'='\u0006','serialization.escape.crlf'='true') stored as 
textfile as select `flngdockey`, `fstrcustomersubtypeclass`, `fstrcustomersubtype`, `fstrcustomersegment`, `fstrspecialfiletype`, 
`fblnspecialtaxresidency`, `fstrnonresidenttype`, `fstrcurrenttaxresidency`, `fstrclosurereason`, `fintsmscountrycode`, 
`fstrsmsareacode`, `fstrsmsphonenumber`, cast(null as varchar(26)) as `fdtmincomebalancedate`, `fstrcustomerclass`, `fstrwho`, 
cast(null as varchar(26)) as `fdtmwhen` from `dev_raw`.`app_tblnz_customerstd` where false) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
23                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   insert into hivestg.app_tblnz_customerstd(bulkload=yes) select flngdockey, 
fstrcustomersubtypeclass, fstrcustomersubtype, fstrcustomersegment, fstrspecialfiletype, fblnspecialtaxresidency, 
fstrnonresidenttype, fstrcurrenttaxresidency, fstrclosurereason, fintsmscountrycode, fstrsmsareacode, fstrsmsphonenumber, 
fdtmincomebalancedate, fstrcustomerclass, fstrwho, fdtmwhen from _source_v3;
NOTE: There were 12078 observations read from the data set WORK._SOURCE_V.
NOTE: View WORK._SOURCE_V3.VIEW used (Total process time):
      real time           3.56 seconds
      cpu time            0.41 seconds
      
NOTE: There were 12078 observations read from the data set WORK._SOURCE_V2.
NOTE: 12078 rows were inserted into HIVESTG.APP_TBLNZ_CUSTOMERSTD.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           9.90 seconds
      cpu time            0.70 seconds
      


INFO: 12,078 observations inserted
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are no observations in impstg.app_tblnz_customerstd (dev_staging.app_tblnz_customerstd) where `flngdockey` is null or 
`fdtmwhen` is null.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql dquote=ansi noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select count(*) into :date_columns_count trimmed from dictionary.columns where 
libname = 'WORK' and memname = '_SOURCE_V2' and ( format like 'DATETIME%' or format like 'IS8601DT%');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select case when format like 'DATETIME%' or format like 'IS8601DT%' then 
cat('cast(`', strip(lowcase(name)), '` as timestamp) as `', strip(name), '`') else cats('`', name, '`') end as select_clause into 
:select_clause separated by ', ' from dictionary.columns where libname = 'WORK' and memname = '_SOURCE_V2';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`app_tblnz_customerstd_dt` stored as parquet as 
select `flngdockey`, `fstrcustomersubtypeclass`, `fstrcustomersubtype`, `fstrcustomersegment`, `fstrspecialfiletype`, 
`fblnspecialtaxresidency`, `fstrnonresidenttype`, `fstrcurrenttaxresidency`, `fstrclosurereason`, `fintsmscountrycode`, 
`fstrsmsareacode`, `fstrsmsphonenumber`, cast(`fdtmincomebalancedate` as timestamp) as `fdtmincomebalancedate`, 
`fstrcustomerclass`, `fstrwho`, cast(`fdtmwhen` as timestamp) as `fdtmwhen` from `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblnz_customerstd_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (drop table `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (alter table `dev_staging`.`app_tblnz_customerstd_dt` rename to 
`dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
24                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (compute stats `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           33.24 seconds
      cpu time            0.20 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute(create table `dev_staging`.`app_tblnz_customerstd_nr` stored as parquet as 
select _left.`flngdockey`, _left.`fstrcustomersubtypeclass`, _left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, 
_left.`fstrspecialfiletype`, _left.`fblnspecialtaxresidency`, _left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, 
_left.`fstrclosurereason`, _left.`fintsmscountrycode`, _left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, 
_left.`fdtmincomebalancedate`, _left.`fstrcustomerclass`, _left.`fstrwho`, _left.`fdtmwhen` from 
`dev_staging`.`app_tblnz_customerstd` as _left left join `dev_raw`.`app_tblnz_customerstd` as _right on _left.`flngdockey` = 
_right.`flngdockey` and _left.`fdtmwhen` = _right.`fdtmwhen` where _right.`flngdockey` is null) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           16.62 seconds
      cpu time            0.12 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are 9,720 observations in impstg.app_tblnz_customerstd_nr (dev_staging.app_tblnz_customerstd_nr).
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task3 = 
"Table Load", task3_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task4 = "Capture Changes", 
task4_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

25                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql noprint;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (invalidate metadata `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT):   execute (refresh `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`app_tblnz_customerstd_chgt` stored as parquet as with new_min as 
(select `flngdockey`, min(`fdtmwhen`) as `effective_ts` from `dev_staging`.`app_tblnz_customerstd_nr` group by `flngdockey`), 
current_max as (select `flngdockey`, max(record_effective_timestamp) as `effective_ts` from `dev_raw`.`app_tblnz_customerstd` group 
by `flngdockey`), new_ranked as (select `flngdockey`, `fdtmwhen` as `effective_ts`, rank() over(partition by `flngdockey` order by 
`fdtmwhen`) as `rank` from `dev_staging`.`app_tblnz_customerstd_nr`), previous_active as (select distinct `flngdockey`, 
`effective_ts`, `rank` - 1 as `rank` from new_ranked) select _left.`flngdockey`, _left.`effective_ts`, _left.`effective_ts` as 
`record_effective_timestamp`, milliseconds_add(_right.`effective_ts`, -1) as `record_expiry_timestamp`, cast('U' as varchar(1)) as 
`operation`, cast(9113 as int) as `object_run_key` from current_max as _left left join new_min as _right on _left.`flngdockey` = 
_right.`flngdockey` where _right.`flngdockey` is not null union all select _left.`flngdockey`, _left.`effective_ts`, 
_left.`effective_ts` as `record_effective_timestamp`, coalesce(milliseconds_add(_right.`effective_ts`, -1), 
cast('9000-12-31T00:00:00' as timestamp)) as `record_expiry_timestamp`, cast('I' as varchar(1)) as `operation`, cast(9113 as int) 
as `object_run_key` from new_ranked as _left left join previous_active as _right on _left.`flngdockey` = _right.`flngdockey` and 
_left.`rank` = _right.`rank`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   select count into :_nobs from connection to SASIOIMP (select count(*) as `count` from 
`dev_staging`.`app_tblnz_customerstd_chgt`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.29 seconds
      cpu time            0.11 seconds
      


INFO: There are 19,440 rows in app_tblnz_customerstd_chgt
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`app_tblnz_customerstd_chgd` stored as parquet as select 
_left.`flngdockey`, _left.`fstrcustomersubtypeclass`, _left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, 
_left.`fstrspecialfiletype`, _left.`fblnspecialtaxresidency`, _left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, 
_left.`fstrclosurereason`, _left.`fintsmscountrycode`, _left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, 
_left.`fdtmincomebalancedate`, _left.`fstrcustomerclass`, _left.`fstrwho`, _left.`fdtmwhen`, _right.record_effective_timestamp, 
_right.record_expiry_timestamp, _right.operation, _right.object_run_key from `dev_staging`.`app_tblnz_customerstd_nr` as _left 
inner join `dev_staging`.`app_tblnz_customerstd_chgt` as _right on _left.`flngdockey` = _right.`flngdockey` and _left.`fdtmwhen` = 
_right.`effective_ts` and _right.operation = 'I' union all select _left.`flngdockey`, _left.`fstrcustomersubtypeclass`, 
26                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

_left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, _left.`fstrspecialfiletype`, _left.`fblnspecialtaxresidency`, 
_left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, _left.`fstrclosurereason`, _left.`fintsmscountrycode`, 
_left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, _left.`fdtmincomebalancedate`, _left.`fstrcustomerclass`, _left.`fstrwho`, 
_left.`fdtmwhen`, _right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, _right.object_run_key from 
`dev_raw`.`app_tblnz_customerstd` as _left inner join `dev_staging`.`app_tblnz_customerstd_chgt` as _right on _left.`flngdockey` = 
_right.`flngdockey` and _left.record_effective_timestamp = _right.record_effective_timestamp and _right.operation = 'U') by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.11 seconds
      cpu time            0.07 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task4 = "Capture Changes", 
task4_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task5 = "Apply Changes", 
task5_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_raw`.`app_tblnz_customerstd_new` stored as parquet as select 
_left.`flngdockey`, _left.`fstrcustomersubtypeclass`, _left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, 
_left.`fstrspecialfiletype`, _left.`fblnspecialtaxresidency`, _left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, 
_left.`fstrclosurereason`, _left.`fintsmscountrycode`, _left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, 
_left.`fdtmincomebalancedate`, _left.`fstrcustomerclass`, _left.`fstrwho`, _left.`fdtmwhen`, _left.record_effective_timestamp, 
_left.record_expiry_timestamp, _left.record_active_flag, _left.record_deleted_flag, _left.insert_object_run_key, 
_left.update_object_run_key from `dev_raw`.`app_tblnz_customerstd` as _left left join `dev_staging`.`app_tblnz_customerstd_chgd` as 
_right on _left.`flngdockey` = _right.`flngdockey` and _left.record_effective_timestamp = _right.record_effective_timestamp and 
27                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

_right.object_run_key = 9113 where _right.`flngdockey` is null union all select _left.`flngdockey`, 
_left.`fstrcustomersubtypeclass`, _left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, _left.`fstrspecialfiletype`, 
_left.`fblnspecialtaxresidency`, _left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, _left.`fstrclosurereason`, 
_left.`fintsmscountrycode`, _left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, _left.`fdtmincomebalancedate`, 
_left.`fstrcustomerclass`, _left.`fstrwho`, _left.`fdtmwhen`, record_effective_timestamp, record_expiry_timestamp, cast(case when 
record_expiry_timestamp >= cast("9000-12-31T00:00:00" as timestamp) then 'Y' else 'N' end as varchar(1)) as record_active_flag, 
cast('N' as varchar(1)) as record_deleted_flag, object_run_key as insert_object_run_key, object_run_key as update_object_run_key 
from `dev_staging`.`app_tblnz_customerstd_chgd` as _left where object_run_key = 9113 and operation = 'I' union all select 
_left.`flngdockey`, _left.`fstrcustomersubtypeclass`, _left.`fstrcustomersubtype`, _left.`fstrcustomersegment`, 
_left.`fstrspecialfiletype`, _left.`fblnspecialtaxresidency`, _left.`fstrnonresidenttype`, _left.`fstrcurrenttaxresidency`, 
_left.`fstrclosurereason`, _left.`fintsmscountrycode`, _left.`fstrsmsareacode`, _left.`fstrsmsphonenumber`, 
_left.`fdtmincomebalancedate`, _left.`fstrcustomerclass`, _left.`fstrwho`, _left.`fdtmwhen`, _left.record_effective_timestamp, 
_left.record_expiry_timestamp, cast('N' as varchar(1)) as record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, 
_right.insert_object_run_key, _left.object_run_key as update_object_run_key from `dev_staging`.`app_tblnz_customerstd_chgd` as 
_left inner join `dev_raw`.`app_tblnz_customerstd` as _right on _left.`flngdockey` = _right.`flngdockey` and 
_left.record_effective_timestamp = _right.record_effective_timestamp and _left.object_run_key = 9113 and _left.operation = 'U') by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           38.24 seconds
      cpu time            0.22 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task5 = "Apply Changes", 
task5_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task6 = "Reconciliation", 
task6_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.47 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
28                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc sql;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_source_v as select 'Source' as type length=6, measure length=6, count as 
source_count format=comma14. from connection to SASIOIMP (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_staging`.`app_tblnz_customerstd_nr` union all select cast('update' as varchar(6)) as measure, count(distinct 
_left.`flngdockey`) as count from `dev_staging`.`app_tblnz_customerstd_nr` as _left inner join (select distinct `flngdockey` from 
`dev_raw`.`app_tblnz_customerstd`) as _right on _left.`flngdockey` = _right.`flngdockey`);
NOTE: SQL view WORK.COUNT_SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_target_v as select 'Target' as type length=6, measure length=6, count as 
target_count format=comma14. from connection to sasioimp (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_raw`.`app_tblnz_customerstd_new` as _left inner join (select distinct object_run_key from 
`dev_staging`.`app_tblnz_customerstd_chgt`) as _right on _left.insert_object_run_key = _right.object_run_key union all select 
cast('update' as varchar) as measure, count(*) as count from `dev_raw`.`app_tblnz_customerstd_new` as _left inner join (select 
distinct object_run_key from `dev_staging`.`app_tblnz_customerstd_chgt`) as _right on _left.update_object_run_key = 
_right.object_run_key where update_object_run_key != insert_object_run_key);
NOTE: SQL view WORK.COUNT_TARGET_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   data _null_;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   merge count_source_v(in=in_source) count_target_v(in=in_target);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   by measure;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   format source_count target_count comma14.;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   retain m1 -1 error 0;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   attrib status_msg length=$ 32767;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   if source_count ne target_count then do;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   status_msg = cat('ERROR: Mismatch on ', strip(measure), ': Source count ', 
strip(putn(source_count, 'comma14.')), '; Target count: ', strip(putn(target_count, 'comma14.')), '.');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call symputx('status_msg', strip(status_msg), 'g');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   stop;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   end;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   else putlog 'Matched on ' measure +m1 ': rows ' source_count;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   run;

Matched on insert: rows 9,720
Matched on update: rows 9,720
NOTE: There were 2 observations read from the data set WORK.COUNT_SOURCE_V.
NOTE: There were 2 observations read from the data set WORK.COUNT_TARGET_V.
29                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

NOTE: DATA statement used (Total process time):
      real time           4.33 seconds
      cpu time            0.08 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: Deleting WORK.COUNT_SOURCE_V (memtype=VIEW).
NOTE: Deleting WORK.COUNT_TARGET_V (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   select count into :_nobs trimmed from connection to SASIOIMP (select count(*) as `count` from 
`dev_raw`.`app_tblnz_customerstd_new` where `record_effective_timestamp` > `record_expiry_timestamp`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.62 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task6 = "Reconciliation", 
task6_end_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.67 seconds
      cpu time            0.48 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task7 = "Commit", 
task7_start_time = datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.46 seconds
30                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute (refresh `dev_raw`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`app_tblnz_customerstd` rename to 
`dev_raw`.`app_tblnz_customerstd_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`app_tblnz_customerstd_new` rename to 
`dev_raw`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(drop table `dev_raw`.`app_tblnz_customerstd_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(refresh `dev_raw`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(compute stats `dev_raw`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           40.55 seconds
      cpu time            0.20 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 9720, object_key = 31, task7 = "Commit", task7_end_time 
= datetime() where object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.66 seconds
      cpu time            0.46 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.LOGGING):   select coalesce(max_timestamp, '1jan1800:0:0'dt) as max_timestamp format=datetime26.3 into 
:max_timestamp trimmed from connection to SASIOIMP (select max(fdtmwhen) as max_timestamp from `dev_raw`.`app_tblnz_customerstd`);
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   disconnect from SASIOIMP;
31                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.41 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   run;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   option nomprint nonotes
There are 19,440 observations in impraw.app_tblnz_customerstd (dev_raw.app_tblnz_customerstd) where update_object_run_key = 9113.
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set end_time = datetime(), records_written = 19440, high_water_mark_value = 
"30OCT2019:15:52:53.983"dt, status = "Job Successful", status_message = "19,440 rows updated on app_tblnz_customerstd" where 
object_run_key = 9113;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.94 seconds
      cpu time            0.74 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_nr`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_chgt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblnz_customerstd_chgd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblnz_customerstd_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblnz_customerstd_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.65 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):  ;
793        
794        %rcSet(&syserr);
795        %rcSet(&sysrc);
796        %rcSet(&sqlrc);
797        
798        
799        
32                                                         The SAS System                     Wednesday, 30 October 2019 03:50:00 PM

800        /** Step end Change Extract **/
801        
802        %let etls_endTime = %sysfunc(datetime(),datetime.);
803        
804        
805        
806        
807        %LET _CLIENTTASKLABEL=;
808        %LET _CLIENTPROCESSFLOWNAME=;
809        %LET _CLIENTPROJECTPATH=;
810        %LET _CLIENTPROJECTPATHHOST=;
811        %LET _CLIENTPROJECTNAME=;
812        %LET _SASPROGRAMFILE=;
813        %LET _SASPROGRAMFILEHOST=;
814        
815        ;*';*";*/;quit;run;
816        ODS _ALL_ CLOSE;
817        
818        
819        QUIT; RUN;
820        
