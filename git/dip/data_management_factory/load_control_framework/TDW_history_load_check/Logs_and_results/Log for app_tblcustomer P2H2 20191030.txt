1                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

1          ;*';*";*/;quit;run;
2          OPTIONS PAGENO=MIN;
3          %LET _CLIENTTASKLABEL='app_tblcustomer P2H2 20191030';
4          %LET _CLIENTPROCESSFLOWNAME='Process Flow';
5          %LET _CLIENTPROJECTPATH='';
6          %LET _CLIENTPROJECTPATHHOST='';
7          %LET _CLIENTPROJECTNAME='';
8          %LET _SASPROGRAMFILE='H:\DIP Data Management\Load Control Framework\3.8\app_tblcustomer P2H2 20191030.sas';
9          %LET _SASPROGRAMFILEHOST='IRDTS64';
10         
11         ODS _ALL_ CLOSE;
12         OPTIONS DEV=PNG;
13         FILENAME EGSR TEMP;
14         ODS tagsets.sasreport13(ID=EGSR) FILE=EGSR
15             STYLE=HTMLBlue
16             STYLESHEET=(URL="file:///H:/sso/sfw/sas_factory/940/x86/SASEnterpriseGuide/7.1/Styles/HTMLBlue.css")
17             NOGTITLE
18             NOGFOOTNOTE
19             GPATH=&sasworklocation
20             ENCODING=UTF8
21             options(rolap="on")
22         ;
NOTE: Writing TAGSETS.SASREPORT13(EGSR) Body file: EGSR
23         
24         /****************************************************************************
25          * Job:             app_tblcustomer P2H2                  A5IKCEC7.BR000011 *
26          * Description:     The customer table in Start suffers from silent         *
27          *                  updates. This process does as good a job as possible    *
28          *                  to ameliorate that, picking up as many changes as it    *
29          *                   is able.                                               *
30          *                                                                          *
31          * Metadata Server: ird10119au.vsp.sas.com                                  *
32          * Port:            8561                                                    *
33          * Location:        /IRD/DIP Data Management/5000 Processes/10 Raw          *
34          *                   Ingestion                                              *
35          *                                                                          *
36          * Server:          SASApp                                A5IKCEC7.AS000002 *
37          *                                                                          *
38          * Source Tables:   tblCustomer - strapp.tblCUSTOMER      A5IKCEC7.BE000027 *
39          *                  tblCustomerInfo -                     A5IKCEC7.BE000028 *
40          *                   strapp.tblCustomerInfo                                 *
41          *                  app_tblcustomer -                     A5IKCEC7.BE000017 *
42          *                   impraw.app_tblcustomer                                 *
43          * Target Table:    app_tblcustomer -                     A5IKCEC7.BE000017 *
44          *                   impraw.app_tblcustomer                                 *
45          *                                                                          *
46          * Generated on:    Wednesday, October 30, 2019 2:44:50 PM NZDT             *
47          * Generated by:    ird0nxa                                                 *
48          * Version:         SAS Data Integration Studio 4.903                       *
49          ****************************************************************************/
50         
51         /* Generate the process id for job  */
52         %put Process ID: &SYSJOBID;
Process ID: 46338
53         
54         /* General macro variables  */
55         %let jobID = %quote(A5IKCEC7.BR000011);
56         %let etls_jobName = %nrquote(app_tblcustomer P2H2);
2                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

57         %let etls_userID = %nrquote(ird0nxa);
58         
59         /* Setup to capture return codes  */
60         %global job_rc trans_rc sqlrc;
61         %let sysrc = 0;
62         %let job_rc = 0;
63         %let trans_rc = 0;
64         %let sqlrc = 0;
65         %global etls_stepStartTime;
66         /* initialize syserr to 0 */
67         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      user cpu time       0.00 seconds
      system cpu time     0.00 seconds
      memory              316.68k
      OS Memory           18852.00k
      Timestamp           30/10/2019 02:46:46 PM
      Step Count                        2  Switch Count  0
      Page Faults                       0
      Page Reclaims                     56
      Page Swaps                        0
      Voluntary Context Switches        0
      Involuntary Context Switches      0
      Block Input Operations            0
      Block Output Operations           0
      

68         
69         %macro rcSet(error);
70            %if (&error gt &trans_rc) %then
71               %let trans_rc = &error;
72            %if (&error gt &job_rc) %then
73               %let job_rc = &error;
74         %mend rcSet;
75         
76         %macro rcSetDS(error);
77            if &error gt input(symget('trans_rc'),12.) then
78               call symput('trans_rc',trim(left(put(&error,12.))));
79            if &error gt input(symget('job_rc'),12.) then
80               call symput('job_rc',trim(left(put(&error,12.))));
81         %mend rcSetDS;
82         
83         /* Setup for capturing job status  */
84         %let etls_startTime = %sysfunc(datetime(),datetime.);
85         %let etls_recordsBefore = 0;
86         %let etls_recordsAfter = 0;
87         %let etls_lib = 0;
88         %let etls_table = 0;
89         
90         %global etls_debug;
91         %macro etls_setDebug;
92            %if %str(&etls_debug) ne 0 %then
93               OPTIONS MPRINT%str(;);
94         %mend;
95         %etls_setDebug;
96         
3                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

97         /*---- Start of Pre-Process Code  ----*/
98         
99         option nosymbolgen nomlogic nofullstimer bufno=3000 bufsize=65535;
100        /*---- End of Pre-Process Code  ----*/
101        
102        %rcSet(&syserr);
103        %rcSet(&sqlrc);
104        
105        /*==========================================================================*
106         * Step:            High Watermark                        A5IKCEC7.BT0003KK *
107         * Transform:       High Watermark                                          *
108         * Description:                                                             *
109         *                                                                          *
110         * Source Table:    app_tblcustomer -                     A5IKCEC7.BE000017 *
111         *                   impraw.app_tblcustomer                                 *
112         *==========================================================================*/
113        
114        %let transformID = %quote(A5IKCEC7.BT0003KK);
115        %let trans_rc = 0;
116        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
117        
118        /* Access the data for DIP Impala RAW (impraw)  */
119        LIBNAME impraw SASIOIMP  DATABASE=dev_raw  DBMAX_TEXT=32767  DSN=ClouderaImpala64  SCHEMA=dev_raw ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPRAW was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
120        %rcSet(&syslibrc);
121        
122        %let SYSLAST = %nrquote(impraw.app_tblcustomer);
123        
124        %let _INPUT_count = 1;
125        %let _INPUT = impraw.app_tblcustomer;
126        %let _INPUT_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
127        ;
128        %let _INPUT_engine = SASIOIMP;
129        %let _INPUT_memtype = DATA;
130        %let _INPUT_options = %nrquote();
131        %let _INPUT_alter = %nrquote();
132        %let _INPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/app_tblcustomer%(Table%));
133        %let _INPUT_type = 1;
134        %let _INPUT_label = %nrquote();
135        
136        %let _INPUT0 = impraw.app_tblcustomer;
137        %let _INPUT0_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
138        ;
139        %let _INPUT0_engine = SASIOIMP;
140        %let _INPUT0_memtype = DATA;
141        %let _INPUT0_options = %nrquote();
142        %let _INPUT0_alter = %nrquote();
143        %let _INPUT0_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/app_tblcustomer%(Table%));
144        %let _INPUT0_type = 1;
145        %let _INPUT0_label = %nrquote();
146        
147        %let _OUTPUT_count = 0;
148        
149        %let effective_column = fdtmwhen_info;
150        %let effective_column_count = 1;
4                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

151        %let effective_column0 = 1;
152        %let effective_column1 = fdtmwhen_info;
153        %let pattern = %nrquote(Change Extract);
154        %let lcf = lcf.OBJECT;
155        %let lcf_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
155      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
156        ;
157        %let lcf_engine = ORACLE;
158        %let lcf_memtype = DATA;
159        %let lcf_options = %nrquote();
160        %let lcf_alter = %nrquote();
161        %let lcf_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT%(Table%));
162        %let lcf_type = 1;
163        %let lcf_label = %nrquote();
164        
165        %hwm;
MPRINT(HWM):   option nosymbolgen nomlogic spool mprint mprintnest nofullstimer notes bufno=3000 bufsize=65535 ibufno=10000 
ibufsize=32767 compress=no;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   data _null_;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   connect = "DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64";
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   schema_length = 6;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   schema_index = index(connect, 'SCHEMA');
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   if schema_index = 0 then do;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   schema_index = index(connect, 'DATABASE');
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   schema_length = 8;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   end;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   schema = dequote(scan(substr(connect, schema_index + schema_length + 1), 1, ' '));
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   auth_index = index(connect, 'AUTHDOMAIN');
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   if auth_index then auth = dequote(scan(substr(connect, auth_index + 10 + 1), 1, ' '));
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   else auth = ' ';
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   call symput('tgt_schema', cats('`', schema, '`'));
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   call symput('tgt_auth', strip(auth));
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   select object_key, coalesce(days_to_backfill, 0) as days_to_backfill into :object_key 
trimmed, :backfill trimmed from lcf.OBJECT where lowcase(target_object_name) = "app_tblcustomer";
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.62 seconds
      cpu time            0.45 seconds
      

NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   select row_count format=best20., int(ifn(max_timestamp ne '1jan1800:0:0'dt, max_timestamp - 
10, max_timestamp)) format=is8601dt26.3 into :_nobs trimmed, :max_timestamp trimmed from connection to SASIOIMP (select count(*) as 
`row_count`, coalesce( days_add(max(`fdtmwhen_info`), -5) , '1800-01-01T00:00:00') as `max_timestamp` from 
`dev_raw`.`app_tblcustomer`);
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
5                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   disconnect from SASIOIMP;
MPRINT(HWM.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.11 seconds
      

MPRINT(HWM):  ;
166        %put &=hwm_max;
HWM_MAX='2019-10-24T20:54:38.000'
167        
168        %rcSet(&syserr);
169        %rcSet(&sysrc);
170        %rcSet(&sqlrc);
171        
172        
173        
174        /** Step end High Watermark **/
175        
176        /*==========================================================================*
177         * Step:            Customer                              A5IKCEC7.BT0000KC *
178         * Transform:       Join                                                    *
179         * Description:     Get customers, but also customer info's when timestamp  *
180         *                   (to cover silent updates on the customer table)        *
181         *                                                                          *
182         * Source Tables:   tblCustomer - strapp.tblCUSTOMER      A5IKCEC7.BE000027 *
183         *                  tblCustomerInfo -                     A5IKCEC7.BE000028 *
184         *                   strapp.tblCustomerInfo                                 *
185         * Target Table:    Join - work.tblcustomer               A5IKCEC7.BW000016 *
186         *==========================================================================*/
187        
188        %let transformID = %quote(A5IKCEC7.BT0000KC);
189        %let trans_rc = 0;
190        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
191        
192        /* Access the data for START GTAPP (strapp)  */
193        LIBNAME strapp SQLSVR  PRESERVE_TAB_NAMES=YES  DBMAX_TEXT=32767  PRESERVE_COL_NAMES=YES  Datasrc=NZO_GTAPP  SCHEMA=dbo
193      ! AUTHDOMAIN="start_operations" ;
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref STRAPP was successfully assigned as follows: 
      Engine:        SQLSVR 
      Physical Name: NZO_GTAPP
194        %rcSet(&syslibrc);
195        
196        %global etls_sql_pushDown;
197        %let etls_sql_pushDown = -1;
198        option DBIDIRECTEXEC;
199        
200        proc datasets lib = work nolist nowarn memtype = (data view);
201           delete tblcustomer;
202        quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
6                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM


203        
204        proc sql;
205           connect to SQLSVR
206           (
207               DBMAX_TEXT=32767 DATASRC=NZO_GTAPP AUTHDOMAIN="start_operations"
208           );
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
209           create table work.tblcustomer as
210           select
211              flngCustomerKey length = 8
212                              label = 'flngCustomerKey',
213              flngVer length = 8
214                      label = 'flngVer',
215              flngVerLast length = 8
216                          label = 'flngVerLast',
217              fstrCustomerType length = 12
218                               label = 'fstrCustomerType',
219              fdtmCommence length = 8
220                           format = datetime26.3
221                           label = 'fdtmCommence',
222              fdtmCease length = 8
223                        format = datetime26.3
224                        label = 'fdtmCease',
225              flngCustomerLevel length = 8
226                                label = 'flngCustomerLevel',
227              flngDocKey length = 8
228                         label = 'flngDocKey',
229              flngFolderKey length = 8
230                            label = 'flngFolderKey',
231              flngRefreshVer length = 8
232                             label = 'flngRefreshVer',
233              flngCustomerVersion length = 8
234                                  label = 'flngCustomerVersion',
235              flngWebVersion length = 8
236                             label = 'flngWebVersion',
237              fdtmWebPublished length = 8
238                               format = datetime26.3
239                               label = 'fdtmWebPublished',
240              fdtmCreated length = 8
241                          format = datetime26.3
242                          label = 'fdtmCreated',
243              fstrWho length = 20
244                      label = 'fstrWho',
245              fdtmWhen length = 8
246                       format = datetime26.3
247                       label = 'fdtmWhen',
248              fdtmWhen_info length = 8
249                            format = DATETIME22.3
250                            informat = DATETIME22.3
251                            label = 'fdtmWhen'
252           from connection to SQLSVR
253           (
254              select
255              cust.flngCustomerKey,
256              cust.flngVer,
257              cust.flngVerLast,
7                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

258              cust.fstrCustomerType,
259              cust.fdtmCommence,
260              cust.fdtmCease,
261              cust.flngCustomerLevel,
262              cust.flngDocKey,
263              cust.flngFolderKey,
264              cust.flngRefreshVer,
265              cust.flngCustomerVersion,
266              cust.flngWebVersion,
267              cust.fdtmWebPublished,
268              cust.fdtmCreated,
269              cust.fstrWho,
270              cust.fdtmWhen,
271              case
272                 when custinfo.fdtmWhen > cust.fdtmWhen
273                    then custinfo.fdtmWhen
274              else cust.fdtmWhen
275              end as fdtmWhen_info
276           from
277              dbo.tblCUSTOMER as cust left join
278              dbo.tblCustomerInfo as custinfo
279                 on
280                 (
281                    cust.flngCustomerKey = custinfo.flngCustomerKey
282                 )
283           where
284              case
285                 when custinfo.fdtmWhen > cust.fdtmWhen
286                    then custinfo.fdtmWhen
287              else cust.fdtmWhen
288              end
289              >= &hwm_max
290           order by
291              flngCustomerKey
292        
293           );
NOTE: Table WORK.TBLCUSTOMER created, with 39147 rows and 17 columns.

294        
295           %rcSet(&sqlrc);
296        
297           disconnect from SQLSVR;
298        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           5.78 seconds
      cpu time            0.28 seconds
      

299        
300        %global etls_sql_pushDown;
301        %let etls_sql_pushDown = &sys_sql_ip_all;
302        
303        %rcSet(&sqlrc);
304        
305        
306        
307        /** Step end Customer **/
308        
8                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

309        /*==========================================================================*
310         * Step:            Change Extract                        A5IKCEC7.BT00009S *
311         * Transform:       Change Extract                                          *
312         * Description:                                                             *
313         *                                                                          *
314         * Source Table:    Join - work.tblcustomer               A5IKCEC7.BW000016 *
315         * Target Table:    app_tblcustomer -                     A5IKCEC7.BE000017 *
316         *                   impraw.app_tblcustomer                                 *
317         *==========================================================================*/
318        
319        %let transformID = %quote(A5IKCEC7.BT00009S);
320        %let trans_rc = 0;
321        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
322        
323        %let SYSLAST = %nrquote(work.tblcustomer);
324        
325        %let _INPUT_count = 1;
326        %let _INPUT = work.tblcustomer;
327        %let _INPUT_connect = ;
328        %let _INPUT_engine = ;
329        %let _INPUT_memtype = DATA;
330        %let _INPUT_options = %nrquote();
331        %let _INPUT_alter = %nrquote();
332        %let _INPUT_path = %nrquote(/Join_A5IKCEC7.BW000016%(WorkTable%));
333        %let _INPUT_type = 1;
334        %let _INPUT_label = %nrquote();
335        
336        %let _Source = work.tblcustomer;
337        %let _Source_connect = ;
338        %let _Source_engine = ;
339        %let _Source_memtype = DATA;
340        %let _Source_options = %nrquote();
341        %let _Source_alter = %nrquote();
342        %let _Source_path = %nrquote(/Join_A5IKCEC7.BW000016%(WorkTable%));
343        %let _Source_type = 1;
344        %let _Source_label = %nrquote();
345        
346        %let _OUTPUT_count = 1;
347        %let _OUTPUT = impraw.app_tblcustomer;
348        %let _OUTPUT_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
349        ;
350        %let _OUTPUT_engine = SASIOIMP;
351        %let _OUTPUT_memtype = DATA;
352        %let _OUTPUT_options = %nrquote();
353        %let _OUTPUT_alter = %nrquote();
354        %let _OUTPUT_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/app_tblcustomer%(Table%));
355        %let _OUTPUT_type = 1;
356        %let _OUTPUT_label = %nrquote();
357        /* List of target columns to keep  */
358        %let _OUTPUT_keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
359                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
360                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
361                fstrwho fdtmwhen fdtmwhen_info record_effective_timestamp
362                record_expiry_timestamp record_active_flag record_deleted_flag
363                insert_object_run_key update_object_run_key;
364        %let _OUTPUT_col_count = 23;
365        %let _OUTPUT_col0_name = flngcustomerkey;
366        %let _OUTPUT_col0_table = impraw.app_tblcustomer;
9                                                          The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

367        %let _OUTPUT_col0_length = 8;
368        %let _OUTPUT_col0_type = ;
369        %let _OUTPUT_col0_format = 11.;
370        %let _OUTPUT_col0_informat = 11.;
371        %let _OUTPUT_col0_label = %nrquote(flngcustomerkey);
372        %let _OUTPUT_col0_input0 = flngCustomerKey;
373        %let _OUTPUT_col0_input0_table = work.tblcustomer;
374        %let _OUTPUT_col0_exp = ;
375        %let _OUTPUT_col0_input = flngCustomerKey;
376        %let _OUTPUT_col0_input_count = 1;
377        %let _OUTPUT_col1_name = flngver;
378        %let _OUTPUT_col1_table = impraw.app_tblcustomer;
379        %let _OUTPUT_col1_length = 8;
380        %let _OUTPUT_col1_type = ;
381        %let _OUTPUT_col1_format = 11.;
382        %let _OUTPUT_col1_informat = 11.;
383        %let _OUTPUT_col1_label = %nrquote(flngver);
384        %let _OUTPUT_col1_input0 = flngVer;
385        %let _OUTPUT_col1_input0_table = work.tblcustomer;
386        %let _OUTPUT_col1_exp = ;
387        %let _OUTPUT_col1_input = flngVer;
388        %let _OUTPUT_col1_input_count = 1;
389        %let _OUTPUT_col2_name = flngverlast;
390        %let _OUTPUT_col2_table = impraw.app_tblcustomer;
391        %let _OUTPUT_col2_length = 8;
392        %let _OUTPUT_col2_type = ;
393        %let _OUTPUT_col2_format = 11.;
394        %let _OUTPUT_col2_informat = 11.;
395        %let _OUTPUT_col2_label = %nrquote(flngverlast);
396        %let _OUTPUT_col2_input0 = flngVerLast;
397        %let _OUTPUT_col2_input0_table = work.tblcustomer;
398        %let _OUTPUT_col2_exp = ;
399        %let _OUTPUT_col2_input = flngVerLast;
400        %let _OUTPUT_col2_input_count = 1;
401        %let _OUTPUT_col3_name = fstrcustomertype;
402        %let _OUTPUT_col3_table = impraw.app_tblcustomer;
403        %let _OUTPUT_col3_length = 12;
404        %let _OUTPUT_col3_type = $;
405        %let _OUTPUT_col3_format = $12.;
406        %let _OUTPUT_col3_informat = $12.;
407        %let _OUTPUT_col3_label = %nrquote(fstrcustomertype);
408        %let _OUTPUT_col3_input0 = fstrCustomerType;
409        %let _OUTPUT_col3_input0_table = work.tblcustomer;
410        %let _OUTPUT_col3_exp = ;
411        %let _OUTPUT_col3_input = fstrCustomerType;
412        %let _OUTPUT_col3_input_count = 1;
413        %let _OUTPUT_col4_name = fdtmcommence;
414        %let _OUTPUT_col4_table = impraw.app_tblcustomer;
415        %let _OUTPUT_col4_length = 8;
416        %let _OUTPUT_col4_type = ;
417        %let _OUTPUT_col4_format = DATETIME29.9;
418        %let _OUTPUT_col4_informat = DATETIME29.9;
419        %let _OUTPUT_col4_label = %nrquote(fdtmcommence);
420        %let _OUTPUT_col4_input0 = fdtmCommence;
421        %let _OUTPUT_col4_input0_table = work.tblcustomer;
422        %let _OUTPUT_col4_exp = ;
423        %let _OUTPUT_col4_input = fdtmCommence;
424        %let _OUTPUT_col4_input_count = 1;
10                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

425        %let _OUTPUT_col5_name = fdtmcease;
426        %let _OUTPUT_col5_table = impraw.app_tblcustomer;
427        %let _OUTPUT_col5_length = 8;
428        %let _OUTPUT_col5_type = ;
429        %let _OUTPUT_col5_format = DATETIME29.9;
430        %let _OUTPUT_col5_informat = DATETIME29.9;
431        %let _OUTPUT_col5_label = %nrquote(fdtmcease);
432        %let _OUTPUT_col5_input0 = fdtmCease;
433        %let _OUTPUT_col5_input0_table = work.tblcustomer;
434        %let _OUTPUT_col5_exp = ;
435        %let _OUTPUT_col5_input = fdtmCease;
436        %let _OUTPUT_col5_input_count = 1;
437        %let _OUTPUT_col6_name = flngcustomerlevel;
438        %let _OUTPUT_col6_table = impraw.app_tblcustomer;
439        %let _OUTPUT_col6_length = 8;
440        %let _OUTPUT_col6_type = ;
441        %let _OUTPUT_col6_format = 11.;
442        %let _OUTPUT_col6_informat = 11.;
443        %let _OUTPUT_col6_label = %nrquote(flngcustomerlevel);
444        %let _OUTPUT_col6_input0 = flngCustomerLevel;
445        %let _OUTPUT_col6_input0_table = work.tblcustomer;
446        %let _OUTPUT_col6_exp = ;
447        %let _OUTPUT_col6_input = flngCustomerLevel;
448        %let _OUTPUT_col6_input_count = 1;
449        %let _OUTPUT_col7_name = flngdockey;
450        %let _OUTPUT_col7_table = impraw.app_tblcustomer;
451        %let _OUTPUT_col7_length = 8;
452        %let _OUTPUT_col7_type = ;
453        %let _OUTPUT_col7_format = 11.;
454        %let _OUTPUT_col7_informat = 11.;
455        %let _OUTPUT_col7_label = %nrquote(flngdockey);
456        %let _OUTPUT_col7_input0 = flngDocKey;
457        %let _OUTPUT_col7_input0_table = work.tblcustomer;
458        %let _OUTPUT_col7_exp = ;
459        %let _OUTPUT_col7_input = flngDocKey;
460        %let _OUTPUT_col7_input_count = 1;
461        %let _OUTPUT_col8_name = flngfolderkey;
462        %let _OUTPUT_col8_table = impraw.app_tblcustomer;
463        %let _OUTPUT_col8_length = 8;
464        %let _OUTPUT_col8_type = ;
465        %let _OUTPUT_col8_format = 11.;
466        %let _OUTPUT_col8_informat = 11.;
467        %let _OUTPUT_col8_label = %nrquote(flngfolderkey);
468        %let _OUTPUT_col8_input0 = flngFolderKey;
469        %let _OUTPUT_col8_input0_table = work.tblcustomer;
470        %let _OUTPUT_col8_exp = ;
471        %let _OUTPUT_col8_input = flngFolderKey;
472        %let _OUTPUT_col8_input_count = 1;
473        %let _OUTPUT_col9_name = flngrefreshver;
474        %let _OUTPUT_col9_table = impraw.app_tblcustomer;
475        %let _OUTPUT_col9_length = 8;
476        %let _OUTPUT_col9_type = ;
477        %let _OUTPUT_col9_format = 11.;
478        %let _OUTPUT_col9_informat = 11.;
479        %let _OUTPUT_col9_label = %nrquote(flngrefreshver);
480        %let _OUTPUT_col9_input0 = flngRefreshVer;
481        %let _OUTPUT_col9_input0_table = work.tblcustomer;
482        %let _OUTPUT_col9_exp = ;
11                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

483        %let _OUTPUT_col9_input = flngRefreshVer;
484        %let _OUTPUT_col9_input_count = 1;
485        %let _OUTPUT_col10_name = flngcustomerversion;
486        %let _OUTPUT_col10_table = impraw.app_tblcustomer;
487        %let _OUTPUT_col10_length = 8;
488        %let _OUTPUT_col10_type = ;
489        %let _OUTPUT_col10_format = 11.;
490        %let _OUTPUT_col10_informat = 11.;
491        %let _OUTPUT_col10_label = %nrquote(flngcustomerversion);
492        %let _OUTPUT_col10_input0 = flngCustomerVersion;
493        %let _OUTPUT_col10_input0_table = work.tblcustomer;
494        %let _OUTPUT_col10_exp = ;
495        %let _OUTPUT_col10_input = flngCustomerVersion;
496        %let _OUTPUT_col10_input_count = 1;
497        %let _OUTPUT_col11_name = flngwebversion;
498        %let _OUTPUT_col11_table = impraw.app_tblcustomer;
499        %let _OUTPUT_col11_length = 8;
500        %let _OUTPUT_col11_type = ;
501        %let _OUTPUT_col11_format = 11.;
502        %let _OUTPUT_col11_informat = 11.;
503        %let _OUTPUT_col11_label = %nrquote(flngwebversion);
504        %let _OUTPUT_col11_input0 = flngWebVersion;
505        %let _OUTPUT_col11_input0_table = work.tblcustomer;
506        %let _OUTPUT_col11_exp = ;
507        %let _OUTPUT_col11_input = flngWebVersion;
508        %let _OUTPUT_col11_input_count = 1;
509        %let _OUTPUT_col12_name = fdtmwebpublished;
510        %let _OUTPUT_col12_table = impraw.app_tblcustomer;
511        %let _OUTPUT_col12_length = 8;
512        %let _OUTPUT_col12_type = ;
513        %let _OUTPUT_col12_format = DATETIME29.9;
514        %let _OUTPUT_col12_informat = DATETIME29.9;
515        %let _OUTPUT_col12_label = %nrquote(fdtmwebpublished);
516        %let _OUTPUT_col12_input0 = fdtmWebPublished;
517        %let _OUTPUT_col12_input0_table = work.tblcustomer;
518        %let _OUTPUT_col12_exp = ;
519        %let _OUTPUT_col12_input = fdtmWebPublished;
520        %let _OUTPUT_col12_input_count = 1;
521        %let _OUTPUT_col13_name = fdtmcreated;
522        %let _OUTPUT_col13_table = impraw.app_tblcustomer;
523        %let _OUTPUT_col13_length = 8;
524        %let _OUTPUT_col13_type = ;
525        %let _OUTPUT_col13_format = DATETIME29.9;
526        %let _OUTPUT_col13_informat = DATETIME29.9;
527        %let _OUTPUT_col13_label = %nrquote(fdtmcreated);
528        %let _OUTPUT_col13_input0 = fdtmCreated;
529        %let _OUTPUT_col13_input0_table = work.tblcustomer;
530        %let _OUTPUT_col13_exp = ;
531        %let _OUTPUT_col13_input = fdtmCreated;
532        %let _OUTPUT_col13_input_count = 1;
533        %let _OUTPUT_col14_name = fstrwho;
534        %let _OUTPUT_col14_table = impraw.app_tblcustomer;
535        %let _OUTPUT_col14_length = 20;
536        %let _OUTPUT_col14_type = $;
537        %let _OUTPUT_col14_format = $20.;
538        %let _OUTPUT_col14_informat = $20.;
539        %let _OUTPUT_col14_label = %nrquote(fstrwho);
540        %let _OUTPUT_col14_input0 = fstrWho;
12                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

541        %let _OUTPUT_col14_input0_table = work.tblcustomer;
542        %let _OUTPUT_col14_exp = ;
543        %let _OUTPUT_col14_input = fstrWho;
544        %let _OUTPUT_col14_input_count = 1;
545        %let _OUTPUT_col15_name = fdtmwhen;
546        %let _OUTPUT_col15_table = impraw.app_tblcustomer;
547        %let _OUTPUT_col15_length = 8;
548        %let _OUTPUT_col15_type = ;
549        %let _OUTPUT_col15_format = DATETIME29.9;
550        %let _OUTPUT_col15_informat = DATETIME29.9;
551        %let _OUTPUT_col15_label = %nrquote(fdtmwhen);
552        %let _OUTPUT_col15_input0 = fdtmWhen;
553        %let _OUTPUT_col15_input0_table = work.tblcustomer;
554        %let _OUTPUT_col15_exp = ;
555        %let _OUTPUT_col15_input = fdtmWhen;
556        %let _OUTPUT_col15_input_count = 1;
557        %let _OUTPUT_col16_name = fdtmwhen_info;
558        %let _OUTPUT_col16_table = impraw.app_tblcustomer;
559        %let _OUTPUT_col16_length = 8;
560        %let _OUTPUT_col16_type = ;
561        %let _OUTPUT_col16_format = DATETIME29.9;
562        %let _OUTPUT_col16_informat = DATETIME29.9;
563        %let _OUTPUT_col16_label = %nrquote(fdtmwhen_info);
564        %let _OUTPUT_col16_input0 = fdtmWhen_info;
565        %let _OUTPUT_col16_input0_table = work.tblcustomer;
566        %let _OUTPUT_col16_exp = ;
567        %let _OUTPUT_col16_input = fdtmWhen_info;
568        %let _OUTPUT_col16_input_count = 1;
569        %let _OUTPUT_col17_name = record_effective_timestamp;
570        %let _OUTPUT_col17_table = impraw.app_tblcustomer;
571        %let _OUTPUT_col17_length = 8;
572        %let _OUTPUT_col17_type = ;
573        %let _OUTPUT_col17_format = DATETIME29.9;
574        %let _OUTPUT_col17_informat = DATETIME29.9;
575        %let _OUTPUT_col17_label = %nrquote(record_effective_timestamp);
576        %let _OUTPUT_col17_exp = ;
577        %let _OUTPUT_col17_input_count = 0;
578        %let _OUTPUT_col18_name = record_expiry_timestamp;
579        %let _OUTPUT_col18_table = impraw.app_tblcustomer;
580        %let _OUTPUT_col18_length = 8;
581        %let _OUTPUT_col18_type = ;
582        %let _OUTPUT_col18_format = DATETIME29.9;
583        %let _OUTPUT_col18_informat = DATETIME29.9;
584        %let _OUTPUT_col18_label = %nrquote(record_expiry_timestamp);
585        %let _OUTPUT_col18_exp = ;
586        %let _OUTPUT_col18_input_count = 0;
587        %let _OUTPUT_col19_name = record_active_flag;
588        %let _OUTPUT_col19_table = impraw.app_tblcustomer;
589        %let _OUTPUT_col19_length = 1;
590        %let _OUTPUT_col19_type = $;
591        %let _OUTPUT_col19_format = $1.;
592        %let _OUTPUT_col19_informat = $1.;
593        %let _OUTPUT_col19_label = %nrquote(record_active_flag);
594        %let _OUTPUT_col19_exp = ;
595        %let _OUTPUT_col19_input_count = 0;
596        %let _OUTPUT_col20_name = record_deleted_flag;
597        %let _OUTPUT_col20_table = impraw.app_tblcustomer;
598        %let _OUTPUT_col20_length = 1;
13                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

599        %let _OUTPUT_col20_type = $;
600        %let _OUTPUT_col20_format = $1.;
601        %let _OUTPUT_col20_informat = $1.;
602        %let _OUTPUT_col20_label = %nrquote(record_deleted_flag);
603        %let _OUTPUT_col20_exp = ;
604        %let _OUTPUT_col20_input_count = 0;
605        %let _OUTPUT_col21_name = insert_object_run_key;
606        %let _OUTPUT_col21_table = impraw.app_tblcustomer;
607        %let _OUTPUT_col21_length = 8;
608        %let _OUTPUT_col21_type = ;
609        %let _OUTPUT_col21_format = 11.;
610        %let _OUTPUT_col21_informat = 11.;
611        %let _OUTPUT_col21_label = %nrquote(insert_object_run_key);
612        %let _OUTPUT_col21_exp = ;
613        %let _OUTPUT_col21_input_count = 0;
614        %let _OUTPUT_col22_name = update_object_run_key;
615        %let _OUTPUT_col22_table = impraw.app_tblcustomer;
616        %let _OUTPUT_col22_length = 8;
617        %let _OUTPUT_col22_type = ;
618        %let _OUTPUT_col22_format = 11.;
619        %let _OUTPUT_col22_informat = 11.;
620        %let _OUTPUT_col22_label = %nrquote(update_object_run_key);
621        %let _OUTPUT_col22_exp = ;
622        %let _OUTPUT_col22_input_count = 0;
623        
624        %let _target = impraw.app_tblcustomer;
625        %let _target_connect =  DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64
626        ;
627        %let _target_engine = SASIOIMP;
628        %let _target_memtype = DATA;
629        %let _target_options = %nrquote();
630        %let _target_alter = %nrquote();
631        %let _target_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP Impala Raw/app_tblcustomer%(Table%));
632        %let _target_type = 1;
633        %let _target_label = %nrquote();
634        /* List of target columns to keep  */
635        %let _target_keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
636                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
637                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
638                fstrwho fdtmwhen fdtmwhen_info record_effective_timestamp
639                record_expiry_timestamp record_active_flag record_deleted_flag
640                insert_object_run_key update_object_run_key;
641        %let _target_col_count = 23;
642        %let _target_col0_name = flngcustomerkey;
643        %let _target_col0_table = impraw.app_tblcustomer;
644        %let _target_col0_length = 8;
645        %let _target_col0_type = ;
646        %let _target_col0_format = 11.;
647        %let _target_col0_informat = 11.;
648        %let _target_col0_label = %nrquote(flngcustomerkey);
649        %let _target_col0_input0 = flngCustomerKey;
650        %let _target_col0_input0_table = work.tblcustomer;
651        %let _target_col0_exp = ;
652        %let _target_col0_input = flngCustomerKey;
653        %let _target_col0_input_count = 1;
654        %let _target_col1_name = flngver;
655        %let _target_col1_table = impraw.app_tblcustomer;
656        %let _target_col1_length = 8;
14                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

657        %let _target_col1_type = ;
658        %let _target_col1_format = 11.;
659        %let _target_col1_informat = 11.;
660        %let _target_col1_label = %nrquote(flngver);
661        %let _target_col1_input0 = flngVer;
662        %let _target_col1_input0_table = work.tblcustomer;
663        %let _target_col1_exp = ;
664        %let _target_col1_input = flngVer;
665        %let _target_col1_input_count = 1;
666        %let _target_col2_name = flngverlast;
667        %let _target_col2_table = impraw.app_tblcustomer;
668        %let _target_col2_length = 8;
669        %let _target_col2_type = ;
670        %let _target_col2_format = 11.;
671        %let _target_col2_informat = 11.;
672        %let _target_col2_label = %nrquote(flngverlast);
673        %let _target_col2_input0 = flngVerLast;
674        %let _target_col2_input0_table = work.tblcustomer;
675        %let _target_col2_exp = ;
676        %let _target_col2_input = flngVerLast;
677        %let _target_col2_input_count = 1;
678        %let _target_col3_name = fstrcustomertype;
679        %let _target_col3_table = impraw.app_tblcustomer;
680        %let _target_col3_length = 12;
681        %let _target_col3_type = $;
682        %let _target_col3_format = $12.;
683        %let _target_col3_informat = $12.;
684        %let _target_col3_label = %nrquote(fstrcustomertype);
685        %let _target_col3_input0 = fstrCustomerType;
686        %let _target_col3_input0_table = work.tblcustomer;
687        %let _target_col3_exp = ;
688        %let _target_col3_input = fstrCustomerType;
689        %let _target_col3_input_count = 1;
690        %let _target_col4_name = fdtmcommence;
691        %let _target_col4_table = impraw.app_tblcustomer;
692        %let _target_col4_length = 8;
693        %let _target_col4_type = ;
694        %let _target_col4_format = DATETIME29.9;
695        %let _target_col4_informat = DATETIME29.9;
696        %let _target_col4_label = %nrquote(fdtmcommence);
697        %let _target_col4_input0 = fdtmCommence;
698        %let _target_col4_input0_table = work.tblcustomer;
699        %let _target_col4_exp = ;
700        %let _target_col4_input = fdtmCommence;
701        %let _target_col4_input_count = 1;
702        %let _target_col5_name = fdtmcease;
703        %let _target_col5_table = impraw.app_tblcustomer;
704        %let _target_col5_length = 8;
705        %let _target_col5_type = ;
706        %let _target_col5_format = DATETIME29.9;
707        %let _target_col5_informat = DATETIME29.9;
708        %let _target_col5_label = %nrquote(fdtmcease);
709        %let _target_col5_input0 = fdtmCease;
710        %let _target_col5_input0_table = work.tblcustomer;
711        %let _target_col5_exp = ;
712        %let _target_col5_input = fdtmCease;
713        %let _target_col5_input_count = 1;
714        %let _target_col6_name = flngcustomerlevel;
15                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

715        %let _target_col6_table = impraw.app_tblcustomer;
716        %let _target_col6_length = 8;
717        %let _target_col6_type = ;
718        %let _target_col6_format = 11.;
719        %let _target_col6_informat = 11.;
720        %let _target_col6_label = %nrquote(flngcustomerlevel);
721        %let _target_col6_input0 = flngCustomerLevel;
722        %let _target_col6_input0_table = work.tblcustomer;
723        %let _target_col6_exp = ;
724        %let _target_col6_input = flngCustomerLevel;
725        %let _target_col6_input_count = 1;
726        %let _target_col7_name = flngdockey;
727        %let _target_col7_table = impraw.app_tblcustomer;
728        %let _target_col7_length = 8;
729        %let _target_col7_type = ;
730        %let _target_col7_format = 11.;
731        %let _target_col7_informat = 11.;
732        %let _target_col7_label = %nrquote(flngdockey);
733        %let _target_col7_input0 = flngDocKey;
734        %let _target_col7_input0_table = work.tblcustomer;
735        %let _target_col7_exp = ;
736        %let _target_col7_input = flngDocKey;
737        %let _target_col7_input_count = 1;
738        %let _target_col8_name = flngfolderkey;
739        %let _target_col8_table = impraw.app_tblcustomer;
740        %let _target_col8_length = 8;
741        %let _target_col8_type = ;
742        %let _target_col8_format = 11.;
743        %let _target_col8_informat = 11.;
744        %let _target_col8_label = %nrquote(flngfolderkey);
745        %let _target_col8_input0 = flngFolderKey;
746        %let _target_col8_input0_table = work.tblcustomer;
747        %let _target_col8_exp = ;
748        %let _target_col8_input = flngFolderKey;
749        %let _target_col8_input_count = 1;
750        %let _target_col9_name = flngrefreshver;
751        %let _target_col9_table = impraw.app_tblcustomer;
752        %let _target_col9_length = 8;
753        %let _target_col9_type = ;
754        %let _target_col9_format = 11.;
755        %let _target_col9_informat = 11.;
756        %let _target_col9_label = %nrquote(flngrefreshver);
757        %let _target_col9_input0 = flngRefreshVer;
758        %let _target_col9_input0_table = work.tblcustomer;
759        %let _target_col9_exp = ;
760        %let _target_col9_input = flngRefreshVer;
761        %let _target_col9_input_count = 1;
762        %let _target_col10_name = flngcustomerversion;
763        %let _target_col10_table = impraw.app_tblcustomer;
764        %let _target_col10_length = 8;
765        %let _target_col10_type = ;
766        %let _target_col10_format = 11.;
767        %let _target_col10_informat = 11.;
768        %let _target_col10_label = %nrquote(flngcustomerversion);
769        %let _target_col10_input0 = flngCustomerVersion;
770        %let _target_col10_input0_table = work.tblcustomer;
771        %let _target_col10_exp = ;
772        %let _target_col10_input = flngCustomerVersion;
16                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

773        %let _target_col10_input_count = 1;
774        %let _target_col11_name = flngwebversion;
775        %let _target_col11_table = impraw.app_tblcustomer;
776        %let _target_col11_length = 8;
777        %let _target_col11_type = ;
778        %let _target_col11_format = 11.;
779        %let _target_col11_informat = 11.;
780        %let _target_col11_label = %nrquote(flngwebversion);
781        %let _target_col11_input0 = flngWebVersion;
782        %let _target_col11_input0_table = work.tblcustomer;
783        %let _target_col11_exp = ;
784        %let _target_col11_input = flngWebVersion;
785        %let _target_col11_input_count = 1;
786        %let _target_col12_name = fdtmwebpublished;
787        %let _target_col12_table = impraw.app_tblcustomer;
788        %let _target_col12_length = 8;
789        %let _target_col12_type = ;
790        %let _target_col12_format = DATETIME29.9;
791        %let _target_col12_informat = DATETIME29.9;
792        %let _target_col12_label = %nrquote(fdtmwebpublished);
793        %let _target_col12_input0 = fdtmWebPublished;
794        %let _target_col12_input0_table = work.tblcustomer;
795        %let _target_col12_exp = ;
796        %let _target_col12_input = fdtmWebPublished;
797        %let _target_col12_input_count = 1;
798        %let _target_col13_name = fdtmcreated;
799        %let _target_col13_table = impraw.app_tblcustomer;
800        %let _target_col13_length = 8;
801        %let _target_col13_type = ;
802        %let _target_col13_format = DATETIME29.9;
803        %let _target_col13_informat = DATETIME29.9;
804        %let _target_col13_label = %nrquote(fdtmcreated);
805        %let _target_col13_input0 = fdtmCreated;
806        %let _target_col13_input0_table = work.tblcustomer;
807        %let _target_col13_exp = ;
808        %let _target_col13_input = fdtmCreated;
809        %let _target_col13_input_count = 1;
810        %let _target_col14_name = fstrwho;
811        %let _target_col14_table = impraw.app_tblcustomer;
812        %let _target_col14_length = 20;
813        %let _target_col14_type = $;
814        %let _target_col14_format = $20.;
815        %let _target_col14_informat = $20.;
816        %let _target_col14_label = %nrquote(fstrwho);
817        %let _target_col14_input0 = fstrWho;
818        %let _target_col14_input0_table = work.tblcustomer;
819        %let _target_col14_exp = ;
820        %let _target_col14_input = fstrWho;
821        %let _target_col14_input_count = 1;
822        %let _target_col15_name = fdtmwhen;
823        %let _target_col15_table = impraw.app_tblcustomer;
824        %let _target_col15_length = 8;
825        %let _target_col15_type = ;
826        %let _target_col15_format = DATETIME29.9;
827        %let _target_col15_informat = DATETIME29.9;
828        %let _target_col15_label = %nrquote(fdtmwhen);
829        %let _target_col15_input0 = fdtmWhen;
830        %let _target_col15_input0_table = work.tblcustomer;
17                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

831        %let _target_col15_exp = ;
832        %let _target_col15_input = fdtmWhen;
833        %let _target_col15_input_count = 1;
834        %let _target_col16_name = fdtmwhen_info;
835        %let _target_col16_table = impraw.app_tblcustomer;
836        %let _target_col16_length = 8;
837        %let _target_col16_type = ;
838        %let _target_col16_format = DATETIME29.9;
839        %let _target_col16_informat = DATETIME29.9;
840        %let _target_col16_label = %nrquote(fdtmwhen_info);
841        %let _target_col16_input0 = fdtmWhen_info;
842        %let _target_col16_input0_table = work.tblcustomer;
843        %let _target_col16_exp = ;
844        %let _target_col16_input = fdtmWhen_info;
845        %let _target_col16_input_count = 1;
846        %let _target_col17_name = record_effective_timestamp;
847        %let _target_col17_table = impraw.app_tblcustomer;
848        %let _target_col17_length = 8;
849        %let _target_col17_type = ;
850        %let _target_col17_format = DATETIME29.9;
851        %let _target_col17_informat = DATETIME29.9;
852        %let _target_col17_label = %nrquote(record_effective_timestamp);
853        %let _target_col17_exp = ;
854        %let _target_col17_input_count = 0;
855        %let _target_col18_name = record_expiry_timestamp;
856        %let _target_col18_table = impraw.app_tblcustomer;
857        %let _target_col18_length = 8;
858        %let _target_col18_type = ;
859        %let _target_col18_format = DATETIME29.9;
860        %let _target_col18_informat = DATETIME29.9;
861        %let _target_col18_label = %nrquote(record_expiry_timestamp);
862        %let _target_col18_exp = ;
863        %let _target_col18_input_count = 0;
864        %let _target_col19_name = record_active_flag;
865        %let _target_col19_table = impraw.app_tblcustomer;
866        %let _target_col19_length = 1;
867        %let _target_col19_type = $;
868        %let _target_col19_format = $1.;
869        %let _target_col19_informat = $1.;
870        %let _target_col19_label = %nrquote(record_active_flag);
871        %let _target_col19_exp = ;
872        %let _target_col19_input_count = 0;
873        %let _target_col20_name = record_deleted_flag;
874        %let _target_col20_table = impraw.app_tblcustomer;
875        %let _target_col20_length = 1;
876        %let _target_col20_type = $;
877        %let _target_col20_format = $1.;
878        %let _target_col20_informat = $1.;
879        %let _target_col20_label = %nrquote(record_deleted_flag);
880        %let _target_col20_exp = ;
881        %let _target_col20_input_count = 0;
882        %let _target_col21_name = insert_object_run_key;
883        %let _target_col21_table = impraw.app_tblcustomer;
884        %let _target_col21_length = 8;
885        %let _target_col21_type = ;
886        %let _target_col21_format = 11.;
887        %let _target_col21_informat = 11.;
888        %let _target_col21_label = %nrquote(insert_object_run_key);
18                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

889        %let _target_col21_exp = ;
890        %let _target_col21_input_count = 0;
891        %let _target_col22_name = update_object_run_key;
892        %let _target_col22_table = impraw.app_tblcustomer;
893        %let _target_col22_length = 8;
894        %let _target_col22_type = ;
895        %let _target_col22_format = 11.;
896        %let _target_col22_informat = 11.;
897        %let _target_col22_label = %nrquote(update_object_run_key);
898        %let _target_col22_exp = ;
899        %let _target_col22_input_count = 0;
900        
901        
902        %let ep_key_cols = flngcustomerkey;
903        %let ep_key_cols_count = 1;
904        %let ep_key_cols0 = 1;
905        %let ep_key_cols1 = flngcustomerkey;
906        %let where = ;
907        %let change_capture_timestamp = fdtmWhen_info;
908        %let change_capture_timestamp_count = 1;
909        %let change_capture_timestamp0 = 1;
910        %let change_capture_timestamp1 = fdtmWhen_info;
911        %let history_type = %nrquote(H2);
912        %let duplication_grain = %nrquote(1);
913        %let h2_effective_column = fdtmWhen_info;
914        %let h2_effective_column_count = 1;
915        %let h2_effective_column0 = 1;
916        %let h2_effective_column1 = fdtmWhen_info;
917        %let effective_column = ;
918        %let effective_column_count = 0;
919        %let effective_column0 = 0;
920        %let to_timestamp = ;
921        %let to_timestamp_count = 0;
922        %let to_timestamp0 = 0;
923        %let effective_timestamp_grain = %nrquote(Seconds);
924        %let purge_grain = %nrquote(1);
925        %let debug = %nrquote(No);
926        %let ep_db_create_opts = %nrquote(with serdeproperties %(%'field.delim%'=%'\u0006%', %'line.delim%'=%'\u0007%',
926      ! %'serialization.format%'=%'\u0006%',%'serialization.escape.crlf%'=%'true%'%) stored as textfile);
927        %let lcf = lcf.OBJECT;
928        %let lcf_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
928      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
929        ;
930        %let lcf_engine = ORACLE;
931        %let lcf_memtype = DATA;
932        %let lcf_options = %nrquote();
933        %let lcf_alter = %nrquote();
934        %let lcf_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT%(Table%));
935        %let lcf_type = 1;
936        %let lcf_label = %nrquote();
937        %let ep_db_opts_count = %nrquote(1);
938        %let ep_db_opts = %nrquote(stored as parquet);
939        %let ep_db_opts1 = %nrquote(stored as parquet);
940        %let logging = lcf.OBJECT_RUN;
941        %let logging_connect =  DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" READBUFF=20000 dbclient_max_bytes=2
941      ! PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev"
942        ;
943        %let logging_engine = ORACLE;
19                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

944        %let logging_memtype = DATA;
945        %let logging_options = %nrquote();
946        %let logging_alter = %nrquote();
947        %let logging_path = %nrquote(/IRD/DIP Data Management/3000 Repositories/DIP/DIP LCF/OBJECT_RUN%(Table%));
948        %let logging_type = 1;
949        %let logging_label = %nrquote();
950        /* Access the data for DIP Hive Staging (hivestg)  */
951        LIBNAME hivestg HADOOP  URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;
951      ! ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"  HDFS_TEMPDIR="/env/1_dev/landing/"
951      ! LOGIN_TIMEOUT=0  DEFER=YES
952        PORT=10001 SERVER="ird26au.vsp.sas.com"  SCHEMA=dev_staging ;
NOTE: Libref HIVESTG was successfully assigned as follows: 
      Engine:        HADOOP 
      Physical Name: jdbc:hive2://ird26au.vsp.sas.com:10001/
953        %rcSet(&syslibrc);
954        
955        %let stg_hive_connect =  DEFER=YES URI="jdbc:hive2://ird26au.vsp.sas.com:10001/;
955      ! principal=hive/ird26au.vsp.sas.com@VSP.SAS.COM;ssl=true;sslTrustStore=/sso/sfw/sas/940/hadoopfiles/DigiAndSAS-CA.jks"
955      ! HDFS_TEMPDIR="/env/1_dev/landing/" LOGIN_TIMEOUT=0 SERVER="ird26au.vsp.sas.com"  PORT=10001
956        ;
957        %let stg_hive_engine = HADOOP;
958        %let stg_hive_path = /IRD/DIP Data Management/1000 Libraries/DIP Hive Staging (hivestg)(Library);
959        %let stg_hive = hivestg;
960        /* Access the data for DIP Impala Staging (impstg)  */
961        LIBNAME impstg SASIOIMP  DATABASE=dev_staging  HDFS_TEMPDIR="/env/1_dev/landing/"  DSN=ClouderaImpala64
961      ! SCHEMA=dev_staging ;
NOTE: DATABASE= and SCHEMA= now represent the same option. The value of the SCHEMA option will be used.
NOTE: Libref IMPSTG was successfully assigned as follows: 
      Engine:        IMPALA 
      Physical Name: ClouderaImpala64
962        %rcSet(&syslibrc);
963        
964        %let ep_staging_library_connect =  DATABASE=dev_staging DSN=ClouderaImpala64
965        ;
966        %let ep_staging_library_engine = SASIOIMP;
967        %let ep_staging_library = impstg;
968        %let ep_staging_library_path = /IRD/DIP Data Management/1000 Libraries/DIP Impala Staging (impstg)(Library);
969        %let Source_table_type = %nrquote(view);
970        %let tagsort = %nrquote(No);
971        
972        /* List of target columns to keep  */
973        %let _keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
974                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
975                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
976                fstrwho fdtmwhen fdtmwhen_info record_effective_timestamp
977                record_expiry_timestamp record_active_flag record_deleted_flag
978                insert_object_run_key update_object_run_key;
979        /* List of target columns to keep  */
980        %let keep = flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence
981                fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver
982                flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated
983                fstrwho fdtmwhen fdtmwhen_info record_effective_timestamp
984                record_expiry_timestamp record_active_flag record_deleted_flag
985                insert_object_run_key update_object_run_key;
986        %change_extract;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   option nosymbolgen nomlogic validvarname=any validmemname=extend spool mprint 
mprintnest nofullstimer notes bufno=3000 bufsize=65535 ibufno=10000 ibufsize=32767 compress=no;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
20                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do connect = "DATABASE=dev_staging DSN=ClouderaImpala64", 
"DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   i + 1;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if i = 1 then prefix = 'stg';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else prefix = 'tgt';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 6;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'SCHEMA');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if schema_index = 0 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_index = index(connect, 'DATABASE');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema_length = 8;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   schema = dequote(scan(substr(connect, schema_index + schema_length + 
1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   auth_index = index(connect, 'AUTHDOMAIN');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if auth_index then auth = dequote(scan(substr(connect, auth_index + 10 
+ 1), 1, ' '));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   else auth = ' ';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_schema', cats('`', schema, '`'));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput(prefix || '_auth', strip(auth));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(tblcustomer, app_tblcustomer);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('source_table', lowcase(vname(tblcustomer)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('_target_name', lowcase(vname(app_tblcustomer)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   array col $ 1 flngcustomerkey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length key_cols by_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(key_cols, by_cols);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do over col;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   key_cols = catx(', ', key_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   by_cols = catx(' ', by_cols, lowcase(vname(col)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('key_order', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('by_order', strip(by_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc sql noprint;
21                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   connect to ORACLE(DBMAX_TEXT=32767 DEFER=YES encoding="utf-8" 
READBUFF=20000 dbclient_max_bytes=2 PATH="irddev20.vsp.sas.com" AUTHDOMAIN="lcf_dev");
NOTE:  Credential could not be obtained from Viya credentials service.
NOTE:  Credential obtained from SAS metadata server.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   select object_run_key format=best. into :object_run_key 
trimmed from connection to ORACLE (select lcf.seq_object_run_key.nextval as object_run_key from dual);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   disconnect from ORACLE;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.37 seconds
      cpu time            0.16 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   data _object_run(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if 0 then set lcf.OBJECT_RUN;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   start_time = "30OCT2019:14:46:54"dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   object_prg_name = "app_tblcustomer P2H2";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   status_message = 'Job incomplete';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_read = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   records_written = 0;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   log_position = getoption('log');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   if not missing(log_position) then object_log_name = 
substr(log_position, index(log_position, 'Logs/') + 5);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   load_pattern_name = "Change Extract";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   output;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   drop log_position;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: The data set WORK._OBJECT_RUN has 1 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc append base=lcf.OBJECT_RUN data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;

NOTE: Appending WORK._OBJECT_RUN to LCF.OBJECT_RUN.
NOTE: There were 1 observations read from the data set WORK._OBJECT_RUN.
NOTE: 1 observations added.
NOTE: The data set LCF.OBJECT_RUN has . observations and 35 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.36 seconds
      cpu time            0.17 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   proc delete data=_object_run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   run;
NOTE: Deleting WORK._OBJECT_RUN (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
22                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(app_tblcustomer);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('meta_target_name', 
strip(lowcase(vname(app_tblcustomer))), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call missing(fdtmWhen_info);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('effective_column', lowcase(vname(fdtmWhen_info)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   retain table "app_tblcustomer";
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   length table_suffix $ 40 suffix $ 5;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   do suffix = '', '_chgt', '_chgd', '_new', '_old', '_dt', '_unwd', 
'_nr';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_suffix = cats(table, suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   table_length = length(table);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   suffix_length = length(suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   if suffix = '_nr' and length(table_suffix) > 32 then do;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   status_msg = catx(' ', 'Table name length too long:', table_suffix);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symput('status_msg', strip(status_msg));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('hadoop_table' || suffix, cats('`', table_suffix, '`'), 
'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   call symputx('sas_table' || suffix, table_suffix, 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   data _app_tblcustomer(compress=no);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   stop;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):   run;

NOTE: The data set WORK._APP_TBLCUSTOMER has 0 observations and 0 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select object_key, coalesce(days_to_backfill, 
0) as days_to_backfill into :object_key trimmed, :backfill trimmed from lcf.OBJECT where lowcase(target_object_name) = 
"app_tblcustomer";
23                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   connect to SASIOIMP(DBMAX_TEXT=32767 
DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   select row_count format=best20., 
int(ifn(max_timestamp ne '1jan1800:0:0'dt, max_timestamp - 10, max_timestamp)) format=is8601dt26.3 into :_nobs trimmed, 
:max_timestamp trimmed from connection to SASIOIMP (select count(*) as `row_count`, coalesce( days_add(max(`fdtmwhen_info`), -5) , 
'1800-01-01T00:00:00') as `max_timestamp` from `dev_raw`.`app_tblcustomer`);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS.GET_OBJECT_AND_TIMESTAMP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.35 seconds
      cpu time            0.11 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.PARSE_COLUMNS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   delete _source_v _source_v_dedup _source_v2 _source_v3 existing_keys 
_source_date_selection;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 28, object_name = 
"app_tblcustomer", prev_high_water_mark_value = inputn("2019-10-24T20:54:38.000", 'is8601dt23.0'), task1 = "Read Source", 
task1_start_time = datetime() where object_run_key = 9107;
NOTE: 1 row was updated in LCF.OBJECT_RUN.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.11 seconds
      cpu time            0.88 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   create view _source_v as select flngcustomerkey length=8 format=11. , flngver 
length=8 format=11. , flngverlast length=8 format=11. , fstrcustomertype length=12 format=$12. , fdtmcommence length=8 
format=DATETIME29.9 , fdtmcease length=8 format=DATETIME29.9 , flngcustomerlevel length=8 format=11. , flngdockey length=8 
format=11. , flngfolderkey length=8 format=11. , flngrefreshver length=8 format=11. , flngcustomerversion length=8 format=11. , 
24                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

flngwebversion length=8 format=11. , fdtmwebpublished length=8 format=DATETIME29.9 , fdtmcreated length=8 format=DATETIME29.9 , 
fstrwho length=20 format=$20. , fdtmwhen length=8 format=DATETIME29.9 , fdtmwhen_info length=8 format=DATETIME29.9 from 
work.tblcustomer where ( fdtmWhen_info between "24OCT2019:20:54:38.000"dt and "30OCT2019:14:46:56.964"dt) order by flngcustomerkey, 
fdtmwhen_info ;
NOTE: SQL view WORK._SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence 
fdtmcease flngcustomerlevel flngdockey flngfolderkey flngrefreshver flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated 
fstrwho fdtmwhen fdtmwhen_info;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   attrib sas_cols hadoop_cols length=$ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   sas_cols = catx(', ', sas_cols, strip(lowcase(vname(cols))));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   hadoop_cols = catx(', ', hadoop_cols, cats("`", lowcase(vname(cols)), "`"));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('sas_cols', strip(sas_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_cols', strip(hadoop_cols), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symputx('hadoop_effective_column', cats('`', lowcase(vname(fdtmwhen_info)), 
'`'), 'g');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name into :date_vars separated by ' ' from dictionary.columns where libname = 
'WORK' and memname = '_SOURCE_V' and format like 'DATE%' and format not like 'DATETIME%';
NOTE: No rows were selected.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.02 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v2 / view=_source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   retain flngcustomerkey flngver flngverlast fstrcustomertype fdtmcommence fdtmcease 
flngcustomerlevel flngdockey flngfolderkey flngrefreshver flngcustomerversion flngwebversion fdtmwebpublished fdtmcreated fstrwho 
fdtmwhen fdtmwhen_info ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
25                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 28, task1 = "Read 
Source", task1_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 28, task2 = 
"Validation", task2_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _null_;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array cols $ 1 flngcustomerkey;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   length key_cols $ 32767;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over cols;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   key_cols = catx(', ', key_cols, lowcase(vname(cols)));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   call symput('key_cols', strip(key_cols));
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):   option compress=no missing=' ' nomprint nonotes
There are no rows in work.mismatched_error.
There are no rows in work.mismatched_warning.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.VALIDATE):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 28, task2 = 
"Validation", task2_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
26                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

      cpu time            0.28 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 0, object_key = 28, task3 = "Table 
Load", task3_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select name, cats(name, '_x'), catx(' = ', cats(name, '_x'), name) into 
:datetime_names separated by ' ', :datetime_names_char separated by ' ', :datetime_rename separated by ' ' from dictionary.columns 
where libname = 'WORK' and memname = '_SOURCE_V2' and format like 'DATETIME%';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   data _source_v3(label="Datetimes converted to ISO8601 timestamps") / view=_source_v3;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   set _source_v2;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array from_dt fdtmcommence fdtmcease fdtmwebpublished fdtmcreated fdtmwhen 
fdtmwhen_info;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   array to_dt $ 26 fdtmcommence_x fdtmcease_x fdtmwebpublished_x fdtmcreated_x 
fdtmwhen_x fdtmwhen_info_x;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   do over from_dt;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   to_dt[_i_] = put(from_dt, is8601dt26.3);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   end;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   drop fdtmcommence fdtmcease fdtmwebpublished fdtmcreated fdtmwhen fdtmwhen_info;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   rename fdtmcommence_x = fdtmcommence fdtmcease_x = fdtmcease fdtmwebpublished_x = 
fdtmwebpublished fdtmcreated_x = fdtmcreated fdtmwhen_x = fdtmwhen fdtmwhen_info_x = fdtmwhen_info;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   run;

NOTE: DATA STEP view saved on file WORK._SOURCE_V3.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View WORK._SOURCE_V2.VIEW used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
27                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_nr`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_chgt`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_chgd`) by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblcustomer_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblcustomer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.24 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select ifc(format not like 'DATETIME%', cats('`', name, '`'), cat('cast(null as 
varchar(26)) as `', strip(name), '`')) into :create_string separated by ', ' from dictionary.columns where libname = "IMPRAW" and 
upcase(memname) = "APP_TBLCUSTOMER" and lowcase(name) notin('record_effective_timestamp', 'record_expiry_timestamp', 
'record_active_flag', 'record_deleted_flag', 'insert_object_run_key', 'update_object_run_key') ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.09 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`app_tblcustomer` with serdeproperties 
('field.delim'='\u0006', 'line.delim'='\u0007', 'serialization.format'='\u0006','serialization.escape.crlf'='true') stored as 
textfile as select `flngcustomerkey`, `flngver`, `flngverlast`, `fstrcustomertype`, cast(null as varchar(26)) as `fdtmcommence`, 
cast(null as varchar(26)) as `fdtmcease`, `flngcustomerlevel`, `flngdockey`, `flngfolderkey`, `flngrefreshver`, 
`flngcustomerversion`, `flngwebversion`, cast(null as varchar(26)) as `fdtmwebpublished`, cast(null as varchar(26)) as 
`fdtmcreated`, `fstrwho`, cast(null as varchar(26)) as `fdtmwhen`, cast(null as varchar(26)) as `fdtmwhen_info` from 
`dev_raw`.`app_tblcustomer` where false) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   insert into hivestg.app_tblcustomer(bulkload=yes) select flngcustomerkey, flngver, 
flngverlast, fstrcustomertype, fdtmcommence, fdtmcease, flngcustomerlevel, flngdockey, flngfolderkey, flngrefreshver, 
flngcustomerversion, flngwebversion, fdtmwebpublished, fdtmcreated, fstrwho, fdtmwhen, fdtmwhen_info from _source_v3;
NOTE: View WORK._SOURCE_V3.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
28                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

NOTE: There were 39147 observations read from the data set WORK.TBLCUSTOMER.
      WHERE (fdtmWhen_info>='  24OCT2019:20:54:38'DT and fdtmWhen_info<='  30OCT2019:14:46:57'DT);
NOTE: There were 39147 observations read from the data set WORK._SOURCE_V.
NOTE: View WORK._SOURCE_V3.VIEW used (Total process time):
      real time           2.86 seconds
      cpu time            0.23 seconds
      
NOTE: There were 39147 observations read from the data set WORK._SOURCE_V2.
NOTE: 39147 rows were inserted into HIVESTG.APP_TBLCUSTOMER.

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.21 seconds
      cpu time            0.54 seconds
      


INFO: 39,147 observations inserted
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are no observations in impstg.app_tblcustomer (dev_staging.app_tblcustomer) where `flngcustomerkey` is null or 
`fdtmwhen_info` is null.
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql dquote=ansi noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select count(*) into :date_columns_count trimmed from dictionary.columns where 
libname = 'WORK' and memname = '_SOURCE_V2' and ( format like 'DATETIME%' or format like 'IS8601DT%');
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   select case when format like 'DATETIME%' or format like 'IS8601DT%' then 
cat('cast(`', strip(lowcase(name)), '` as timestamp) as `', strip(name), '`') else cats('`', name, '`') end as select_clause into 
:select_clause separated by ', ' from dictionary.columns where libname = 'WORK' and memname = '_SOURCE_V2';
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (create table `dev_staging`.`app_tblcustomer_dt` stored as parquet as select 
`flngcustomerkey`, `flngver`, `flngverlast`, `fstrcustomertype`, cast(`fdtmcommence` as timestamp) as `fdtmcommence`, 
cast(`fdtmcease` as timestamp) as `fdtmcease`, `flngcustomerlevel`, `flngdockey`, `flngfolderkey`, `flngrefreshver`, 
`flngcustomerversion`, `flngwebversion`, cast(`fdtmwebpublished` as timestamp) as `fdtmwebpublished`, cast(`fdtmcreated` as 
timestamp) as `fdtmcreated`, `fstrwho`, cast(`fdtmwhen` as timestamp) as `fdtmwhen`, cast(`fdtmwhen_info` as timestamp) as 
`fdtmwhen_info` from `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (refresh `dev_staging`.`app_tblcustomer_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (drop table `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (alter table `dev_staging`.`app_tblcustomer_dt` rename to 
`dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (invalidate metadata `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute (compute stats `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
29                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           27.85 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   execute(create table `dev_staging`.`app_tblcustomer_nr` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`fdtmwhen`, _left.`fdtmwhen_info` 
from `dev_staging`.`app_tblcustomer` as _left left join `dev_raw`.`app_tblcustomer` as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.`fdtmwhen_info` = _right.`fdtmwhen_info` where _right.`flngcustomerkey` is null) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           4.40 seconds
      cpu time            0.08 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   run;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.COUNT):   option nomprint nonotes
There are 39,147 observations in impstg.app_tblcustomer_nr (dev_staging.app_tblcustomer_nr).
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task3 = 
"Table Load", task3_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds
      

MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT.PATTERN_COMMON_SETUP):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task4 = "Capture Changes", 
task4_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
30                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql noprint;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (invalidate metadata `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT):   execute (refresh `dev_staging`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`app_tblcustomer_chgt` stored as parquet as with new_min as (select 
`flngcustomerkey`, min(`fdtmwhen_info`) as `effective_ts` from `dev_staging`.`app_tblcustomer_nr` group by `flngcustomerkey`), 
current_max as (select `flngcustomerkey`, max(record_effective_timestamp) as `effective_ts` from `dev_raw`.`app_tblcustomer` group 
by `flngcustomerkey`), new_ranked as (select `flngcustomerkey`, `fdtmwhen_info` as `effective_ts`, rank() over(partition by 
`flngcustomerkey` order by `fdtmwhen_info`) as `rank` from `dev_staging`.`app_tblcustomer_nr`), previous_active as (select distinct 
`flngcustomerkey`, `effective_ts`, `rank` - 1 as `rank` from new_ranked) select _left.`flngcustomerkey`, _left.`effective_ts`, 
_left.`effective_ts` as `record_effective_timestamp`, milliseconds_add(_right.`effective_ts`, -1) as `record_expiry_timestamp`, 
cast('U' as varchar(1)) as `operation`, cast(9107 as int) as `object_run_key` from current_max as _left left join new_min as _right 
on _left.`flngcustomerkey` = _right.`flngcustomerkey` where _right.`flngcustomerkey` is not null union all select 
_left.`flngcustomerkey`, _left.`effective_ts`, _left.`effective_ts` as `record_effective_timestamp`, 
coalesce(milliseconds_add(_right.`effective_ts`, -1), cast('9000-12-31T00:00:00' as timestamp)) as `record_expiry_timestamp`, 
cast('I' as varchar(1)) as `operation`, cast(9107 as int) as `object_run_key` from new_ranked as _left left join previous_active as 
_right on _left.`flngcustomerkey` = _right.`flngcustomerkey` and _left.`rank` = _right.`rank`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   select count into :_nobs from connection to SASIOIMP (select count(*) as `count` from 
`dev_staging`.`app_tblcustomer_chgt`);
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           2.62 seconds
      cpu time            0.11 seconds
      


INFO: There are 78,294 rows in app_tblcustomer_chgt
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_staging`.`app_tblcustomer_chgd` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`fdtmwhen`, _left.`fdtmwhen_info`, 
_right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, _right.object_run_key from 
`dev_staging`.`app_tblcustomer_nr` as _left inner join `dev_staging`.`app_tblcustomer_chgt` as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.`fdtmwhen_info` = _right.`effective_ts` and _right.operation = 'I' union all select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`fdtmwhen`, _left.`fdtmwhen_info`, 
_right.record_effective_timestamp, _right.record_expiry_timestamp, _right.operation, _right.object_run_key from 
`dev_raw`.`app_tblcustomer` as _left inner join `dev_staging`.`app_tblcustomer_chgt` as _right on _left.`flngcustomerkey` = 
_right.`flngcustomerkey` and _left.record_effective_timestamp = _right.record_effective_timestamp and _right.operation = 'U') by 
SASIOIMP;
MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
31                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

NOTE: PROCEDURE SQL used (Total process time):
      real time           2.20 seconds
      cpu time            0.06 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task4 = "Capture Changes", 
task4_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.29 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task5 = "Apply Changes", 
task5_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   execute (create table `dev_raw`.`app_tblcustomer_new` stored as parquet as select 
_left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, 
_left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, 
_left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, _left.`fdtmwhen`, _left.`fdtmwhen_info`, 
_left.record_effective_timestamp, _left.record_expiry_timestamp, _left.record_active_flag, _left.record_deleted_flag, 
_left.insert_object_run_key, _left.update_object_run_key from `dev_raw`.`app_tblcustomer` as _left left join 
`dev_staging`.`app_tblcustomer_chgd` as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey` and 
_left.record_effective_timestamp = _right.record_effective_timestamp and _right.object_run_key = 9107 where 
_right.`flngcustomerkey` is null union all select _left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, 
_left.`fstrcustomertype`, _left.`fdtmcommence`, _left.`fdtmcease`, _left.`flngcustomerlevel`, _left.`flngdockey`, 
_left.`flngfolderkey`, _left.`flngrefreshver`, _left.`flngcustomerversion`, _left.`flngwebversion`, _left.`fdtmwebpublished`, 
_left.`fdtmcreated`, _left.`fstrwho`, _left.`fdtmwhen`, _left.`fdtmwhen_info`, record_effective_timestamp, record_expiry_timestamp, 
cast(case when record_expiry_timestamp >= cast("9000-12-31T00:00:00" as timestamp) then 'Y' else 'N' end as varchar(1)) as 
record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, object_run_key as insert_object_run_key, object_run_key as 
update_object_run_key from `dev_staging`.`app_tblcustomer_chgd` as _left where object_run_key = 9107 and operation = 'I' union all 
select _left.`flngcustomerkey`, _left.`flngver`, _left.`flngverlast`, _left.`fstrcustomertype`, _left.`fdtmcommence`, 
_left.`fdtmcease`, _left.`flngcustomerlevel`, _left.`flngdockey`, _left.`flngfolderkey`, _left.`flngrefreshver`, 
_left.`flngcustomerversion`, _left.`flngwebversion`, _left.`fdtmwebpublished`, _left.`fdtmcreated`, _left.`fstrwho`, 
_left.`fdtmwhen`, _left.`fdtmwhen_info`, _left.record_effective_timestamp, _left.record_expiry_timestamp, cast('N' as varchar(1)) 
as record_active_flag, cast('N' as varchar(1)) as record_deleted_flag, _right.insert_object_run_key, _left.object_run_key as 
update_object_run_key from `dev_staging`.`app_tblcustomer_chgd` as _left inner join `dev_raw`.`app_tblcustomer` as _right on 
_left.`flngcustomerkey` = _right.`flngcustomerkey` and _left.record_effective_timestamp = _right.record_effective_timestamp and 
_left.object_run_key = 9107 and _left.operation = 'U') by SASIOIMP;
32                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           12.31 seconds
      cpu time            0.11 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task5 = "Apply Changes", 
task5_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task6 = "Reconciliation", 
task6_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.29 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):   option nomprint nonotes
MPRINT(CHANGE_EXTRACT.RECONCILIATION.SELECT_COLS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc sql;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_source_v as select 'Source' as type length=6, measure length=6, count as 
source_count format=comma14. from connection to SASIOIMP (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_staging`.`app_tblcustomer_nr` union all select cast('update' as varchar(6)) as measure, count(distinct 
_left.`flngcustomerkey`) as count from `dev_staging`.`app_tblcustomer_nr` as _left inner join (select distinct `flngcustomerkey` 
from `dev_raw`.`app_tblcustomer`) as _right on _left.`flngcustomerkey` = _right.`flngcustomerkey`);
NOTE: SQL view WORK.COUNT_SOURCE_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   create view count_target_v as select 'Target' as type length=6, measure length=6, count as 
33                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

target_count format=comma14. from connection to sasioimp (select cast('insert' as varchar(6)) as measure, count(*) as count from 
`dev_raw`.`app_tblcustomer_new` as _left inner join (select distinct object_run_key from `dev_staging`.`app_tblcustomer_chgt`) as 
_right on _left.insert_object_run_key = _right.object_run_key union all select cast('update' as varchar) as measure, count(*) as 
count from `dev_raw`.`app_tblcustomer_new` as _left inner join (select distinct object_run_key from 
`dev_staging`.`app_tblcustomer_chgt`) as _right on _left.update_object_run_key = _right.object_run_key where update_object_run_key 
!= insert_object_run_key);
NOTE: SQL view WORK.COUNT_TARGET_V has been defined.
MPRINT(CHANGE_EXTRACT.RECONCILIATION.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):  ;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.05 seconds
      cpu time            0.03 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   data _null_;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   merge count_source_v(in=in_source) count_target_v(in=in_target);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   by measure;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   format source_count target_count comma14.;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   retain m1 -1 error 0;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   attrib status_msg length=$ 32767;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   if source_count ne target_count then do;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   status_msg = cat('ERROR: Mismatch on ', strip(measure), ': Source count ', 
strip(putn(source_count, 'comma14.')), '; Target count: ', strip(putn(target_count, 'comma14.')), '.');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   putlog status_msg;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call symputx('status_msg', strip(status_msg), 'g');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   call execute('%rcset(8);');
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   stop;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   end;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   else putlog 'Matched on ' measure +m1 ': rows ' source_count;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   run;

Matched on insert: rows 39,147
Matched on update: rows 39,147
NOTE: There were 2 observations read from the data set WORK.COUNT_SOURCE_V.
NOTE: There were 2 observations read from the data set WORK.COUNT_TARGET_V.
NOTE: DATA statement used (Total process time):
      real time           4.87 seconds
      cpu time            0.08 seconds
      

MPRINT(CHANGE_EXTRACT.RECONCILIATION):   proc datasets lib=work nolist nowarn mt=(data view);
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   delete count_source_v count_target_v;
MPRINT(CHANGE_EXTRACT.RECONCILIATION):   quit;

NOTE: Deleting WORK.COUNT_SOURCE_V (memtype=VIEW).
NOTE: Deleting WORK.COUNT_TARGET_V (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   proc sql;
MPRINT(CHANGE_EXTRACT):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT):   select count into :_nobs trimmed from connection to SASIOIMP (select count(*) as `count` from 
`dev_raw`.`app_tblcustomer_new` where `record_effective_timestamp` > `record_expiry_timestamp`);
34                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.27 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task6 = "Reconciliation", 
task6_end_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task7 = "Commit", 
task7_start_time = datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.28 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute (refresh `dev_raw`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`app_tblcustomer` rename to `dev_raw`.`app_tblcustomer_old`) 
by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(alter table `dev_raw`.`app_tblcustomer_new` rename to `dev_raw`.`app_tblcustomer`) 
by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(drop table `dev_raw`.`app_tblcustomer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(refresh `dev_raw`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   execute(compute stats `dev_raw`.`app_tblcustomer`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES.CHECK_STATUS):  ;
35                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):  ;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.COMMIT_CHANGES):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           18.88 seconds
      cpu time            0.16 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set records_read = 39147, object_key = 28, task7 = "Commit", task7_end_time 
= datetime() where object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.29 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   options nosyntaxcheck mprint notes;
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   connect to SASIOIMP(DBMAX_TEXT=32767 DATABASE=dev_raw DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.LOGGING):   select coalesce(max_timestamp, '1jan1800:0:0'dt) as max_timestamp format=datetime26.3 into 
:max_timestamp trimmed from connection to SASIOIMP (select max(fdtmwhen_info) as max_timestamp from `dev_raw`.`app_tblcustomer`);
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.26 seconds
      cpu time            0.04 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   run;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   quit;
MPRINT(CHANGE_EXTRACT.LOGGING.COUNT):   option nomprint nonotes
There are 78,294 observations in impraw.app_tblcustomer (dev_raw.app_tblcustomer) where update_object_run_key = 9107.
MPRINT(CHANGE_EXTRACT.LOGGING):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.LOGGING):   update lcf.OBJECT_RUN set end_time = datetime(), records_written = 78294, high_water_mark_value = 
"30OCT2019:13:32:24.677"dt, status = "Job Successful", status_message = "78,294 rows updated on app_tblcustomer" where 
object_run_key = 9107;
MPRINT(CHANGE_EXTRACT.LOGGING.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):  ;
MPRINT(CHANGE_EXTRACT.LOGGING):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.28 seconds
      cpu time            0.27 seconds
      

MPRINT(CHANGE_EXTRACT.LOGGING):   option NOSYNTAXCHECK MPRINT NOTES;
MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   proc sql noprint;
MPRINT(CHANGE_EXTRACT.TIDYUP):   connect to SASIOIMP(DATABASE=dev_staging DSN=ClouderaImpala64);
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer`) by SASIOIMP;
36                                                         The SAS System                     Wednesday, 30 October 2019 02:46:00 PM

MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_dt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_nr`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_chgt`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_staging`.`app_tblcustomer_chgd`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblcustomer_new`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   execute (drop table if exists `dev_raw`.`app_tblcustomer_old`) by SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP.CHECK_STATUS):  ;
MPRINT(CHANGE_EXTRACT.TIDYUP):   disconnect from SASIOIMP;
MPRINT(CHANGE_EXTRACT.TIDYUP):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.68 seconds
      cpu time            0.19 seconds
      

MPRINT(CHANGE_EXTRACT):  ;
MPRINT(CHANGE_EXTRACT):  ;
1016       
1017       %rcSet(&syserr);
1018       %rcSet(&sysrc);
1019       %rcSet(&sqlrc);
1020       
1021       
1022       
1023       /** Step end Change Extract **/
1024       
1025       %let etls_endTime = %sysfunc(datetime(),datetime.);
1026       
1027       
1028       
1029       
1030       %LET _CLIENTTASKLABEL=;
1031       %LET _CLIENTPROCESSFLOWNAME=;
1032       %LET _CLIENTPROJECTPATH=;
1033       %LET _CLIENTPROJECTPATHHOST=;
1034       %LET _CLIENTPROJECTNAME=;
1035       %LET _SASPROGRAMFILE=;
1036       %LET _SASPROGRAMFILEHOST=;
1037       
1038       ;*';*";*/;quit;run;
1039       ODS _ALL_ CLOSE;
1040       
1041       
1042       QUIT; RUN;
1043       
