CREATE TABLE dev_raw.ke1 (
  record_effective_timestamp TIMESTAMP NOT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  flngreturnkey INT NOT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  flngitemnumber INT NOT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  flngverlast INT NOT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,  
  flngver INT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  flngrelationshipkey INT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblninerror SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrirdnumber STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblninvalidird SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstremployeename STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrsurname STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrfirstname STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrtaxcode STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmstart TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmfinish TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmpayperiodstart TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmpayperiodend TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrpayfrequency STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnpayment SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrcscode STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurgross DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurearnings DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurpaye DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurchildsupport DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurstudentloan DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurkiwisaverdeductions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurkiwisavercontributions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurtaxcreditsdonations DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuresctdeductions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurtaxcreditsextinguish DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuremployercontributionsadj DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurfamilytaxcredits DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrgatewayreferenceid STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmdeleted TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmprocessed TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnduplicateirdtaxcode SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnoverridekiwisaverdedrule SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fstrwho STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmwhen TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  flngworkitemkey INT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnstoprtnforerror SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurhourspaid DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurslcirdeductions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurslbordeductions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuressdeductions DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuremployeekssdedrfn DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuremployerksscontrfn DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurpriorperiodgrossadj DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurpriorperiodpayeadj DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurksemployeecontrate DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurcompemployercont DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurvoluntaryemployercont DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurstudentloandedposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurslcirdedposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurslbordedposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurcecposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcurvecposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fcuressdedposting DECIMAL(19,4) NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fdtmreturnreversed TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnreversed SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  fblnproxyfieldsallowed SMALLINT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  record_expiry_timestamp TIMESTAMP NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  record_active_flag STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  record_deleted_flag STRING NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  insert_object_run_key INT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  update_object_run_key INT NULL ENCODING AUTO_ENCODING COMPRESSION DEFAULT_COMPRESSION,
  PRIMARY KEY (record_effective_timestamp,flngreturnkey, flngitemnumber, flngverlast )
)
PARTITION BY HASH PARTITIONS 6,
RANGE (record_effective_timestamp)
(
        PARTITION '1800-01-01 00:00:00'<=VALUES<'2018-01-01 00:00:00',
        PARTITION '2018-01-01 00:00:00'<=VALUES<'2019-01-01 00:00:00',
		PARTITION '2019-01-01 00:00:00'<=VALUES<'2020-01-01 00:00:00',
		PARTITION '2020-01-01 00:00:00'<=VALUES
)
STORED AS KUDU
;

insert /*+ noshuffle,noclustered */ into ke1 
select 
record_effective_timestamp,
flngreturnkey,
flngitemnumber,
flngverlast,
flngver,
flngrelationshipkey,
fblninerror,
fstrirdnumber,
fblninvalidird,
fstremployeename,
fstrsurname,
fstrfirstname,
fstrtaxcode,
fdtmstart,
fdtmfinish,
fdtmpayperiodstart,
fdtmpayperiodend,
fstrpayfrequency,
fblnpayment,
fstrcscode,
fcurgross,
fcurearnings,
fcurpaye,
fcurchildsupport,
fcurstudentloan,
fcurkiwisaverdeductions,
fcurkiwisavercontributions,
fcurtaxcreditsdonations,
fcuresctdeductions,
fcurtaxcreditsextinguish,
fcuremployercontributionsadj,
fcurfamilytaxcredits,
fstrgatewayreferenceid,
fdtmdeleted,
fdtmprocessed,
fblnduplicateirdtaxcode,
fblnoverridekiwisaverdedrule,
fstrwho,
fdtmwhen,
flngworkitemkey,
fblnstoprtnforerror,
fcurhourspaid,
fcurslcirdeductions,
fcurslbordeductions,
fcuressdeductions,
fcuremployeekssdedrfn,
fcuremployerksscontrfn,
fcurpriorperiodgrossadj,
fcurpriorperiodpayeadj,
fcurksemployeecontrate,
fcurcompemployercont,
fcurvoluntaryemployercont,
fcurstudentloandedposting,
fcurslcirdedposting,
fcurslbordedposting,
fcurcecposting,
fcurvecposting,
fcuressdedposting,
fdtmreturnreversed,
fblnreversed,
fblnproxyfieldsallowed,
record_expiry_timestamp,
record_active_flag,
record_deleted_flag,
insert_object_run_key,
update_object_run_key
from app_tblnz_rtnpsoemployeeinfo;

