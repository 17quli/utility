{
  "queries" : [ {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "0",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "session_id" : "4841d6b1ebcaca2b:6ddf365a0a5e19a1",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "5223",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40456",
      "session_type" : "BEESWAX"
    },
    "user" : "ird0dxi@VSP.SAS.COM",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 3375526,
    "queryId" : "0443564afae47535:4379257100000000",
    "statement" : "drop table if exists test_staging.md_test_multi_dip_account_id_for_exclusion",
    "queryType" : "DDL",
    "queryState" : "RUNNING",
    "startTime" : "2020-11-24T07:03:47.128Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_cpu_time_percentage" : "8",
      "thread_network_receive_wait_time" : "3487760",
      "thread_cpu_time" : "612628",
      "hdfs_average_scan_range" : "3.982489263800905E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read" : "17602602546",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "3.306795978320493E7",
      "thread_network_receive_wait_time_percentage" : "44",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "89",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "6158953615",
      "client_fetch_wait_time" : "0",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "session_id" : "ad4c061661940dfb:9d737150802ab589",
      "stats_corrupt" : "false",
      "thread_total_time" : "7914614",
      "thread_network_send_wait_time_percentage" : "45",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:60400",
      "thread_storage_wait_time_percentage" : "3",
      "thread_network_send_wait_time" : "3599315",
      "num_fragments" : "108",
      "thread_storage_wait_time" : "214909"
    },
    "user" : "ird0txh@VSP.SAS.COM",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 288565,
    "queryId" : "534663583d719684:fa8bb18900000000",
    "statement" : "CREATE TABLE tmp_income1 STORED AS PARQUET AS select straight_join e.fstrirdnumber, c.flngcustomerkey, count(distinct a.flngcustomerkey) as income_employer_count, max(case when a.flngcustomerkey=1980390400 then 'Y' else 'N' end) as income_benefit_flag, max(case when a.flngcustomerkey=18102272 then 'Y' else 'N' end) as income_super_flag from prod_raw_restricted_access.app_tblnz_rtnpsoemployeeinfo as e inner join prod_raw_restricted_access.app_tblcustomerinfo as c on c.fstrid = e.fstrirdnumber inner join prod_raw_restricted_access.app_tblreturn as r on e.flngreturnkey = r.flngreturnkey inner join prod_raw_restricted_access.app_tblaccount as a on r.flngaccountkey = a.flngaccountkey where e.flngver=0 and e.record_active_flag = 'Y' and e.fblninvalidird = 0 and e.fcurgross > 0 and r.flngver=0 and r.record_active_flag = 'Y' and a.record_active_flag = 'Y' and a.flngver=0 and r.fdtmfilingperiod between '2018-04-01' and '2019-03-31' and c.record_active_flag = 'Y' and c.fstridtype = 'IRD' group by e.fstrirdnumber, c.flngcustomerkey",
    "queryType" : "DDL",
    "queryState" : "RUNNING",
    "startTime" : "2020-11-24T07:55:13.806Z"
  }, {
    "rowsProduced" : 7446528,
    "attributes" : {
      "thread_cpu_time_percentage" : "1",
      "thread_network_receive_wait_time" : "134156",
      "thread_cpu_time" : "129240",
      "hdfs_average_scan_range" : "1.4997606155844156E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "1610719522",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "2382210965",
      "query_status" : "Session closed",
      "hdfs_scanner_average_bytes_read_per_second" : "5.438821020134798E8",
      "thread_network_receive_wait_time_percentage" : "1",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "8",
      "memory_aggregate_peak" : "2.4410412208E10",
      "client_fetch_wait_time_percentage" : "95",
      "memory_per_node_peak_node" : "ird10146au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "hdfs_bytes_read_remote" : "771491443",
      "estimated_per_node_peak_memory" : "3432856477",
      "hdfs_bytes_read_local_percentage" : "68",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "2646444",
      "file_formats" : "PARQUET/NONE,PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0dxi@VSP.SAS.COM",
      "session_id" : "ee4100872ea1b394:c6ac9afbf2856b95",
      "hdfs_bytes_read_remote_percentage" : "32",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "68",
      "memory_accrual" : "6.5368638143104E13",
      "thread_total_time" : "17014332",
      "thread_network_send_wait_time_percentage" : "98",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:46410",
      "thread_storage_wait_time_percentage" : "0",
      "hdfs_bytes_read_local" : "1610719522",
      "memory_per_node_peak" : "4.14464344064E9",
      "thread_network_send_wait_time" : "16749024",
      "num_fragments" : "43",
      "thread_storage_wait_time" : "1911"
    },
    "user" : "ird0dxi",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 2796130,
    "queryId" : "8a454060a033daf0:cec3534100000000",
    "statement" : "select * from dev_refined.vw_crw_rs_p2a",
    "queryType" : "QUERY",
    "queryState" : "EXCEPTION",
    "startTime" : "2020-11-24T07:11:52.159Z",
    "endTime" : "2020-11-24T07:58:28.289Z"
  }, {
    "rowsProduced" : 3,
    "attributes" : {
      "thread_cpu_time_percentage" : "21",
      "thread_network_receive_wait_time" : "365071",
      "thread_cpu_time" : "153221",
      "hdfs_average_scan_range" : "1.3900075823333332E8",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "4170022747",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "4170022747",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "2.1924331276850078E8",
      "thread_network_receive_wait_time_percentage" : "51",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "6",
      "memory_aggregate_peak" : "2.43739394048E9",
      "client_fetch_wait_time_percentage" : "1",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "2864746548",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "432",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0dxi@VSP.SAS.COM",
      "session_id" : "ab480dced6047212:9a3cbd363d4d42a5",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "7287360.0",
      "thread_total_time" : "720252",
      "thread_network_send_wait_time_percentage" : "27",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:36046",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "4170022747",
      "memory_per_node_peak" : "2.43739394048E9",
      "thread_network_send_wait_time" : "198044",
      "num_fragments" : "25",
      "thread_storage_wait_time" : "3915"
    },
    "user" : "ird0dxi",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 33654,
    "queryId" : "244dc67948708293:e248d5ca00000000",
    "statement" : "select chk, count(*) cnt\nfrom (\nselect\n    case when act.fdtmcommence = expd.derived_fdtmcommence\n            and act.fdtmcease = expd.derived_fdtmcease then 'crw_rs_tblnz_EmpEmp dates are reconciled as expected - OK'\n        when act.fdtmcommence <> expd.derived_fdtmcommence\n            or act.fdtmcease <> expd.derived_fdtmcease then 'crw_rs_tblnz_EmpEmp dates are not reconciled as expected - CHECK!!'\n         else '???' end chk,\n    act.*, expd.derived_FromCustomerKey expd_drvdfromcustkey, expd.derived_FromAccountkey expd_drvdfromacctkey, expd.derived_ToCustomerKey expd_drvdtocustkey, expd.derived_ToAccountKey expd_drvdtoacctkey,\n    expd.relationship_type expd_reltype, expd.derived_fdtmcommence expd_commence, expd.derived_fdtmcease expd_cease\nfrom\n    (\n    select *\n    from dev_refined.crw_rs_EmpEmp\n    ) act\nfull outer join (\n    select *\n    from test_staging.md_refined_exp_crw_rs_tblnz_EmpEmp\n\n    ) expd\non act.derived_From_Customer_Key = expd.derived_FromCustomerKey\nand act.derived_From_Account_key = expd.derived_FromAccountkey\nand act.derived_To_Customer_Key = expd.derived_ToCustomerKey\nand act.derived_To_Account_Key = expd.derived_ToAccountKey\nand act.derived_relationship_type = expd.relationship_type\nand act.record_effective_timestamp = expd.timeline_start_final\n) zz\n\ngroup by chk",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:57:47.536Z",
    "endTime" : "2020-11-24T07:58:21.190Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "22",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0dxi@VSP.SAS.COM",
      "session_id" : "ab480dced6047212:9a3cbd363d4d42a5",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "3",
      "client_fetch_wait_time_percentage" : "1",
      "network_address" : "::ffff:10.239.248.79:36046",
      "session_type" : "BEESWAX"
    },
    "user" : "ird0dxi",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 3335,
    "queryId" : "70495706e6d45a09:45d914b100000000",
    "statement" : "compute stats test_staging.md_refined_exp_crw_rs_tblnz_EmpEmp",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:57:44.192Z",
    "endTime" : "2020-11-24T07:57:47.527Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "84",
      "thread_network_receive_wait_time" : "3041",
      "thread_cpu_time" : "17394",
      "hdfs_average_scan_range" : "2.486982455E8",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "2984378946",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "2984378946",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "8.338554238609687E8",
      "thread_network_receive_wait_time_percentage" : "15",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "8",
      "memory_aggregate_peak" : "1.186821329E9",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10143au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "421543936",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0dxi@VSP.SAS.COM",
      "session_id" : "ab480dced6047212:9a3cbd363d4d42a5",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.275623189E9",
      "thread_total_time" : "20626",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:36046",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "2984378946",
      "memory_per_node_peak" : "3.9202062336E8",
      "thread_network_send_wait_time" : "10",
      "num_fragments" : "9",
      "thread_storage_wait_time" : "181"
    },
    "user" : "ird0dxi",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 3077,
    "queryId" : "2241a53e0c734ebc:0202fb6000000000",
    "statement" : "SELECT NDV(derived_fromcustomerkey) AS derived_fromcustomerkey, COUNT(CASE WHEN derived_fromcustomerkey IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(derived_fromaccountkey) AS derived_fromaccountkey, COUNT(CASE WHEN derived_fromaccountkey IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(derived_tocustomerkey) AS derived_tocustomerkey, COUNT(CASE WHEN derived_tocustomerkey IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(derived_toaccountkey) AS derived_toaccountkey, COUNT(CASE WHEN derived_toaccountkey IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(relationship_type) AS relationship_type, COUNT(CASE WHEN relationship_type IS NULL THEN 1 ELSE NULL END), MAX(length(relationship_type)), AVG(length(relationship_type)), NDV(derived_fdtmcommence) AS derived_fdtmcommence, COUNT(CASE WHEN derived_fdtmcommence IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(derived_fdtmcease) AS derived_fdtmcease, COUNT(CASE WHEN derived_fdtmcease IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(timeline_start_final) AS timeline_start_final, COUNT(CASE WHEN timeline_start_final IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(timeline_end_final) AS timeline_end_final, COUNT(CASE WHEN timeline_end_final IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE) FROM test_staging.md_refined_exp_crw_rs_tblnz_EmpEmp",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:57:44.305Z",
    "endTime" : "2020-11-24T07:57:47.382Z"
  }, {
    "rowsProduced" : 96710071,
    "attributes" : {
      "thread_cpu_time_percentage" : "29",
      "thread_network_receive_wait_time" : "16735432",
      "thread_cpu_time" : "7003130",
      "hdfs_average_scan_range" : "1.194054658974359E8",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "9313626340",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "9313626340",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "8.95500681216E9",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "234",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.69074382912E11",
      "thread_network_send_wait_time_percentage" : "2",
      "network_address" : "::ffff:10.239.248.79:36046",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "8.95500681216E9",
      "thread_storage_wait_time" : "492",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "6.989568265095456E8",
      "thread_network_receive_wait_time_percentage" : "69",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0dxi@VSP.SAS.COM",
      "planning_wait_time" : "63",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "BEESWAX",
      "estimated_per_node_peak_memory" : "1076186770",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "96710071",
      "hdfs_bytes_written" : "2983179366",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0dxi@VSP.SAS.COM",
      "session_id" : "ab480dced6047212:9a3cbd363d4d42a5",
      "stats_corrupt" : "false",
      "thread_total_time" : "24313686",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "9313626340",
      "thread_network_send_wait_time" : "574630",
      "num_fragments" : "30"
    },
    "user" : "ird0dxi",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "default",
    "durationMillis" : 1230824,
    "queryId" : "b148cace2dd24ed2:210457c000000000",
    "statement" : "create table test_staging.md_refined_exp_crw_rs_tblnz_EmpEmp stored as parquet as\nselect distinct derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type, derived_fdtmcommence, derived_fdtmcease,\n     min_eff_ts timeline_start_final, max_exp_ts timeline_end_final\nfrom (\n    select derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type, derived_fdtmcommence, derived_fdtmcease,\n        min(timeline_start) over (partition by derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type, hash_w_sk) min_eff_ts,\n        max(timeline_end) over (partition by derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type, hash_w_sk) max_exp_ts\n    from (\n        select v.*, fnv_hash(cast(new_sk as varchar)) hash_w_sk\n        from (\n            select cast(b.derived_FromCustomerKey as int) * 100 + sum(chk_diff) over (partition by derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type order by timeline_start) new_sk, b.*\n            from (\n                select a.*,\n                    case when coalesce(prev_hash, hash_val) = hash_val\n                         or hash_val = 4777139631683889413 --NULL is lumped together with previous row\n                         then 0 else 1 end chk_diff,\n                    case when coalesce(prev_hash, hash_val) = hash_val\n                         or hash_val = 4777139631683889413 --NULL is lumped together with previous row\n                         then 'SAME AS PREV' else 'DIFF THAN PREV' end diff\n                from (\n                    select ddd.*,\n                        lag(hash_val,1) over (partition by derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type order by timeline_start) prev_hash\n                    from (\n                        select tiebreaker, derived_FromCustomerKey, derived_FromAccountkey, derived_ToCustomerKey, derived_ToAccountKey, relationship_type,\n                            derived_fdtmcommence, derived_fdtmcease, --just so gap can be identified\n                            timeline_start, timeline_end,\n                            concat(nvl(cast(derived_fdtmcommence as varchar), '???'), '#', nvl(cast(derived_fdtmcease as varchar), '???'), '#') concat_val,\n                            fnv_hash(concat(nvl(cast(derived_fdtmcommence as varchar), '???'), '#', nvl(cast(derived_fdtmcease as varchar), '???'), '#')) hash_val\n                        from test_staging.md_test_app_tblNZ_EmployerEmployees_derived_one_timeline_tiebreaker\n                        where tiebreaker = 1\n\n                    ) ddd\n                ) a\n            ) b\n        ) v\n    ) vv\n) zz\nwhere derived_fdtmcommence is not NULL and derived_fdtmcease is not NULL",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:37:13.006Z",
    "endTime" : "2020-11-24T07:57:43.830Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "63",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "11",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "1b43a3859b7702eb:984f889c8cfb48bb",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:33786",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "prod_staging",
    "durationMillis" : 2945,
    "queryId" : "794347eb6cb70fce:01956c6b00000000",
    "statement" : "create table prod_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from prod_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:56:01.256Z",
    "endTime" : "2020-11-24T07:56:04.201Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "71",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "8",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "7947938624b37186:c960e2c367f665ae",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:48640",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "test_staging",
    "durationMillis" : 2889,
    "queryId" : "4d43200a85f61e5d:4c8df86600000000",
    "statement" : "create table test_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from test_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:55:44.312Z",
    "endTime" : "2020-11-24T07:55:47.201Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "ad4c061661940dfb:9d737150802ab589",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60400",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7045,
    "queryId" : "0448a92bc9afb090:59cf603e00000000",
    "statement" : "drop table if exists tmp_income1",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:55:06.736Z",
    "endTime" : "2020-11-24T07:55:13.781Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "e24a2819e33231a7:59011c182389deb9",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:43578",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "537a39f4-3f2e-447b-b789-a04401c1452e"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5978,
    "queryId" : "8e4cba471f966464:a9d8aac900000000",
    "statement" : "invalidate metadata shindig_customer",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:55:00.623Z",
    "endTime" : "2020-11-24T07:55:06.601Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "13",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "e24a2819e33231a7:59011c182389deb9",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:43578",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "537a39f4-3f2e-447b-b789-a04401c1452e"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 9977,
    "queryId" : "2f42014d5dd20f7f:fccc4d0100000000",
    "statement" : "compute stats shindig_customer",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:50.622Z",
    "endTime" : "2020-11-24T07:55:00.599Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "85",
      "thread_network_receive_wait_time" : "3399",
      "thread_cpu_time" : "19811",
      "hdfs_average_scan_range" : "9.297769683333333E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "557866181",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "557866181",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "6.184746385292153E8",
      "thread_network_receive_wait_time_percentage" : "15",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "1",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "35",
      "memory_aggregate_peak" : "8.63285148E8",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "455115720",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "e24a2819e33231a7:59011c182389deb9",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.878242419E9",
      "thread_total_time" : "23316",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:43578",
      "thread_storage_wait_time_percentage" : "0",
      "hdfs_bytes_read_local" : "557866181",
      "memory_per_node_peak" : "1.4447280128E8",
      "thread_network_send_wait_time" : "8",
      "num_fragments" : "7",
      "thread_storage_wait_time" : "98"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "537a39f4-3f2e-447b-b789-a04401c1452e"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 3469,
    "queryId" : "d942b3fac0614ea1:76674c9d00000000",
    "statement" : "SELECT NDV(customer_key) AS customer_key, COUNT(CASE WHEN customer_key IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number) AS ird_number, COUNT(CASE WHEN ird_number IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number_formatted) AS ird_number_formatted, COUNT(CASE WHEN ird_number_formatted IS NULL THEN 1 ELSE NULL END), MAX(length(ird_number_formatted)), AVG(length(ird_number_formatted)), NDV(customer_level) AS customer_level, COUNT(CASE WHEN customer_level IS NULL THEN 1 ELSE NULL END), MAX(length(customer_level)), AVG(length(customer_level)), NDV(customer_segment) AS customer_segment, COUNT(CASE WHEN customer_segment IS NULL THEN 1 ELSE NULL END), MAX(length(customer_segment)), AVG(length(customer_segment)), NDV(dob_commence_date) AS dob_commence_date, COUNT(CASE WHEN dob_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(customer_type) AS customer_type, COUNT(CASE WHEN customer_type IS NULL THEN 1 ELSE NULL END), MAX(length(customer_type)), AVG(length(customer_type)), NDV(customer_class) AS customer_class, COUNT(CASE WHEN customer_class IS NULL THEN 1 ELSE NULL END), MAX(length(customer_class)), AVG(length(customer_class)), NDV(customer_subtype) AS customer_subtype, COUNT(CASE WHEN customer_subtype IS NULL THEN 1 ELSE NULL END), MAX(length(customer_subtype)), AVG(length(customer_subtype)), NDV(geo_city) AS geo_city, COUNT(CASE WHEN geo_city IS NULL THEN 1 ELSE NULL END), MAX(length(geo_city)), AVG(length(geo_city)), NDV(geo_meshblock) AS geo_meshblock, COUNT(CASE WHEN geo_meshblock IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock)), AVG(length(geo_meshblock)), NDV(geo_post_code) AS geo_post_code, COUNT(CASE WHEN geo_post_code IS NULL THEN 1 ELSE NULL END), MAX(length(geo_post_code)), AVG(length(geo_post_code)), NDV(geo_country) AS geo_country, COUNT(CASE WHEN geo_country IS NULL THEN 1 ELSE NULL END), MAX(length(geo_country)), AVG(length(geo_country)), NDV(sl_indicator) AS sl_indicator, COUNT(CASE WHEN sl_indicator IS NULL THEN 1 ELSE NULL END), 1, CAST(1 as DOUBLE), NDV(sl_nzb_obb_indicator) AS sl_nzb_obb_indicator, COUNT(CASE WHEN sl_nzb_obb_indicator IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nzb_obb_indicator)), AVG(length(sl_nzb_obb_indicator)), NDV(sl_total_loan_balance) AS sl_total_loan_balance, COUNT(CASE WHEN sl_total_loan_balance IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_start_date) AS sl_nrb_start_date, COUNT(CASE WHEN sl_nrb_start_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_duration) AS sl_nrb_duration, COUNT(CASE WHEN sl_nrb_duration IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nrb_duration)), AVG(length(sl_nrb_duration)), NDV(sl_obb_category) AS sl_obb_category, COUNT(CASE WHEN sl_obb_category IS NULL THEN 1 ELSE NULL END), MAX(length(sl_obb_category)), AVG(length(sl_obb_category)), NDV(sl_debt_amount) AS sl_debt_amount, COUNT(CASE WHEN sl_debt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_periods_in_debt) AS sl_periods_in_debt, COUNT(CASE WHEN sl_periods_in_debt IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(myir_first_login) AS myir_first_login, COUNT(CASE WHEN myir_first_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_last_login) AS myir_last_login, COUNT(CASE WHEN myir_last_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_num_logins) AS myir_num_logins, COUNT(CASE WHEN myir_num_logins IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(myir_account_opened) AS myir_account_opened, COUNT(CASE WHEN myir_account_opened IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_account_closed) AS myir_account_closed, COUNT(CASE WHEN myir_account_closed IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_current_status) AS myir_current_status, COUNT(CASE WHEN myir_current_status IS NULL THEN 1 ELSE NULL END), MAX(length(myir_current_status)), AVG(length(myir_current_status)), NDV(pmt_earliest_payment_date) AS pmt_earliest_payment_date, COUNT(CASE WHEN pmt_earliest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_date) AS pmt_latest_payment_date, COUNT(CASE WHEN pmt_latest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_cheque_date) AS pmt_latest_cheque_date, COUNT(CASE WHEN pmt_latest_cheque_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_method) AS pmt_latest_payment_method, COUNT(CASE WHEN pmt_latest_payment_method IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_latest_payment_method)), AVG(length(pmt_latest_payment_method)), NDV(pmt_other_channels) AS pmt_other_channels, COUNT(CASE WHEN pmt_other_channels IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_other_channels)), AVG(length(pmt_other_channels)), NDV(pmt_count) AS pmt_count, COUNT(CASE WHEN pmt_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_cheque_count) AS pmt_cheque_count, COUNT(CASE WHEN pmt_cheque_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_amount) AS pmt_amount, COUNT(CASE WHEN pmt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_cheque_amount) AS pmt_cheque_amount, COUNT(CASE WHEN pmt_cheque_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_linked_flag) AS agent_linked_flag, COUNT(CASE WHEN agent_linked_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_linked_flag)), AVG(length(agent_linked_flag)), NDV(is_agent) AS is_agent, COUNT(CASE WHEN is_agent IS NULL THEN 1 ELSE NULL END), MAX(length(is_agent)), AVG(length(is_agent)), NDV(bank_inc_flag) AS bank_inc_flag, COUNT(CASE WHEN bank_inc_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_inc_flag)), AVG(length(bank_inc_flag)), NDV(bank_inc_update_channel) AS bank_inc_update_channel, COUNT(CASE WHEN bank_inc_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_inc_update_channel)), AVG(length(bank_inc_update_channel)), NDV(bank_inc_commence_date) AS bank_inc_commence_date, COUNT(CASE WHEN bank_inc_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_inc) AS agent_disburse_inc, COUNT(CASE WHEN agent_disburse_inc IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_inc)), AVG(length(agent_disburse_inc)), NDV(agent_inc_mail_flag) AS agent_inc_mail_flag, COUNT(CASE WHEN agent_inc_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_inc_mail_flag)), AVG(length(agent_inc_mail_flag)), NDV(bank_reb_flag) AS bank_reb_flag, COUNT(CASE WHEN bank_reb_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_reb_flag)), AVG(length(bank_reb_flag)), NDV(bank_reb_update_channel) AS bank_reb_update_channel, COUNT(CASE WHEN bank_reb_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_reb_update_channel)), AVG(length(bank_reb_update_channel)), NDV(bank_reb_commence_date) AS bank_reb_commence_date, COUNT(CASE WHEN bank_reb_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_reb) AS agent_disburse_reb, COUNT(CASE WHEN agent_disburse_reb IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_reb)), AVG(length(agent_disburse_reb)), NDV(agent_reb_mail_flag) AS agent_reb_mail_flag, COUNT(CASE WHEN agent_reb_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_reb_mail_flag)), AVG(length(agent_reb_mail_flag)), NDV(bank_fam_flag) AS bank_fam_flag, COUNT(CASE WHEN bank_fam_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_fam_flag)), AVG(length(bank_fam_flag)), NDV(bank_fam_update_channel) AS bank_fam_update_channel, COUNT(CASE WHEN bank_fam_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_fam_update_channel)), AVG(length(bank_fam_update_channel)), NDV(bank_fam_commence_date) AS bank_fam_commence_date, COUNT(CASE WHEN bank_fam_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_fam) AS agent_disburse_fam, COUNT(CASE WHEN agent_disburse_fam IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_fam)), AVG(length(agent_disburse_fam)), NDV(agent_fam_mail_flag) AS agent_fam_mail_flag, COUNT(CASE WHEN agent_fam_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_fam_mail_flag)), AVG(length(agent_fam_mail_flag)), NDV(geo_meshblock_db) AS geo_meshblock_db, COUNT(CASE WHEN geo_meshblock_db IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_latitude) AS geo_latitude, COUNT(CASE WHEN geo_latitude IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_longitude) AS geo_longitude, COUNT(CASE WHEN geo_longitude IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_internet) AS geo_meshblock_internet, COUNT(CASE WHEN geo_meshblock_internet IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_phone) AS geo_meshblock_phone, COUNT(CASE WHEN geo_meshblock_phone IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_mobile) AS geo_meshblock_mobile, COUNT(CASE WHEN geo_meshblock_mobile IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_telecomms) AS geo_meshblock_telecomms, COUNT(CASE WHEN geo_meshblock_telecomms IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_households) AS geo_meshblock_households, COUNT(CASE WHEN geo_meshblock_households IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(geo_meshblock_tele_group) AS geo_meshblock_tele_group, COUNT(CASE WHEN geo_meshblock_tele_group IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock_tele_group)), AVG(length(geo_meshblock_tele_group)), NDV(geo_meshblock_internet_group) AS geo_meshblock_internet_group, COUNT(CASE WHEN geo_meshblock_internet_group IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock_internet_group)), AVG(length(geo_meshblock_internet_group)) FROM shindig_customer",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:50.684Z",
    "endTime" : "2020-11-24T07:54:54.153Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "100",
      "thread_network_receive_wait_time" : "5",
      "thread_cpu_time" : "47877",
      "hdfs_average_scan_range" : "6.657305925E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "532584474",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "532584474",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "1.60747392E9",
      "memory_per_node_peak_node" : "ird10146au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "7",
      "file_formats" : "PARQUET/NONE,PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "8.911914845E9",
      "thread_network_send_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:43578",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "2.8302114816E8",
      "thread_storage_wait_time" : "115",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "5.970654612507524E8",
      "thread_network_receive_wait_time_percentage" : "0",
      "planning_wait_time_percentage" : "23",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "4032",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "4202299392",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "557341085",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "e24a2819e33231a7:59011c182389deb9",
      "stats_corrupt" : "false",
      "thread_total_time" : "48097",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "532584474",
      "thread_network_send_wait_time" : "100",
      "num_fragments" : "8"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "537a39f4-3f2e-447b-b789-a04401c1452e"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 17239,
    "queryId" : "0a4f55646cd115ae:d07ac25300000000",
    "statement" : "CREATE TABLE shindig_customer STORED AS PARQUET AS select a.*, b.latitude as geo_latitude, b.longitude as geo_longitude, cast(c.internet_access as double) as geo_meshblock_internet, cast(c.telephone_access as double) as geo_meshblock_phone, cast(c.mobile_access as double) as geo_meshblock_mobile, cast(c.telecommunications_access as double) as geo_meshblock_telecomms, cast(c.total_households as double) as geo_meshblock_households, case when c.no_access_to_telecommunications is null then 'Meshblock too small' when no_access_to_telecommunications = 0 then 'Everone has access' when no_access_to_telecommunications > 0 and no_access_to_telecommunications / total_households between 0 and 0.25 then '>75 percent access' when no_access_to_telecommunications > 0 and no_access_to_telecommunications / total_households between 0.25 and 0.5 then '50-75 percent access' when no_access_to_telecommunications > 0 and no_access_to_telecommunications / total_households between 0.5 and 0.75 then '25-50 percent access' when no_access_to_telecommunications > 0 and no_access_to_telecommunications / total_households > 0.75 then '<25 percent access' end as geo_meshblock_tele_group, case when internet_access is null then 'Meshblock too small' when internet_access = 0 then 'Noone has access' when internet_access > 0 and internet_access / total_households between 0 and 0.25 then '<25 percent access' when internet_access > 0 and internet_access / total_households between 0.25 and 0.5 then '25-50 percent access' when internet_access > 0 and internet_access / total_households between 0.5 and 0.75 then '50-75 percent access' when internet_access > 0 and internet_access / total_households between 0.75 and 0.99 then '75+ percent access' when internet_access > 0 and internet_access / total_households >= 1 then '100 percent access' end as geo_meshblock_internet_group from tmp_shindig_customer_pt2 a left join meshblock_2019 b ON (case when a.geo_meshblock_db = 0 then null else a.geo_meshblock_db end) = b.MB2018_V1_00 left join meshblock_data c ON b.MB2018_V1_00 = c.meshblock",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:26.562Z",
    "endTime" : "2020-11-24T07:54:43.801Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "e24a2819e33231a7:59011c182389deb9",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:43578",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "537a39f4-3f2e-447b-b789-a04401c1452e"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 6412,
    "queryId" : "a74b76e5a9873e43:14608d5500000000",
    "statement" : "drop table if exists shindig_customer purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:20.124Z",
    "endTime" : "2020-11-24T07:54:26.536Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "2c4eea524d8713cf:ac4890d2fffe73ac",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:33518",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5987,
    "queryId" : "b64ca394491e31dc:0d82b30600000000",
    "statement" : "invalidate metadata tmp_shindig_customer_pt2",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:13.925Z",
    "endTime" : "2020-11-24T07:54:19.912Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "2c4eea524d8713cf:ac4890d2fffe73ac",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:33518",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 9823,
    "queryId" : "1b4459653d6e41a3:8854beb100000000",
    "statement" : "compute stats tmp_shindig_customer_pt2",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:04.079Z",
    "endTime" : "2020-11-24T07:54:13.902Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "85",
      "thread_network_receive_wait_time" : "3117",
      "thread_cpu_time" : "17938",
      "hdfs_average_scan_range" : "8.842149766666667E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "530528986",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "530528986",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "6.784233216984912E8",
      "thread_network_receive_wait_time_percentage" : "15",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "50",
      "memory_aggregate_peak" : "8.19350225E8",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "421557228",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "2c4eea524d8713cf:ac4890d2fffe73ac",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.577834663E9",
      "thread_total_time" : "21159",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:33518",
      "thread_storage_wait_time_percentage" : "0",
      "hdfs_bytes_read_local" : "530528986",
      "memory_per_node_peak" : "1.3712228352E8",
      "thread_network_send_wait_time" : "6",
      "num_fragments" : "7",
      "thread_storage_wait_time" : "98"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 3203,
    "queryId" : "734bfb256c764040:b7fa636e00000000",
    "statement" : "SELECT NDV(customer_key) AS customer_key, COUNT(CASE WHEN customer_key IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number) AS ird_number, COUNT(CASE WHEN ird_number IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number_formatted) AS ird_number_formatted, COUNT(CASE WHEN ird_number_formatted IS NULL THEN 1 ELSE NULL END), MAX(length(ird_number_formatted)), AVG(length(ird_number_formatted)), NDV(customer_level) AS customer_level, COUNT(CASE WHEN customer_level IS NULL THEN 1 ELSE NULL END), MAX(length(customer_level)), AVG(length(customer_level)), NDV(customer_segment) AS customer_segment, COUNT(CASE WHEN customer_segment IS NULL THEN 1 ELSE NULL END), MAX(length(customer_segment)), AVG(length(customer_segment)), NDV(dob_commence_date) AS dob_commence_date, COUNT(CASE WHEN dob_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(customer_type) AS customer_type, COUNT(CASE WHEN customer_type IS NULL THEN 1 ELSE NULL END), MAX(length(customer_type)), AVG(length(customer_type)), NDV(customer_class) AS customer_class, COUNT(CASE WHEN customer_class IS NULL THEN 1 ELSE NULL END), MAX(length(customer_class)), AVG(length(customer_class)), NDV(customer_subtype) AS customer_subtype, COUNT(CASE WHEN customer_subtype IS NULL THEN 1 ELSE NULL END), MAX(length(customer_subtype)), AVG(length(customer_subtype)), NDV(geo_city) AS geo_city, COUNT(CASE WHEN geo_city IS NULL THEN 1 ELSE NULL END), MAX(length(geo_city)), AVG(length(geo_city)), NDV(geo_meshblock) AS geo_meshblock, COUNT(CASE WHEN geo_meshblock IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock)), AVG(length(geo_meshblock)), NDV(geo_post_code) AS geo_post_code, COUNT(CASE WHEN geo_post_code IS NULL THEN 1 ELSE NULL END), MAX(length(geo_post_code)), AVG(length(geo_post_code)), NDV(geo_country) AS geo_country, COUNT(CASE WHEN geo_country IS NULL THEN 1 ELSE NULL END), MAX(length(geo_country)), AVG(length(geo_country)), NDV(sl_indicator) AS sl_indicator, COUNT(CASE WHEN sl_indicator IS NULL THEN 1 ELSE NULL END), 1, CAST(1 as DOUBLE), NDV(sl_nzb_obb_indicator) AS sl_nzb_obb_indicator, COUNT(CASE WHEN sl_nzb_obb_indicator IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nzb_obb_indicator)), AVG(length(sl_nzb_obb_indicator)), NDV(sl_total_loan_balance) AS sl_total_loan_balance, COUNT(CASE WHEN sl_total_loan_balance IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_start_date) AS sl_nrb_start_date, COUNT(CASE WHEN sl_nrb_start_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_duration) AS sl_nrb_duration, COUNT(CASE WHEN sl_nrb_duration IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nrb_duration)), AVG(length(sl_nrb_duration)), NDV(sl_obb_category) AS sl_obb_category, COUNT(CASE WHEN sl_obb_category IS NULL THEN 1 ELSE NULL END), MAX(length(sl_obb_category)), AVG(length(sl_obb_category)), NDV(sl_debt_amount) AS sl_debt_amount, COUNT(CASE WHEN sl_debt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_periods_in_debt) AS sl_periods_in_debt, COUNT(CASE WHEN sl_periods_in_debt IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(myir_first_login) AS myir_first_login, COUNT(CASE WHEN myir_first_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_last_login) AS myir_last_login, COUNT(CASE WHEN myir_last_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_num_logins) AS myir_num_logins, COUNT(CASE WHEN myir_num_logins IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(myir_account_opened) AS myir_account_opened, COUNT(CASE WHEN myir_account_opened IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_account_closed) AS myir_account_closed, COUNT(CASE WHEN myir_account_closed IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_current_status) AS myir_current_status, COUNT(CASE WHEN myir_current_status IS NULL THEN 1 ELSE NULL END), MAX(length(myir_current_status)), AVG(length(myir_current_status)), NDV(pmt_earliest_payment_date) AS pmt_earliest_payment_date, COUNT(CASE WHEN pmt_earliest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_date) AS pmt_latest_payment_date, COUNT(CASE WHEN pmt_latest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_cheque_date) AS pmt_latest_cheque_date, COUNT(CASE WHEN pmt_latest_cheque_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_method) AS pmt_latest_payment_method, COUNT(CASE WHEN pmt_latest_payment_method IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_latest_payment_method)), AVG(length(pmt_latest_payment_method)), NDV(pmt_other_channels) AS pmt_other_channels, COUNT(CASE WHEN pmt_other_channels IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_other_channels)), AVG(length(pmt_other_channels)), NDV(pmt_count) AS pmt_count, COUNT(CASE WHEN pmt_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_cheque_count) AS pmt_cheque_count, COUNT(CASE WHEN pmt_cheque_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_amount) AS pmt_amount, COUNT(CASE WHEN pmt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_cheque_amount) AS pmt_cheque_amount, COUNT(CASE WHEN pmt_cheque_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_linked_flag) AS agent_linked_flag, COUNT(CASE WHEN agent_linked_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_linked_flag)), AVG(length(agent_linked_flag)), NDV(is_agent) AS is_agent, COUNT(CASE WHEN is_agent IS NULL THEN 1 ELSE NULL END), MAX(length(is_agent)), AVG(length(is_agent)), NDV(bank_inc_flag) AS bank_inc_flag, COUNT(CASE WHEN bank_inc_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_inc_flag)), AVG(length(bank_inc_flag)), NDV(bank_inc_update_channel) AS bank_inc_update_channel, COUNT(CASE WHEN bank_inc_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_inc_update_channel)), AVG(length(bank_inc_update_channel)), NDV(bank_inc_commence_date) AS bank_inc_commence_date, COUNT(CASE WHEN bank_inc_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_inc) AS agent_disburse_inc, COUNT(CASE WHEN agent_disburse_inc IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_inc)), AVG(length(agent_disburse_inc)), NDV(agent_inc_mail_flag) AS agent_inc_mail_flag, COUNT(CASE WHEN agent_inc_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_inc_mail_flag)), AVG(length(agent_inc_mail_flag)), NDV(bank_reb_flag) AS bank_reb_flag, COUNT(CASE WHEN bank_reb_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_reb_flag)), AVG(length(bank_reb_flag)), NDV(bank_reb_update_channel) AS bank_reb_update_channel, COUNT(CASE WHEN bank_reb_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_reb_update_channel)), AVG(length(bank_reb_update_channel)), NDV(bank_reb_commence_date) AS bank_reb_commence_date, COUNT(CASE WHEN bank_reb_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_reb) AS agent_disburse_reb, COUNT(CASE WHEN agent_disburse_reb IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_reb)), AVG(length(agent_disburse_reb)), NDV(agent_reb_mail_flag) AS agent_reb_mail_flag, COUNT(CASE WHEN agent_reb_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_reb_mail_flag)), AVG(length(agent_reb_mail_flag)), NDV(bank_fam_flag) AS bank_fam_flag, COUNT(CASE WHEN bank_fam_flag IS NULL THEN 1 ELSE NULL END), MAX(length(bank_fam_flag)), AVG(length(bank_fam_flag)), NDV(bank_fam_update_channel) AS bank_fam_update_channel, COUNT(CASE WHEN bank_fam_update_channel IS NULL THEN 1 ELSE NULL END), MAX(length(bank_fam_update_channel)), AVG(length(bank_fam_update_channel)), NDV(bank_fam_commence_date) AS bank_fam_commence_date, COUNT(CASE WHEN bank_fam_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(agent_disburse_fam) AS agent_disburse_fam, COUNT(CASE WHEN agent_disburse_fam IS NULL THEN 1 ELSE NULL END), MAX(length(agent_disburse_fam)), AVG(length(agent_disburse_fam)), NDV(agent_fam_mail_flag) AS agent_fam_mail_flag, COUNT(CASE WHEN agent_fam_mail_flag IS NULL THEN 1 ELSE NULL END), MAX(length(agent_fam_mail_flag)), AVG(length(agent_fam_mail_flag)), NDV(geo_meshblock_db) AS geo_meshblock_db, COUNT(CASE WHEN geo_meshblock_db IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE) FROM tmp_shindig_customer_pt2",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:04.146Z",
    "endTime" : "2020-11-24T07:54:07.349Z"
  }, {
    "rowsProduced" : 829160,
    "attributes" : {
      "thread_cpu_time_percentage" : "23",
      "thread_network_receive_wait_time" : "1427",
      "thread_cpu_time" : "19529",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "thread_network_receive_wait_time_percentage" : "2",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "3",
      "admission_wait" : "0",
      "connected_user" : "ird0qal@VSP.SAS.COM",
      "stats_missing" : "true",
      "planning_wait_time" : "81",
      "memory_aggregate_peak" : "1.221582098E9",
      "client_fetch_wait_time_percentage" : "2",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "estimated_per_node_peak_memory" : "2190166115",
      "client_fetch_wait_time" : "54",
      "rows_inserted" : "829160",
      "hdfs_bytes_written" : "38937524",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "ird0qal@VSP.SAS.COM",
      "session_id" : "6d440ad5e36cddd4:c996908e7f433baa",
      "stats_corrupt" : "false",
      "memory_accrual" : "2.421437476E9",
      "thread_total_time" : "86729",
      "thread_network_send_wait_time_percentage" : "68",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:60676",
      "thread_storage_wait_time_percentage" : "8",
      "memory_per_node_peak" : "3.2858177536E8",
      "thread_network_send_wait_time" : "58853",
      "num_fragments" : "36",
      "thread_storage_wait_time" : "6920"
    },
    "user" : "ird0qal",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "dev_raw",
    "durationMillis" : 3194,
    "queryId" : "824ba11c6fb1aa1f:615554e400000000",
    "statement" : "with t as\n(\nselect to_date(now()) as inc_on_date,l.* from mfile_ls l where run_date=to_date(now())\n),\ny as\n(\nselect to_date(now()) as inc_on_date,l.* from mfile_ls l where run_date=to_date(date_add(now(),-1))\n),\ndeleted as\n(\nselect y.*\nfrom y\nleft join t on y.file_name=t.file_name\nwhere t.run_date is null\n),\nnew as\n(\nselect t.*\nfrom t\nleft join y on y.file_name=t.file_name\nwhere y.run_date is null\n),\nchanged_current as\n(\nselect t.*\nfrom t\njoin y on t.file_name=y.file_name\nwhere t.last_modified<>y.last_modified\n),\nchanged_old as\n(\nselect y.*\nfrom y\njoin t on y.file_name=t.file_name\nwhere y.last_modified<>t.last_modified\n),\nunchanged as\n(\nselect t.*\nfrom t\njoin y on t.file_name=y.file_name and t.last_modified=y.last_modified\n)\ninsert into mfile_ls_inc\nselect 'new' as change_type,* from new union all\nselect 'deleted' as change_type,* from deleted union all\nselect 'changed_current' as change_type,* from changed_current union all\nselect 'changed_old' as change_type,* from changed_old union all\nselect 'unchanged' as change_type,* from unchanged",
    "queryType" : "DML",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:04.106Z",
    "endTime" : "2020-11-24T07:54:07.300Z"
  }, {
    "rowsProduced" : 802327,
    "attributes" : {
      "thread_cpu_time_percentage" : "89",
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "2232",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "thread_network_receive_wait_time_percentage" : "0",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "0",
      "connected_user" : "ird0qal@VSP.SAS.COM",
      "stats_missing" : "true",
      "planning_wait_time" : "22",
      "memory_aggregate_peak" : "2.04941046E8",
      "client_fetch_wait_time_percentage" : "3",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "estimated_per_node_peak_memory" : "22544384",
      "client_fetch_wait_time" : "42",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "ird0qal@VSP.SAS.COM",
      "session_id" : "6d440ad5e36cddd4:c996908e7f433baa",
      "stats_corrupt" : "false",
      "memory_accrual" : "1.73098742E8",
      "thread_total_time" : "2519",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:60676",
      "thread_storage_wait_time_percentage" : "11",
      "memory_per_node_peak" : "3.8797312E7",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "6",
      "thread_storage_wait_time" : "287"
    },
    "user" : "ird0qal",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "dev_raw",
    "durationMillis" : 1591,
    "queryId" : "694c512ca688695f:f1fce9c600000000",
    "statement" : "update mfile_ls set if_partitioned=if(instr(file_name,'=')=0,'N','Y')\nwhere run_date='2020-11-24'",
    "queryType" : "DML",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:02.452Z",
    "endTime" : "2020-11-24T07:54:04.043Z"
  }, {
    "rowsProduced" : 802327,
    "attributes" : {
      "thread_cpu_time_percentage" : "94",
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "5413",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "thread_network_receive_wait_time_percentage" : "0",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "1",
      "connected_user" : "ird0qal@VSP.SAS.COM",
      "stats_missing" : "true",
      "planning_wait_time" : "27",
      "memory_aggregate_peak" : "1.94075317E8",
      "client_fetch_wait_time_percentage" : "3",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "estimated_per_node_peak_memory" : "22544384",
      "client_fetch_wait_time" : "70",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "ird0qal@VSP.SAS.COM",
      "session_id" : "6d440ad5e36cddd4:c996908e7f433baa",
      "stats_corrupt" : "false",
      "memory_accrual" : "2.619614725E8",
      "thread_total_time" : "5753",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:60676",
      "thread_storage_wait_time_percentage" : "6",
      "memory_per_node_peak" : "3.881828352E7",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "6",
      "thread_storage_wait_time" : "340"
    },
    "user" : "ird0qal",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "dev_raw",
    "durationMillis" : 2169,
    "queryId" : "bb4aa3db2fa92547:4792708800000000",
    "statement" : "update mfile_ls set table_name=decode(instr(\n                    decode(instr(substr(file_name,instr(file_name,'/',-1,2)+1,instr(substr(file_name,instr(file_name,'/',-1,2)+1),'/')-1),'='),\n                    0,substr(file_name,instr(file_name,'/',-1,2)+1,instr(substr(file_name,instr(file_name,'/',-1,2)+1),'/')-1),\n                    substr(file_name,instr(file_name,'/',-1,3)+1,instr(substr(file_name,instr(file_name,'/',-1,3)+1),'/')-1)\n                    )\n                ,'='\n              ),\n        0,    decode(instr(substr(file_name,instr(file_name,'/',-1,2)+1,instr(substr(file_name,instr(file_name,'/',-1,2)+1),'/')-1),'='),\n                                    0,substr(file_name,instr(file_name,'/',-1,2)+1,instr(substr(file_name,instr(file_name,'/',-1,2)+1),'/')-1),\n                                    substr(file_name,instr(file_name,'/',-1,3)+1,instr(substr(file_name,instr(file_name,'/',-1,3)+1),'/')-1)\n                    )\n        ,substr(file_name,instr(file_name,'/',-1,4)+1,instr(substr(file_name,instr(file_name,'/',-1,4)+1),'/')-1)\n        )\nwhere run_date='2020-11-24'",
    "queryType" : "DML",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:54:00.200Z",
    "endTime" : "2020-11-24T07:54:02.369Z"
  }, {
    "rowsProduced" : 802327,
    "attributes" : {
      "thread_cpu_time_percentage" : "96",
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "5606",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "thread_network_receive_wait_time_percentage" : "0",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "ird0qal@VSP.SAS.COM",
      "stats_missing" : "true",
      "planning_wait_time" : "44",
      "memory_aggregate_peak" : "2.32040022E8",
      "client_fetch_wait_time_percentage" : "4",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "estimated_per_node_peak_memory" : "22544384",
      "client_fetch_wait_time" : "87",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "ird0qal@VSP.SAS.COM",
      "session_id" : "6d440ad5e36cddd4:c996908e7f433baa",
      "stats_corrupt" : "false",
      "memory_accrual" : "3.12423738E8",
      "thread_total_time" : "5847",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:60676",
      "thread_storage_wait_time_percentage" : "4",
      "memory_per_node_peak" : "3.88497408E7",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "6",
      "thread_storage_wait_time" : "241"
    },
    "user" : "ird0qal",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "dev_raw",
    "durationMillis" : 2171,
    "queryId" : "cb49e9ee2cc029a6:e8efadf500000000",
    "statement" : "update mfile_ls set db_name=concat(substr(substr(substr(file_name,instr(file_name,'/',1,4)+1),1,instr(substr(file_name,instr(file_name,'/',1,4)+1),'/',1)-1),3),'_',\n        substr( decode(substr(substr(file_name,instr(file_name,'/hive/')+6),1,instr(substr(file_name,instr(file_name,'/hive/')+6),'/')-1),'teams',substr(file_name,instr(file_name,'/hive/')+12),\n                       'projects',substr(file_name,instr(file_name,'/hive/')+15),\n                       substr(file_name,instr(file_name,'/hive/')+6)\n                )\n            ,1,instr(decode(substr(substr(file_name,instr(file_name,'/hive/')+6),1,instr(substr(file_name,instr(file_name,'/hive/')+6),'/')-1),'teams',substr(file_name,instr(file_name,'/hive/')+12)\n                            ,'projects',substr(file_name,instr(file_name,'/hive/')+15),substr(file_name,instr(file_name,'/hive/')+6)\n                    )\n                ,'/')-1\n        )\n        ,decode(substr(substr(file_name,instr(file_name,'/hive/')+6),1,instr(substr(file_name,instr(file_name,'/hive/')+6),'/')-1),'teams','_team','projects','_project',''))\nwhere run_date='2020-11-24'",
    "queryType" : "DML",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:57.924Z",
    "endTime" : "2020-11-24T07:54:00.095Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "31",
      "thread_network_receive_wait_time" : "303751",
      "thread_cpu_time" : "184830",
      "hdfs_average_scan_range" : "1.9115643995850623E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "4606870203",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "4606870203",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "6.871439669E9",
      "memory_per_node_peak_node" : "ird10146au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "7",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "5.8739845362E10",
      "thread_network_send_wait_time_percentage" : "11",
      "network_address" : "::ffff:10.239.248.79:33518",
      "thread_storage_wait_time_percentage" : "8",
      "memory_per_node_peak" : "1.54618822656E9",
      "thread_storage_wait_time" : "47724",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "4.6540922902869456E7",
      "thread_network_receive_wait_time_percentage" : "50",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "122",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "7405123775",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "529990420",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "2c4eea524d8713cf:ac4890d2fffe73ac",
      "stats_corrupt" : "false",
      "thread_total_time" : "605422",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "4606870203",
      "thread_network_send_wait_time" : "69116",
      "num_fragments" : "90"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 21609,
    "queryId" : "8c4ebfd674d346e3:dcb7b5b000000000",
    "statement" : "CREATE TABLE tmp_shindig_customer_pt2 STORED AS PARQUET AS select a.*, case when c.flngtocustomerkey is not null then 'Y' else null end as agent_linked_flag, case when d.flngcustomerkey is not null then 'Y' else null end as is_agent, b.bank_inc_flag, b.bank_inc_update_channel, b.bank_inc_commence_date, c.agent_disburse_inc, c.agent_inc_mail_flag, b.bank_reb_flag, b.bank_reb_update_channel, b.bank_reb_commence_date, c.agent_disburse_reb, c.agent_reb_mail_flag, b.bank_fam_flag, b.bank_fam_update_channel, b.bank_fam_commence_date, c.agent_disburse_fam, c.agent_fam_mail_flag, case when geo_meshblock like '%^[0-9]%' or geo_meshblock is null then 0 else cast(geo_meshblock as double) end as geo_meshblock_db from shindig_customer a left join ( select flngcustomerkey, INC as bank_inc_flag, INC_ACCOUNT_KEY, INC_COMMENCE as bank_inc_commence_date, case when inc_who = 'svcgtyserv' then 'MYIR' when inc_who = 'cnvr3' then 'CONVERSION' when inc_who = 'batch' then 'BATCH' when inc_who is null then null else 'STAFF' end as bank_inc_update_channel, REB as bank_reb_flag, REB_ACCOUNT_KEY, REB_COMMENCE as bank_reb_commence_date, case when reb_who = 'svcgtyserv' then 'MYIR' when reb_who = 'cnvr3' then 'CONVERSION' when reb_who = 'batch' then 'BATCH' when reb_who is null then null else 'STAFF' end as bank_reb_update_channel, FAM as bank_fam_flag, FAM_ACCOUNT_KEY, FAM_COMMENCE as bank_fam_commence_date, case when fam_who = 'svcgtyserv' then 'MYIR' when fam_who = 'cnvr3' then 'CONVERSION' when fam_who = 'batch' then 'BATCH' when fam_who is null then null else 'STAFF' end as bank_fam_update_channel from ( select a.flngcustomerkey, max(case when b.fstraccounttype = 'IIT' then 'Y' else null end) as INC, max(case when b.fstraccounttype = 'IIT' then b.flngaccountkey else null end) as INC_ACCOUNT_KEY, max(case when b.fstraccounttype = 'IIT' then a.fdtmcommence else null end) as INC_COMMENCE, max(case when b.fstraccounttype = 'IIT' then a.fstrwho else null end) as INC_WHO, max(case when b.fstraccounttype = 'REB' then 'Y' else null end) as REB, max(case when b.fstraccounttype = 'REB' then b.flngaccountkey else null end) as REB_ACCOUNT_KEY, max(case when b.fstraccounttype = 'REB' then a.fdtmcommence else null end) as REB_COMMENCE, max(case when b.fstraccounttype = 'REB' then a.fstrwho else null end) as REB_WHO, max(case when b.fstraccounttype = 'FAM' then 'Y' else null end) as FAM, max(case when b.fstraccounttype = 'FAM' then b.flngaccountkey else null end) as FAM_ACCOUNT_KEY, max(case when b.fstraccounttype = 'FAM' then a.fdtmcommence else null end) as FAM_COMMENCE, max(case when b.fstraccounttype = 'FAM' then a.fstrwho else null end) as FAM_WHO from prod_raw_restricted_access.app_tblbankaccountrefund a left join prod_raw_restricted_access.app_tblaccountinfo b on a.flngaccountkey = b.flngaccountkey where a.record_active_flag = 'Y' and b.record_active_flag = 'Y' and a.fdtmcease = '9999-12-31 00:00:00' and b.fstraccounttype in ('IIT', 'REB', 'FAM') group by a.flngcustomerkey ) a ) b ON a.customer_key = b.flngcustomerkey left join (select a.flngtocustomerkey, max(case when b.fstraccounttype = 'IIT' then a.flngtoaccountkey else null end) as INC_ACCOUNT_KEY, max(case when b.fstraccounttype = 'IIT' and fblndisbursementredirect = 1 then 'Y' else null end) as agent_disburse_inc, max(case when b.fstraccounttype = 'IIT' and fblnmailredirect = 1 then 'Y' else null end) as agent_inc_mail_flag, max(case when b.fstraccounttype = 'REB' then a.flngtoaccountkey else null end) as REB_ACCOUNT_KEY, max(case when b.fstraccounttype = 'REB' and fblndisbursementredirect = 1 then 'Y' else null end) as agent_disburse_reb, max(case when b.fstraccounttype = 'REB' and fblnmailredirect = 1 then 'Y' else null end) as agent_reb_mail_flag, max(case when b.fstraccounttype = 'FAM' then a.flngtoaccountkey else null end) as FAM_ACCOUNT_KEY, max(case when b.fstraccounttype = 'FAM' and fblndisbursementredirect = 1 then 'Y' else null end) as agent_disburse_fam, max(case when b.fstraccounttype = 'FAM' and fblnmailredirect = 1 then 'Y' else null end) as agent_fam_mail_flag from prod_raw_restricted_access.app_tblnz_taxpreplink a left join prod_raw_restricted_access.app_tblaccountinfo b on a.flngtoaccountkey = b.flngaccountkey where a.fdtmcease = '9999-12-31 00:00:00' and a.fblnactive = 1 and a.record_active_flag = 'Y' and b.record_active_flag = 'Y' group by a.flngtocustomerkey ) c on a.customer_key = c.flngtocustomerkey left join (select flngcustomerkey from prod_raw_restricted_access.app_tblindicator where fstrindicator = 'TAXAGT' and record_active_flag ='Y' and flngver = 0 and fdtmcease = '9999-12-31 00:00:00' group by flngcustomerkey ) d on a.customer_key = d.flngcustomerkey",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:35.870Z",
    "endTime" : "2020-11-24T07:53:57.479Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "1",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "2c4eea524d8713cf:ac4890d2fffe73ac",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:33518",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 6924,
    "queryId" : "3c4e71403c5f29e6:d6e3c50300000000",
    "statement" : "drop table if exists tmp_shindig_customer_pt2 purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:28.917Z",
    "endTime" : "2020-11-24T07:53:35.841Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "5",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "33",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "3979",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 11999,
    "queryId" : "7444b4ebd182c2af:450603bc00000000",
    "statement" : "compute stats shindig_customer",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:16.800Z",
    "endTime" : "2020-11-24T07:53:28.799Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "84",
      "thread_network_receive_wait_time" : "2070",
      "thread_cpu_time" : "11950",
      "hdfs_average_scan_range" : "7.96625375E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "477975225",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "477975225",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "5.850348418607473E8",
      "thread_network_receive_wait_time_percentage" : "15",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "16",
      "memory_aggregate_peak" : "7.33759816E8",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "421546208",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "8.54201668E8",
      "thread_total_time" : "14166",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:40006",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "477975225",
      "memory_per_node_peak" : "1.2281970688E8",
      "thread_network_send_wait_time" : "7",
      "num_fragments" : "7",
      "thread_storage_wait_time" : "139"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 2109,
    "queryId" : "8b4dc08ce51379ec:00161e3800000000",
    "statement" : "SELECT NDV(customer_key) AS customer_key, COUNT(CASE WHEN customer_key IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number) AS ird_number, COUNT(CASE WHEN ird_number IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number_formatted) AS ird_number_formatted, COUNT(CASE WHEN ird_number_formatted IS NULL THEN 1 ELSE NULL END), MAX(length(ird_number_formatted)), AVG(length(ird_number_formatted)), NDV(customer_level) AS customer_level, COUNT(CASE WHEN customer_level IS NULL THEN 1 ELSE NULL END), MAX(length(customer_level)), AVG(length(customer_level)), NDV(customer_segment) AS customer_segment, COUNT(CASE WHEN customer_segment IS NULL THEN 1 ELSE NULL END), MAX(length(customer_segment)), AVG(length(customer_segment)), NDV(dob_commence_date) AS dob_commence_date, COUNT(CASE WHEN dob_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(customer_type) AS customer_type, COUNT(CASE WHEN customer_type IS NULL THEN 1 ELSE NULL END), MAX(length(customer_type)), AVG(length(customer_type)), NDV(customer_class) AS customer_class, COUNT(CASE WHEN customer_class IS NULL THEN 1 ELSE NULL END), MAX(length(customer_class)), AVG(length(customer_class)), NDV(customer_subtype) AS customer_subtype, COUNT(CASE WHEN customer_subtype IS NULL THEN 1 ELSE NULL END), MAX(length(customer_subtype)), AVG(length(customer_subtype)), NDV(geo_city) AS geo_city, COUNT(CASE WHEN geo_city IS NULL THEN 1 ELSE NULL END), MAX(length(geo_city)), AVG(length(geo_city)), NDV(geo_meshblock) AS geo_meshblock, COUNT(CASE WHEN geo_meshblock IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock)), AVG(length(geo_meshblock)), NDV(geo_post_code) AS geo_post_code, COUNT(CASE WHEN geo_post_code IS NULL THEN 1 ELSE NULL END), MAX(length(geo_post_code)), AVG(length(geo_post_code)), NDV(geo_country) AS geo_country, COUNT(CASE WHEN geo_country IS NULL THEN 1 ELSE NULL END), MAX(length(geo_country)), AVG(length(geo_country)), NDV(sl_indicator) AS sl_indicator, COUNT(CASE WHEN sl_indicator IS NULL THEN 1 ELSE NULL END), 1, CAST(1 as DOUBLE), NDV(sl_nzb_obb_indicator) AS sl_nzb_obb_indicator, COUNT(CASE WHEN sl_nzb_obb_indicator IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nzb_obb_indicator)), AVG(length(sl_nzb_obb_indicator)), NDV(sl_total_loan_balance) AS sl_total_loan_balance, COUNT(CASE WHEN sl_total_loan_balance IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_start_date) AS sl_nrb_start_date, COUNT(CASE WHEN sl_nrb_start_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_duration) AS sl_nrb_duration, COUNT(CASE WHEN sl_nrb_duration IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nrb_duration)), AVG(length(sl_nrb_duration)), NDV(sl_obb_category) AS sl_obb_category, COUNT(CASE WHEN sl_obb_category IS NULL THEN 1 ELSE NULL END), MAX(length(sl_obb_category)), AVG(length(sl_obb_category)), NDV(sl_debt_amount) AS sl_debt_amount, COUNT(CASE WHEN sl_debt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_periods_in_debt) AS sl_periods_in_debt, COUNT(CASE WHEN sl_periods_in_debt IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(myir_first_login) AS myir_first_login, COUNT(CASE WHEN myir_first_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_last_login) AS myir_last_login, COUNT(CASE WHEN myir_last_login IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_num_logins) AS myir_num_logins, COUNT(CASE WHEN myir_num_logins IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(myir_account_opened) AS myir_account_opened, COUNT(CASE WHEN myir_account_opened IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_account_closed) AS myir_account_closed, COUNT(CASE WHEN myir_account_closed IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(myir_current_status) AS myir_current_status, COUNT(CASE WHEN myir_current_status IS NULL THEN 1 ELSE NULL END), MAX(length(myir_current_status)), AVG(length(myir_current_status)), NDV(pmt_earliest_payment_date) AS pmt_earliest_payment_date, COUNT(CASE WHEN pmt_earliest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_date) AS pmt_latest_payment_date, COUNT(CASE WHEN pmt_latest_payment_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_cheque_date) AS pmt_latest_cheque_date, COUNT(CASE WHEN pmt_latest_cheque_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_latest_payment_method) AS pmt_latest_payment_method, COUNT(CASE WHEN pmt_latest_payment_method IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_latest_payment_method)), AVG(length(pmt_latest_payment_method)), NDV(pmt_other_channels) AS pmt_other_channels, COUNT(CASE WHEN pmt_other_channels IS NULL THEN 1 ELSE NULL END), MAX(length(pmt_other_channels)), AVG(length(pmt_other_channels)), NDV(pmt_count) AS pmt_count, COUNT(CASE WHEN pmt_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_cheque_count) AS pmt_cheque_count, COUNT(CASE WHEN pmt_cheque_count IS NULL THEN 1 ELSE NULL END), 8, CAST(8 as DOUBLE), NDV(pmt_amount) AS pmt_amount, COUNT(CASE WHEN pmt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(pmt_cheque_amount) AS pmt_cheque_amount, COUNT(CASE WHEN pmt_cheque_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE) FROM shindig_customer",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:20.852Z",
    "endTime" : "2020-11-24T07:53:22.961Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5961,
    "queryId" : "074530935fb1a323:2331b48c00000000",
    "statement" : "invalidate metadata shindig_customer",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:53:10.816Z",
    "endTime" : "2020-11-24T07:53:16.777Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "89",
      "thread_network_receive_wait_time" : "986",
      "thread_cpu_time" : "32450",
      "hdfs_average_scan_range" : "3.98407205E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "478088646",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "478088646",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "4.321304738E9",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "10",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.7666455515E10",
      "thread_network_send_wait_time_percentage" : "8",
      "network_address" : "::ffff:10.239.248.79:40006",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "7.2593965056E8",
      "thread_storage_wait_time" : "172",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "6.49574583488823E8",
      "thread_network_receive_wait_time_percentage" : "3",
      "planning_wait_time_percentage" : "24",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "4004",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "3904441940",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "477413199",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "thread_total_time" : "36500",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "478088646",
      "thread_network_send_wait_time" : "2892",
      "num_fragments" : "12"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 17001,
    "queryId" : "be4d6e1c9a66f7a9:29fd0f0000000000",
    "statement" : "CREATE TABLE shindig_customer STORED AS PARQUET AS select a.*, b.pmt_earliest_payment_date, b.pmt_latest_payment_date, b.pmt_latest_cheque_date, b.pmt_latest_payment_method, b.pmt_other_channels, b.pmt_count, b.pmt_cheque_count, b.pmt_amount, b.pmt_cheque_amount from tmp_customer_segmentation_pt2 a left join tmp_payments b ON a.customer_key = b.customer_key",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:52:46.752Z",
    "endTime" : "2020-11-24T07:53:03.753Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "33",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "3971",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 11989,
    "queryId" : "7f48f5971e493da8:39f9dee500000000",
    "statement" : "drop table if exists shindig_customer purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:52:34.737Z",
    "endTime" : "2020-11-24T07:52:46.726Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "11",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "40",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "3979",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 10002,
    "queryId" : "a448f831d5d754a9:98670bde00000000",
    "statement" : "compute stats tmp_payments",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:52:24.713Z",
    "endTime" : "2020-11-24T07:52:34.715Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5919,
    "queryId" : "cb4f88b119cc5ae2:55986e4100000000",
    "statement" : "invalidate metadata tmp_payments",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:52:18.771Z",
    "endTime" : "2020-11-24T07:52:24.690Z"
  }, {
    "rowsProduced" : 2840780,
    "attributes" : {
      "thread_cpu_time_percentage" : "32",
      "thread_network_receive_wait_time" : "172137",
      "thread_cpu_time" : "156317",
      "hdfs_average_scan_range" : "2.3951440152777776E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "1724503691",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "1724503691",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "7.32291923968E9",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "4",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "5.87068148E8",
      "thread_network_send_wait_time_percentage" : "33",
      "network_address" : "::ffff:10.239.248.79:40006",
      "thread_storage_wait_time_percentage" : "1",
      "memory_per_node_peak" : "7.32291923968E9",
      "thread_storage_wait_time" : "3781",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "1.6035867918186054E8",
      "thread_network_receive_wait_time_percentage" : "35",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "1",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "69",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "3727976955",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "2840780",
      "hdfs_bytes_written" : "40731323",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "thread_total_time" : "494626",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "1724503691",
      "thread_network_send_wait_time" : "162389",
      "num_fragments" : "36"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 30461,
    "queryId" : "f34a2aa70359c1ea:e6e987b000000000",
    "statement" : "CREATE TABLE tmp_payments STORED AS PARQUET AS select acc.flngcustomerkey as customer_key, min(fdtmreceived) as pmt_earliest_payment_date, max(fdtmreceived) as pmt_latest_payment_date, max(case when pmt.fstrpaymenttype = 'CHEQUE' then fdtmreceived else null end) as pmt_latest_cheque_date, max(l_pmt.fstrpaymenttype) as pmt_latest_payment_method, max(case when pmt.fstrpaymenttype <> 'CHEQUE' then 'Y' else 'N' end) as pmt_other_channels, sum(case when fdtmreceived >= add_months(now(), -12) then 1 else 0 end) as pmt_count, sum(case when pmt.fstrpaymenttype = 'CHEQUE' and fdtmreceived >= add_months(now(), -12) then 1 else 0 end) as pmt_cheque_count, sum(case when fdtmreceived >= add_months(now(), -12) then pmt.fcuramount else 0 end) as pmt_amount, sum(case when pmt.fstrpaymenttype = 'CHEQUE' and fdtmreceived >= add_months(now(), -12) then pmt.fcuramount else 0 end) as pmt_cheque_amount from prod_raw_restricted_access.app_tblpayment pmt inner join prod_raw_restricted_access.app_tblallocation alo ON pmt.flngpaymentkey = alo.flngpaymentkey inner join prod_raw_restricted_access.app_tblaccount acc ON alo.flngaccountkey = acc.flngaccountkey left join tmp_latest_payment_type l_pmt ON acc.flngcustomerkey = l_pmt.flngcustomerkey where pmt.flngver = 0 and acc.flngver = 0 and pmt.fblnactive = 1 and pmt.record_active_flag = 'Y' and alo.record_active_flag = 'Y' and acc.record_active_flag = 'Y' group by acc.flngcustomerkey",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:51:42.700Z",
    "endTime" : "2020-11-24T07:52:13.161Z"
  }, {
    "rowsProduced" : 2840780,
    "attributes" : {
      "thread_cpu_time_percentage" : "34",
      "thread_network_receive_wait_time" : "204583",
      "thread_cpu_time" : "210613",
      "hdfs_average_scan_range" : "2.1698419939393938E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "1432095716",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "1432095716",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "6.89342251008E9",
      "memory_per_node_peak_node" : "ird10146au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "4",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "7.2852990952E10",
      "thread_network_send_wait_time_percentage" : "32",
      "network_address" : "::ffff:10.239.248.79:40006",
      "thread_storage_wait_time_percentage" : "2",
      "memory_per_node_peak" : "6.89342251008E9",
      "thread_storage_wait_time" : "11591",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "4.229695399128477E7",
      "thread_network_receive_wait_time_percentage" : "33",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "37",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "1414195070",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "2840780",
      "hdfs_bytes_written" : "13432941",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "thread_total_time" : "626105",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "1432095716",
      "thread_network_send_wait_time" : "199316",
      "num_fragments" : "30"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 40816,
    "queryId" : "0044267005b75d0f:da008f5b00000000",
    "statement" : "CREATE TABLE tmp_latest_payment_type STORED AS PARQUET AS select flngcustomerkey, fstrpaymenttype from ( select acc.flngcustomerkey, pmt.fstrpaymenttype, row_number() over (partition by flngcustomerkey order by fdtmreceived desc) as rn from prod_raw_restricted_access.app_tblpayment pmt inner join prod_raw_restricted_access.app_tblallocation alo ON pmt.flngpaymentkey = alo.flngpaymentkey inner join prod_raw_restricted_access.app_tblaccount acc ON alo.flngaccountkey = acc.flngaccountkey where pmt.flngver = 0 and acc.flngver = 0 and pmt.fblnactive = 1 and pmt.record_active_flag = 'Y' and alo.record_active_flag = 'Y' and acc.record_active_flag = 'Y' ) x where rn = 1",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:54.569Z",
    "endTime" : "2020-11-24T07:51:35.385Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "1",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "69",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "10",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "28420d3436146224:c57fc605d03285b5",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:53658",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "prod_staging",
    "durationMillis" : 2857,
    "queryId" : "b74f1a3348d7058e:f73a8cf000000000",
    "statement" : "create table prod_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from prod_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:51:00.921Z",
    "endTime" : "2020-11-24T07:51:03.778Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 1980,
    "queryId" : "b34d0178a05a826f:c478d1f100000000",
    "statement" : "drop table if exists tmp_customer_segmentation_pt3 purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:52.565Z",
    "endTime" : "2020-11-24T07:50:54.545Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7991,
    "queryId" : "fc480eed929ef309:9a3ad9ae00000000",
    "statement" : "drop table if exists tmp_payments purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:44.551Z",
    "endTime" : "2020-11-24T07:50:52.542Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "66",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "11",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "734ae2bd50c5fc5f:447e556aedec729e",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:40174",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "test_staging",
    "durationMillis" : 2842,
    "queryId" : "104ecb95c19e642b:0b618a2a00000000",
    "statement" : "create table test_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from test_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:42.949Z",
    "endTime" : "2020-11-24T07:50:45.791Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "1",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "d4435b4f1628a615:c825c222925350a6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:40006",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7270,
    "queryId" : "614cd78d968a72d7:c931cee900000000",
    "statement" : "drop table if exists tmp_latest_payment_type purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:37.259Z",
    "endTime" : "2020-11-24T07:50:44.529Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5962,
    "queryId" : "f84bb748befc0845:9a3646b900000000",
    "statement" : "invalidate metadata tmp_customer_segmentation_pt2",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:31.183Z",
    "endTime" : "2020-11-24T07:50:37.145Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "82",
      "thread_network_receive_wait_time" : "1879",
      "thread_cpu_time" : "25866",
      "hdfs_average_scan_range" : "3.7374170833333336E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "448490050",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "448490050",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "3.372199519E9",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "9",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.04294361015E10",
      "thread_network_send_wait_time_percentage" : "12",
      "network_address" : "::ffff:10.239.248.79:60852",
      "thread_storage_wait_time_percentage" : "1",
      "memory_per_node_peak" : "5.716312064E8",
      "thread_storage_wait_time" : "262",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "6.836713523441163E8",
      "thread_network_receive_wait_time_percentage" : "6",
      "planning_wait_time_percentage" : "25",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "4003",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "5133828096",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "436182487",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "thread_total_time" : "31679",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "448490050",
      "thread_network_send_wait_time" : "3672",
      "num_fragments" : "12"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 16109,
    "queryId" : "0146275dd7aef4ae:572a786700000000",
    "statement" : "CREATE TABLE tmp_customer_segmentation_pt2 STORED AS PARQUET AS select csi.*, tlp.min_account_opened as myir_account_opened, tlp.max_account_closed as myir_account_closed, tlp.myir_current_status from tmp_customer_segmentation csi left join tmp_logon_priority tlp on (csi.customer_key = tlp.customer_key )",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:07.130Z",
    "endTime" : "2020-11-24T07:50:23.239Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5981,
    "queryId" : "fd43a31aeb450760:afa3865d00000000",
    "statement" : "invalidate metadata tmp_logon_priority",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:50:01.126Z",
    "endTime" : "2020-11-24T07:50:07.107Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7952,
    "queryId" : "7f4dc3661eb90437:d7e88fac00000000",
    "statement" : "drop table if exists tmp_customer_segmentation_pt2 purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:49:53.147Z",
    "endTime" : "2020-11-24T07:50:01.099Z"
  }, {
    "rowsProduced" : 3831858,
    "attributes" : {
      "thread_cpu_time_percentage" : "63",
      "thread_network_receive_wait_time" : "2992",
      "thread_cpu_time" : "10375",
      "hdfs_average_scan_range" : "6799615.0",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "81595380",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "81595380",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "1.617588929E9",
      "memory_per_node_peak_node" : "ird10145au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "12",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.0710694495E9",
      "thread_network_send_wait_time_percentage" : "18",
      "network_address" : "::ffff:10.239.248.79:60852",
      "thread_storage_wait_time_percentage" : "1",
      "memory_per_node_peak" : "2.7665629184E8",
      "thread_storage_wait_time" : "246",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "5.2983817222129875E8",
      "thread_network_receive_wait_time_percentage" : "18",
      "planning_wait_time_percentage" : "30",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "3994",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "3668041726",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "3831858",
      "hdfs_bytes_written" : "57754807",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "thread_total_time" : "16527",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "81595380",
      "thread_network_send_wait_time" : "2914",
      "num_fragments" : "18"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 13488,
    "queryId" : "844bcf26b5cdb454:732277c400000000",
    "statement" : "create table tmp_logon_priority stored as parquet as select a.* from tmp_min_max_logon a inner join (select customer_key, min(status_priority) as status_priority from tmp_min_max_logon group by customer_key) b on a.customer_key = b.customer_key and a.status_priority = b.status_priority",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:49:33.096Z",
    "endTime" : "2020-11-24T07:49:46.584Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7987,
    "queryId" : "944e263ca3d99b7d:1b863af600000000",
    "statement" : "drop table if exists tmp_logon_priority",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:49:25.078Z",
    "endTime" : "2020-11-24T07:49:33.065Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5966,
    "queryId" : "134ff85deb2085c5:bdb42db800000000",
    "statement" : "invalidate metadata tmp_min_max_logon",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:49:19.089Z",
    "endTime" : "2020-11-24T07:49:25.055Z"
  }, {
    "rowsProduced" : 4038610,
    "attributes" : {
      "thread_cpu_time_percentage" : "62",
      "thread_network_receive_wait_time" : "2849",
      "thread_cpu_time" : "6951",
      "hdfs_average_scan_range" : "1.2224920666666666E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "73349524",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "73349524",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "true",
      "memory_aggregate_peak" : "5.03319976E8",
      "memory_per_node_peak_node" : "ird10146au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "4",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.51659988E8",
      "thread_network_send_wait_time_percentage" : "11",
      "network_address" : "::ffff:10.239.248.79:60852",
      "thread_storage_wait_time_percentage" : "2",
      "memory_per_node_peak" : "1.5257829376E8",
      "thread_storage_wait_time" : "225",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "5.963354748081098E8",
      "thread_network_receive_wait_time_percentage" : "25",
      "planning_wait_time_percentage" : "31",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "4002",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "1468006400",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "4038610",
      "hdfs_bytes_written" : "63096656",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "thread_total_time" : "11247",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "73349524",
      "thread_network_send_wait_time" : "1222",
      "num_fragments" : "12"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 13082,
    "queryId" : "604c8df38415b10e:1a53898b00000000",
    "statement" : "create table tmp_min_max_logon stored as parquet as select customer_key, myir_current_status, status_priority, min(myir_account_opened) as min_account_opened, max(myir_account_closed) as max_account_closed from tmp_logons group by customer_Key, myir_current_status, status_priority",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:59.045Z",
    "endTime" : "2020-11-24T07:49:12.127Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7987,
    "queryId" : "8a4ac631549775f1:4665e6a000000000",
    "statement" : "drop table if exists tmp_min_max_logon",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:51.034Z",
    "endTime" : "2020-11-24T07:48:59.021Z"
  }, {
    "rowsProduced" : 336501,
    "attributes" : {
      "thread_cpu_time_percentage" : "92",
      "thread_network_receive_wait_time" : "133",
      "thread_cpu_time" : "1921",
      "hdfs_average_scan_range" : "5.9438968E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "59438968",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "59438968",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "1.1214863862037873E9",
      "thread_network_receive_wait_time_percentage" : "6",
      "oom" : "false",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "0",
      "connected_user" : "ird0qal@VSP.SAS.COM",
      "stats_missing" : "true",
      "planning_wait_time" : "19",
      "memory_aggregate_peak" : "1.4168358912E8",
      "client_fetch_wait_time_percentage" : "1",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "BEESWAX",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "306296726",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "42",
      "file_formats" : "TEXT/NONE",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "ird0qal@VSP.SAS.COM",
      "session_id" : "174e06525ac710b1:a4bb29c924869cad",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "3.232785825E8",
      "thread_total_time" : "2097",
      "thread_network_send_wait_time_percentage" : "1",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:59612",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "59438968",
      "memory_per_node_peak" : "1.4168358912E8",
      "thread_network_send_wait_time" : "30",
      "num_fragments" : "2",
      "thread_storage_wait_time" : "13"
    },
    "user" : "ird0qal",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "dev_raw",
    "durationMillis" : 3012,
    "queryId" : "484edaaa053aacfd:250617bf00000000",
    "statement" : "upsert into mfile_ls select * from mfile_ls_stg",
    "queryType" : "DML",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:54.959Z",
    "endTime" : "2020-11-24T07:48:57.971Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5946,
    "queryId" : "ed422f0fa0f5b543:37ab69c100000000",
    "statement" : "invalidate metadata tmp_logons",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:45.065Z",
    "endTime" : "2020-11-24T07:48:51.011Z"
  }, {
    "rowsProduced" : 5272215,
    "attributes" : {
      "thread_cpu_time_percentage" : "44",
      "thread_network_receive_wait_time" : "16578",
      "thread_cpu_time" : "20631",
      "hdfs_average_scan_range" : "1.347035061904762E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "282877363",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "282877363",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "7.7853326E8",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "10",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.58897699E9",
      "thread_network_send_wait_time_percentage" : "20",
      "network_address" : "::ffff:10.239.248.79:60852",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "1.675624448E8",
      "thread_storage_wait_time" : "133",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "8.036260503358005E8",
      "thread_network_receive_wait_time_percentage" : "36",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "60",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "941038784",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "5272215",
      "hdfs_bytes_written" : "94556917",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "thread_total_time" : "46430",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "282877363",
      "thread_network_send_wait_time" : "9088",
      "num_fragments" : "18"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 12245,
    "queryId" : "4248c840fe4282eb:aefbe56500000000",
    "statement" : "CREATE TABLE tmp_logons STORED AS PARQUET AS select wlg.flngweblogonkey, flngcustomerkey as customer_key, case when wlg.fdtmopened = '9999-12-31 00:00:00' then null else wlg.fdtmopened end as myir_account_opened, case when wlg.fdtmclosed = '9999-12-31 00:00:00' then null else wlg.fdtmclosed end as myir_account_closed, case when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper(wlg.fstraccesstype) <> 'VIEW' then 'ACTIVE' when wlg.fdtmclosed <> '9999-12-31 00:00:00' and wlg.fdtmopened = wlg.fdtmclosed then 'PENDING' when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper (wlg.fstraccesstype) = 'VIEW' then 'VIEW' when wlg.fdtmclosed <> '9999-12-31 00:00:00' then 'CLOSED' end as myir_current_status, case when upper(wlg.fstraccesstype) in ('OWNIND','OWNBUS') then 'OWNER' when upper(wlg.fstraccesstype) in ('ACTREP') then 'ACCOUNT REP' when upper(wlg.fstraccesstype) in ('USER') then 'USER' when upper(wlg.fstraccesstype) in ('VIEW') then 'VIEW' end as myir_access_type, case when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper(wlg.fstraccesstype) <> 'VIEW' then '1' when wlg.fdtmclosed <> '9999-12-31 00:00:00' and wlg.fdtmopened = wlg.fdtmclosed then '2' when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper (wlg.fstraccesstype) = 'VIEW' then '3' when wlg.fdtmclosed <> '9999-12-31 00:00:00' then '4' end as STATUS_PRIORITY from prod_raw_restricted_access.wrq_tblweblogon wlg where wlg.flngver = 0",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:25.004Z",
    "endTime" : "2020-11-24T07:48:37.249Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9346072facf0fb9e:26aef14853013a94",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:60852",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "0dfe00c8-3b33-4d53-b97b-e86ed886d2eb"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7134,
    "queryId" : "1a4f577e9ff145e3:fe10459600000000",
    "statement" : "drop table if exists tmp_logons purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:17.845Z",
    "endTime" : "2020-11-24T07:48:24.979Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "f441b4cc3c19f6a4:9eba0830741f00aa",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:38776",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "3adff437-4b49-4723-a393-3b8313883571"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5949,
    "queryId" : "eb4bc39e7a1addef:6ff9694900000000",
    "statement" : "invalidate metadata tmp_customer_segmentation",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:48:11.768Z",
    "endTime" : "2020-11-24T07:48:17.717Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "43",
      "thread_network_receive_wait_time" : "58461",
      "thread_cpu_time" : "48839",
      "hdfs_average_scan_range" : "8.3493598E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "1669871960",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "1669871960",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "2.754398391E9",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "7",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "8.985470061E9",
      "thread_network_send_wait_time_percentage" : "5",
      "network_address" : "::ffff:10.239.248.79:38776",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "4.7380955136E8",
      "thread_storage_wait_time" : "172",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "9.580411140778635E8",
      "thread_network_receive_wait_time_percentage" : "52",
      "planning_wait_time_percentage" : "22",
      "admission_wait" : "1",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "4032",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "2359401875",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "389864675",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "f441b4cc3c19f6a4:9eba0830741f00aa",
      "stats_corrupt" : "false",
      "thread_total_time" : "112988",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "1669871960",
      "thread_network_send_wait_time" : "5516",
      "num_fragments" : "18"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "3adff437-4b49-4723-a393-3b8313883571"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 18342,
    "queryId" : "f74e078ef3d5e0fe:9f6568f000000000",
    "statement" : "CREATE TABLE tmp_customer_segmentation STORED AS PARQUET AS select csi.*, myir_first_login, myir_last_login, myir_num_logins from customer_segmentation csi left join ( select customer_key, min(logon) as myir_first_login, max(logon) as myir_last_login, sum(case when logon >= add_months(now(), -12) then 1 else 0 end) as myir_num_logins from tmp_myir_logins group by customer_Key ) wlg on csi.customer_key = wlg.customer_key",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:47:47.704Z",
    "endTime" : "2020-11-24T07:48:06.046Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "f441b4cc3c19f6a4:9eba0830741f00aa",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:38776",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "3adff437-4b49-4723-a393-3b8313883571"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 6438,
    "queryId" : "594775dc2fc2187a:1428e69b00000000",
    "statement" : "drop table if exists tmp_customer_segmentation purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:47:41.242Z",
    "endTime" : "2020-11-24T07:47:47.680Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9a49e00c8ab5e969:4aeb52a153e55093",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:46126",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5980,
    "queryId" : "1b4f8bad8f82a124:a4ac355000000000",
    "statement" : "refresh tmp_myir_logins",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:47:35.036Z",
    "endTime" : "2020-11-24T07:47:41.016Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "12",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9a49e00c8ab5e969:4aeb52a153e55093",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:46126",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 9955,
    "queryId" : "1d421c15382d7a16:e6b1fc8c00000000",
    "statement" : "compute stats tmp_myir_logins",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:47:25.057Z",
    "endTime" : "2020-11-24T07:47:35.012Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "84",
      "thread_network_receive_wait_time" : "2373",
      "thread_cpu_time" : "13387",
      "hdfs_average_scan_range" : "2.035556422142857E8",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "2849778991",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "2849778991",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "9.569403339209853E8",
      "thread_network_receive_wait_time_percentage" : "15",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "4",
      "memory_aggregate_peak" : "6.69157936E8",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "421543936",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9a49e00c8ab5e969:4aeb52a153e55093",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "7.825511815E8",
      "thread_total_time" : "15937",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:46126",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "2849778991",
      "memory_per_node_peak" : "3.2667336704E8",
      "thread_network_send_wait_time" : "11",
      "num_fragments" : "11",
      "thread_storage_wait_time" : "166"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 2394,
    "queryId" : "614a446efe16730c:0cdc8f8200000000",
    "statement" : "SELECT NDV(customer_key) AS customer_key, COUNT(CASE WHEN customer_key IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(flngweblogonkey) AS flngweblogonkey, COUNT(CASE WHEN flngweblogonkey IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(logon) AS logon, COUNT(CASE WHEN logon IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(account_opened) AS account_opened, COUNT(CASE WHEN account_opened IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(account_closed) AS account_closed, COUNT(CASE WHEN account_closed IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(current_status) AS current_status, COUNT(CASE WHEN current_status IS NULL THEN 1 ELSE NULL END), MAX(length(current_status)), AVG(length(current_status)), NDV(access_type) AS access_type, COUNT(CASE WHEN access_type IS NULL THEN 1 ELSE NULL END), MAX(length(access_type)), AVG(length(access_type)) FROM tmp_myir_logins",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:47:25.148Z",
    "endTime" : "2020-11-24T07:47:27.542Z"
  }, {
    "rowsProduced" : 104143880,
    "attributes" : {
      "thread_cpu_time_percentage" : "67",
      "thread_network_receive_wait_time" : "43399",
      "thread_cpu_time" : "144867",
      "hdfs_average_scan_range" : "5.381168326785714E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "3013454263",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "3013454263",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "7.562171252E9",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "6",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "1.406665807005E11",
      "thread_network_send_wait_time_percentage" : "3",
      "network_address" : "::ffff:10.239.248.79:46126",
      "thread_storage_wait_time_percentage" : "10",
      "memory_per_node_peak" : "1.32070244352E9",
      "thread_storage_wait_time" : "21038",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "3.074973159874104E7",
      "thread_network_receive_wait_time_percentage" : "20",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "61",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "1653025868",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "104143880",
      "hdfs_bytes_written" : "2848369781",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9a49e00c8ab5e969:4aeb52a153e55093",
      "stats_corrupt" : "false",
      "thread_total_time" : "216606",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "3013454263",
      "thread_network_send_wait_time" : "7302",
      "num_fragments" : "24"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 35306,
    "queryId" : "e84260f7518beb3b:6488e5c500000000",
    "statement" : "CREATE TABLE tmp_myir_logins STORED AS PARQUET AS select wlg.flngcustomerkey as customer_key, wlg.flngweblogonkey, wla.fdtmlogon as logon, case when wlg.fdtmopened = '9999-12-31 00:00:00' then null else wlg.fdtmopened end as account_opened, case when wlg.fdtmclosed = '9999-12-31 00:00:00' then null else wlg.fdtmclosed end as account_closed, case when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper(wlg.fstraccesstype) <> 'VIEW' then 'ACTIVE' when wlg.fdtmclosed <> '9999-12-31 00:00:00' and wlg.fdtmopened = wlg.fdtmclosed then 'PENDING' when wlg.fdtmclosed = '9999-12-31 00:00:00' and upper (wlg.fstraccesstype) = 'VIEW' then 'VIEW' when wlg.fdtmclosed <> '9999-12-31 00:00:00' then 'CLOSED' end as CURRENT_STATUS, case when upper(wlg.fstraccesstype) in ('OWNIND','OWNBUS') then 'OWNER' when upper(wlg.fstraccesstype) in ('ACTREP') then 'ACCOUNT REP' when upper(wlg.fstraccesstype) in ('USER') then 'USER' when upper(wlg.fstraccesstype) in ('VIEW') then 'VIEW' end as ACCESS_TYPE from prod_raw_restricted_access.wrq_tblweblogonactivity wla inner join prod_raw_restricted_access.wrq_tblweblogon wlg on wla.flngweblogonkey = wlg.flngweblogonkey where wla.fstrsource = 'Fast.Logon' and wla.record_active_flag = 'Y' and wlg.flngver = 0 and wlg.record_active_flag = 'Y'",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:46:42.942Z",
    "endTime" : "2020-11-24T07:47:18.248Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "9a49e00c8ab5e969:4aeb52a153e55093",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:46126",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7623,
    "queryId" : "c34f11aefab3d995:8867580800000000",
    "statement" : "drop table if exists tmp_myir_logins purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:46:35.294Z",
    "endTime" : "2020-11-24T07:46:42.917Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "a64c1e3127fb5572:942ec8b91903c4a2",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "1",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:48650",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7989,
    "queryId" : "a6471deec1da718c:e7d7228a00000000",
    "statement" : "invalidate metadata customer_segmentation",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:46:27.179Z",
    "endTime" : "2020-11-24T07:46:35.168Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "4",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "a64c1e3127fb5572:942ec8b91903c4a2",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:48650",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 7930,
    "queryId" : "3745f6a05502957b:855b574100000000",
    "statement" : "compute stats customer_segmentation",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:46:19.226Z",
    "endTime" : "2020-11-24T07:46:27.156Z"
  }, {
    "rowsProduced" : 1,
    "attributes" : {
      "thread_cpu_time_percentage" : "84",
      "thread_network_receive_wait_time" : "1174",
      "thread_cpu_time" : "6886",
      "hdfs_average_scan_range" : "5.3421499833333336E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "320528999",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "320528999",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "5.93570323143745E8",
      "thread_network_receive_wait_time_percentage" : "14",
      "oom" : "false",
      "num_backends" : "6",
      "planning_wait_time_percentage" : "1",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "11",
      "memory_aggregate_peak" : "4.69032394E8",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10142au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "hdfs_bytes_read_remote" : "0",
      "estimated_per_node_peak_memory" : "320880640",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "client_fetch_wait_time" : "0",
      "file_formats" : "PARQUET/SNAPPY",
      "admission_result" : "Admitted immediately",
      "pool" : "root.default",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "a64c1e3127fb5572:942ec8b91903c4a2",
      "hdfs_bytes_read_remote_percentage" : "0",
      "stats_corrupt" : "false",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.34516197E8",
      "thread_total_time" : "8191",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:48650",
      "thread_storage_wait_time_percentage" : "1",
      "hdfs_bytes_read_local" : "320528999",
      "memory_per_node_peak" : "7.873757184E7",
      "thread_network_send_wait_time" : "9",
      "num_fragments" : "7",
      "thread_storage_wait_time" : "122"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 1204,
    "queryId" : "c74a294390ee37ab:98e149f200000000",
    "statement" : "SELECT NDV(customer_key) AS customer_key, COUNT(CASE WHEN customer_key IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number) AS ird_number, COUNT(CASE WHEN ird_number IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE), NDV(ird_number_formatted) AS ird_number_formatted, COUNT(CASE WHEN ird_number_formatted IS NULL THEN 1 ELSE NULL END), MAX(length(ird_number_formatted)), AVG(length(ird_number_formatted)), NDV(customer_level) AS customer_level, COUNT(CASE WHEN customer_level IS NULL THEN 1 ELSE NULL END), MAX(length(customer_level)), AVG(length(customer_level)), NDV(customer_segment) AS customer_segment, COUNT(CASE WHEN customer_segment IS NULL THEN 1 ELSE NULL END), MAX(length(customer_segment)), AVG(length(customer_segment)), NDV(dob_commence_date) AS dob_commence_date, COUNT(CASE WHEN dob_commence_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(customer_type) AS customer_type, COUNT(CASE WHEN customer_type IS NULL THEN 1 ELSE NULL END), MAX(length(customer_type)), AVG(length(customer_type)), NDV(customer_class) AS customer_class, COUNT(CASE WHEN customer_class IS NULL THEN 1 ELSE NULL END), MAX(length(customer_class)), AVG(length(customer_class)), NDV(customer_subtype) AS customer_subtype, COUNT(CASE WHEN customer_subtype IS NULL THEN 1 ELSE NULL END), MAX(length(customer_subtype)), AVG(length(customer_subtype)), NDV(geo_city) AS geo_city, COUNT(CASE WHEN geo_city IS NULL THEN 1 ELSE NULL END), MAX(length(geo_city)), AVG(length(geo_city)), NDV(geo_meshblock) AS geo_meshblock, COUNT(CASE WHEN geo_meshblock IS NULL THEN 1 ELSE NULL END), MAX(length(geo_meshblock)), AVG(length(geo_meshblock)), NDV(geo_post_code) AS geo_post_code, COUNT(CASE WHEN geo_post_code IS NULL THEN 1 ELSE NULL END), MAX(length(geo_post_code)), AVG(length(geo_post_code)), NDV(geo_country) AS geo_country, COUNT(CASE WHEN geo_country IS NULL THEN 1 ELSE NULL END), MAX(length(geo_country)), AVG(length(geo_country)), NDV(sl_indicator) AS sl_indicator, COUNT(CASE WHEN sl_indicator IS NULL THEN 1 ELSE NULL END), 1, CAST(1 as DOUBLE), NDV(sl_nzb_obb_indicator) AS sl_nzb_obb_indicator, COUNT(CASE WHEN sl_nzb_obb_indicator IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nzb_obb_indicator)), AVG(length(sl_nzb_obb_indicator)), NDV(sl_total_loan_balance) AS sl_total_loan_balance, COUNT(CASE WHEN sl_total_loan_balance IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_start_date) AS sl_nrb_start_date, COUNT(CASE WHEN sl_nrb_start_date IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_nrb_duration) AS sl_nrb_duration, COUNT(CASE WHEN sl_nrb_duration IS NULL THEN 1 ELSE NULL END), MAX(length(sl_nrb_duration)), AVG(length(sl_nrb_duration)), NDV(sl_obb_category) AS sl_obb_category, COUNT(CASE WHEN sl_obb_category IS NULL THEN 1 ELSE NULL END), MAX(length(sl_obb_category)), AVG(length(sl_obb_category)), NDV(sl_debt_amount) AS sl_debt_amount, COUNT(CASE WHEN sl_debt_amount IS NULL THEN 1 ELSE NULL END), 16, CAST(16 as DOUBLE), NDV(sl_periods_in_debt) AS sl_periods_in_debt, COUNT(CASE WHEN sl_periods_in_debt IS NULL THEN 1 ELSE NULL END), 4, CAST(4 as DOUBLE) FROM customer_segmentation",
    "queryType" : "QUERY",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:46:19.286Z",
    "endTime" : "2020-11-24T07:46:20.490Z"
  }, {
    "rowsProduced" : 10008205,
    "attributes" : {
      "thread_cpu_time_percentage" : "37",
      "thread_network_receive_wait_time" : "57010",
      "thread_cpu_time" : "99112",
      "hdfs_average_scan_range" : "3.571844496923077E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "2321698923",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "2321698923",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "4.505340006E9",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "0",
      "client_fetch_wait_time" : "3",
      "file_formats" : "PARQUET/SNAPPY",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.2246397507E10",
      "thread_network_send_wait_time_percentage" : "35",
      "network_address" : "::ffff:10.239.248.79:48650",
      "thread_storage_wait_time_percentage" : "7",
      "memory_per_node_peak" : "1.76093659136E9",
      "thread_storage_wait_time" : "19326",
      "query_status" : "OK",
      "hdfs_scanner_average_bytes_read_per_second" : "2.8654011668209933E7",
      "thread_network_receive_wait_time_percentage" : "21",
      "planning_wait_time_percentage" : "0",
      "admission_wait" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "planning_wait_time" : "37",
      "client_fetch_wait_time_percentage" : "0",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "4610939153",
      "hdfs_bytes_read_local_percentage" : "100",
      "hdfs_bytes_read_from_cache_percentage" : "0",
      "rows_inserted" : "10008205",
      "hdfs_bytes_written" : "319944371",
      "admission_result" : "Admitted immediately",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "a64c1e3127fb5572:942ec8b91903c4a2",
      "stats_corrupt" : "false",
      "thread_total_time" : "268785",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "hdfs_bytes_read_local" : "2321698923",
      "thread_network_send_wait_time" : "93336",
      "num_fragments" : "41"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 17485,
    "queryId" : "0446214dcafad43a:e9b09b6600000000",
    "statement" : "CREATE TABLE customer_segmentation STORED AS PARQUET AS select ci.flngCustomerKey as customer_key, cast(ci.fstrid as int) as ird_number, ci.fstrformattedid as ird_number_formatted, ci.fstrcustomerlevel as customer_level, std.fstrcustomersegment as customer_segment, ci.fdtmcommence as dob_commence_date, ci.fstrCustomerType as customer_type, coalesce(std.fstrcustomerclass, fstrcustomersubtypeclass) as customer_class, std.fstrcustomersubtype as customer_subtype, ci.fstrcity as geo_city, ci.fstrstreet2 as geo_meshblock, ci.fstrzip as geo_post_code, ci.fstrCountry as geo_country, case when sl_nzb_obb_indicator is null then 0 else 1 end as sl_indicator, sl.sl_nzb_obb_indicator, sl.sl_total_loan_balance, sl.sl_nrb_start_date, sl.sl_nrb_duration, sl.sl_obb_category, sl.sl_debt_amount, sl.sl_periods_in_debt from prod_raw_restricted_access.app_tblcustomerinfo ci left join prod_raw_restricted_access.app_tblnz_customerstd std on (ci.flngdockey = std.flngdockey and std.record_active_flag = 'Y') left join tmp_sl as sl on (sl.ird_number = cast(ci.fstrid as int)) where ci.record_active_flag = 'Y'",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:55.127Z",
    "endTime" : "2020-11-24T07:46:12.612Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "61",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10144au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "8",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "0a4d279975942b42:0c9f437600112d87",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:45036",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "d7fff870-62bf-4074-ad51-928f97ce5a7f"
    },
    "detailsAvailable" : true,
    "database" : "prod_staging",
    "durationMillis" : 2701,
    "queryId" : "3543996ed5666eb5:5065eebe00000000",
    "statement" : "create table prod_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from prod_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:59.549Z",
    "endTime" : "2020-11-24T07:46:02.250Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "2",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "a64c1e3127fb5572:942ec8b91903c4a2",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "DROP_TABLE",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:48650",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "693a0278-7cbf-4483-b85f-93d74b72204d"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 6946,
    "queryId" : "5c4ad03411bcb792:a0b0344400000000",
    "statement" : "drop table if exists customer_segmentation purge",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:48.156Z",
    "endTime" : "2020-11-24T07:45:55.102Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "3",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "49486d6abb332e53:1e3ebac06a037aa6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "COMPUTE_STATS",
      "planning_wait_time_percentage" : "40",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "3979",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:58514",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 9994,
    "queryId" : "494415dd88cddbe0:79d114af00000000",
    "statement" : "compute stats tmp_sl",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:38.048Z",
    "endTime" : "2020-11-24T07:45:48.042Z"
  }, {
    "rowsProduced" : 0,
    "attributes" : {
      "thread_cpu_time_percentage" : "100",
      "thread_network_receive_wait_time" : "0",
      "thread_cpu_time" : "0",
      "memory_spilled" : "0",
      "query_status" : "OK",
      "thread_network_receive_wait_time_percentage" : "0",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "1",
      "planning_wait_time_percentage" : "2",
      "admission_wait" : "0",
      "connected_user" : "irdrun@VSP.SAS.COM",
      "stats_missing" : "false",
      "planning_wait_time" : "66",
      "client_fetch_wait_time_percentage" : "0",
      "memory_per_node_peak_node" : "ird10141au.vsp.sas.com:22000",
      "session_type" : "HIVESERVER2",
      "estimated_per_node_peak_memory" : "10485760",
      "client_fetch_wait_time" : "2",
      "rows_inserted" : "0",
      "hdfs_bytes_written" : "0",
      "file_formats" : "",
      "admission_result" : "Admitted immediately",
      "pool" : "root.ird_pr_r_dadm",
      "original_user" : "irdrun@VSP.SAS.COM",
      "session_id" : "5142d2f67f60393f:5b9368b66a36cc93",
      "stats_corrupt" : "false",
      "thread_total_time" : "0",
      "thread_network_send_wait_time_percentage" : "0",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "network_address" : "::ffff:10.239.248.79:59820",
      "thread_storage_wait_time_percentage" : "0",
      "memory_per_node_peak" : "8192.0",
      "thread_network_send_wait_time" : "0",
      "num_fragments" : "1",
      "thread_storage_wait_time" : "0"
    },
    "user" : "irdrun",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "test_staging",
    "durationMillis" : 2696,
    "queryId" : "4c470e85c0f77f2b:58a2f83700000000",
    "statement" : "create table test_staging.LCF_WORKFLOW_STATUS with SERDEPROPERTIES ('field.delim'='\\u0006', 'line.delim'='\\007', 'serializataion.format'='\\u0006') STORED AS TEXTFILE as select * from test_raw.LCF_WORKFLOW_STATUS where 1=0 ;",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:43.511Z",
    "endTime" : "2020-11-24T07:45:46.207Z"
  }, {
    "rowsProduced" : null,
    "attributes" : {
      "client_fetch_wait_time" : "1",
      "file_formats" : "",
      "query_status" : "OK",
      "admission_result" : "Unknown",
      "original_user" : "ird0txh@VSP.SAS.COM",
      "session_id" : "49486d6abb332e53:1e3ebac06a037aa6",
      "stats_corrupt" : "false",
      "oom" : "false",
      "ddl_type" : "RESET_METADATA",
      "planning_wait_time_percentage" : "0",
      "connected_user" : "ird0txh@VSP.SAS.COM",
      "impala_version" : "impalad version 3.2.0-cdh6.3.2 RELEASE (build 1bb9836227301b839a32c6bc230e35439d5984ac)",
      "stats_missing" : "false",
      "planning_wait_time" : "0",
      "client_fetch_wait_time_percentage" : "0",
      "network_address" : "::ffff:10.239.248.79:58514",
      "session_type" : "HIVESERVER2"
    },
    "user" : "ird0txh",
    "coordinator" : {
      "hostId" : "44a2d97a-9105-4722-b3d4-95274de2a362"
    },
    "detailsAvailable" : true,
    "database" : "lab_r3_assurance_project",
    "durationMillis" : 5936,
    "queryId" : "ea47b6f858f63405:5bd0649600000000",
    "statement" : "invalidate metadata tmp_sl",
    "queryType" : "DDL",
    "queryState" : "FINISHED",
    "startTime" : "2020-11-24T07:45:32.090Z",
    "endTime" : "2020-11-24T07:45:38.026Z"
  }, {
    "rowsProduced" : 693729,
    "attributes" : {
      "thread_cpu_time_percentage" : "10",
      "thread_network_receive_wait_time" : "77110",
      "thread_cpu_time" : "15725",
      "hdfs_average_scan_range" : "5.8025251461538464E7",
      "memory_spilled" : "0",
      "hdfs_bytes_read_short_circuit" : "1508525466",
      "hdfs_bytes_read_from_cache" : "0",
      "hdfs_bytes_read" : "1508656538",
      "oom" : "false",
      "ddl_type" : "CREATE_TABLE_AS_SELECT",
      "num_backends" : "6",
      "stats_missing" : "false",
      "memory_aggregate_peak" : "8.08434383E8",
      "memory_per_node_peak_node" : "ird10145au.vsp.sas.com:22000",
      "hdfs_bytes_read_remote" : "131072",
      "client_fetch_wait_time" : "5",
      "file_formats" : "PARQUET/SNAPPY,TEXT/NONE",
      "pool" : "root.default",
      "hdfs_bytes_read_remote_percentage" : "0",
      "hdfs_bytes_read_short_circuit_percentage" : "100",
      "memory_accrual" : "2.50901812E9",
      "thread_network_send_wait_time_percentage" : "16",
 