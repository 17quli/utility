-- Load data manually from RAW TDW tables into RAW START table
select count(1) from  ${var:target_db}.${var:app_tbl_name};

INSERT INTO TABLE  ${var:target_db}.${var:app_tbl_name} 
SELECT
CAST(FLNGDOCKEY AS INT) AS flngDocKey,
CAST(FBLNMULTIPLEACTIVITY AS SMALLINT) AS fblnMultipleActivity,
CAST(FCURGROSSSALES AS DECIMAL(19,4)) AS fcurGrossSales,
CAST(FCURGOODSOPENINGSTOCK AS DECIMAL(19,4)) AS fcurGoodsOpeningStock,
CAST(FCURGOODSPURCHASES AS DECIMAL(19,4)) AS fcurGoodsPurchases,
CAST(FCURGOODSCLOSINGSTOCK AS DECIMAL(19,4)) AS fcurGoodsClosingStock,
CAST(FCURGROSSPROFIT AS DECIMAL(19,4)) AS fcurGrossProfit,
CAST(FCUROTHERGROSSINTEREST AS DECIMAL(19,4)) AS fcurOtherGrossInterest,
CAST(FCUROTHERGROSSDIVIDENDS AS DECIMAL(19,4)) AS fcurOtherGrossDividends,
CAST(FCUROTHERRENTAL AS DECIMAL(19,4)) AS fcurOtherRental,
CAST(FCUROTHERINCOME AS DECIMAL(19,4)) AS fcurOtherIncome,
CAST(FCURTOTALINCOME AS DECIMAL(19,4)) AS fcurTotalIncome,
CAST(FCURBADDEBT AS DECIMAL(19,4)) AS fcurBadDebt,
CAST(FCURACCOUNTINGDEPRECIATION AS DECIMAL(19,4)) AS fcurAccountingDepreciation,
CAST(FCURINSURANCE AS DECIMAL(19,4)) AS fcurInsurance,
CAST(FCURINTERESTEXPENSE AS DECIMAL(19,4)) AS fcurInterestExpense,
CAST(FCURPROFESSIONALFEES AS DECIMAL(19,4)) AS fcurProfessionalFees,
CAST(FCURRATES AS DECIMAL(19,4)) AS fcurRates,
CAST(FCURRENTALPAYMENTS AS DECIMAL(19,4)) AS fcurRentalPayments,
CAST(FCURREPAIRSMAINTENANCE AS DECIMAL(19,4)) AS fcurRepairsMaintenance,
CAST(FCURRESEARCHDEVELOPMENT AS DECIMAL(19,4)) AS fcurResearchDevelopment,
CAST(FCURASSOCIATEDREMUNERATION AS DECIMAL(19,4)) AS fcurAssociatedRemuneration,
CAST(FCUREMPLOYEESALARY AS DECIMAL(19,4)) AS fcurEmployeeSalary,
CAST(FCURCONTRACTORPAYMENTS AS DECIMAL(19,4)) AS fcurContractorPayments,
CAST(FCUROTHEREXPENSES AS DECIMAL(19,4)) AS fcurOtherExpenses,
CAST(FCURTOTALEXPENSES AS DECIMAL(19,4)) AS fcurTotalExpenses,
CAST(FCUREXCEPTIONALITEMS AS DECIMAL(19,4)) AS fcurExceptionalItems,
CAST(FCURNETPROFITBEFORETAX AS DECIMAL(19,4)) AS fcurNetProfitBeforeTax,
CAST(FCURTAXADJUSTMENTS AS DECIMAL(19,4)) AS fcurTaxAdjustments,
CAST(FCURCURRENTTAXABLEPROFIT AS DECIMAL(19,4)) AS fcurCurrentTaxableProfit,
CAST(FCURACCOUNTSRECEIVABLE AS DECIMAL(19,4)) AS fcurAccountsReceivable,
CAST(FCURCASHDEPOSITS AS DECIMAL(19,4)) AS fcurCashDeposits,
CAST(FCUROTHERASSETS AS DECIMAL(19,4)) AS fcurOtherAssets,
CAST(FCURVEHICLES AS DECIMAL(19,4)) AS fcurVehicles,
CAST(FCURPLANTMACHINERY AS DECIMAL(19,4)) AS fcurPlantMachinery,
CAST(FCURFURNITUREFITTINGS AS DECIMAL(19,4)) AS fcurFurnitureFittings,
CAST(FCURLAND AS DECIMAL(19,4)) AS fcurLand,
CAST(FCURBUILDINGS AS DECIMAL(19,4)) AS fcurBuildings,
CAST(FCUROTHERFIXEDASSETS AS DECIMAL(19,4)) AS fcurOtherFixedAssets,
CAST(FCURINTANGIBLES AS DECIMAL(19,4)) AS fcurIntangibles,
CAST(FCURSHARESINTERESTS AS DECIMAL(19,4)) AS fcurSharesInterests,
CAST(FCURTERMDEPOSITS AS DECIMAL(19,4)) AS fcurTermDeposits,
CAST(FCURNONCURRENTASSETS AS DECIMAL(19,4)) AS fcurNonCurrentAssets,
CAST(FCURTOTALASSETS AS DECIMAL(19,4)) AS fcurTotalAssets,
CAST(FCURPROVISIONS AS DECIMAL(19,4)) AS fcurProvisions,
CAST(FCURACCOUNTSPAYABLE AS DECIMAL(19,4)) AS fcurAccountsPayable,
CAST(FCURCURRENTLOAN AS DECIMAL(19,4)) AS fcurCurrentLoan,
CAST(FCUROTHERCURRENTLIABILITIES AS DECIMAL(19,4)) AS fcurOtherCurrentLiabilities,
CAST(FCURTOTALCURRENTLIABILITIES AS DECIMAL(19,4)) AS fcurTotalCurrentLiabilities,
CAST(FCURNONCURRENTLIABILITIES AS DECIMAL(19,4)) AS fcurNonCurrentLiabilities,
CAST(FCURFINALTOTALLIABILITIES AS DECIMAL(19,4)) AS fcurFinalTotalLiabilities,
CAST(FCUROWNERSEQUITY AS DECIMAL(19,4)) AS fcurOwnersEquity,
CAST(FCURTAXDEPRECIATION AS DECIMAL(19,4)) AS fcurTaxDepreciation,
CAST(FCURUNTAXEDGAINS AS DECIMAL(19,4)) AS fcurUntaxedGains,
CAST(FCURADDITIONFIXEDASSETS AS DECIMAL(19,4)) AS fcurAdditionFixedAssets,
CAST(FCURDISPOSALSFIXEDASSETS AS DECIMAL(19,4)) AS fcurDisposalsFixedAssets,
CAST(FCURDIVIDENDSPAID AS DECIMAL(19,4)) AS fcurDividendsPaid,
CAST(FCURDRAWINGS AS DECIMAL(19,4)) AS fcurDrawings,
CAST(FCURCURRENTACCOUNTBALANCES AS DECIMAL(19,4)) AS fcurCurrentAccountBalances,
CAST(FCURTAXDEDUCTIBLELOSS AS DECIMAL(19,4)) AS fcurTaxDeductibleLoss,
CAST(FSTRWHO AS VARCHAR(20)) AS fstrWho,
CAST(EFFECTIVE_FROM AS TIMESTAMP) AS FDTMWHEN,
CAST(record_effective_timestamp AS TIMESTAMP) AS record_effective_timestamp,
CAST(record_expiry_timestamp AS TIMESTAMP) AS record_expiry_timestamp,
CAST(record_active_flag AS VARCHAR(1)) AS record_active_flag,
CAST(record_deleted_flag AS VARCHAR(1)) AS record_deleted_flag,
CAST(insert_object_run_key AS INT) AS insert_object_run_key,
CAST(update_object_run_key AS INT) AS update_object_run_key
FROM  ${var:target_db}.${var:tdw_tbl_name}; 

-- Check row counts of RAW tables with TDW history loaded:
select count(*) as raw_new_count from  ${var:target_db}.${var:app_tbl_name};
select count(distinct flngdockey) as distinct_keys_count FROM  ${var:target_db}.${var:app_tbl_name};
select count(*) as low_date_count FROM  ${var:target_db}.${var:app_tbl_name} where record_effective_timestamp = '1800-01-01 00:00:00';
select count(*) as high_date_count FROM  ${var:target_db}.${var:app_tbl_name} where record_expiry_timestamp = '9000-12-31 00:00:00';
