-- Load data manually from RAW TDW tables into RAW START table
select count(1) from  ${var:target_db}.${var:app_tbl_name};

INSERT INTO TABLE  ${var:target_db}.${var:app_tbl_name} 
(flngdockey,
fcurgrossinterest,
fcurdividendgross,
fcurmaoridistributions,
fcurnetrentalincome,
fcurnettradingincome,
fcurotherincome,
fcurtotalincome,
fcurtotaladjustments,
fcurincomeafteradjustments,
fcurtotaldonations,
fcurincomeafterdonations,
fcurlossesbroughtforward,
fcurtaxableincome,
fcurtotaltaxpayable,
fcuroverseastax,
fcurtaxafteroverseas,
fcurdividendimputation,
fcurtaxafterdividend,
fcurrwt,
fcurrlwt,
fcurtaxafterrwt,
fcurmaoricredits,
fcurresidualincometax,
fcurprovisionaltaxpaid,
fcurtaxamount,
fcuroverpaymentprovisional,
fcurrefundafteroverpayment,
fcurtransferprovisional,
fcurtransfercustomeramount,
fcurtotalrefund,
fdtmprovisionalstartdate,
fstrprovisionaloption,
fcurprovisionaltax,
fblncfc,
fcurlosstocarryforward,
fcurexcessimputation,
fcurexcessimputationasloss,
fstrwho,
fdtmWhen,
record_effective_timestamp,
record_expiry_timestamp,
record_active_flag,
record_deleted_flag,
insert_object_run_key,
update_object_run_key
)
SELECT
CAST(FLNGDOCKEY AS INT) AS flngdockey,
CAST(FCURGROSSINTEREST AS DECIMAL(19,4)) AS fcurgrossinterest,
CAST(FCURDIVIDENDGROSS AS DECIMAL(19,4)) AS fcurdividendgross,
CAST(FCURMAORIDISTRIBUTIONS AS DECIMAL(19,4)) AS fcurmaoridistributions,
CAST(FCURNETRENTALINCOME AS DECIMAL(19,4)) AS fcurnetrentalincome,
CAST(FCURNETTRADINGINCOME AS DECIMAL(19,4)) AS fcurnettradingincome,
CAST(FCUROTHERINCOME AS DECIMAL(19,4)) AS fcurotherincome,
CAST(FCURTOTALINCOME AS DECIMAL(19,4)) AS fcurtotalincome,
CAST(FCURTOTALADJUSTMENTS AS DECIMAL(19,4)) AS fcurtotaladjustments,
CAST(FCURINCOMEAFTERADJUSTMENTS AS DECIMAL(19,4)) AS fcurincomeafteradjustments,
CAST(FCURTOTALDONATIONS AS DECIMAL(19,4)) AS fcurtotaldonations,
CAST(FCURINCOMEAFTERDONATIONS AS DECIMAL(19,4)) AS fcurincomeafterdonations,
CAST(FCURLOSSESBROUGHTFORWARD AS DECIMAL(19,4)) AS fcurlossesbroughtforward,
CAST(FCURTAXABLEINCOME AS DECIMAL(19,4)) AS fcurtaxableincome,
CAST(FCURTOTALTAXPAYABLE AS DECIMAL(19,4)) AS fcurtotaltaxpayable,
CAST(FCUROVERSEASTAX AS DECIMAL(19,4)) AS fcuroverseastax,
CAST(FCURTAXAFTEROVERSEAS AS DECIMAL(19,4)) AS fcurtaxafteroverseas,
CAST(FCURDIVIDENDIMPUTATION AS DECIMAL(19,4)) AS fcurdividendimputation,
CAST(FCURTAXAFTERDIVIDEND AS DECIMAL(19,4)) AS fcurtaxafterdividend,
CAST(FCURRWT AS DECIMAL(19,4)) AS fcurrwt,
CAST(FCURRLWT AS DECIMAL(19,4)) AS fcurrlwt,
CAST(FCURTAXAFTERRWT AS DECIMAL(19,4)) AS fcurtaxafterrwt,
CAST(FCURMAORICREDITS AS DECIMAL(19,4)) AS fcurmaoricredits,
CAST(FCURRESIDUALINCOMETAX AS DECIMAL(19,4)) AS fcurresidualincometax,
CAST(FCURPROVISIONALTAXPAID AS DECIMAL(19,4)) AS fcurprovisionaltaxpaid,
CAST(FCURTAXAMOUNT AS DECIMAL(19,4)) AS fcurtaxamount,
CAST(FCUROVERPAYMENTPROVISIONAL AS DECIMAL(19,4)) AS fcuroverpaymentprovisional,
CAST(FCURREFUNDAFTEROVERPAYMENT AS DECIMAL(19,4)) AS fcurrefundafteroverpayment,
CAST(FCURTRANSFERPROVISIONAL AS DECIMAL(19,4)) AS fcurtransferprovisional,
CAST(FCURTRANSFERCUSTOMERAMOUNT AS DECIMAL(19,4)) AS fcurtransfercustomeramount,
CAST(FCURTOTALREFUND AS DECIMAL(19,4)) AS fcurtotalrefund,
CAST(FDTMPROVISIONALSTARTDATE AS TIMESTAMP) AS fdtmprovisionalstartdate,
CAST(FSTRPROVISIONALOPTION AS VARCHAR(100)) AS fstrprovisionaloption,
CAST(FCURPROVISIONALTAX AS DECIMAL(19,4)) AS fcurprovisionaltax,
CAST(FBLNCFC AS SMALLINT) AS fblncfc,
CAST(FCURLOSSTOCARRYFORWARD AS DECIMAL(19,4)) AS fcurlosstocarryforward,
CAST(FCUREXCESSIMPUTATION AS DECIMAL(19,4)) AS fcurexcessimputation,
CAST(FCUREXCESSIMPUTATIONASLOSS AS DECIMAL(19,4)) AS fcurexcessimputationasloss,
CAST(FSTRWHO AS VARCHAR(20)) AS fstrwho,
CAST(record_effective_timestamp AS TIMESTAMP) AS fdtmwhen,
CAST(record_effective_timestamp AS TIMESTAMP) AS record_effective_timestamp,
CAST(record_expiry_timestamp AS TIMESTAMP) AS record_expiry_timestamp,
CAST(CURRENT_REC_FLAG AS VARCHAR(1)) AS record_active_flag,
CAST('N' AS VARCHAR(1)) AS record_deleted_flag,
CAST(insert_object_run_key AS INT) AS insert_object_run_key,
CAST(update_object_run_key AS INT) AS update_object_run_key
FROM  ${var:target_db}.${var:tdw_tbl_name}; 

-- Check row counts of RAW tables with TDW history loaded:
select count(1) as fstrresmethodcnt from ${var:target_db}.${var:app_tbl_name} where fstrResMethod='I';
select count(*) as raw_new_count from  ${var:target_db}.${var:app_tbl_name};
select count(distinct flngdockey) as distinct_keys_count FROM  ${var:target_db}.${var:app_tbl_name};
select count(*) as low_date_count FROM  ${var:target_db}.${var:app_tbl_name} where record_effective_timestamp = '1800-01-01 00:00:00';
select count(*) as high_date_count FROM  ${var:target_db}.${var:app_tbl_name} where record_expiry_timestamp = '9000-12-31 00:00:00';
